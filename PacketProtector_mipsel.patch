diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/.config buildroot/.config
--- buildroot.orig/.config	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/.config	2010-09-27 22:10:00.000000000 -0400
@@ -0,0 +1,1670 @@
+#
+# Automatically generated make config: don't edit
+# OpenWrt version: Kamikaze (r23118)
+# Fri Sep 24 22:51:19 2010
+#
+CONFIG_HAVE_DOT_CONFIG=y
+# CONFIG_TARGET_ppc40x is not set
+# CONFIG_TARGET_ppc44x is not set
+# CONFIG_TARGET_atheros is not set
+# CONFIG_TARGET_ar71xx is not set
+# CONFIG_TARGET_at91 is not set
+# CONFIG_TARGET_avr32 is not set
+# CONFIG_TARGET_etrax is not set
+# CONFIG_TARGET_brcm63xx is not set
+CONFIG_TARGET_brcm47xx=y
+# CONFIG_TARGET_sibyte is not set
+# CONFIG_TARGET_cns3xxx is not set
+# CONFIG_TARGET_octeon is not set
+# CONFIG_TARGET_ep93xx is not set
+# CONFIG_TARGET_cobalt is not set
+# CONFIG_TARGET_gemini is not set
+# CONFIG_TARGET_coldfire is not set
+# CONFIG_TARGET_mpc52xx is not set
+# CONFIG_TARGET_mpc83xx is not set
+# CONFIG_TARGET_imx21 is not set
+# CONFIG_TARGET_goldfish is not set
+# CONFIG_TARGET_amazon is not set
+# CONFIG_TARGET_ifxmips is not set
+# CONFIG_TARGET_adm5120 is not set
+# CONFIG_TARGET_xburst is not set
+# CONFIG_TARGET_iop32x is not set
+# CONFIG_TARGET_ixp4xx is not set
+# CONFIG_TARGET_malta is not set
+# CONFIG_TARGET_kirkwood is not set
+# CONFIG_TARGET_orion is not set
+# CONFIG_TARGET_pxa is not set
+# CONFIG_TARGET_rb532 is not set
+# CONFIG_TARGET_pxcab is not set
+# CONFIG_TARGET_rdc is not set
+# CONFIG_TARGET_au1000 is not set
+# CONFIG_TARGET_ramips is not set
+# CONFIG_TARGET_s3c24xx is not set
+# CONFIG_TARGET_ps3 is not set
+# CONFIG_TARGET_ar7 is not set
+# CONFIG_TARGET_omap24xx is not set
+# CONFIG_TARGET_omap35xx is not set
+# CONFIG_TARGET_ubicom32 is not set
+# CONFIG_TARGET_uml is not set
+# CONFIG_TARGET_x86 is not set
+# CONFIG_TARGET_ppc40x_Default is not set
+# CONFIG_TARGET_kirkwood_Sheevaplug is not set
+# CONFIG_TARGET_kirkwood_Dockstar is not set
+# CONFIG_TARGET_malta_le_Default is not set
+# CONFIG_TARGET_malta_be_Default is not set
+# CONFIG_TARGET_octeon_generic is not set
+# CONFIG_TARGET_octeon_mototech is not set
+# CONFIG_TARGET_orion_generic_Default is not set
+# CONFIG_TARGET_orion_harddisk_Default is not set
+# CONFIG_TARGET_brcm63xx_Broadcom is not set
+# CONFIG_TARGET_brcm63xx_Broadcom-wl is not set
+# CONFIG_TARGET_brcm63xx_Atheros is not set
+# CONFIG_TARGET_brcm63xx_Ralink is not set
+# CONFIG_TARGET_brcm63xx_NoWiFi is not set
+# CONFIG_TARGET_brcm63xx_GW6X00 is not set
+# CONFIG_TARGET_iop32x_Default is not set
+# CONFIG_TARGET_sibyte_Default is not set
+# CONFIG_TARGET_xburst_qi_lb60_Default is not set
+# CONFIG_TARGET_xburst_n516_Default is not set
+# CONFIG_TARGET_xburst_n526_Default is not set
+# CONFIG_TARGET_xburst_id800wt_Default is not set
+# CONFIG_TARGET_avr32_Default is not set
+# CONFIG_TARGET_etrax_default is not set
+# CONFIG_TARGET_etrax_vhdl_no_fb is not set
+# CONFIG_TARGET_imx21_Default is not set
+# CONFIG_TARGET_ixp4xx_generic_Default is not set
+# CONFIG_TARGET_ixp4xx_generic_Atheros-ath5k is not set
+# CONFIG_TARGET_ixp4xx_generic_NSLU2 is not set
+# CONFIG_TARGET_ixp4xx_generic_NAS100d is not set
+# CONFIG_TARGET_ixp4xx_generic_DSMG600RevA is not set
+# CONFIG_TARGET_ixp4xx_generic_USR8200 is not set
+# CONFIG_TARGET_ixp4xx_harddisk_FSG3 is not set
+# CONFIG_TARGET_rb532_Default is not set
+# CONFIG_TARGET_ramips_rt288x_Default is not set
+# CONFIG_TARGET_ramips_rt305x_Default is not set
+# CONFIG_TARGET_coldfire_Default is not set
+# CONFIG_TARGET_au1000_au1500_Atheros is not set
+# CONFIG_TARGET_au1000_au1500_InternetBox is not set
+# CONFIG_TARGET_au1000_au1500_MeshCube is not set
+# CONFIG_TARGET_au1000_au1550_DBAu1550 is not set
+# CONFIG_TARGET_cns3xxx_Default is not set
+# CONFIG_TARGET_goldfish_Default is not set
+# CONFIG_TARGET_ifxmips_danube_None is not set
+# CONFIG_TARGET_ifxmips_danube_Atheros is not set
+# CONFIG_TARGET_ifxmips_danube_Ralink is not set
+# CONFIG_TARGET_ifxmips_ar9_None is not set
+# CONFIG_TARGET_ifxmips_ar9_Atheros is not set
+# CONFIG_TARGET_ifxmips_ar9_Ralink is not set
+# CONFIG_TARGET_uml_Default is not set
+# CONFIG_TARGET_pxcab_Default is not set
+# CONFIG_TARGET_ubicom32_Default is not set
+# CONFIG_TARGET_mpc83xx_Default is not set
+# CONFIG_TARGET_x86_generic_Generic is not set
+# CONFIG_TARGET_x86_generic_Alix is not set
+# CONFIG_TARGET_x86_generic_Soekris45xx is not set
+# CONFIG_TARGET_x86_generic_Soekris48xx is not set
+# CONFIG_TARGET_x86_generic_Wrap is not set
+# CONFIG_TARGET_x86_olpc_Default is not set
+# CONFIG_TARGET_x86_xen_domu_Default is not set
+# CONFIG_TARGET_x86_ep80579_Default is not set
+# CONFIG_TARGET_x86_net5501_Default is not set
+# CONFIG_TARGET_x86_kvm_guest_Default is not set
+# CONFIG_TARGET_atheros_Default is not set
+# CONFIG_TARGET_amazon_Default is not set
+# CONFIG_TARGET_adm5120_router_le_Generic is not set
+# CONFIG_TARGET_adm5120_router_le_EB-214A is not set
+# CONFIG_TARGET_adm5120_router_le_CAS630 is not set
+# CONFIG_TARGET_adm5120_router_le_CAS630W is not set
+# CONFIG_TARGET_adm5120_router_le_CAS670 is not set
+# CONFIG_TARGET_adm5120_router_le_CAS670W is not set
+# CONFIG_TARGET_adm5120_router_le_CAS700 is not set
+# CONFIG_TARGET_adm5120_router_le_CAS700W is not set
+# CONFIG_TARGET_adm5120_router_le_CAS771 is not set
+# CONFIG_TARGET_adm5120_router_le_CAS771W is not set
+# CONFIG_TARGET_adm5120_router_le_CAS790 is not set
+# CONFIG_TARGET_adm5120_router_le_CAS861 is not set
+# CONFIG_TARGET_adm5120_router_le_CAS861W is not set
+# CONFIG_TARGET_adm5120_router_le_NFS101U is not set
+# CONFIG_TARGET_adm5120_router_le_NFS101WU is not set
+# CONFIG_TARGET_adm5120_router_le_NP27G is not set
+# CONFIG_TARGET_adm5120_router_le_NP28G is not set
+# CONFIG_TARGET_adm5120_router_le_WP54 is not set
+# CONFIG_TARGET_adm5120_router_le_BR6104K is not set
+# CONFIG_TARGET_adm5120_router_le_BR6104KP is not set
+# CONFIG_TARGET_adm5120_router_le_BR6104WG is not set
+# CONFIG_TARGET_adm5120_router_le_BR6114WG is not set
+# CONFIG_TARGET_adm5120_router_le_EASY5120RT is not set
+# CONFIG_TARGET_adm5120_router_le_EASY5120PATA is not set
+# CONFIG_TARGET_adm5120_router_le_PMUGW is not set
+# CONFIG_TARGET_adm5120_router_le_5GXI is not set
+# CONFIG_TARGET_adm5120_router_le_RouterBoard is not set
+# CONFIG_TARGET_adm5120_router_be_Generic is not set
+# CONFIG_TARGET_adm5120_router_be_P334WT is not set
+# CONFIG_TARGET_adm5120_router_be_P335WT is not set
+# CONFIG_TARGET_at91_Default is not set
+# CONFIG_TARGET_cobalt_Default is not set
+# CONFIG_TARGET_s3c24xx_openmoko-gta02-minimal is not set
+# CONFIG_TARGET_s3c24xx_openmoko-gta02-full is not set
+# CONFIG_TARGET_ep93xx_Default is not set
+# CONFIG_TARGET_omap35xx_beagleboard_Beagleboard is not set
+# CONFIG_TARGET_omap35xx_gumstix_Gumstix is not set
+# CONFIG_TARGET_ar7_Annex-A is not set
+# CONFIG_TARGET_ar7_Annex-B is not set
+# CONFIG_TARGET_ar7_Texas is not set
+# CONFIG_TARGET_ar7_None is not set
+# CONFIG_TARGET_rdc_ar525w is not set
+# CONFIG_TARGET_rdc_bifferboard is not set
+# CONFIG_TARGET_rdc_r8610 is not set
+# CONFIG_TARGET_rdc_sitecom is not set
+# CONFIG_TARGET_ar71xx_generic_Default is not set
+# CONFIG_TARGET_ar71xx_generic_Minimal is not set
+# CONFIG_TARGET_ar71xx_generic_Madwifi is not set
+# CONFIG_TARGET_ar71xx_generic_AP81 is not set
+# CONFIG_TARGET_ar71xx_generic_AP83 is not set
+# CONFIG_TARGET_ar71xx_generic_PB42 is not set
+# CONFIG_TARGET_ar71xx_generic_PB44 is not set
+# CONFIG_TARGET_ar71xx_generic_PB92 is not set
+# CONFIG_TARGET_ar71xx_generic_A02RBW300N is not set
+# CONFIG_TARGET_ar71xx_generic_WZRHPG300NH is not set
+# CONFIG_TARGET_ar71xx_generic_WP543 is not set
+# CONFIG_TARGET_ar71xx_generic_DIR600A1 is not set
+# CONFIG_TARGET_ar71xx_generic_DIR615C1 is not set
+# CONFIG_TARGET_ar71xx_generic_DIR825B1 is not set
+# CONFIG_TARGET_ar71xx_generic_WRT160NL is not set
+# CONFIG_TARGET_ar71xx_generic_WRT400N is not set
+# CONFIG_TARGET_ar71xx_generic_WNDR3700 is not set
+# CONFIG_TARGET_ar71xx_generic_MZKW04NU is not set
+# CONFIG_TARGET_ar71xx_generic_MZKW300NH is not set
+# CONFIG_TARGET_ar71xx_generic_TLWA901NDV1 is not set
+# CONFIG_TARGET_ar71xx_generic_TLWR741NDV1 is not set
+# CONFIG_TARGET_ar71xx_generic_TLWR841NV15 is not set
+# CONFIG_TARGET_ar71xx_generic_TLWR841NDV3 is not set
+# CONFIG_TARGET_ar71xx_generic_TLWR841NDV5 is not set
+# CONFIG_TARGET_ar71xx_generic_TLWR941NDV2 is not set
+# CONFIG_TARGET_ar71xx_generic_TLWR941NDV3 is not set
+# CONFIG_TARGET_ar71xx_generic_TLWR941NDV4 is not set
+# CONFIG_TARGET_ar71xx_generic_TLWR1043NDV1 is not set
+# CONFIG_TARGET_ar71xx_generic_TEW632BRP is not set
+# CONFIG_TARGET_ar71xx_generic_TEW652BRP is not set
+# CONFIG_TARGET_ar71xx_generic_UBNTRS is not set
+# CONFIG_TARGET_ar71xx_generic_UBNTRSPRO is not set
+# CONFIG_TARGET_ar71xx_generic_UBNT is not set
+# CONFIG_TARGET_ar71xx_generic_ZCN1523H28 is not set
+# CONFIG_TARGET_ar71xx_generic_ZCN1523H516 is not set
+# CONFIG_TARGET_ar71xx_generic_NBG_460N_550N_550NH is not set
+# CONFIG_TARGET_ar71xx_nand_DefaultNoWifi is not set
+# CONFIG_TARGET_ar71xx_nand_Madwifi is not set
+# CONFIG_TARGET_pxa_Default is not set
+# CONFIG_TARGET_ps3_petitboot_Default is not set
+# CONFIG_TARGET_ppc44x_Default is not set
+# CONFIG_TARGET_mpc52xx_Default is not set
+# CONFIG_TARGET_brcm47xx_Broadcom-b43 is not set
+CONFIG_TARGET_brcm47xx_Broadcom-wl=y
+# CONFIG_TARGET_brcm47xx_Atheros is not set
+# CONFIG_TARGET_brcm47xx_Atheros-ath5k is not set
+# CONFIG_TARGET_brcm47xx_None is not set
+# CONFIG_TARGET_brcm47xx_WGT634U is not set
+# CONFIG_TARGET_brcm47xx_WL500GPv1 is not set
+# CONFIG_TARGET_brcm47xx_WRT350Nv1 is not set
+# CONFIG_TARGET_brcm47xx_WRTSL54GS is not set
+# CONFIG_TARGET_gemini_Default is not set
+# CONFIG_TARGET_omap24xx_n810-base is not set
+# CONFIG_TARGET_omap24xx_n810-gui is not set
+CONFIG_TARGET_BOARD="brcm47xx"
+CONFIG_TARGET_ARCH_PACKAGES="brcm47xx"
+CONFIG_DEFAULT_TARGET_OPTIMIZATION="-Os -pipe -mips32 -mtune=mips32 -funit-at-a-time"
+CONFIG_LINUX_2_6_34=y
+CONFIG_DEFAULT_base-files=y
+CONFIG_DEFAULT_busybox=y
+CONFIG_DEFAULT_dnsmasq=y
+CONFIG_DEFAULT_dropbear=y
+CONFIG_DEFAULT_firewall=y
+CONFIG_DEFAULT_hotplug2=y
+CONFIG_DEFAULT_iptables=y
+CONFIG_DEFAULT_kmod-brcm-wl=y
+CONFIG_DEFAULT_kmod-diag=y
+CONFIG_DEFAULT_kmod-ipt-nathelper=y
+CONFIG_DEFAULT_kmod-switch=y
+CONFIG_DEFAULT_libc=y
+CONFIG_DEFAULT_libgcc=y
+CONFIG_DEFAULT_mtd=y
+CONFIG_DEFAULT_nas=y
+CONFIG_DEFAULT_nvram=y
+CONFIG_DEFAULT_opkg=y
+CONFIG_DEFAULT_ppp=y
+CONFIG_DEFAULT_ppp-mod-pppoe=y
+CONFIG_DEFAULT_uci=y
+CONFIG_DEFAULT_udevtrigger=y
+CONFIG_DEFAULT_wlc=y
+CONFIG_LINUX_2_6=y
+CONFIG_AUDIO_SUPPORT=y
+CONFIG_GPIO_SUPPORT=y
+CONFIG_PCI_SUPPORT=y
+CONFIG_PCMCIA_SUPPORT=y
+CONFIG_USB_SUPPORT=y
+CONFIG_USES_SQUASHFS=y
+CONFIG_mipsel=y
+CONFIG_ARCH="mipsel"
+
+#
+# Target Images
+#
+# CONFIG_TARGET_ROOTFS_INITRAMFS is not set
+
+#
+# Root filesystem archives
+#
+# CONFIG_TARGET_ROOTFS_CPIOGZ is not set
+# CONFIG_TARGET_ROOTFS_TARGZ is not set
+
+#
+# Root filesystem images
+#
+# CONFIG_TARGET_ROOTFS_EXT2FS is not set
+# CONFIG_TARGET_ROOTFS_JFFS2 is not set
+CONFIG_TARGET_ROOTFS_SQUASHFS=y
+
+#
+# Image Options
+#
+
+#
+# Global build settings
+#
+# CONFIG_ALL is not set
+
+#
+# General build options
+#
+CONFIG_BUILD_PATENTED=y
+CONFIG_LARGEFILE=y
+CONFIG_SHADOW_PASSWORDS=y
+# CONFIG_CLEAN_IPKG is not set
+# CONFIG_COLLECT_KERNEL_DEBUG is not set
+
+#
+# Kernel build options
+#
+CONFIG_KERNEL_DEBUG_FS=y
+# CONFIG_KERNEL_PROFILING is not set
+# CONFIG_KERNEL_KALLSYMS is not set
+# CONFIG_KERNEL_DEBUG_KERNEL is not set
+# CONFIG_KERNEL_DEBUG_INFO is not set
+
+#
+# Package build options
+#
+# CONFIG_DEBUG is not set
+# CONFIG_IPV6 is not set
+# CONFIG_PKG_BUILD_PARALLEL is not set
+
+#
+# Stripping options
+#
+# CONFIG_NO_STRIP is not set
+# CONFIG_USE_STRIP is not set
+CONFIG_USE_SSTRIP=y
+# CONFIG_STRIP_KERNEL_EXPORTS is not set
+# CONFIG_USE_MKLIBS is not set
+# CONFIG_DEVEL is not set
+# CONFIG_BROKEN is not set
+CONFIG_DOWNLOAD_FOLDER=""
+CONFIG_LOCALMIRROR=""
+CONFIG_AUTOREBUILD=y
+CONFIG_BUILD_SUFFIX=""
+CONFIG_TARGET_ROOTFS_DIR=""
+# CONFIG_CCACHE is not set
+CONFIG_EXTERNAL_KERNEL_TREE=""
+CONFIG_KERNEL_GIT_CLONE_URI=""
+CONFIG_KERNEL_GIT_LOCAL_REPOSITORY=""
+CONFIG_TARGET_OPTIMIZATION="-Os -pipe -mips32 -mtune=mips32 -funit-at-a-time"
+CONFIG_SOFT_FLOAT=y
+# CONFIG_EXTRA_TARGET_ARCH is not set
+CONFIG_EXTRA_BINUTILS_CONFIG_OPTIONS=""
+CONFIG_BINUTILS_VERSION="2.19.1"
+CONFIG_GCC_VERSION_4_3_3_CS=y
+CONFIG_EXTRA_GCC_CONFIG_OPTIONS=""
+# CONFIG_SSP_SUPPORT is not set
+CONFIG_INSTALL_LIBSTDCPP=y
+# CONFIG_INSTALL_LIBGCJ is not set
+CONFIG_USE_UCLIBC=y
+# CONFIG_GDB is not set
+# CONFIG_INSIGHT is not set
+CONFIG_GCC_VERSION="4.3.3+cs"
+CONFIG_GCC_VERSION_4=y
+CONFIG_GCC_VERSION_4_3=y
+CONFIG_UCLIBC_VERSION="0.9.30.1"
+CONFIG_LIBC="uClibc"
+CONFIG_LIBC_VERSION="0.9.30.1"
+CONFIG_TARGET_SUFFIX="uclibc"
+# CONFIG_IB is not set
+CONFIG_SDK=y
+# CONFIG_MAKE_TOOLCHAIN is not set
+# CONFIG_IMAGEOPT is not set
+CONFIG_UCI_PRECONFIG_network_lan_dns=""
+CONFIG_UCI_PRECONFIG_network_lan_proto="static"
+CONFIG_UCI_PRECONFIG_network_lan_gateway=""
+CONFIG_UCI_PRECONFIG_network_lan_netmask="255.255.255.0"
+CONFIG_UCI_PRECONFIG_network_lan_ipaddr="192.168.1.1"
+# CONFIG_PREINITOPT is not set
+CONFIG_TARGET_PREINIT_SUPPRESS_STDERR=y
+CONFIG_TARGET_PREINIT_TIMEOUT=2
+# CONFIG_TARGET_PREINIT_SHOW_NETMSG is not set
+# CONFIG_TARGET_PREINIT_SUPPRESS_FAILSAFE_NETMSG is not set
+CONFIG_TARGET_PREINIT_IFNAME=""
+CONFIG_TARGET_PREINIT_IP="192.168.1.1"
+CONFIG_TARGET_PREINIT_NETMASK="255.255.255.0"
+CONFIG_TARGET_PREINIT_BROADCAST="192.168.1.255"
+# CONFIG_INITOPT is not set
+CONFIG_TARGET_INIT_PATH="/bin:/sbin:/usr/bin:/usr/sbin"
+CONFIG_TARGET_INIT_ENV=""
+CONFIG_TARGET_INIT_CMD="/sbin/init"
+CONFIG_TARGET_INIT_SUPPRESS_STDERR=y
+
+#
+# Base system
+#
+CONFIG_PACKAGE_base-files=y
+# CONFIG_PACKAGE_block-extroot is not set
+CONFIG_EXTROOT_SETTLETIME=20
+# CONFIG_PACKAGE_block-hotplug is not set
+# CONFIG_PACKAGE_block-mount is not set
+# CONFIG_PACKAGE_br2684ctl is not set
+CONFIG_PACKAGE_bridge=y
+CONFIG_PACKAGE_busybox=y
+
+#
+# Configuration
+#
+# CONFIG_BUSYBOX_CONFIG_NOMMU is not set
+# CONFIG_CONFIG_BUSYBOX_CONFIG_FEATURE_SH_IS_HUSH is not set
+# CONFIG_BUSYBOX_CONFIG_HUSH is not set
+CONFIG_BUSYBOX_CONFIG_HAVE_DOT_CONFIG=y
+
+#
+# Busybox Settings
+#
+
+#
+# General Configuration
+#
+# CONFIG_BUSYBOX_CONFIG_DESKTOP is not set
+# CONFIG_BUSYBOX_CONFIG_EXTRA_COMPAT is not set
+CONFIG_BUSYBOX_CONFIG_INCLUDE_SUSv2=y
+# CONFIG_BUSYBOX_CONFIG_USE_PORTABLE_CODE is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_BUFFERS_USE_MALLOC is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_BUFFERS_GO_ON_STACK=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_BUFFERS_GO_IN_BSS is not set
+CONFIG_BUSYBOX_CONFIG_SHOW_USAGE=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_VERBOSE_USAGE=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_COMPRESS_USAGE=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_INSTALLER is not set
+# CONFIG_BUSYBOX_CONFIG_LOCALE_SUPPORT is not set
+# CONFIG_BUSYBOX_CONFIG_UNICODE_SUPPORT is not set
+CONFIG_BUSYBOX_CONFIG_LONG_OPTS=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_DEVPTS=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_CLEAN_UP is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_UTMP is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_WTMP is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_PIDFILE=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_SUID=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_SUID_CONFIG is not set
+# CONFIG_BUSYBOX_CONFIG_SELINUX is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_PREFER_APPLETS=y
+CONFIG_BUSYBOX_CONFIG_BUSYBOX_EXEC_PATH="/proc/self/exe"
+CONFIG_BUSYBOX_CONFIG_FEATURE_SYSLOG=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_HAVE_RPC=y
+
+#
+# Build Options
+#
+# CONFIG_BUSYBOX_CONFIG_STATIC is not set
+# CONFIG_BUSYBOX_CONFIG_PIE is not set
+CONFIG_BUSYBOX_CONFIG_LFS=y
+CONFIG_BUSYBOX_CONFIG_CROSS_COMPILER_PREFIX=""
+CONFIG_BUSYBOX_CONFIG_EXTRA_CFLAGS=""
+
+#
+# Debugging Options
+#
+# CONFIG_BUSYBOX_CONFIG_DEBUG is not set
+# CONFIG_BUSYBOX_CONFIG_WERROR is not set
+CONFIG_BUSYBOX_CONFIG_NO_DEBUG_LIB=y
+# CONFIG_BUSYBOX_CONFIG_DMALLOC is not set
+# CONFIG_BUSYBOX_CONFIG_EFENCE is not set
+
+#
+# Installation Options
+#
+# CONFIG_BUSYBOX_CONFIG_INSTALL_NO_USR is not set
+CONFIG_BUSYBOX_CONFIG_INSTALL_APPLET_SYMLINKS=y
+# CONFIG_BUSYBOX_CONFIG_INSTALL_APPLET_HARDLINKS is not set
+# CONFIG_BUSYBOX_CONFIG_INSTALL_APPLET_SCRIPT_WRAPPERS is not set
+# CONFIG_BUSYBOX_CONFIG_INSTALL_APPLET_DONT is not set
+CONFIG_BUSYBOX_CONFIG_PREFIX="./_install"
+
+#
+# Busybox Library Tuning
+#
+CONFIG_BUSYBOX_CONFIG_PASSWORD_MINLEN=6
+CONFIG_BUSYBOX_CONFIG_MD5_SIZE_VS_SPEED=2
+CONFIG_BUSYBOX_CONFIG_FEATURE_FAST_TOP=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_ETC_NETWORKS is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_EDITING=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_EDITING_MAX_LEN=512
+# CONFIG_BUSYBOX_CONFIG_FEATURE_EDITING_VI is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_EDITING_HISTORY=256
+# CONFIG_BUSYBOX_CONFIG_FEATURE_EDITING_SAVEHISTORY is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_TAB_COMPLETION=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_USERNAME_COMPLETION is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_EDITING_FANCY_PROMPT=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_EDITING_ASK_TERMINAL is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_NON_POSIX_CP=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_VERBOSE_CP_MESSAGE is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_COPYBUF_KB=4
+# CONFIG_BUSYBOX_CONFIG_MONOTONIC_SYSCALL is not set
+CONFIG_BUSYBOX_CONFIG_IOCTL_HEX2STR_ERROR=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_HWIB is not set
+
+#
+# Applets
+#
+
+#
+# Archival Utilities
+#
+# CONFIG_BUSYBOX_CONFIG_FEATURE_SEAMLESS_XZ is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_SEAMLESS_LZMA is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_SEAMLESS_BZ2 is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_SEAMLESS_GZ=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_SEAMLESS_Z is not set
+# CONFIG_BUSYBOX_CONFIG_AR is not set
+CONFIG_BUSYBOX_CONFIG_BUNZIP2=y
+# CONFIG_BUSYBOX_CONFIG_BZIP2 is not set
+# CONFIG_BUSYBOX_CONFIG_CPIO is not set
+# CONFIG_BUSYBOX_CONFIG_DPKG is not set
+# CONFIG_BUSYBOX_CONFIG_DPKG_DEB is not set
+CONFIG_BUSYBOX_CONFIG_GUNZIP=y
+CONFIG_BUSYBOX_CONFIG_GZIP=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_GZIP_LONG_OPTIONS is not set
+# CONFIG_BUSYBOX_CONFIG_LZOP is not set
+# CONFIG_BUSYBOX_CONFIG_RPM2CPIO is not set
+# CONFIG_BUSYBOX_CONFIG_RPM is not set
+CONFIG_BUSYBOX_CONFIG_TAR=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_TAR_CREATE=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_TAR_AUTODETECT is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_TAR_FROM=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_TAR_OLDGNU_COMPATIBILITY is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_TAR_OLDSUN_COMPATIBILITY is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_TAR_GNU_EXTENSIONS=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_TAR_LONG_OPTIONS is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_TAR_UNAME_GNAME is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_TAR_NOPRESERVE_TIME is not set
+# CONFIG_BUSYBOX_CONFIG_UNCOMPRESS is not set
+# CONFIG_BUSYBOX_CONFIG_UNLZMA is not set
+# CONFIG_BUSYBOX_CONFIG_UNXZ is not set
+# CONFIG_BUSYBOX_CONFIG_UNZIP is not set
+
+#
+# Coreutils
+#
+CONFIG_BUSYBOX_CONFIG_BASENAME=y
+CONFIG_BUSYBOX_CONFIG_CAT=y
+CONFIG_BUSYBOX_CONFIG_DATE=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_DATE_ISOFMT=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_DATE_NANO is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_DATE_COMPAT is not set
+CONFIG_BUSYBOX_CONFIG_TEST=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_TEST_64 is not set
+CONFIG_BUSYBOX_CONFIG_TR=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_TR_CLASSES is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_TR_EQUIV is not set
+CONFIG_BUSYBOX_CONFIG_CAL=y
+# CONFIG_BUSYBOX_CONFIG_CATV is not set
+CONFIG_BUSYBOX_CONFIG_CHGRP=y
+CONFIG_BUSYBOX_CONFIG_CHMOD=y
+CONFIG_BUSYBOX_CONFIG_CHOWN=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_CHOWN_LONG_OPTIONS is not set
+CONFIG_BUSYBOX_CONFIG_CHROOT=y
+# CONFIG_BUSYBOX_CONFIG_CKSUM is not set
+# CONFIG_BUSYBOX_CONFIG_COMM is not set
+CONFIG_BUSYBOX_CONFIG_CP=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_CP_LONG_OPTIONS is not set
+CONFIG_BUSYBOX_CONFIG_CUT=y
+CONFIG_BUSYBOX_CONFIG_DD=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_DD_SIGNAL_HANDLING=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_DD_THIRD_STATUS_LINE is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_DD_IBS_OBS is not set
+CONFIG_BUSYBOX_CONFIG_DF=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_DF_FANCY is not set
+CONFIG_BUSYBOX_CONFIG_DIRNAME=y
+CONFIG_BUSYBOX_CONFIG_DOS2UNIX=y
+# CONFIG_BUSYBOX_CONFIG_UNIX2DOS is not set
+CONFIG_BUSYBOX_CONFIG_DU=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_DU_DEFAULT_BLOCKSIZE_1K=y
+CONFIG_BUSYBOX_CONFIG_ECHO=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_FANCY_ECHO=y
+CONFIG_BUSYBOX_CONFIG_ENV=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_ENV_LONG_OPTIONS is not set
+# CONFIG_BUSYBOX_CONFIG_EXPAND is not set
+CONFIG_BUSYBOX_CONFIG_EXPR=y
+# CONFIG_BUSYBOX_CONFIG_EXPR_MATH_SUPPORT_64 is not set
+CONFIG_BUSYBOX_CONFIG_FALSE=y
+CONFIG_BUSYBOX_CONFIG_FOLD=y
+# CONFIG_BUSYBOX_CONFIG_FSYNC is not set
+CONFIG_BUSYBOX_CONFIG_HEAD=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_FANCY_HEAD=y
+CONFIG_BUSYBOX_CONFIG_HOSTID=y
+CONFIG_BUSYBOX_CONFIG_ID=y
+# CONFIG_BUSYBOX_CONFIG_INSTALL is not set
+CONFIG_BUSYBOX_CONFIG_LENGTH=y
+CONFIG_BUSYBOX_CONFIG_LN=y
+# CONFIG_BUSYBOX_CONFIG_LOGNAME is not set
+CONFIG_BUSYBOX_CONFIG_LS=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_LS_FILETYPES=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_LS_FOLLOWLINKS=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_LS_RECURSIVE=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_LS_SORTFILES=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_LS_TIMESTAMPS=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_LS_USERNAME=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_LS_COLOR=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_LS_COLOR_IS_DEFAULT=y
+CONFIG_BUSYBOX_CONFIG_MD5SUM=y
+CONFIG_BUSYBOX_CONFIG_MKDIR=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_MKDIR_LONG_OPTIONS is not set
+CONFIG_BUSYBOX_CONFIG_MKFIFO=y
+CONFIG_BUSYBOX_CONFIG_MKNOD=y
+CONFIG_BUSYBOX_CONFIG_MV=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_MV_LONG_OPTIONS is not set
+CONFIG_BUSYBOX_CONFIG_NICE=y
+# CONFIG_BUSYBOX_CONFIG_NOHUP is not set
+# CONFIG_BUSYBOX_CONFIG_OD is not set
+# CONFIG_BUSYBOX_CONFIG_PRINTENV is not set
+CONFIG_BUSYBOX_CONFIG_PRINTF=y
+CONFIG_BUSYBOX_CONFIG_PWD=y
+# CONFIG_BUSYBOX_CONFIG_READLINK is not set
+# CONFIG_BUSYBOX_CONFIG_REALPATH is not set
+CONFIG_BUSYBOX_CONFIG_RM=y
+CONFIG_BUSYBOX_CONFIG_RMDIR=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_RMDIR_LONG_OPTIONS is not set
+CONFIG_BUSYBOX_CONFIG_SEQ=y
+# CONFIG_BUSYBOX_CONFIG_SHA1SUM is not set
+# CONFIG_BUSYBOX_CONFIG_SHA256SUM is not set
+# CONFIG_BUSYBOX_CONFIG_SHA512SUM is not set
+CONFIG_BUSYBOX_CONFIG_SLEEP=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_FANCY_SLEEP=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_FLOAT_SLEEP is not set
+CONFIG_BUSYBOX_CONFIG_SORT=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_SORT_BIG is not set
+# CONFIG_BUSYBOX_CONFIG_SPLIT is not set
+# CONFIG_BUSYBOX_CONFIG_STAT is not set
+# CONFIG_BUSYBOX_CONFIG_STTY is not set
+# CONFIG_BUSYBOX_CONFIG_SUM is not set
+CONFIG_BUSYBOX_CONFIG_SYNC=y
+# CONFIG_BUSYBOX_CONFIG_TAC is not set
+CONFIG_BUSYBOX_CONFIG_TAIL=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_FANCY_TAIL=y
+CONFIG_BUSYBOX_CONFIG_TEE=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_TEE_USE_BLOCK_IO=y
+CONFIG_BUSYBOX_CONFIG_TOUCH=y
+CONFIG_BUSYBOX_CONFIG_TRUE=y
+# CONFIG_BUSYBOX_CONFIG_TTY is not set
+CONFIG_BUSYBOX_CONFIG_UNAME=y
+# CONFIG_BUSYBOX_CONFIG_UNEXPAND is not set
+CONFIG_BUSYBOX_CONFIG_UNIQ=y
+# CONFIG_BUSYBOX_CONFIG_USLEEP is not set
+# CONFIG_BUSYBOX_CONFIG_UUDECODE is not set
+# CONFIG_BUSYBOX_CONFIG_UUENCODE is not set
+CONFIG_BUSYBOX_CONFIG_WC=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_WC_LARGE is not set
+# CONFIG_BUSYBOX_CONFIG_WHOAMI is not set
+CONFIG_BUSYBOX_CONFIG_YES=y
+
+#
+# Common options for cp and mv
+#
+CONFIG_BUSYBOX_CONFIG_FEATURE_PRESERVE_HARDLINKS=y
+
+#
+# Common options for ls, more and telnet
+#
+CONFIG_BUSYBOX_CONFIG_FEATURE_AUTOWIDTH=y
+
+#
+# Common options for df, du, ls
+#
+CONFIG_BUSYBOX_CONFIG_FEATURE_HUMAN_READABLE=y
+
+#
+# Common options for md5sum, sha1sum, sha256sum, sha512sum
+#
+CONFIG_BUSYBOX_CONFIG_FEATURE_MD5_SHA1_SUM_CHECK=y
+
+#
+# Console Utilities
+#
+# CONFIG_BUSYBOX_CONFIG_CHVT is not set
+# CONFIG_BUSYBOX_CONFIG_FGCONSOLE is not set
+CONFIG_BUSYBOX_CONFIG_CLEAR=y
+# CONFIG_BUSYBOX_CONFIG_DEALLOCVT is not set
+# CONFIG_BUSYBOX_CONFIG_DUMPKMAP is not set
+# CONFIG_BUSYBOX_CONFIG_KBD_MODE is not set
+# CONFIG_BUSYBOX_CONFIG_LOADFONT is not set
+# CONFIG_BUSYBOX_CONFIG_LOADKMAP is not set
+# CONFIG_BUSYBOX_CONFIG_OPENVT is not set
+CONFIG_BUSYBOX_CONFIG_RESET=y
+# CONFIG_BUSYBOX_CONFIG_RESIZE is not set
+# CONFIG_BUSYBOX_CONFIG_SETCONSOLE is not set
+# CONFIG_BUSYBOX_CONFIG_SETFONT is not set
+# CONFIG_BUSYBOX_CONFIG_SETKEYCODES is not set
+# CONFIG_BUSYBOX_CONFIG_SETLOGCONS is not set
+# CONFIG_BUSYBOX_CONFIG_SHOWKEY is not set
+
+#
+# Debian Utilities
+#
+CONFIG_BUSYBOX_CONFIG_MKTEMP=y
+# CONFIG_BUSYBOX_CONFIG_PIPE_PROGRESS is not set
+# CONFIG_BUSYBOX_CONFIG_RUN_PARTS is not set
+CONFIG_BUSYBOX_CONFIG_START_STOP_DAEMON=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_START_STOP_DAEMON_FANCY is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_START_STOP_DAEMON_LONG_OPTIONS is not set
+CONFIG_BUSYBOX_CONFIG_WHICH=y
+
+#
+# Editors
+#
+CONFIG_BUSYBOX_CONFIG_AWK=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_AWK_LIBM=y
+# CONFIG_BUSYBOX_CONFIG_CMP is not set
+CONFIG_BUSYBOX_CONFIG_DIFF=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_DIFF_LONG_OPTIONS is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_DIFF_DIR=y
+# CONFIG_BUSYBOX_CONFIG_ED is not set
+# CONFIG_BUSYBOX_CONFIG_PATCH is not set
+CONFIG_BUSYBOX_CONFIG_SED=y
+CONFIG_BUSYBOX_CONFIG_VI=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_VI_MAX_LEN=1024
+# CONFIG_BUSYBOX_CONFIG_FEATURE_VI_8BIT is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_VI_COLON=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_VI_YANKMARK=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_VI_SEARCH=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_VI_USE_SIGNALS=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_VI_DOT_CMD=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_VI_READONLY=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_VI_SETOPTS=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_VI_SET=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_VI_WIN_RESIZE=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_VI_ASK_TERMINAL=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_VI_OPTIMIZE_CURSOR=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_ALLOW_EXEC=y
+
+#
+# Finding Utilities
+#
+CONFIG_BUSYBOX_CONFIG_FIND=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_FIND_PRINT0=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_FIND_MTIME is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_FIND_MMIN is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_FIND_PERM=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_FIND_TYPE=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_FIND_XDEV=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_FIND_MAXDEPTH=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_FIND_NEWER is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_FIND_INUM is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_FIND_EXEC=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_FIND_USER=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_FIND_GROUP=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_FIND_NOT=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_FIND_DEPTH=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_FIND_PAREN=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_FIND_SIZE=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_FIND_PRUNE=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_FIND_DELETE is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_FIND_PATH=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_FIND_REGEX=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_FIND_LINKS is not set
+CONFIG_BUSYBOX_CONFIG_GREP=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_GREP_EGREP_ALIAS=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_GREP_FGREP_ALIAS=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_GREP_CONTEXT=y
+CONFIG_BUSYBOX_CONFIG_XARGS=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_XARGS_SUPPORT_CONFIRMATION=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_XARGS_SUPPORT_QUOTES=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_XARGS_SUPPORT_TERMOPT=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_XARGS_SUPPORT_ZERO_TERM=y
+
+#
+# Init Utilities
+#
+# CONFIG_BUSYBOX_CONFIG_BOOTCHARTD is not set
+CONFIG_BUSYBOX_CONFIG_INIT=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_USE_INITTAB=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_KILL_REMOVED is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_INIT_SCTTY is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_INIT_SYSLOG=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_EXTRA_QUIET is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_INIT_COREDUMPS is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_INITRD is not set
+CONFIG_BUSYBOX_CONFIG_HALT=y
+CONFIG_BUSYBOX_CONFIG_MESG=y
+
+#
+# Login/Password Management Utilities
+#
+CONFIG_BUSYBOX_CONFIG_FEATURE_SHADOWPASSWDS=y
+# CONFIG_BUSYBOX_CONFIG_USE_BB_PWD_GRP is not set
+# CONFIG_BUSYBOX_CONFIG_USE_BB_CRYPT is not set
+CONFIG_BUSYBOX_CONFIG_ADDGROUP=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_ADDGROUP_LONG_OPTIONS is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_ADDUSER_TO_GROUP=y
+CONFIG_BUSYBOX_CONFIG_DELGROUP=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_DEL_USER_FROM_GROUP=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_CHECK_NAMES is not set
+CONFIG_BUSYBOX_CONFIG_ADDUSER=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_ADDUSER_LONG_OPTIONS is not set
+CONFIG_BUSYBOX_CONFIG_FIRST_SYSTEM_ID=100
+CONFIG_BUSYBOX_CONFIG_LAST_SYSTEM_ID=999
+CONFIG_BUSYBOX_CONFIG_DELUSER=y
+# CONFIG_BUSYBOX_CONFIG_GETTY is not set
+# CONFIG_BUSYBOX_CONFIG_LOGIN is not set
+CONFIG_BUSYBOX_CONFIG_PASSWD=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_PASSWD_WEAK_CHECK=y
+CONFIG_BUSYBOX_CONFIG_CRYPTPW=y
+# CONFIG_BUSYBOX_CONFIG_CHPASSWD is not set
+CONFIG_BUSYBOX_CONFIG_SU=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_SU_SYSLOG=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_SU_CHECKS_SHELLS=y
+# CONFIG_BUSYBOX_CONFIG_SULOGIN is not set
+# CONFIG_BUSYBOX_CONFIG_VLOCK is not set
+
+#
+# Linux Ext2 FS Progs
+#
+# CONFIG_BUSYBOX_CONFIG_CHATTR is not set
+# CONFIG_BUSYBOX_CONFIG_FSCK is not set
+# CONFIG_BUSYBOX_CONFIG_LSATTR is not set
+# CONFIG_BUSYBOX_CONFIG_TUNE2FS is not set
+
+#
+# Linux Module Utilities
+#
+# CONFIG_BUSYBOX_CONFIG_MODINFO is not set
+# CONFIG_BUSYBOX_CONFIG_MODPROBE_SMALL is not set
+CONFIG_BUSYBOX_CONFIG_INSMOD=y
+CONFIG_BUSYBOX_CONFIG_RMMOD=y
+CONFIG_BUSYBOX_CONFIG_LSMOD=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_LSMOD_PRETTY_2_6_OUTPUT=y
+# CONFIG_BUSYBOX_CONFIG_MODPROBE is not set
+# CONFIG_BUSYBOX_CONFIG_DEPMOD is not set
+
+#
+# Options common to multiple modutils
+#
+# CONFIG_BUSYBOX_CONFIG_FEATURE_2_4_MODULES is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_INSMOD_TRY_MMAP is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_INSMOD_VERSION_CHECKING is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_INSMOD_KSYMOOPS_SYMBOLS is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_INSMOD_LOADINKMEM is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_INSMOD_LOAD_MAP is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_CHECK_TAINTED_MODULE=y
+CONFIG_BUSYBOX_CONFIG_DEFAULT_MODULES_DIR="/lib/modules"
+
+#
+# Linux System Utilities
+#
+# CONFIG_BUSYBOX_CONFIG_REV is not set
+# CONFIG_BUSYBOX_CONFIG_ACPID is not set
+# CONFIG_BUSYBOX_CONFIG_BLKID is not set
+CONFIG_BUSYBOX_CONFIG_DMESG=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_DMESG_PRETTY=y
+# CONFIG_BUSYBOX_CONFIG_FBSET is not set
+# CONFIG_BUSYBOX_CONFIG_FDFLUSH is not set
+# CONFIG_BUSYBOX_CONFIG_FDFORMAT is not set
+# CONFIG_BUSYBOX_CONFIG_FDISK is not set
+CONFIG_BUSYBOX_CONFIG_FDISK_SUPPORT_LARGE_DISKS=y
+# CONFIG_BUSYBOX_CONFIG_FINDFS is not set
+# CONFIG_BUSYBOX_CONFIG_FLOCK is not set
+# CONFIG_BUSYBOX_CONFIG_FREERAMDISK is not set
+# CONFIG_BUSYBOX_CONFIG_FSCK_MINIX is not set
+# CONFIG_BUSYBOX_CONFIG_MKFS_EXT2 is not set
+# CONFIG_BUSYBOX_CONFIG_MKFS_MINIX is not set
+# CONFIG_BUSYBOX_CONFIG_MKFS_REISER is not set
+# CONFIG_BUSYBOX_CONFIG_MKFS_VFAT is not set
+# CONFIG_BUSYBOX_CONFIG_GETOPT is not set
+# CONFIG_BUSYBOX_CONFIG_HEXDUMP is not set
+CONFIG_BUSYBOX_CONFIG_HWCLOCK=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_HWCLOCK_LONG_OPTIONS is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_HWCLOCK_ADJTIME_FHS is not set
+# CONFIG_BUSYBOX_CONFIG_IPCRM is not set
+# CONFIG_BUSYBOX_CONFIG_IPCS is not set
+# CONFIG_BUSYBOX_CONFIG_LOSETUP is not set
+# CONFIG_BUSYBOX_CONFIG_LSPCI is not set
+# CONFIG_BUSYBOX_CONFIG_LSUSB is not set
+# CONFIG_BUSYBOX_CONFIG_MDEV is not set
+# CONFIG_BUSYBOX_CONFIG_MKSWAP is not set
+# CONFIG_BUSYBOX_CONFIG_MORE is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_USE_TERMIOS is not set
+CONFIG_BUSYBOX_CONFIG_MOUNT=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_MOUNT_FAKE is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_MOUNT_VERBOSE is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_MOUNT_HELPERS is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_MOUNT_LABEL is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_MOUNT_NFS=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_MOUNT_CIFS=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_MOUNT_FLAGS=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_MOUNT_FSTAB=y
+CONFIG_BUSYBOX_CONFIG_PIVOT_ROOT=y
+# CONFIG_BUSYBOX_CONFIG_RDATE is not set
+# CONFIG_BUSYBOX_CONFIG_RDEV is not set
+# CONFIG_BUSYBOX_CONFIG_READPROFILE is not set
+# CONFIG_BUSYBOX_CONFIG_RTCWAKE is not set
+# CONFIG_BUSYBOX_CONFIG_SCRIPT is not set
+# CONFIG_BUSYBOX_CONFIG_SCRIPTREPLAY is not set
+# CONFIG_BUSYBOX_CONFIG_SETARCH is not set
+# CONFIG_BUSYBOX_CONFIG_SWAPONOFF is not set
+CONFIG_BUSYBOX_CONFIG_SWITCH_ROOT=y
+CONFIG_BUSYBOX_CONFIG_UMOUNT=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_UMOUNT_ALL=y
+
+#
+# Common options for mount/umount
+#
+CONFIG_BUSYBOX_CONFIG_FEATURE_MOUNT_LOOP=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_MOUNT_LOOP_CREATE is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_MTAB_SUPPORT is not set
+# CONFIG_BUSYBOX_CONFIG_VOLUMEID is not set
+
+#
+# Miscellaneous Utilities
+#
+# CONFIG_BUSYBOX_CONFIG_CONSPY is not set
+# CONFIG_BUSYBOX_CONFIG_UBIATTACH is not set
+# CONFIG_BUSYBOX_CONFIG_UBIDETACH is not set
+# CONFIG_BUSYBOX_CONFIG_ADJTIMEX is not set
+# CONFIG_BUSYBOX_CONFIG_BBCONFIG is not set
+# CONFIG_BUSYBOX_CONFIG_BEEP is not set
+# CONFIG_BUSYBOX_CONFIG_CHAT is not set
+# CONFIG_BUSYBOX_CONFIG_CHRT is not set
+CONFIG_BUSYBOX_CONFIG_CROND=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_CROND_D is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_CROND_CALL_SENDMAIL is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_CROND_DIR="/var/spool/cron"
+CONFIG_BUSYBOX_CONFIG_CRONTAB=y
+# CONFIG_BUSYBOX_CONFIG_DC is not set
+# CONFIG_BUSYBOX_CONFIG_DEVFSD is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_DEVFS=y
+# CONFIG_BUSYBOX_CONFIG_DEVMEM is not set
+# CONFIG_BUSYBOX_CONFIG_EJECT is not set
+# CONFIG_BUSYBOX_CONFIG_FBSPLASH is not set
+# CONFIG_BUSYBOX_CONFIG_FLASHCP is not set
+# CONFIG_BUSYBOX_CONFIG_FLASH_LOCK is not set
+# CONFIG_BUSYBOX_CONFIG_FLASH_UNLOCK is not set
+# CONFIG_BUSYBOX_CONFIG_FLASH_ERASEALL is not set
+# CONFIG_BUSYBOX_CONFIG_IONICE is not set
+# CONFIG_BUSYBOX_CONFIG_INOTIFYD is not set
+CONFIG_BUSYBOX_CONFIG_LESS=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_LESS_MAXLINES=9999999
+# CONFIG_BUSYBOX_CONFIG_FEATURE_LESS_BRACKETS is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_LESS_FLAGS is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_LESS_MARKS is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_LESS_REGEXP=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_LESS_WINCH is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_LESS_DASHCMD is not set
+CONFIG_BUSYBOX_CONFIG_HDPARM=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_HDPARM_GET_IDENTITY is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_HDPARM_HDIO_SCAN_HWIF is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_HDPARM_HDIO_UNREGISTER_HWIF is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_HDPARM_HDIO_DRIVE_RESET is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_HDPARM_HDIO_TRISTATE_HWIF is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_HDPARM_HDIO_GETSET_DMA is not set
+CONFIG_BUSYBOX_CONFIG_LOCK=y
+# CONFIG_BUSYBOX_CONFIG_MAKEDEVS is not set
+# CONFIG_BUSYBOX_CONFIG_MAN is not set
+# CONFIG_BUSYBOX_CONFIG_MICROCOM is not set
+# CONFIG_BUSYBOX_CONFIG_MOUNTPOINT is not set
+# CONFIG_BUSYBOX_CONFIG_MT is not set
+# CONFIG_BUSYBOX_CONFIG_RAIDAUTORUN is not set
+# CONFIG_BUSYBOX_CONFIG_READAHEAD is not set
+# CONFIG_BUSYBOX_CONFIG_RFKILL is not set
+# CONFIG_BUSYBOX_CONFIG_RUNLEVEL is not set
+# CONFIG_BUSYBOX_CONFIG_RX is not set
+# CONFIG_BUSYBOX_CONFIG_SETSID is not set
+CONFIG_BUSYBOX_CONFIG_STRINGS=y
+# CONFIG_BUSYBOX_CONFIG_TASKSET is not set
+CONFIG_BUSYBOX_CONFIG_TIME=y
+# CONFIG_BUSYBOX_CONFIG_TIMEOUT is not set
+# CONFIG_BUSYBOX_CONFIG_TTYSIZE is not set
+# CONFIG_BUSYBOX_CONFIG_VOLNAME is not set
+# CONFIG_BUSYBOX_CONFIG_WALL is not set
+CONFIG_BUSYBOX_CONFIG_WATCHDOG=y
+
+#
+# Networking Utilities
+#
+CONFIG_BUSYBOX_CONFIG_NC=y
+# CONFIG_BUSYBOX_CONFIG_NC_SERVER is not set
+# CONFIG_BUSYBOX_CONFIG_NC_EXTRA is not set
+# CONFIG_BUSYBOX_CONFIG_NC_110_COMPAT is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_IPV6=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_UNIX_LOCAL is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_PREFER_IPV4_ADDRESS=y
+CONFIG_BUSYBOX_CONFIG_VERBOSE_RESOLUTION_ERRORS=y
+CONFIG_BUSYBOX_CONFIG_ARP=y
+CONFIG_BUSYBOX_CONFIG_ARPING=y
+# CONFIG_BUSYBOX_CONFIG_BRCTL is not set
+# CONFIG_BUSYBOX_CONFIG_DNSD is not set
+CONFIG_BUSYBOX_CONFIG_ETHER_WAKE=y
+# CONFIG_BUSYBOX_CONFIG_FAKEIDENTD is not set
+# CONFIG_BUSYBOX_CONFIG_FTPD is not set
+# CONFIG_BUSYBOX_CONFIG_FTPGET is not set
+# CONFIG_BUSYBOX_CONFIG_FTPPUT is not set
+CONFIG_BUSYBOX_CONFIG_HOSTNAME=y
+# CONFIG_BUSYBOX_CONFIG_HTTPD is not set
+CONFIG_BUSYBOX_CONFIG_IFCONFIG=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_IFCONFIG_STATUS=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_IFCONFIG_SLIP is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_IFCONFIG_MEMSTART_IOADDR_IRQ is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_IFCONFIG_HW=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_IFCONFIG_BROADCAST_PLUS=y
+# CONFIG_BUSYBOX_CONFIG_IFENSLAVE is not set
+# CONFIG_BUSYBOX_CONFIG_IFPLUGD is not set
+# CONFIG_BUSYBOX_CONFIG_IFUPDOWN is not set
+# CONFIG_BUSYBOX_CONFIG_INETD is not set
+# CONFIG_BUSYBOX_CONFIG_IP is not set
+# CONFIG_BUSYBOX_CONFIG_IPCALC is not set
+# CONFIG_BUSYBOX_CONFIG_NAMEIF is not set
+# CONFIG_BUSYBOX_CONFIG_NETMSG is not set
+CONFIG_BUSYBOX_CONFIG_NETSTAT=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_NETSTAT_WIDE=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_NETSTAT_PRG=y
+CONFIG_BUSYBOX_CONFIG_NSLOOKUP=y
+# CONFIG_BUSYBOX_CONFIG_NTPD is not set
+CONFIG_BUSYBOX_CONFIG_PING=y
+CONFIG_BUSYBOX_CONFIG_PING6=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_FANCY_PING=y
+# CONFIG_BUSYBOX_CONFIG_PSCAN is not set
+CONFIG_BUSYBOX_CONFIG_ROUTE=y
+# CONFIG_BUSYBOX_CONFIG_SLATTACH is not set
+# CONFIG_BUSYBOX_CONFIG_TCPSVD is not set
+CONFIG_BUSYBOX_CONFIG_TELNET=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_TELNET_TTYPE=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_TELNET_AUTOLOGIN is not set
+CONFIG_BUSYBOX_CONFIG_TELNETD=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_TELNETD_STANDALONE=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_TELNETD_INETD_WAIT is not set
+# CONFIG_BUSYBOX_CONFIG_TFTP is not set
+# CONFIG_BUSYBOX_CONFIG_TFTPD is not set
+CONFIG_BUSYBOX_CONFIG_TRACEROUTE=y
+# CONFIG_BUSYBOX_CONFIG_TRACEROUTE6 is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_TRACEROUTE_VERBOSE=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_TRACEROUTE_SOURCE_ROUTE is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_TRACEROUTE_USE_ICMP is not set
+# CONFIG_BUSYBOX_CONFIG_TUNCTL is not set
+# CONFIG_BUSYBOX_CONFIG_UDHCPD is not set
+CONFIG_BUSYBOX_CONFIG_UDHCPC=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_UDHCPC_ARPING is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_UDHCP_PORT is not set
+CONFIG_BUSYBOX_CONFIG_UDHCP_DEBUG=0
+CONFIG_BUSYBOX_CONFIG_FEATURE_UDHCP_RFC3397=y
+CONFIG_BUSYBOX_CONFIG_UDHCPC_DEFAULT_SCRIPT="/usr/share/udhcpc/default.script"
+CONFIG_BUSYBOX_CONFIG_UDHCPC_SLACK_FOR_BUGGY_SERVERS=80
+# CONFIG_BUSYBOX_CONFIG_UDPSVD is not set
+CONFIG_BUSYBOX_CONFIG_VCONFIG=y
+CONFIG_BUSYBOX_CONFIG_WGET=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_WGET_STATUSBAR=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_WGET_AUTHENTICATION=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_WGET_LONG_OPTIONS=y
+# CONFIG_BUSYBOX_CONFIG_ZCIP is not set
+
+#
+# Print Utilities
+#
+# CONFIG_BUSYBOX_CONFIG_LPD is not set
+# CONFIG_BUSYBOX_CONFIG_LPR is not set
+# CONFIG_BUSYBOX_CONFIG_LPQ is not set
+
+#
+# Mail Utilities
+#
+# CONFIG_BUSYBOX_CONFIG_MAKEMIME is not set
+# CONFIG_BUSYBOX_CONFIG_POPMAILDIR is not set
+# CONFIG_BUSYBOX_CONFIG_REFORMIME is not set
+# CONFIG_BUSYBOX_CONFIG_SENDMAIL is not set
+
+#
+# Process Utilities
+#
+# CONFIG_BUSYBOX_CONFIG_SMEMCAP is not set
+CONFIG_BUSYBOX_CONFIG_FREE=y
+# CONFIG_BUSYBOX_CONFIG_FUSER is not set
+CONFIG_BUSYBOX_CONFIG_KILL=y
+CONFIG_BUSYBOX_CONFIG_KILLALL=y
+CONFIG_BUSYBOX_CONFIG_KILLALL5=y
+# CONFIG_BUSYBOX_CONFIG_NMETER is not set
+CONFIG_BUSYBOX_CONFIG_PGREP=y
+CONFIG_BUSYBOX_CONFIG_PIDOF=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_PIDOF_SINGLE=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_PIDOF_OMIT=y
+CONFIG_BUSYBOX_CONFIG_PKILL=y
+CONFIG_BUSYBOX_CONFIG_PS=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_PS_WIDE=y
+# CONFIG_BUSYBOX_CONFIG_RENICE is not set
+CONFIG_BUSYBOX_CONFIG_BB_SYSCTL=y
+CONFIG_BUSYBOX_CONFIG_TOP=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_TOP_CPU_USAGE_PERCENTAGE is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_TOP_SMP_PROCESS is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_TOPMEM=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_SHOW_THREADS is not set
+CONFIG_BUSYBOX_CONFIG_UPTIME=y
+CONFIG_BUSYBOX_CONFIG_WATCH=y
+
+#
+# Runit Utilities
+#
+# CONFIG_BUSYBOX_CONFIG_RUNSV is not set
+# CONFIG_BUSYBOX_CONFIG_RUNSVDIR is not set
+# CONFIG_BUSYBOX_CONFIG_SV is not set
+# CONFIG_BUSYBOX_CONFIG_SVLOGD is not set
+# CONFIG_BUSYBOX_CONFIG_CHPST is not set
+# CONFIG_BUSYBOX_CONFIG_SETUIDGID is not set
+# CONFIG_BUSYBOX_CONFIG_ENVUIDGID is not set
+# CONFIG_BUSYBOX_CONFIG_ENVDIR is not set
+# CONFIG_BUSYBOX_CONFIG_SOFTLIMIT is not set
+
+#
+# Shells
+#
+CONFIG_BUSYBOX_CONFIG_ASH=y
+CONFIG_BUSYBOX_CONFIG_ASH_BASH_COMPAT=y
+CONFIG_BUSYBOX_CONFIG_ASH_JOB_CONTROL=y
+CONFIG_BUSYBOX_CONFIG_ASH_ALIAS=y
+CONFIG_BUSYBOX_CONFIG_ASH_GETOPTS=y
+CONFIG_BUSYBOX_CONFIG_ASH_BUILTIN_ECHO=y
+CONFIG_BUSYBOX_CONFIG_ASH_BUILTIN_PRINTF=y
+CONFIG_BUSYBOX_CONFIG_ASH_BUILTIN_TEST=y
+CONFIG_BUSYBOX_CONFIG_ASH_CMDCMD=y
+# CONFIG_BUSYBOX_CONFIG_ASH_MAIL is not set
+# CONFIG_BUSYBOX_CONFIG_ASH_OPTIMIZE_FOR_SIZE is not set
+CONFIG_BUSYBOX_CONFIG_ASH_RANDOM_SUPPORT=y
+CONFIG_BUSYBOX_CONFIG_ASH_EXPAND_PRMT=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_SH_IS_ASH=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_SH_IS_HUSH is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_SH_IS_NONE is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_BASH_IS_ASH is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_BASH_IS_HUSH is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_BASH_IS_NONE=y
+# CONFIG_BUSYBOX_CONFIG_LASH is not set
+# CONFIG_BUSYBOX_CONFIG_MSH is not set
+CONFIG_BUSYBOX_CONFIG_SH_MATH_SUPPORT=y
+CONFIG_BUSYBOX_CONFIG_SH_MATH_SUPPORT_64=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_SH_EXTRA_QUIET is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_SH_STANDALONE is not set
+# CONFIG_BUSYBOX_CONFIG_FEATURE_SH_NOFORK is not set
+# CONFIG_BUSYBOX_CONFIG_CTTYHACK is not set
+
+#
+# System Logging Utilities
+#
+CONFIG_BUSYBOX_CONFIG_SYSLOGD=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_ROTATE_LOGFILE=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_REMOTE_LOG=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_SYSLOGD_DUP is not set
+CONFIG_BUSYBOX_CONFIG_FEATURE_SYSLOGD_READ_BUFFER_SIZE=256
+CONFIG_BUSYBOX_CONFIG_FEATURE_IPC_SYSLOG=y
+CONFIG_BUSYBOX_CONFIG_FEATURE_IPC_SYSLOG_BUFFER_SIZE=16
+CONFIG_BUSYBOX_CONFIG_LOGREAD=y
+# CONFIG_BUSYBOX_CONFIG_FEATURE_LOGREAD_REDUCED_LOCKING is not set
+CONFIG_BUSYBOX_CONFIG_KLOGD=y
+CONFIG_BUSYBOX_CONFIG_LOGGER=y
+CONFIG_PACKAGE_dnsmasq=y
+CONFIG_PACKAGE_dropbear=y
+# CONFIG_PACKAGE_ead is not set
+# CONFIG_PACKAGE_hotplug2 is not set
+CONFIG_PACKAGE_libc=y
+CONFIG_PACKAGE_libgcc=y
+CONFIG_PACKAGE_libpthread=y
+CONFIG_PACKAGE_librt=y
+# CONFIG_PACKAGE_libstdcpp is not set
+CONFIG_PACKAGE_mtd=y
+CONFIG_PACKAGE_nvram=y
+CONFIG_PACKAGE_opkg=y
+# CONFIG_PACKAGE_qos-scripts is not set
+CONFIG_PACKAGE_uci=y
+CONFIG_PACKAGE_ucitrigger=y
+# CONFIG_PACKAGE_udev is not set
+CONFIG_PACKAGE_udevtrigger=y
+CONFIG_PACKAGE_wireless-tools=y
+
+#
+# Network
+#
+
+#
+# Time Synchronization
+#
+CONFIG_PACKAGE_ntpclient=y
+
+#
+# Web
+#
+# CONFIG_PACKAGE_mini-httpd is not set
+# CONFIG_PACKAGE_mini-httpd-htpasswd is not set
+# CONFIG_PACKAGE_mini-httpd-matrixssl is not set
+CONFIG_PACKAGE_mini-httpd-openssl=y
+# CONFIG_PACKAGE_arptables is not set
+# CONFIG_PACKAGE_crda is not set
+# CONFIG_PACKAGE_ebtables is not set
+# CONFIG_PACKAGE_ebtables-utils is not set
+# CONFIG_PACKAGE_genl is not set
+# CONFIG_PACKAGE_hostapd is not set
+# CONFIG_PACKAGE_hostapd-mini is not set
+# CONFIG_PACKAGE_ifenslave is not set
+# CONFIG_PACKAGE_ip is not set
+# CONFIG_PACKAGE_ipset is not set
+CONFIG_PACKAGE_iptables=y
+CONFIG_PACKAGE_iptables-mod-conntrack=y
+CONFIG_PACKAGE_iptables-mod-extra=y
+CONFIG_PACKAGE_iptables-mod-filter=y
+# CONFIG_PACKAGE_iptables-mod-hashlimit is not set
+# CONFIG_PACKAGE_iptables-mod-imq is not set
+CONFIG_PACKAGE_iptables-mod-ipopt=y
+CONFIG_PACKAGE_iptables-mod-iprange=y
+# CONFIG_PACKAGE_iptables-mod-ipsec is not set
+# CONFIG_PACKAGE_iptables-mod-ipset is not set
+CONFIG_PACKAGE_iptables-mod-nat=y
+# CONFIG_PACKAGE_iptables-mod-tproxy is not set
+CONFIG_PACKAGE_iptables-mod-ulog=y
+CONFIG_PACKAGE_iptables-utils=y
+# CONFIG_PACKAGE_iw is not set
+CONFIG_PACKAGE_ppp=y
+# CONFIG_PACKAGE_chat is not set
+# CONFIG_PACKAGE_ppp-mod-pppoa is not set
+CONFIG_PACKAGE_ppp-mod-pppoe=y
+# CONFIG_PACKAGE_ppp-mod-radius is not set
+# CONFIG_PACKAGE_pppdump is not set
+# CONFIG_PACKAGE_pppstats is not set
+# CONFIG_PACKAGE_pptp is not set
+# CONFIG_PACKAGE_tc is not set
+CONFIG_PACKAGE_uhttpd=y
+# CONFIG_PACKAGE_uhttpd-mod-lua is not set
+# CONFIG_PACKAGE_uhttpd-mod-tls is not set
+# CONFIG_PACKAGE_wpa-supplicant is not set
+# CONFIG_PACKAGE_wpa-supplicant-mini is not set
+# CONFIG_PACKAGE_wpad is not set
+# CONFIG_PACKAGE_wpad-mini is not set
+# CONFIG_PACKAGE_wprobe-export is not set
+# CONFIG_PACKAGE_wprobe-util is not set
+
+#
+# Libraries
+#
+
+#
+# Filesystem
+#
+CONFIG_PACKAGE_libblkid=y
+CONFIG_PACKAGE_libext2fs=y
+# CONFIG_PACKAGE_libfuse is not set
+CONFIG_PACKAGE_libuuid=y
+
+#
+# SSL
+#
+# CONFIG_PACKAGE_libcyassl is not set
+CONFIG_PACKAGE_libopenssl=y
+
+#
+# Configuration
+#
+# CONFIG_OPENSSL_ENGINE is not set
+# CONFIG_PACKAGE_libipq is not set
+CONFIG_PACKAGE_libiptc=y
+# CONFIG_PACKAGE_libiw is not set
+# CONFIG_PACKAGE_libltdl is not set
+CONFIG_PACKAGE_liblua=y
+# CONFIG_PACKAGE_libncurses is not set
+# CONFIG_PACKAGE_libnl is not set
+# CONFIG_PACKAGE_libnl-tiny is not set
+# CONFIG_PACKAGE_libpcap is not set
+# CONFIG_PACKAGE_libreadline is not set
+CONFIG_PACKAGE_libuci=y
+CONFIG_PACKAGE_libuci-lua=y
+CONFIG_PACKAGE_libusb=y
+CONFIG_PACKAGE_libxtables=y
+# CONFIG_PACKAGE_linux-atm is not set
+CONFIG_PACKAGE_zlib=y
+
+#
+# IPv6
+#
+# CONFIG_PACKAGE_6in4 is not set
+# CONFIG_PACKAGE_ip6tables is not set
+
+#
+# Kernel modules
+#
+
+#
+# Block Devices
+#
+# CONFIG_PACKAGE_kmod-aoe is not set
+# CONFIG_PACKAGE_kmod-ata-core is not set
+# CONFIG_PACKAGE_kmod-block2mtd is not set
+# CONFIG_PACKAGE_kmod-dm is not set
+# CONFIG_PACKAGE_kmod-ide-core is not set
+# CONFIG_PACKAGE_kmod-loop is not set
+# CONFIG_PACKAGE_kmod-nbd is not set
+CONFIG_PACKAGE_kmod-scsi-core=y
+# CONFIG_PACKAGE_kmod-scsi-generic is not set
+
+#
+# Cryptographic API modules
+#
+# CONFIG_PACKAGE_kmod-crypto-core is not set
+
+#
+# Filesystems
+#
+# CONFIG_PACKAGE_kmod-fs-autofs4 is not set
+# CONFIG_PACKAGE_kmod-fs-btrfs is not set
+# CONFIG_PACKAGE_kmod-fs-cifs is not set
+# CONFIG_PACKAGE_kmod-fs-exportfs is not set
+# CONFIG_PACKAGE_kmod-fs-ext2 is not set
+CONFIG_PACKAGE_kmod-fs-ext3=y
+# CONFIG_PACKAGE_kmod-fs-ext4 is not set
+# CONFIG_PACKAGE_kmod-fs-hfs is not set
+# CONFIG_PACKAGE_kmod-fs-hfsplus is not set
+# CONFIG_PACKAGE_kmod-fs-isofs is not set
+CONFIG_PACKAGE_kmod-fs-mbcache=y
+# CONFIG_PACKAGE_kmod-fs-minix is not set
+# CONFIG_PACKAGE_kmod-fs-msdos is not set
+# CONFIG_PACKAGE_kmod-fs-nfs is not set
+# CONFIG_PACKAGE_kmod-fs-nfs-common is not set
+# CONFIG_PACKAGE_kmod-fs-nfsd is not set
+# CONFIG_PACKAGE_kmod-fs-ntfs is not set
+# CONFIG_PACKAGE_kmod-fs-reiserfs is not set
+# CONFIG_PACKAGE_kmod-fs-udf is not set
+CONFIG_PACKAGE_kmod-fs-vfat=y
+# CONFIG_PACKAGE_kmod-fs-xfs is not set
+# CONFIG_PACKAGE_kmod-fuse is not set
+
+#
+# FireWire support
+#
+# CONFIG_PACKAGE_kmod-ieee1394 is not set
+
+#
+# Hardware Monitoring Support
+#
+# CONFIG_PACKAGE_kmod-hwmon-core is not set
+
+#
+# I2C support
+#
+# CONFIG_PACKAGE_kmod-i2c-core is not set
+# CONFIG_PACKAGE_kmod-i2c-gpio-custom is not set
+
+#
+# Native Language Support
+#
+CONFIG_PACKAGE_kmod-nls-base=y
+# CONFIG_PACKAGE_kmod-nls-cp1250 is not set
+# CONFIG_PACKAGE_kmod-nls-cp1251 is not set
+CONFIG_PACKAGE_kmod-nls-cp437=y
+# CONFIG_PACKAGE_kmod-nls-cp775 is not set
+# CONFIG_PACKAGE_kmod-nls-cp850 is not set
+# CONFIG_PACKAGE_kmod-nls-cp852 is not set
+# CONFIG_PACKAGE_kmod-nls-cp866 is not set
+# CONFIG_PACKAGE_kmod-nls-iso8859-1 is not set
+# CONFIG_PACKAGE_kmod-nls-iso8859-13 is not set
+# CONFIG_PACKAGE_kmod-nls-iso8859-15 is not set
+# CONFIG_PACKAGE_kmod-nls-iso8859-2 is not set
+# CONFIG_PACKAGE_kmod-nls-koi8r is not set
+# CONFIG_PACKAGE_kmod-nls-utf8 is not set
+
+#
+# Netfilter Extensions
+#
+# CONFIG_PACKAGE_kmod-arptables is not set
+# CONFIG_PACKAGE_kmod-ebtables is not set
+# CONFIG_PACKAGE_kmod-ip6tables is not set
+CONFIG_PACKAGE_kmod-ipt-core=y
+CONFIG_PACKAGE_kmod-ipt-conntrack=y
+CONFIG_PACKAGE_kmod-ipt-conntrack-extra=y
+CONFIG_PACKAGE_kmod-ipt-extra=y
+CONFIG_PACKAGE_kmod-ipt-filter=y
+# CONFIG_PACKAGE_kmod-ipt-hashlimit is not set
+# CONFIG_PACKAGE_kmod-ipt-imq is not set
+CONFIG_PACKAGE_kmod-ipt-ipopt=y
+CONFIG_PACKAGE_kmod-ipt-iprange=y
+# CONFIG_PACKAGE_kmod-ipt-ipsec is not set
+# CONFIG_PACKAGE_kmod-ipt-ipset is not set
+CONFIG_PACKAGE_kmod-ipt-nat=y
+# CONFIG_PACKAGE_kmod-ipt-nat-extra is not set
+CONFIG_PACKAGE_kmod-ipt-nathelper=y
+# CONFIG_PACKAGE_kmod-ipt-nathelper-extra is not set
+CONFIG_PACKAGE_kmod-ipt-queue=y
+# CONFIG_PACKAGE_kmod-ipt-tproxy is not set
+CONFIG_PACKAGE_kmod-ipt-ulog=y
+# CONFIG_PACKAGE_kmod-nf-conntrack-netlink is not set
+# CONFIG_PACKAGE_kmod-nfnetlink is not set
+# CONFIG_PACKAGE_kmod-nfnetlink-log is not set
+# CONFIG_PACKAGE_kmod-nfnetlink-queue is not set
+
+#
+# Network Devices
+#
+# CONFIG_PACKAGE_kmod-e1000 is not set
+# CONFIG_PACKAGE_kmod-gigaset is not set
+# CONFIG_PACKAGE_kmod-hfcmulti is not set
+# CONFIG_PACKAGE_kmod-libphy is not set
+# CONFIG_PACKAGE_kmod-macvlan is not set
+# CONFIG_PACKAGE_kmod-mvswitch is not set
+# CONFIG_PACKAGE_kmod-siit is not set
+# CONFIG_PACKAGE_kmod-ssb-gige is not set
+# CONFIG_PACKAGE_kmod-swconfig is not set
+# CONFIG_PACKAGE_kmod-switch-ip17xx is not set
+# CONFIG_PACKAGE_kmod-tg3 is not set
+# CONFIG_PACKAGE_kmod-tulip is not set
+
+#
+# Network Support
+#
+# CONFIG_PACKAGE_kmod-appletalk is not set
+# CONFIG_PACKAGE_kmod-atm is not set
+# CONFIG_PACKAGE_kmod-ax25 is not set
+# CONFIG_PACKAGE_kmod-bonding is not set
+# CONFIG_PACKAGE_kmod-capi is not set
+# CONFIG_PACKAGE_kmod-gre is not set
+# CONFIG_PACKAGE_kmod-ip6-tunnel is not set
+# CONFIG_PACKAGE_kmod-ipip is not set
+# CONFIG_PACKAGE_kmod-ipsec is not set
+# CONFIG_PACKAGE_kmod-iptunnel4 is not set
+# CONFIG_PACKAGE_kmod-iptunnel6 is not set
+# CONFIG_PACKAGE_kmod-ipv6 is not set
+# CONFIG_PACKAGE_kmod-isdn4linux is not set
+# CONFIG_PACKAGE_kmod-misdn is not set
+# CONFIG_PACKAGE_kmod-mp-alg is not set
+# CONFIG_PACKAGE_kmod-pktgen is not set
+CONFIG_PACKAGE_kmod-ppp=y
+# CONFIG_PACKAGE_kmod-mppe is not set
+# CONFIG_PACKAGE_kmod-ppp-synctty is not set
+# CONFIG_PACKAGE_kmod-pppoa is not set
+CONFIG_PACKAGE_kmod-pppoe=y
+# CONFIG_PACKAGE_kmod-pppol2tp is not set
+# CONFIG_PACKAGE_kmod-sched is not set
+# CONFIG_PACKAGE_kmod-sctp is not set
+# CONFIG_PACKAGE_kmod-sit is not set
+CONFIG_PACKAGE_kmod-tun=y
+# CONFIG_PACKAGE_kmod-wprobe is not set
+
+#
+# OCF Configuration
+#
+# CONFIG_PACKAGE_kmod-ocf-ubsec-ssb is not set
+
+#
+# Other modules
+#
+# CONFIG_PACKAGE_kmod-bluetooth is not set
+# CONFIG_PACKAGE_kmod-button-hotplug is not set
+CONFIG_PACKAGE_kmod-crc-ccitt=y
+# CONFIG_PACKAGE_kmod-crc-itu-t is not set
+# CONFIG_PACKAGE_kmod-crc16 is not set
+# CONFIG_PACKAGE_kmod-crc7 is not set
+CONFIG_PACKAGE_kmod-diag=y
+# CONFIG_PACKAGE_kmod-eeprom-93cx6 is not set
+# CONFIG_PACKAGE_kmod-gpio-dev is not set
+# CONFIG_PACKAGE_kmod-hid is not set
+# CONFIG_PACKAGE_kmod-input-core is not set
+# CONFIG_PACKAGE_kmod-input-evdev is not set
+# CONFIG_PACKAGE_kmod-input-gpio-buttons is not set
+# CONFIG_PACKAGE_kmod-input-gpio-encoder is not set
+# CONFIG_PACKAGE_kmod-input-gpio-keys is not set
+# CONFIG_PACKAGE_kmod-input-joydev is not set
+# CONFIG_PACKAGE_kmod-input-polldev is not set
+# CONFIG_PACKAGE_kmod-leds-gpio is not set
+# CONFIG_PACKAGE_kmod-ledtrig-morse is not set
+# CONFIG_PACKAGE_kmod-ledtrig-netdev is not set
+# CONFIG_PACKAGE_kmod-libcrc32c is not set
+# CONFIG_PACKAGE_kmod-mmc is not set
+# CONFIG_PACKAGE_kmod-mmc-over-gpio is not set
+# CONFIG_PACKAGE_kmod-pwm is not set
+# CONFIG_PACKAGE_kmod-pwm-gpio is not set
+# CONFIG_PACKAGE_kmod-pwm-gpio-custom is not set
+# CONFIG_PACKAGE_kmod-rfkill is not set
+# CONFIG_PACKAGE_kmod-rotary-gpio-custom is not set
+# CONFIG_PACKAGE_kmod-rtc-rv5c386a is not set
+# CONFIG_PACKAGE_kmod-softdog is not set
+CONFIG_PACKAGE_kmod-switch=y
+CONFIG_PACKAGE_kmod-textsearch=y
+
+#
+# PCMCIA support
+#
+# CONFIG_PACKAGE_kmod-pcmcia-core is not set
+
+#
+# Proprietary BCM43xx WiFi driver
+#
+CONFIG_PACKAGE_kmod-brcm-wl=y
+# CONFIG_PACKAGE_kmod-brcm-wl-mini is not set
+CONFIG_PACKAGE_nas=y
+# CONFIG_PACKAGE_wl is not set
+CONFIG_PACKAGE_wlc=y
+
+#
+# SPI Support
+#
+# CONFIG_PACKAGE_kmod-mmc-spi is not set
+# CONFIG_PACKAGE_kmod-spi-bitbang is not set
+# CONFIG_PACKAGE_kmod-spi-dev is not set
+# CONFIG_PACKAGE_kmod-spi-gpio is not set
+# CONFIG_PACKAGE_kmod-spi-gpio-old is not set
+# CONFIG_PACKAGE_kmod-spi-ks8995 is not set
+
+#
+# Sound Support
+#
+# CONFIG_PACKAGE_kmod-pcspkr is not set
+# CONFIG_PACKAGE_kmod-sound-core is not set
+
+#
+# USB Support
+#
+# CONFIG_PACKAGE_kmod-usb-acm is not set
+# CONFIG_PACKAGE_kmod-usb-atm is not set
+# CONFIG_PACKAGE_kmod-usb-cm109 is not set
+CONFIG_PACKAGE_kmod-usb-core=y
+# CONFIG_PACKAGE_kmod-usb-hid is not set
+# CONFIG_PACKAGE_kmod-usb-net is not set
+# CONFIG_PACKAGE_kmod-usb-ohci is not set
+# CONFIG_PACKAGE_kmod-usb-phidget is not set
+# CONFIG_PACKAGE_kmod-usb-printer is not set
+# CONFIG_PACKAGE_kmod-usb-serial is not set
+CONFIG_PACKAGE_kmod-usb-storage=y
+# CONFIG_PACKAGE_kmod-usb-storage-extras is not set
+# CONFIG_PACKAGE_kmod-usb-uhci is not set
+# CONFIG_PACKAGE_kmod-usb-video is not set
+# CONFIG_PACKAGE_kmod-usb-yealink is not set
+CONFIG_PACKAGE_kmod-usb2=y
+
+#
+# Video Support
+#
+# CONFIG_PACKAGE_kmod-video-core is not set
+
+#
+# Virtualization Support
+#
+
+#
+# Voice over IP
+#
+
+#
+# W1 support
+#
+# CONFIG_PACKAGE_kmod-w1 is not set
+
+#
+# Wireless Drivers
+#
+# CONFIG_PACKAGE_kmod-acx is not set
+# CONFIG_PACKAGE_kmod-acx-mac80211 is not set
+# CONFIG_PACKAGE_kmod-ath is not set
+# CONFIG_PACKAGE_kmod-ath5k is not set
+# CONFIG_PACKAGE_kmod-ath9k is not set
+# CONFIG_PACKAGE_kmod-b43 is not set
+# CONFIG_B43_STABLE is not set
+# CONFIG_B43_EXPERIMENTAL is not set
+# CONFIG_B43_OPENFIRMWARE is not set
+# CONFIG_PACKAGE_kmod-b43legacy is not set
+# CONFIG_PACKAGE_kmod-carl9170 is not set
+# CONFIG_PACKAGE_kmod-cfg80211 is not set
+# CONFIG_PACKAGE_kmod-hostap is not set
+# CONFIG_PACKAGE_kmod-hostap-cs is not set
+# CONFIG_PACKAGE_kmod-hostap-pci is not set
+# CONFIG_PACKAGE_kmod-hostap-plx is not set
+# CONFIG_PACKAGE_kmod-lib80211 is not set
+# CONFIG_PACKAGE_kmod-libertas-sd is not set
+# CONFIG_PACKAGE_kmod-libertas-usb is not set
+# CONFIG_PACKAGE_kmod-mac80211 is not set
+# CONFIG_PACKAGE_kmod-mac80211-hwsim is not set
+# CONFIG_PACKAGE_kmod-madwifi is not set
+# CONFIG_PACKAGE_kmod-mwl8k is not set
+# CONFIG_PACKAGE_kmod-net-airo is not set
+# CONFIG_PACKAGE_kmod-net-hermes is not set
+# CONFIG_PACKAGE_kmod-net-hermes-pci is not set
+# CONFIG_PACKAGE_kmod-net-hermes-pcmcia is not set
+# CONFIG_PACKAGE_kmod-net-hermes-plx is not set
+# CONFIG_PACKAGE_kmod-net-ipw2100 is not set
+# CONFIG_PACKAGE_kmod-net-ipw2200 is not set
+# CONFIG_PACKAGE_kmod-net-libipw is not set
+# CONFIG_PACKAGE_kmod-net-prism54 is not set
+# CONFIG_PACKAGE_kmod-p54-common is not set
+# CONFIG_PACKAGE_kmod-p54-pci is not set
+# CONFIG_PACKAGE_kmod-p54-usb is not set
+# CONFIG_PACKAGE_kmod-rt2400-pci is not set
+# CONFIG_PACKAGE_kmod-rt2500-pci is not set
+# CONFIG_PACKAGE_kmod-rt2500-usb is not set
+# CONFIG_PACKAGE_kmod-rt2800-lib is not set
+# CONFIG_PACKAGE_kmod-rt2800-pci is not set
+# CONFIG_PACKAGE_kmod-rt2800-usb is not set
+# CONFIG_PACKAGE_kmod-rt2x00-lib is not set
+# CONFIG_PACKAGE_kmod-rt2x00-pci is not set
+# CONFIG_PACKAGE_kmod-rt2x00-usb is not set
+# CONFIG_PACKAGE_kmod-rt61-pci is not set
+# CONFIG_PACKAGE_kmod-rt73-usb is not set
+# CONFIG_PACKAGE_kmod-rtl8180 is not set
+# CONFIG_PACKAGE_kmod-rtl8187 is not set
+# CONFIG_PACKAGE_kmod-zd1211rw is not set
+
+#
+# Boot Loaders
+#
+
+#
+# Administration
+#
+
+#
+# webif
+#
+CONFIG_PACKAGE_webif=y
+# CONFIG_PACKAGE_webif-lang-ca is not set
+# CONFIG_PACKAGE_webif-lang-cs is not set
+# CONFIG_PACKAGE_webif-lang-da is not set
+# CONFIG_PACKAGE_webif-lang-de is not set
+# CONFIG_PACKAGE_webif-lang-ee is not set
+# CONFIG_PACKAGE_webif-lang-es is not set
+# CONFIG_PACKAGE_webif-lang-fr is not set
+# CONFIG_PACKAGE_webif-lang-hr is not set
+# CONFIG_PACKAGE_webif-lang-hu is not set
+# CONFIG_PACKAGE_webif-lang-it is not set
+# CONFIG_PACKAGE_webif-lang-nl is not set
+# CONFIG_PACKAGE_webif-lang-no is not set
+# CONFIG_PACKAGE_webif-lang-pl is not set
+# CONFIG_PACKAGE_webif-lang-pt is not set
+# CONFIG_PACKAGE_webif-lang-ru is not set
+# CONFIG_PACKAGE_webif-lang-sq is not set
+# CONFIG_PACKAGE_webif-lang-sv is not set
+# CONFIG_PACKAGE_webif-lang-uk is not set
+# CONFIG_PACKAGE_webif-lang-zh is not set
+# CONFIG_PACKAGE_webif-theme-clubman is not set
+# CONFIG_PACKAGE_webif-theme-sedky1 is not set
+CONFIG_PACKAGE_webif-theme-xwrt=y
+# CONFIG_PACKAGE_webif-theme-xwrt-mini is not set
+# CONFIG_PACKAGE_webif-theme-zephyr is not set
+
+#
+# Utilities
+#
+
+#
+# Boot Loaders
+#
+
+#
+# Filesystem
+#
+# CONFIG_PACKAGE_badblocks is not set
+# CONFIG_PACKAGE_blkid is not set
+# CONFIG_PACKAGE_e2fsprogs is not set
+# CONFIG_PACKAGE_fuse-utils is not set
+# CONFIG_PACKAGE_resize2fs is not set
+# CONFIG_PACKAGE_tune2fs is not set
+# CONFIG_PACKAGE_uuidgen is not set
+
+#
+# Terminal
+#
+# CONFIG_PACKAGE_script is not set
+# CONFIG_PACKAGE_setterm is not set
+
+#
+# disc
+#
+# CONFIG_PACKAGE_cfdisk is not set
+# CONFIG_PACKAGE_fdisk is not set
+# CONFIG_PACKAGE_sfdisk is not set
+CONFIG_PACKAGE_swap-utils=y
+# CONFIG_PACKAGE_comgt is not set
+# CONFIG_PACKAGE_dropbearconvert is not set
+# CONFIG_PACKAGE_fconfig is not set
+# CONFIG_PACKAGE_flock is not set
+# CONFIG_PACKAGE_gdb is not set
+# CONFIG_PACKAGE_gdbserver is not set
+# CONFIG_PACKAGE_gpioctl is not set
+CONFIG_PACKAGE_haserl=y
+# CONFIG_PACKAGE_hdparm is not set
+# CONFIG_PACKAGE_hwclock is not set
+# CONFIG_PACKAGE_kexec-tools is not set
+# CONFIG_PACKAGE_ldconfig is not set
+# CONFIG_PACKAGE_ldd is not set
+# CONFIG_PACKAGE_losetup is not set
+# CONFIG_PACKAGE_mount-utils is not set
+# CONFIG_PACKAGE_mountd is not set
+# CONFIG_PACKAGE_ocf-crypto-headers is not set
+CONFIG_PACKAGE_openssl-util=y
+# CONFIG_PACKAGE_px5g is not set
+# CONFIG_PACKAGE_robocfg is not set
+# CONFIG_PACKAGE_spidev-test is not set
+# CONFIG_PACKAGE_uboot-envtools is not set
+# CONFIG_PACKAGE_usbutils is not set
+
+#
+# Emulators
+#
+
+#
+# Languages
+#
+
+#
+# Lua
+#
+CONFIG_PACKAGE_lua=y
+# CONFIG_PACKAGE_lua-examples is not set
+# CONFIG_PACKAGE_luac is not set
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/include/image.mk buildroot/include/image.mk
--- buildroot.orig/include/image.mk	2010-09-24 22:18:27.000000000 -0400
+++ buildroot/include/image.mk	2010-09-24 22:25:55.000000000 -0400
@@ -150,6 +150,8 @@
 	- $(FIND) $(TARGET_DIR) -type d -print0 | $(XARGS) -0 chmod 0755
 	$(INSTALL_DIR) $(TARGET_DIR)/tmp
 	chmod 0777 $(TARGET_DIR)/tmp
+	chmod 0600 $(TARGET_DIR)/etc/shadow
+	chmod 0600 $(TARGET_DIR)/etc/freeradius/users
 endef
 
 define Image/mkfs/prepare
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/advanced_firewall.conf buildroot/package/base-files/files/etc/advanced_firewall.conf
--- buildroot.orig/package/base-files/files/etc/advanced_firewall.conf	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/advanced_firewall.conf	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,20 @@
+https_from_outside=block
+ssh_from_outside=block
+openvpn_from_outside=unblock
+openvpn_to_internet=block
+external_dns=0
+voip=0
+ipt_unclean=1
+chat_IRC=0
+chat_MS=0
+chat_aim=0
+chat_googletalk=0
+chat_yahoomessenger=0
+p2p_bittorrent=0
+p2p_edonkey=0
+p2p_gnutella=0
+p2p_kazaa=0
+p2p_others=0
+remoteaccess_gotomypc=0
+remoteaccess_logmein=0
+remoteaccess_pcnow=0
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/banner buildroot/package/base-files/files/etc/banner
--- buildroot.orig/package/base-files/files/etc/banner	2010-09-24 22:19:20.000000000 -0400
+++ buildroot/package/base-files/files/etc/banner	2010-09-24 22:25:55.000000000 -0400
@@ -1,10 +1,22 @@
+ ---------------------------------------------------
+
+        11111
+        10101
+        11011
+ .-----m-----m-----.
+ |                 |
+ |                 |
+ | PacketProtector |
+ |                 |
+ .                 .
+  \               /
+   ---------------     http://packetprotector.org
+
+ ---------------------------------------------------
   _______                     ________        __
  |       |.-----.-----.-----.|  |  |  |.----.|  |_
  |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
  |_______||   __|_____|__|__||________||__|  |____|
           |__| W I R E L E S S   F R E E D O M
- KAMIKAZE (bleeding edge, $R) ------------------
-  * 10 oz Vodka       Shake well with ice and strain
-  * 10 oz Triple sec  mixture into 10 shot glasses.
-  * 10 oz lime juice  Salute!
+
  ---------------------------------------------------
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/config/system buildroot/package/base-files/files/etc/config/system
--- buildroot.orig/package/base-files/files/etc/config/system	2010-09-24 22:19:20.000000000 -0400
+++ buildroot/package/base-files/files/etc/config/system	2010-09-24 22:25:55.000000000 -0400
@@ -1,6 +1,6 @@
 config system
-	option hostname	OpenWrt
-	option timezone	UTC
+	option hostname	PacketProtector
+	option timezone	EST5EDT,M3.2.0,M11.1.0
 
 config rdate
 	option interface	wan
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/config/timezone buildroot/package/base-files/files/etc/config/timezone
--- buildroot.orig/package/base-files/files/etc/config/timezone	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/config/timezone	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,3 @@
+config 'timezone'
+        option 'posixtz' 'EST5EDT,M3.2.0,M11.1.0'
+        option 'zoneinfo' 'America/New_York'
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/build-ca buildroot/package/base-files/files/etc/easy-rsa/build-ca
--- buildroot.orig/package/base-files/files/etc/easy-rsa/build-ca	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/build-ca	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,13 @@
+#!/bin/sh
+
+#
+# Build a root certificate
+#
+
+if test $KEY_DIR; then
+	cd $KEY_DIR && \
+	openssl req -days 3650 -nodes -new -x509 -keyout ca.key -out ca.crt -config $KEY_CONFIG && \
+        chmod 0600 ca.key
+else
+	echo you must define KEY_DIR
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/build-ca-batch buildroot/package/base-files/files/etc/easy-rsa/build-ca-batch
--- buildroot.orig/package/base-files/files/etc/easy-rsa/build-ca-batch	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/build-ca-batch	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,14 @@
+#!/bin/sh
+
+#
+# Build a root certificate
+#
+
+if test $KEY_DIR; then
+	KEY_CONFIG=/etc/easy-rsa/openssl-ca.cnf
+	cd $KEY_DIR && \
+	openssl req -days 7300 -nodes -new -x509 -keyout ca.key -out ca.crt -config $KEY_CONFIG && \
+        chmod 0600 ca.key
+else
+	echo you must define KEY_DIR
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/build-dh buildroot/package/base-files/files/etc/easy-rsa/build-dh
--- buildroot.orig/package/base-files/files/etc/easy-rsa/build-dh	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/build-dh	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,12 @@
+#!/bin/sh
+
+#
+# Build Diffie-Hellman parameters for the server side
+# of an SSL/TLS connection.
+#
+
+if test $KEY_DIR; then
+    openssl dhparam -out ${KEY_DIR}/dh${KEY_SIZE}.pem ${KEY_SIZE}
+else
+    echo you must define KEY_DIR
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/build-inter buildroot/package/base-files/files/etc/easy-rsa/build-inter
--- buildroot.orig/package/base-files/files/etc/easy-rsa/build-inter	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/build-inter	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,19 @@
+#!/bin/sh
+
+#
+# Make an intermediate CA certificate/private key pair using a locally generated
+# root certificate.
+#
+
+if test $# -ne 1; then
+        echo "usage: build-inter <name>";
+        exit 1
+fi                                                                             
+
+if test $KEY_DIR; then
+	cd $KEY_DIR && \
+	openssl req -days 3650 -nodes -new -keyout $1.key -out $1.csr -config $KEY_CONFIG && \
+	openssl ca -extensions v3_ca -days 3650 -out $1.crt -in $1.csr -config $KEY_CONFIG
+else
+	echo you must define KEY_DIR
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/build-key buildroot/package/base-files/files/etc/easy-rsa/build-key
--- buildroot.orig/package/base-files/files/etc/easy-rsa/build-key	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/build-key	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,20 @@
+#!/bin/sh
+
+#
+# Make a certificate/private key pair using a locally generated
+# root certificate.
+#
+
+if test $# -ne 1; then
+        echo "usage: build-key <name>";
+        exit 1
+fi                                                                             
+
+if test $KEY_DIR; then
+	cd $KEY_DIR && \
+	openssl req -days 3650 -nodes -new -keyout $1.key -out $1.csr -config $KEY_CONFIG && \
+	openssl ca -days 3650 -out $1.crt -in $1.csr -config $KEY_CONFIG && \
+	chmod 0600 $1.key
+else
+	echo you must define KEY_DIR
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/build-key-pass buildroot/package/base-files/files/etc/easy-rsa/build-key-pass
--- buildroot.orig/package/base-files/files/etc/easy-rsa/build-key-pass	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/build-key-pass	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,20 @@
+#!/bin/sh
+
+#
+# Similar to build-key, but protect the private key
+# with a password.
+#
+
+if test $# -ne 1; then
+        echo "usage: build-key-pass <name>";
+        exit 1
+fi
+
+if test $KEY_DIR; then
+	cd $KEY_DIR && \
+	openssl req -days 3650 -new -keyout $1.key -out $1.csr -config $KEY_CONFIG && \
+	openssl ca -days 3650 -out $1.crt -in $1.csr -config $KEY_CONFIG && \
+	chmod 0600 $1.key
+else
+	echo you must define KEY_DIR
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/build-key-pass-batch buildroot/package/base-files/files/etc/easy-rsa/build-key-pass-batch
--- buildroot.orig/package/base-files/files/etc/easy-rsa/build-key-pass-batch	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/build-key-pass-batch	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,21 @@
+#!/bin/sh
+
+#
+# Similar to build-key, but protect the private key
+# with a password.
+#
+
+if test $# -ne 1; then
+        echo "usage: build-key-pass <name>";
+        exit 1
+fi
+
+if test $KEY_DIR; then
+	KEY_CONFIG=/etc/easy-rsa/openssl-client.cnf
+	cd $KEY_DIR && \
+	openssl req -days 3650 -new -keyout $1.key -out $1.csr -config $KEY_CONFIG && \
+	openssl ca -batch -days 3650 -out $1.crt -in $1.csr -config $KEY_CONFIG && \
+	chmod 0600 $1.key
+else
+	echo you must define KEY_DIR
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/build-key-pkcs12 buildroot/package/base-files/files/etc/easy-rsa/build-key-pkcs12
--- buildroot.orig/package/base-files/files/etc/easy-rsa/build-key-pkcs12	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/build-key-pkcs12	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,21 @@
+#!/bin/sh
+
+#
+# Make a certificate/private key pair using a locally generated
+# root certificate and convert it to a PKCS #12 file including the
+# the CA certificate as well.
+
+if test $# -ne 1; then
+        echo "usage: build-key-pkcs12 <name>";
+        exit 1
+fi                                                                             
+
+if test $KEY_DIR; then
+	cd $KEY_DIR && \
+	openssl req -days 3650 -nodes -new -keyout $1.key -out $1.csr -config $KEY_CONFIG && \
+	openssl ca -days 3650 -out $1.crt -in $1.csr -config $KEY_CONFIG && \
+        openssl pkcs12 -export -inkey $1.key -in $1.crt -certfile ca.crt -out $1.p12 && \
+	chmod 0600 $1.key $1.p12
+else
+	echo you must define KEY_DIR
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/build-key-radius-batch buildroot/package/base-files/files/etc/easy-rsa/build-key-radius-batch
--- buildroot.orig/package/base-files/files/etc/easy-rsa/build-key-radius-batch	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/build-key-radius-batch	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,23 @@
+#!/bin/sh
+
+#
+# Make a certificate/private key pair using a locally generated
+# root certificate.
+#
+# Explicitly set nsCertType to server using the "server"
+# extension in the openssl.cnf file.
+
+if test $# -ne 1; then
+        echo "usage: build-key-server <name>";
+        exit 1
+fi                                                                             
+
+if test $KEY_DIR; then
+	KEY_CONFIG=/etc/easy-rsa/openssl-radius.cnf
+	cd $KEY_DIR && \
+	openssl req -days 7300 -nodes -new -keyout $1.key -out $1.csr -extensions server -config $KEY_CONFIG && \
+	openssl ca -batch -days 7300 -out $1.crt -extensions server -extensions xpserver_ext -extfile /etc/easy-rsa/xpextensions -in $1.csr -config $KEY_CONFIG && \
+        chmod 0600 $1.key
+else
+	echo you must define KEY_DIR
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/build-key-server buildroot/package/base-files/files/etc/easy-rsa/build-key-server
--- buildroot.orig/package/base-files/files/etc/easy-rsa/build-key-server	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/build-key-server	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,22 @@
+#!/bin/sh
+
+#
+# Make a certificate/private key pair using a locally generated
+# root certificate.
+#
+# Explicitly set nsCertType to server using the "server"
+# extension in the openssl.cnf file.
+
+if test $# -ne 1; then
+        echo "usage: build-key-server <name>";
+        exit 1
+fi                                                                             
+
+if test $KEY_DIR; then
+	cd $KEY_DIR && \
+	openssl req -days 3650 -nodes -new -keyout $1.key -out $1.csr -extensions server -config $KEY_CONFIG && \
+	openssl ca -days 3650 -out $1.crt -in $1.csr -extensions server -config $KEY_CONFIG && \
+        chmod 0600 $1.key
+else
+	echo you must define KEY_DIR
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/build-key-server-batch buildroot/package/base-files/files/etc/easy-rsa/build-key-server-batch
--- buildroot.orig/package/base-files/files/etc/easy-rsa/build-key-server-batch	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/build-key-server-batch	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,23 @@
+#!/bin/sh
+
+#
+# Make a certificate/private key pair using a locally generated
+# root certificate.
+#
+# Explicitly set nsCertType to server using the "server"
+# extension in the openssl.cnf file.
+
+if test $# -ne 1; then
+        echo "usage: build-key-server <name>";
+        exit 1
+fi                                                                             
+
+if test $KEY_DIR; then
+	KEY_CONFIG=/etc/easy-rsa/openssl-server.cnf
+	cd $KEY_DIR && \
+	openssl req -days 7300 -nodes -new -keyout $1.key -out $1.csr -extensions server -config $KEY_CONFIG && \
+	openssl ca -batch -days 7300 -out $1.crt -in $1.csr -extensions server -config $KEY_CONFIG && \
+        chmod 0600 $1.key
+else
+	echo you must define KEY_DIR
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/build-req buildroot/package/base-files/files/etc/easy-rsa/build-req
--- buildroot.orig/package/base-files/files/etc/easy-rsa/build-req	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/build-req	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,18 @@
+#!/bin/sh
+
+#
+# Build a certificate signing request and private key.  Use this
+# when your root certificate and key is not available locally.
+#
+
+if test $# -ne 1; then
+    echo "usage: build-req <name>";
+    exit 1
+fi                                                                             
+
+if test $KEY_DIR; then
+    cd $KEY_DIR && \
+    openssl req -days 3650 -nodes -new -keyout $1.key -out $1.csr -config $KEY_CONFIG
+else
+    echo you must define KEY_DIR
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/build-req-pass buildroot/package/base-files/files/etc/easy-rsa/build-req-pass
--- buildroot.orig/package/base-files/files/etc/easy-rsa/build-req-pass	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/build-req-pass	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,18 @@
+#!/bin/sh
+
+#
+# Like build-req, but protect your private key
+# with a password.
+#
+
+if test $# -ne 1; then
+    echo "usage: build-req-pass <name>";
+    exit 1
+fi                                                                             
+
+if test $KEY_DIR; then
+    cd $KEY_DIR && \
+    openssl req -days 3650 -new -keyout $1.key -out $1.csr -config $KEY_CONFIG
+else
+    echo you must define KEY_DIR
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/clean-all buildroot/package/base-files/files/etc/easy-rsa/clean-all
--- buildroot.orig/package/base-files/files/etc/easy-rsa/clean-all	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/clean-all	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,21 @@
+#!/bin/sh
+
+#
+# Initialize the $KEY_DIR directory.
+# Note that this script does a
+# rm -rf on $KEY_DIR so be careful!
+#
+
+d=$KEY_DIR
+
+if test $d; then
+	#rm -rf $d
+	rm -f $d/*
+	rm -f /etc/mini_httpd/server.pem
+	#mkdir $d && \
+	#chmod go-rwx $d && \
+	touch $d/index.txt && \
+	echo 01 >$d/serial
+else
+	echo you must define KEY_DIR
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/keys/dh1024.pem buildroot/package/base-files/files/etc/easy-rsa/keys/dh1024.pem
--- buildroot.orig/package/base-files/files/etc/easy-rsa/keys/dh1024.pem	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/keys/dh1024.pem	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,5 @@
+-----BEGIN DH PARAMETERS-----
+MIGHAoGBALvGKBAgbQMEdRRfPVsPf7/QbT/TXhn4Mqe3mnP4WI0e8DELF5MUwUoI
+DumIAXe8ERaynILe8oNseF71z3peU+WTTPJEixpM2jwd6i4XxSBo3LKSa7c2I4SX
+BrFs5s/ljnwFh0euyHGf4r7C5Pt7aPdV4f6u1FWPY1FLRLgQaryTAgEC
+-----END DH PARAMETERS-----
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/keys/serial buildroot/package/base-files/files/etc/easy-rsa/keys/serial
--- buildroot.orig/package/base-files/files/etc/easy-rsa/keys/serial	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/keys/serial	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1 @@
+01
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/list-crl buildroot/package/base-files/files/etc/easy-rsa/list-crl
--- buildroot.orig/package/base-files/files/etc/easy-rsa/list-crl	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/list-crl	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,18 @@
+#!/bin/sh
+
+#
+# list revoked certificates
+#
+#
+
+if test $# -ne 1; then
+        echo "usage: list-crl <crlfile.pem>";
+        exit 1
+fi
+
+if test $KEY_DIR; then
+       cd $KEY_DIR && \
+       openssl crl -text -noout -in $1
+else
+       echo you must define KEY_DIR
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/make-crl buildroot/package/base-files/files/etc/easy-rsa/make-crl
--- buildroot.orig/package/base-files/files/etc/easy-rsa/make-crl	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/make-crl	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,18 @@
+#!/bin/sh
+
+#
+# generate a CRL
+#
+#
+
+if test $# -ne 1; then
+        echo "usage: make-crl <crlfile.pem>";
+        exit 1
+fi
+
+if test $KEY_DIR; then
+       cd $KEY_DIR && \
+       openssl ca -gencrl -out $1 -config $KEY_CONFIG
+else
+       echo you must define KEY_DIR
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/openssl.1 buildroot/package/base-files/files/etc/easy-rsa/openssl.1
--- buildroot.orig/package/base-files/files/etc/easy-rsa/openssl.1	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/openssl.1	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,93 @@
+#
+# OpenSSL example configuration file.
+# This is mostly being used for generation of certificate requests.
+#
+
+# This definition stops the following lines choking if HOME isn't
+# defined.
+HOME			= .
+RANDFILE		= $ENV::HOME/.rnd
+
+# Extra OBJECT IDENTIFIER info:
+#oid_file		= $ENV::HOME/.oid
+oid_section		= new_oids
+
+# To use this configuration file with the "-extfile" option of the
+# "openssl x509" utility, name here the section containing the
+# X.509v3 extensions to use:
+# extensions		= 
+# (Alternatively, use a configuration file that has only
+# X.509v3 extensions in its main [= default] section.)
+
+[ new_oids ]
+
+# We can add new OIDs in here for use by 'ca' and 'req'.
+# Add a simple OID like this:
+# testoid1=1.2.3.4
+# Or use config file substitution like this:
+# testoid2=${testoid1}.5.6
+
+####################################################################
+[ ca ]
+default_ca	= CA_default		# The default ca section
+
+####################################################################
+[ CA_default ]
+
+dir		= $ENV::KEY_DIR		# Where everything is kept
+certs		= $dir			# Where the issued certs are kept
+crl_dir		= $dir			# Where the issued crl are kept
+database	= $dir/index.txt	# database index file.
+new_certs_dir	= $dir			# default place for new certs.
+
+certificate	= $dir/ca.crt	 	# The CA certificate
+serial		= $dir/serial 		# The current serial number
+crl		= $dir/crl.pem 		# The current CRL
+private_key	= $dir/ca.key	 	# The private key
+RANDFILE	= $dir/.rand		# private random number file
+
+x509_extensions	= usr_cert		# The extentions to add to the cert
+
+# Extensions to add to a CRL. Note: Netscape communicator chokes on V2 CRLs
+# so this is commented out by default to leave a V1 CRL.
+# crl_extensions	= crl_ext
+
+default_days	= 7300			# how long to certify for
+default_crl_days= 30			# how long before next CRL
+default_md	= md5			# which md to use.
+preserve	= no			# keep passed DN ordering
+
+# A few difference way of specifying how similar the request should look
+# For type CA, the listed attributes must be the same, and the optional
+# and supplied fields are just that :-)
+policy		= policy_match
+
+# For the CA policy
+[ policy_match ]
+countryName		= match
+stateOrProvinceName	= match
+organizationName	= match
+organizationalUnitName	= optional
+commonName		= supplied
+emailAddress		= optional
+
+# For the 'anything' policy
+# At this point in time, you must list all acceptable 'object'
+# types.
+[ policy_anything ]
+countryName		= optional
+stateOrProvinceName	= optional
+localityName		= optional
+organizationName	= optional
+organizationalUnitName	= optional
+commonName		= supplied
+emailAddress		= optional
+
+####################################################################
+[ req ]
+default_bits		= $ENV::KEY_SIZE
+default_keyfile 	= privkey.pem
+distinguished_name	= req_distinguished_name
+attributes		= req_attributes
+x509_extensions	= v3_ca	# The extentions to add to the self signed cert
+prompt			= no
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/openssl.2 buildroot/package/base-files/files/etc/easy-rsa/openssl.2
--- buildroot.orig/package/base-files/files/etc/easy-rsa/openssl.2	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/openssl.2	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,20 @@
+# This sets a mask for permitted string types. There are several options. 
+# default: PrintableString, T61String, BMPString.
+# pkix	 : PrintableString, BMPString.
+# utf8only: only UTF8Strings.
+# nombstr : PrintableString, T61String (no BMPStrings or UTF8Strings).
+# MASK:XXXX a literal mask value.
+# WARNING: current versions of Netscape crash on BMPStrings or UTF8Strings
+# so use this option with caution!
+string_mask = nombstr
+
+# req_extensions = v3_req # The extensions to add to a certificate request
+
+[ req_distinguished_name ]
+countryName			= US
+
+stateOrProvinceName		= MD
+
+localityName			= Gaithersburg
+
+0.organizationName		= PacketProtector.org
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/openssl.3 buildroot/package/base-files/files/etc/easy-rsa/openssl.3
--- buildroot.orig/package/base-files/files/etc/easy-rsa/openssl.3	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/openssl.3	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,114 @@
+emailAddress			= charlie@packetprotector.org
+
+# SET-ex3			= SET extension number 3
+
+[ req_attributes ]
+
+[ usr_cert ]
+
+# These extensions are added when 'ca' signs a request.
+
+# This goes against PKIX guidelines but some CAs do it and some software
+# requires this to avoid interpreting an end user certificate as a CA.
+
+basicConstraints=CA:FALSE
+
+# Here are some examples of the usage of nsCertType. If it is omitted
+# the certificate can be used for anything *except* object signing.
+
+# This is OK for an SSL server.
+# nsCertType			= server
+
+# For an object signing certificate this would be used.
+# nsCertType = objsign
+
+# For normal client use this is typical
+# nsCertType = client, email
+
+# and for everything including object signing:
+# nsCertType = client, email, objsign
+
+# This is typical in keyUsage for a client certificate.
+# keyUsage = nonRepudiation, digitalSignature, keyEncipherment
+
+# This will be displayed in Netscape's comment listbox.
+nsComment			= "OpenSSL Generated Certificate"
+
+# PKIX recommendations harmless if included in all certificates.
+subjectKeyIdentifier=hash
+authorityKeyIdentifier=keyid,issuer:always
+
+# This stuff is for subjectAltName and issuerAltname.
+# Import the email address.
+# subjectAltName=email:copy
+
+# Copy subject details
+# issuerAltName=issuer:copy
+
+#nsCaRevocationUrl		= http://www.domain.dom/ca-crl.pem
+#nsBaseUrl
+#nsRevocationUrl
+#nsRenewalUrl
+#nsCaPolicyUrl
+#nsSslServerName
+
+[ server ]
+
+# JY ADDED -- Make a cert with nsCertType set to "server"
+basicConstraints=CA:FALSE
+nsCertType			= server
+nsComment			= "OpenSSL Generated Server Certificate"
+subjectKeyIdentifier=hash
+authorityKeyIdentifier=keyid,issuer:always
+
+[ v3_req ]
+
+# Extensions to add to a certificate request
+
+basicConstraints = CA:FALSE
+keyUsage = nonRepudiation, digitalSignature, keyEncipherment
+
+[ v3_ca ]
+
+
+# Extensions for a typical CA
+
+
+# PKIX recommendation.
+
+subjectKeyIdentifier=hash
+
+authorityKeyIdentifier=keyid:always,issuer:always
+
+# This is what PKIX recommends but some broken software chokes on critical
+# extensions.
+#basicConstraints = critical,CA:true
+# So we do this instead.
+basicConstraints = CA:true
+
+# Key usage: this is typical for a CA certificate. However since it will
+# prevent it being used as an test self-signed certificate it is best
+# left out by default.
+# keyUsage = cRLSign, keyCertSign
+
+# Some might want this also
+# nsCertType = sslCA, emailCA
+
+# Include email address in subject alt name: another PKIX recommendation
+# subjectAltName=email:copy
+# Copy issuer details
+# issuerAltName=issuer:copy
+
+# DER hex encoding of an extension: beware experts only!
+# obj=DER:02:03
+# Where 'obj' is a standard or added object
+# You can even override a supported extension:
+# basicConstraints= critical, DER:30:03:01:01:FF
+
+[ crl_ext ]
+
+# CRL extensions.
+# Only issuerAltName and authorityKeyIdentifier make any sense in a CRL.
+
+# issuerAltName=issuer:copy
+authorityKeyIdentifier=keyid:always,issuer:always
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/openssl-ca.cnf buildroot/package/base-files/files/etc/easy-rsa/openssl-ca.cnf
--- buildroot.orig/package/base-files/files/etc/easy-rsa/openssl-ca.cnf	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/openssl-ca.cnf	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,230 @@
+#
+# OpenSSL example configuration file.
+# This is mostly being used for generation of certificate requests.
+#
+
+# This definition stops the following lines choking if HOME isn't
+# defined.
+HOME			= .
+RANDFILE		= $ENV::HOME/.rnd
+
+# Extra OBJECT IDENTIFIER info:
+#oid_file		= $ENV::HOME/.oid
+oid_section		= new_oids
+
+# To use this configuration file with the "-extfile" option of the
+# "openssl x509" utility, name here the section containing the
+# X.509v3 extensions to use:
+# extensions		= 
+# (Alternatively, use a configuration file that has only
+# X.509v3 extensions in its main [= default] section.)
+
+[ new_oids ]
+
+# We can add new OIDs in here for use by 'ca' and 'req'.
+# Add a simple OID like this:
+# testoid1=1.2.3.4
+# Or use config file substitution like this:
+# testoid2=${testoid1}.5.6
+
+####################################################################
+[ ca ]
+default_ca	= CA_default		# The default ca section
+
+####################################################################
+[ CA_default ]
+
+dir		= $ENV::KEY_DIR		# Where everything is kept
+certs		= $dir			# Where the issued certs are kept
+crl_dir		= $dir			# Where the issued crl are kept
+database	= $dir/index.txt	# database index file.
+new_certs_dir	= $dir			# default place for new certs.
+
+certificate	= $dir/ca.crt	 	# The CA certificate
+serial		= $dir/serial 		# The current serial number
+crl		= $dir/crl.pem 		# The current CRL
+private_key	= $dir/ca.key	 	# The private key
+RANDFILE	= $dir/.rand		# private random number file
+
+x509_extensions	= usr_cert		# The extentions to add to the cert
+
+# Extensions to add to a CRL. Note: Netscape communicator chokes on V2 CRLs
+# so this is commented out by default to leave a V1 CRL.
+# crl_extensions	= crl_ext
+
+default_days	= 7300			# how long to certify for
+default_crl_days= 30			# how long before next CRL
+default_md	= md5			# which md to use.
+preserve	= no			# keep passed DN ordering
+
+# A few difference way of specifying how similar the request should look
+# For type CA, the listed attributes must be the same, and the optional
+# and supplied fields are just that :-)
+policy		= policy_match
+
+# For the CA policy
+[ policy_match ]
+countryName		= match
+stateOrProvinceName	= match
+organizationName	= match
+organizationalUnitName	= optional
+commonName		= supplied
+emailAddress		= optional
+
+# For the 'anything' policy
+# At this point in time, you must list all acceptable 'object'
+# types.
+[ policy_anything ]
+countryName		= optional
+stateOrProvinceName	= optional
+localityName		= optional
+organizationName	= optional
+organizationalUnitName	= optional
+commonName		= supplied
+emailAddress		= optional
+
+####################################################################
+[ req ]
+default_bits		= $ENV::KEY_SIZE
+default_keyfile 	= privkey.pem
+distinguished_name	= req_distinguished_name
+attributes		= req_attributes
+x509_extensions	= v3_ca	# The extentions to add to the self signed cert
+prompt			= no
+# This sets a mask for permitted string types. There are several options. 
+# default: PrintableString, T61String, BMPString.
+# pkix	 : PrintableString, BMPString.
+# utf8only: only UTF8Strings.
+# nombstr : PrintableString, T61String (no BMPStrings or UTF8Strings).
+# MASK:XXXX a literal mask value.
+# WARNING: current versions of Netscape crash on BMPStrings or UTF8Strings
+# so use this option with caution!
+string_mask = nombstr
+
+# req_extensions = v3_req # The extensions to add to a certificate request
+
+[ req_distinguished_name ]
+countryName			= US
+
+stateOrProvinceName		= MD
+
+localityName			= Gaithersburg
+
+0.organizationName		= PacketProtector.org
+
+commonName                      = local.packetprotector.org
+
+emailAddress			= charlie@packetprotector.org
+
+# SET-ex3			= SET extension number 3
+
+[ req_attributes ]
+
+[ usr_cert ]
+
+# These extensions are added when 'ca' signs a request.
+
+# This goes against PKIX guidelines but some CAs do it and some software
+# requires this to avoid interpreting an end user certificate as a CA.
+
+basicConstraints=CA:FALSE
+
+# Here are some examples of the usage of nsCertType. If it is omitted
+# the certificate can be used for anything *except* object signing.
+
+# This is OK for an SSL server.
+# nsCertType			= server
+
+# For an object signing certificate this would be used.
+# nsCertType = objsign
+
+# For normal client use this is typical
+# nsCertType = client, email
+
+# and for everything including object signing:
+# nsCertType = client, email, objsign
+
+# This is typical in keyUsage for a client certificate.
+# keyUsage = nonRepudiation, digitalSignature, keyEncipherment
+
+# This will be displayed in Netscape's comment listbox.
+nsComment			= "OpenSSL Generated Certificate"
+
+# PKIX recommendations harmless if included in all certificates.
+subjectKeyIdentifier=hash
+authorityKeyIdentifier=keyid,issuer:always
+
+# This stuff is for subjectAltName and issuerAltname.
+# Import the email address.
+# subjectAltName=email:copy
+
+# Copy subject details
+# issuerAltName=issuer:copy
+
+#nsCaRevocationUrl		= http://www.domain.dom/ca-crl.pem
+#nsBaseUrl
+#nsRevocationUrl
+#nsRenewalUrl
+#nsCaPolicyUrl
+#nsSslServerName
+
+[ server ]
+
+# JY ADDED -- Make a cert with nsCertType set to "server"
+basicConstraints=CA:FALSE
+nsCertType			= server
+nsComment			= "OpenSSL Generated Server Certificate"
+subjectKeyIdentifier=hash
+authorityKeyIdentifier=keyid,issuer:always
+
+[ v3_req ]
+
+# Extensions to add to a certificate request
+
+basicConstraints = CA:FALSE
+keyUsage = nonRepudiation, digitalSignature, keyEncipherment
+
+[ v3_ca ]
+
+
+# Extensions for a typical CA
+
+
+# PKIX recommendation.
+
+subjectKeyIdentifier=hash
+
+authorityKeyIdentifier=keyid:always,issuer:always
+
+# This is what PKIX recommends but some broken software chokes on critical
+# extensions.
+#basicConstraints = critical,CA:true
+# So we do this instead.
+basicConstraints = CA:true
+
+# Key usage: this is typical for a CA certificate. However since it will
+# prevent it being used as an test self-signed certificate it is best
+# left out by default.
+# keyUsage = cRLSign, keyCertSign
+
+# Some might want this also
+# nsCertType = sslCA, emailCA
+
+# Include email address in subject alt name: another PKIX recommendation
+# subjectAltName=email:copy
+# Copy issuer details
+# issuerAltName=issuer:copy
+
+# DER hex encoding of an extension: beware experts only!
+# obj=DER:02:03
+# Where 'obj' is a standard or added object
+# You can even override a supported extension:
+# basicConstraints= critical, DER:30:03:01:01:FF
+
+[ crl_ext ]
+
+# CRL extensions.
+# Only issuerAltName and authorityKeyIdentifier make any sense in a CRL.
+
+# issuerAltName=issuer:copy
+authorityKeyIdentifier=keyid:always,issuer:always
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/openssl.cnf buildroot/package/base-files/files/etc/easy-rsa/openssl.cnf
--- buildroot.orig/package/base-files/files/etc/easy-rsa/openssl.cnf	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/openssl.cnf	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,255 @@
+#
+# OpenSSL example configuration file.
+# This is mostly being used for generation of certificate requests.
+#
+
+# This definition stops the following lines choking if HOME isn't
+# defined.
+HOME			= .
+RANDFILE		= $ENV::HOME/.rnd
+
+# Extra OBJECT IDENTIFIER info:
+#oid_file		= $ENV::HOME/.oid
+oid_section		= new_oids
+
+# To use this configuration file with the "-extfile" option of the
+# "openssl x509" utility, name here the section containing the
+# X.509v3 extensions to use:
+# extensions		= 
+# (Alternatively, use a configuration file that has only
+# X.509v3 extensions in its main [= default] section.)
+
+[ new_oids ]
+
+# We can add new OIDs in here for use by 'ca' and 'req'.
+# Add a simple OID like this:
+# testoid1=1.2.3.4
+# Or use config file substitution like this:
+# testoid2=${testoid1}.5.6
+
+####################################################################
+[ ca ]
+default_ca	= CA_default		# The default ca section
+
+####################################################################
+[ CA_default ]
+
+dir		= $ENV::KEY_DIR		# Where everything is kept
+certs		= $dir			# Where the issued certs are kept
+crl_dir		= $dir			# Where the issued crl are kept
+database	= $dir/index.txt	# database index file.
+new_certs_dir	= $dir			# default place for new certs.
+
+certificate	= $dir/ca.crt	 	# The CA certificate
+serial		= $dir/serial 		# The current serial number
+crl		= $dir/crl.pem 		# The current CRL
+private_key	= $dir/ca.key	 	# The private key
+RANDFILE	= $dir/.rand		# private random number file
+
+x509_extensions	= usr_cert		# The extentions to add to the cert
+
+# Extensions to add to a CRL. Note: Netscape communicator chokes on V2 CRLs
+# so this is commented out by default to leave a V1 CRL.
+# crl_extensions	= crl_ext
+
+default_days	= 7300			# how long to certify for
+default_crl_days= 30			# how long before next CRL
+default_md	= md5			# which md to use.
+preserve	= no			# keep passed DN ordering
+
+# A few difference way of specifying how similar the request should look
+# For type CA, the listed attributes must be the same, and the optional
+# and supplied fields are just that :-)
+policy		= policy_match
+
+# For the CA policy
+[ policy_match ]
+countryName		= match
+stateOrProvinceName	= match
+organizationName	= match
+organizationalUnitName	= optional
+commonName		= supplied
+emailAddress		= optional
+
+# For the 'anything' policy
+# At this point in time, you must list all acceptable 'object'
+# types.
+[ policy_anything ]
+countryName		= optional
+stateOrProvinceName	= optional
+localityName		= optional
+organizationName	= optional
+organizationalUnitName	= optional
+commonName		= supplied
+emailAddress		= optional
+
+####################################################################
+[ req ]
+default_bits		= $ENV::KEY_SIZE
+default_keyfile 	= privkey.pem
+distinguished_name	= req_distinguished_name
+attributes		= req_attributes
+x509_extensions	= v3_ca	# The extentions to add to the self signed cert
+
+# Passwords for private keys if not present they will be prompted for
+# input_password = secret
+# output_password = secret
+
+# This sets a mask for permitted string types. There are several options. 
+# default: PrintableString, T61String, BMPString.
+# pkix	 : PrintableString, BMPString.
+# utf8only: only UTF8Strings.
+# nombstr : PrintableString, T61String (no BMPStrings or UTF8Strings).
+# MASK:XXXX a literal mask value.
+# WARNING: current versions of Netscape crash on BMPStrings or UTF8Strings
+# so use this option with caution!
+string_mask = nombstr
+
+# req_extensions = v3_req # The extensions to add to a certificate request
+
+[ req_distinguished_name ]
+countryName			= Country Name (2 letter code)
+countryName_default		= $ENV::KEY_COUNTRY
+countryName_min			= 2
+countryName_max			= 2
+
+stateOrProvinceName		= State or Province Name (full name)
+stateOrProvinceName_default	= $ENV::KEY_PROVINCE
+
+localityName			= Locality Name (eg, city)
+localityName_default		= $ENV::KEY_CITY
+
+0.organizationName		= Organization Name (eg, company)
+0.organizationName_default	= $ENV::KEY_ORG
+
+# we can do this but it is not needed normally :-)
+#1.organizationName		= Second Organization Name (eg, company)
+#1.organizationName_default	= World Wide Web Pty Ltd
+
+organizationalUnitName		= Organizational Unit Name (eg, section)
+#organizationalUnitName_default	=
+
+commonName			= Common Name (eg, your name or your server\'s hostname)
+commonName_max			= 64
+
+emailAddress			= Email Address
+emailAddress_default		= $ENV::KEY_EMAIL
+emailAddress_max		= 40
+
+# SET-ex3			= SET extension number 3
+
+[ req_attributes ]
+challengePassword		= A challenge password
+challengePassword_min		= 4
+challengePassword_max		= 20
+
+unstructuredName		= An optional company name
+
+[ usr_cert ]
+
+# These extensions are added when 'ca' signs a request.
+
+# This goes against PKIX guidelines but some CAs do it and some software
+# requires this to avoid interpreting an end user certificate as a CA.
+
+basicConstraints=CA:FALSE
+
+# Here are some examples of the usage of nsCertType. If it is omitted
+# the certificate can be used for anything *except* object signing.
+
+# This is OK for an SSL server.
+# nsCertType			= server
+
+# For an object signing certificate this would be used.
+# nsCertType = objsign
+
+# For normal client use this is typical
+# nsCertType = client, email
+
+# and for everything including object signing:
+# nsCertType = client, email, objsign
+
+# This is typical in keyUsage for a client certificate.
+# keyUsage = nonRepudiation, digitalSignature, keyEncipherment
+
+# This will be displayed in Netscape's comment listbox.
+nsComment			= "OpenSSL Generated Certificate"
+
+# PKIX recommendations harmless if included in all certificates.
+subjectKeyIdentifier=hash
+authorityKeyIdentifier=keyid,issuer:always
+
+# This stuff is for subjectAltName and issuerAltname.
+# Import the email address.
+# subjectAltName=email:copy
+
+# Copy subject details
+# issuerAltName=issuer:copy
+
+#nsCaRevocationUrl		= http://www.domain.dom/ca-crl.pem
+#nsBaseUrl
+#nsRevocationUrl
+#nsRenewalUrl
+#nsCaPolicyUrl
+#nsSslServerName
+
+[ server ]
+
+# JY ADDED -- Make a cert with nsCertType set to "server"
+basicConstraints=CA:FALSE
+nsCertType			= server
+nsComment			= "OpenSSL Generated Server Certificate"
+subjectKeyIdentifier=hash
+authorityKeyIdentifier=keyid,issuer:always
+
+[ v3_req ]
+
+# Extensions to add to a certificate request
+
+basicConstraints = CA:FALSE
+keyUsage = nonRepudiation, digitalSignature, keyEncipherment
+
+[ v3_ca ]
+
+
+# Extensions for a typical CA
+
+
+# PKIX recommendation.
+
+subjectKeyIdentifier=hash
+
+authorityKeyIdentifier=keyid:always,issuer:always
+
+# This is what PKIX recommends but some broken software chokes on critical
+# extensions.
+#basicConstraints = critical,CA:true
+# So we do this instead.
+basicConstraints = CA:true
+
+# Key usage: this is typical for a CA certificate. However since it will
+# prevent it being used as an test self-signed certificate it is best
+# left out by default.
+# keyUsage = cRLSign, keyCertSign
+
+# Some might want this also
+# nsCertType = sslCA, emailCA
+
+# Include email address in subject alt name: another PKIX recommendation
+# subjectAltName=email:copy
+# Copy issuer details
+# issuerAltName=issuer:copy
+
+# DER hex encoding of an extension: beware experts only!
+# obj=DER:02:03
+# Where 'obj' is a standard or added object
+# You can even override a supported extension:
+# basicConstraints= critical, DER:30:03:01:01:FF
+
+[ crl_ext ]
+
+# CRL extensions.
+# Only issuerAltName and authorityKeyIdentifier make any sense in a CRL.
+
+# issuerAltName=issuer:copy
+authorityKeyIdentifier=keyid:always,issuer:always
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/openssl-radius.cnf buildroot/package/base-files/files/etc/easy-rsa/openssl-radius.cnf
--- buildroot.orig/package/base-files/files/etc/easy-rsa/openssl-radius.cnf	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/openssl-radius.cnf	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,230 @@
+#
+# OpenSSL example configuration file.
+# This is mostly being used for generation of certificate requests.
+#
+
+# This definition stops the following lines choking if HOME isn't
+# defined.
+HOME			= .
+RANDFILE		= $ENV::HOME/.rnd
+
+# Extra OBJECT IDENTIFIER info:
+#oid_file		= $ENV::HOME/.oid
+oid_section		= new_oids
+
+# To use this configuration file with the "-extfile" option of the
+# "openssl x509" utility, name here the section containing the
+# X.509v3 extensions to use:
+# extensions		= 
+# (Alternatively, use a configuration file that has only
+# X.509v3 extensions in its main [= default] section.)
+
+[ new_oids ]
+
+# We can add new OIDs in here for use by 'ca' and 'req'.
+# Add a simple OID like this:
+# testoid1=1.2.3.4
+# Or use config file substitution like this:
+# testoid2=${testoid1}.5.6
+
+####################################################################
+[ ca ]
+default_ca	= CA_default		# The default ca section
+
+####################################################################
+[ CA_default ]
+
+dir		= $ENV::KEY_DIR		# Where everything is kept
+certs		= $dir			# Where the issued certs are kept
+crl_dir		= $dir			# Where the issued crl are kept
+database	= $dir/index.txt	# database index file.
+new_certs_dir	= $dir			# default place for new certs.
+
+certificate	= $dir/ca.crt	 	# The CA certificate
+serial		= $dir/serial 		# The current serial number
+crl		= $dir/crl.pem 		# The current CRL
+private_key	= $dir/ca.key	 	# The private key
+RANDFILE	= $dir/.rand		# private random number file
+
+x509_extensions	= usr_cert		# The extentions to add to the cert
+
+# Extensions to add to a CRL. Note: Netscape communicator chokes on V2 CRLs
+# so this is commented out by default to leave a V1 CRL.
+# crl_extensions	= crl_ext
+
+default_days	= 7300			# how long to certify for
+default_crl_days= 30			# how long before next CRL
+default_md	= md5			# which md to use.
+preserve	= no			# keep passed DN ordering
+
+# A few difference way of specifying how similar the request should look
+# For type CA, the listed attributes must be the same, and the optional
+# and supplied fields are just that :-)
+policy		= policy_match
+
+# For the CA policy
+[ policy_match ]
+countryName		= match
+stateOrProvinceName	= match
+organizationName	= match
+organizationalUnitName	= optional
+commonName		= supplied
+emailAddress		= optional
+
+# For the 'anything' policy
+# At this point in time, you must list all acceptable 'object'
+# types.
+[ policy_anything ]
+countryName		= optional
+stateOrProvinceName	= optional
+localityName		= optional
+organizationName	= optional
+organizationalUnitName	= optional
+commonName		= supplied
+emailAddress		= optional
+
+####################################################################
+[ req ]
+default_bits		= $ENV::KEY_SIZE
+default_keyfile 	= privkey.pem
+distinguished_name	= req_distinguished_name
+attributes		= req_attributes
+x509_extensions	= v3_ca	# The extentions to add to the self signed cert
+prompt			= no
+# This sets a mask for permitted string types. There are several options. 
+# default: PrintableString, T61String, BMPString.
+# pkix	 : PrintableString, BMPString.
+# utf8only: only UTF8Strings.
+# nombstr : PrintableString, T61String (no BMPStrings or UTF8Strings).
+# MASK:XXXX a literal mask value.
+# WARNING: current versions of Netscape crash on BMPStrings or UTF8Strings
+# so use this option with caution!
+string_mask = nombstr
+
+# req_extensions = v3_req # The extensions to add to a certificate request
+
+[ req_distinguished_name ]
+countryName			= US
+
+stateOrProvinceName		= MD
+
+localityName			= Gaithersburg
+
+0.organizationName		= PacketProtector.org
+
+commonName                      = radius.packetprotector.org 
+
+emailAddress			= charlie@packetprotector.org
+
+# SET-ex3			= SET extension number 3
+
+[ req_attributes ]
+
+[ usr_cert ]
+
+# These extensions are added when 'ca' signs a request.
+
+# This goes against PKIX guidelines but some CAs do it and some software
+# requires this to avoid interpreting an end user certificate as a CA.
+
+basicConstraints=CA:FALSE
+
+# Here are some examples of the usage of nsCertType. If it is omitted
+# the certificate can be used for anything *except* object signing.
+
+# This is OK for an SSL server.
+# nsCertType			= server
+
+# For an object signing certificate this would be used.
+# nsCertType = objsign
+
+# For normal client use this is typical
+# nsCertType = client, email
+
+# and for everything including object signing:
+# nsCertType = client, email, objsign
+
+# This is typical in keyUsage for a client certificate.
+# keyUsage = nonRepudiation, digitalSignature, keyEncipherment
+
+# This will be displayed in Netscape's comment listbox.
+nsComment			= "OpenSSL Generated Certificate"
+
+# PKIX recommendations harmless if included in all certificates.
+subjectKeyIdentifier=hash
+authorityKeyIdentifier=keyid,issuer:always
+
+# This stuff is for subjectAltName and issuerAltname.
+# Import the email address.
+# subjectAltName=email:copy
+
+# Copy subject details
+# issuerAltName=issuer:copy
+
+#nsCaRevocationUrl		= http://www.domain.dom/ca-crl.pem
+#nsBaseUrl
+#nsRevocationUrl
+#nsRenewalUrl
+#nsCaPolicyUrl
+#nsSslServerName
+
+[ server ]
+
+# JY ADDED -- Make a cert with nsCertType set to "server"
+basicConstraints=CA:FALSE
+nsCertType			= server
+nsComment			= "OpenSSL Generated Server Certificate"
+subjectKeyIdentifier=hash
+authorityKeyIdentifier=keyid,issuer:always
+
+[ v3_req ]
+
+# Extensions to add to a certificate request
+
+basicConstraints = CA:FALSE
+keyUsage = nonRepudiation, digitalSignature, keyEncipherment
+
+[ v3_ca ]
+
+
+# Extensions for a typical CA
+
+
+# PKIX recommendation.
+
+subjectKeyIdentifier=hash
+
+authorityKeyIdentifier=keyid:always,issuer:always
+
+# This is what PKIX recommends but some broken software chokes on critical
+# extensions.
+#basicConstraints = critical,CA:true
+# So we do this instead.
+basicConstraints = CA:true
+
+# Key usage: this is typical for a CA certificate. However since it will
+# prevent it being used as an test self-signed certificate it is best
+# left out by default.
+# keyUsage = cRLSign, keyCertSign
+
+# Some might want this also
+# nsCertType = sslCA, emailCA
+
+# Include email address in subject alt name: another PKIX recommendation
+# subjectAltName=email:copy
+# Copy issuer details
+# issuerAltName=issuer:copy
+
+# DER hex encoding of an extension: beware experts only!
+# obj=DER:02:03
+# Where 'obj' is a standard or added object
+# You can even override a supported extension:
+# basicConstraints= critical, DER:30:03:01:01:FF
+
+[ crl_ext ]
+
+# CRL extensions.
+# Only issuerAltName and authorityKeyIdentifier make any sense in a CRL.
+
+# issuerAltName=issuer:copy
+authorityKeyIdentifier=keyid:always,issuer:always
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/openssl-revoked.cnf buildroot/package/base-files/files/etc/easy-rsa/openssl-revoked.cnf
--- buildroot.orig/package/base-files/files/etc/easy-rsa/openssl-revoked.cnf	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/openssl-revoked.cnf	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,233 @@
+#
+# OpenSSL example configuration file.
+# This is mostly being used for generation of certificate requests.
+#
+
+# This definition stops the following lines choking if HOME isn't
+# defined.
+HOME			= .
+RANDFILE		= $ENV::HOME/.rnd
+
+# Extra OBJECT IDENTIFIER info:
+#oid_file		= $ENV::HOME/.oid
+oid_section		= new_oids
+
+# To use this configuration file with the "-extfile" option of the
+# "openssl x509" utility, name here the section containing the
+# X.509v3 extensions to use:
+# extensions		= 
+# (Alternatively, use a configuration file that has only
+# X.509v3 extensions in its main [= default] section.)
+
+[ new_oids ]
+
+# We can add new OIDs in here for use by 'ca' and 'req'.
+# Add a simple OID like this:
+# testoid1=1.2.3.4
+# Or use config file substitution like this:
+# testoid2=${testoid1}.5.6
+
+####################################################################
+[ ca ]
+default_ca	= CA_default		# The default ca section
+
+####################################################################
+[ CA_default ]
+
+dir		= $ENV::KEY_DIR		# Where everything is kept
+certs		= $dir			# Where the issued certs are kept
+crl_dir		= $dir			# Where the issued crl are kept
+database	= $dir/index.txt	# database index file.
+new_certs_dir	= $dir			# default place for new certs.
+
+certificate	= $dir/ca.crt	 	# The CA certificate
+serial		= $dir/serial 		# The current serial number
+crl		= $dir/crl.pem 		# The current CRL
+private_key	= $dir/ca.key	 	# The private key
+RANDFILE	= $dir/.rand		# private random number file
+
+x509_extensions	= usr_cert		# The extentions to add to the cert
+
+# Extensions to add to a CRL. Note: Netscape communicator chokes on V2 CRLs
+# so this is commented out by default to leave a V1 CRL.
+# crl_extensions	= crl_ext
+
+default_days	= 7300			# how long to certify for
+default_crl_days= 30			# how long before next CRL
+default_md	= md5			# which md to use.
+preserve	= no			# keep passed DN ordering
+
+# A few difference way of specifying how similar the request should look
+# For type CA, the listed attributes must be the same, and the optional
+# and supplied fields are just that :-)
+policy		= policy_match
+
+# For the CA policy
+[ policy_match ]
+countryName		= match
+stateOrProvinceName	= match
+organizationName	= match
+organizationalUnitName	= optional
+commonName		= supplied
+emailAddress		= optional
+
+# For the 'anything' policy
+# At this point in time, you must list all acceptable 'object'
+# types.
+[ policy_anything ]
+countryName		= optional
+stateOrProvinceName	= optional
+localityName		= optional
+organizationName	= optional
+organizationalUnitName	= optional
+commonName		= supplied
+emailAddress		= optional
+
+####################################################################
+[ req ]
+default_bits		= $ENV::KEY_SIZE
+default_keyfile 	= privkey.pem
+distinguished_name	= req_distinguished_name
+attributes		= req_attributes
+x509_extensions	= v3_ca	# The extentions to add to the self signed cert
+prompt			= no
+input_password		= test
+output_password		= test
+
+# This sets a mask for permitted string types. There are several options. 
+# default: PrintableString, T61String, BMPString.
+# pkix	 : PrintableString, BMPString.
+# utf8only: only UTF8Strings.
+# nombstr : PrintableString, T61String (no BMPStrings or UTF8Strings).
+# MASK:XXXX a literal mask value.
+# WARNING: current versions of Netscape crash on BMPStrings or UTF8Strings
+# so use this option with caution!
+string_mask = nombstr
+
+# req_extensions = v3_req # The extensions to add to a certificate request
+
+[ req_distinguished_name ]
+countryName			= US
+
+stateOrProvinceName		= MD
+
+localityName			= Gaithersburg
+
+0.organizationName		= PacketProtector.org
+
+commonName                      = examplerevokedcert
+
+emailAddress			= charlie@packetprotector.org
+
+# SET-ex3			= SET extension number 3
+
+[ req_attributes ]
+
+[ usr_cert ]
+
+# These extensions are added when 'ca' signs a request.
+
+# This goes against PKIX guidelines but some CAs do it and some software
+# requires this to avoid interpreting an end user certificate as a CA.
+
+basicConstraints=CA:FALSE
+
+# Here are some examples of the usage of nsCertType. If it is omitted
+# the certificate can be used for anything *except* object signing.
+
+# This is OK for an SSL server.
+# nsCertType			= server
+
+# For an object signing certificate this would be used.
+# nsCertType = objsign
+
+# For normal client use this is typical
+# nsCertType = client, email
+
+# and for everything including object signing:
+# nsCertType = client, email, objsign
+
+# This is typical in keyUsage for a client certificate.
+# keyUsage = nonRepudiation, digitalSignature, keyEncipherment
+
+# This will be displayed in Netscape's comment listbox.
+nsComment			= "OpenSSL Generated Certificate"
+
+# PKIX recommendations harmless if included in all certificates.
+subjectKeyIdentifier=hash
+authorityKeyIdentifier=keyid,issuer:always
+
+# This stuff is for subjectAltName and issuerAltname.
+# Import the email address.
+# subjectAltName=email:copy
+
+# Copy subject details
+# issuerAltName=issuer:copy
+
+#nsCaRevocationUrl		= http://www.domain.dom/ca-crl.pem
+#nsBaseUrl
+#nsRevocationUrl
+#nsRenewalUrl
+#nsCaPolicyUrl
+#nsSslServerName
+
+[ server ]
+
+# JY ADDED -- Make a cert with nsCertType set to "server"
+basicConstraints=CA:FALSE
+nsCertType			= server
+nsComment			= "OpenSSL Generated Server Certificate"
+subjectKeyIdentifier=hash
+authorityKeyIdentifier=keyid,issuer:always
+
+[ v3_req ]
+
+# Extensions to add to a certificate request
+
+basicConstraints = CA:FALSE
+keyUsage = nonRepudiation, digitalSignature, keyEncipherment
+
+[ v3_ca ]
+
+
+# Extensions for a typical CA
+
+
+# PKIX recommendation.
+
+subjectKeyIdentifier=hash
+
+authorityKeyIdentifier=keyid:always,issuer:always
+
+# This is what PKIX recommends but some broken software chokes on critical
+# extensions.
+#basicConstraints = critical,CA:true
+# So we do this instead.
+basicConstraints = CA:true
+
+# Key usage: this is typical for a CA certificate. However since it will
+# prevent it being used as an test self-signed certificate it is best
+# left out by default.
+# keyUsage = cRLSign, keyCertSign
+
+# Some might want this also
+# nsCertType = sslCA, emailCA
+
+# Include email address in subject alt name: another PKIX recommendation
+# subjectAltName=email:copy
+# Copy issuer details
+# issuerAltName=issuer:copy
+
+# DER hex encoding of an extension: beware experts only!
+# obj=DER:02:03
+# Where 'obj' is a standard or added object
+# You can even override a supported extension:
+# basicConstraints= critical, DER:30:03:01:01:FF
+
+[ crl_ext ]
+
+# CRL extensions.
+# Only issuerAltName and authorityKeyIdentifier make any sense in a CRL.
+
+# issuerAltName=issuer:copy
+authorityKeyIdentifier=keyid:always,issuer:always
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/openssl-server.cnf buildroot/package/base-files/files/etc/easy-rsa/openssl-server.cnf
--- buildroot.orig/package/base-files/files/etc/easy-rsa/openssl-server.cnf	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/openssl-server.cnf	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,230 @@
+#
+# OpenSSL example configuration file.
+# This is mostly being used for generation of certificate requests.
+#
+
+# This definition stops the following lines choking if HOME isn't
+# defined.
+HOME			= .
+RANDFILE		= $ENV::HOME/.rnd
+
+# Extra OBJECT IDENTIFIER info:
+#oid_file		= $ENV::HOME/.oid
+oid_section		= new_oids
+
+# To use this configuration file with the "-extfile" option of the
+# "openssl x509" utility, name here the section containing the
+# X.509v3 extensions to use:
+# extensions		= 
+# (Alternatively, use a configuration file that has only
+# X.509v3 extensions in its main [= default] section.)
+
+[ new_oids ]
+
+# We can add new OIDs in here for use by 'ca' and 'req'.
+# Add a simple OID like this:
+# testoid1=1.2.3.4
+# Or use config file substitution like this:
+# testoid2=${testoid1}.5.6
+
+####################################################################
+[ ca ]
+default_ca	= CA_default		# The default ca section
+
+####################################################################
+[ CA_default ]
+
+dir		= $ENV::KEY_DIR		# Where everything is kept
+certs		= $dir			# Where the issued certs are kept
+crl_dir		= $dir			# Where the issued crl are kept
+database	= $dir/index.txt	# database index file.
+new_certs_dir	= $dir			# default place for new certs.
+
+certificate	= $dir/ca.crt	 	# The CA certificate
+serial		= $dir/serial 		# The current serial number
+crl		= $dir/crl.pem 		# The current CRL
+private_key	= $dir/ca.key	 	# The private key
+RANDFILE	= $dir/.rand		# private random number file
+
+x509_extensions	= usr_cert		# The extentions to add to the cert
+
+# Extensions to add to a CRL. Note: Netscape communicator chokes on V2 CRLs
+# so this is commented out by default to leave a V1 CRL.
+# crl_extensions	= crl_ext
+
+default_days	= 7300			# how long to certify for
+default_crl_days= 30			# how long before next CRL
+default_md	= md5			# which md to use.
+preserve	= no			# keep passed DN ordering
+
+# A few difference way of specifying how similar the request should look
+# For type CA, the listed attributes must be the same, and the optional
+# and supplied fields are just that :-)
+policy		= policy_match
+
+# For the CA policy
+[ policy_match ]
+countryName		= match
+stateOrProvinceName	= match
+organizationName	= match
+organizationalUnitName	= optional
+commonName		= supplied
+emailAddress		= optional
+
+# For the 'anything' policy
+# At this point in time, you must list all acceptable 'object'
+# types.
+[ policy_anything ]
+countryName		= optional
+stateOrProvinceName	= optional
+localityName		= optional
+organizationName	= optional
+organizationalUnitName	= optional
+commonName		= supplied
+emailAddress		= optional
+
+####################################################################
+[ req ]
+default_bits		= $ENV::KEY_SIZE
+default_keyfile 	= privkey.pem
+distinguished_name	= req_distinguished_name
+attributes		= req_attributes
+x509_extensions	= v3_ca	# The extentions to add to the self signed cert
+prompt			= no
+# This sets a mask for permitted string types. There are several options. 
+# default: PrintableString, T61String, BMPString.
+# pkix	 : PrintableString, BMPString.
+# utf8only: only UTF8Strings.
+# nombstr : PrintableString, T61String (no BMPStrings or UTF8Strings).
+# MASK:XXXX a literal mask value.
+# WARNING: current versions of Netscape crash on BMPStrings or UTF8Strings
+# so use this option with caution!
+string_mask = nombstr
+
+# req_extensions = v3_req # The extensions to add to a certificate request
+
+[ req_distinguished_name ]
+countryName			= US
+
+stateOrProvinceName		= MD
+
+localityName			= Gaithersburg
+
+0.organizationName		= PacketProtector.org
+
+commonName                      = local.packetprotector.org 
+
+emailAddress			= charlie@packetprotector.org
+
+# SET-ex3			= SET extension number 3
+
+[ req_attributes ]
+
+[ usr_cert ]
+
+# These extensions are added when 'ca' signs a request.
+
+# This goes against PKIX guidelines but some CAs do it and some software
+# requires this to avoid interpreting an end user certificate as a CA.
+
+basicConstraints=CA:FALSE
+
+# Here are some examples of the usage of nsCertType. If it is omitted
+# the certificate can be used for anything *except* object signing.
+
+# This is OK for an SSL server.
+# nsCertType			= server
+
+# For an object signing certificate this would be used.
+# nsCertType = objsign
+
+# For normal client use this is typical
+# nsCertType = client, email
+
+# and for everything including object signing:
+# nsCertType = client, email, objsign
+
+# This is typical in keyUsage for a client certificate.
+# keyUsage = nonRepudiation, digitalSignature, keyEncipherment
+
+# This will be displayed in Netscape's comment listbox.
+nsComment			= "OpenSSL Generated Certificate"
+
+# PKIX recommendations harmless if included in all certificates.
+subjectKeyIdentifier=hash
+authorityKeyIdentifier=keyid,issuer:always
+
+# This stuff is for subjectAltName and issuerAltname.
+# Import the email address.
+# subjectAltName=email:copy
+
+# Copy subject details
+# issuerAltName=issuer:copy
+
+#nsCaRevocationUrl		= http://www.domain.dom/ca-crl.pem
+#nsBaseUrl
+#nsRevocationUrl
+#nsRenewalUrl
+#nsCaPolicyUrl
+#nsSslServerName
+
+[ server ]
+
+# JY ADDED -- Make a cert with nsCertType set to "server"
+basicConstraints=CA:FALSE
+nsCertType			= server
+nsComment			= "OpenSSL Generated Server Certificate"
+subjectKeyIdentifier=hash
+authorityKeyIdentifier=keyid,issuer:always
+
+[ v3_req ]
+
+# Extensions to add to a certificate request
+
+basicConstraints = CA:FALSE
+keyUsage = nonRepudiation, digitalSignature, keyEncipherment
+
+[ v3_ca ]
+
+
+# Extensions for a typical CA
+
+
+# PKIX recommendation.
+
+subjectKeyIdentifier=hash
+
+authorityKeyIdentifier=keyid:always,issuer:always
+
+# This is what PKIX recommends but some broken software chokes on critical
+# extensions.
+#basicConstraints = critical,CA:true
+# So we do this instead.
+basicConstraints = CA:true
+
+# Key usage: this is typical for a CA certificate. However since it will
+# prevent it being used as an test self-signed certificate it is best
+# left out by default.
+# keyUsage = cRLSign, keyCertSign
+
+# Some might want this also
+# nsCertType = sslCA, emailCA
+
+# Include email address in subject alt name: another PKIX recommendation
+# subjectAltName=email:copy
+# Copy issuer details
+# issuerAltName=issuer:copy
+
+# DER hex encoding of an extension: beware experts only!
+# obj=DER:02:03
+# Where 'obj' is a standard or added object
+# You can even override a supported extension:
+# basicConstraints= critical, DER:30:03:01:01:FF
+
+[ crl_ext ]
+
+# CRL extensions.
+# Only issuerAltName and authorityKeyIdentifier make any sense in a CRL.
+
+# issuerAltName=issuer:copy
+authorityKeyIdentifier=keyid:always,issuer:always
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/README buildroot/package/base-files/files/etc/easy-rsa/README
--- buildroot.orig/package/base-files/files/etc/easy-rsa/README	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/README	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,161 @@
+This is a small RSA key management package,
+based on the openssl command line tool, that
+can be found in the easy-rsa subdirectory
+of the OpenVPN distribution.
+
+These are reference notes.  For step
+by step instructions, see the HOWTO:
+
+http://openvpn.net/howto.html
+
+INSTALL
+
+1. Edit vars.
+2. Set KEY_CONFIG to point to the openssl.cnf file
+   included in this distribution.
+3. Set KEY_DIR to point to a directory which will
+   contain all keys, certificates, etc.  This
+   directory need not exist, and if it does,
+   it will be deleted with rm -rf, so BE
+   CAREFUL how you set KEY_DIR.
+4. (Optional) Edit other fields in vars
+   per your site data.  You may want to
+   increase KEY_SIZE to 2048 if you are
+   paranoid and don't mind slower key
+   processing, but certainly 1024 is
+   fine for testing purposes.  KEY_SIZE
+   must be compatible across both peers
+   participating in a secure SSL/TLS
+   connection.
+5  . vars
+6. ./clean-all
+7. As you create certificates, keys, and
+   certificate signing requests, understand that
+   only .key files should be kept confidential.
+   .crt and .csr files can be sent over insecure
+   channels such as plaintext email.
+8. You should never need to copy a .key file
+   between computers.  Normally each computer
+   will have its own certificate/key pair.
+
+BUILD YOUR OWN ROOT CERTIFICATE AUTHORITY (CA) CERTIFICATE/KEY
+
+1. ./build-ca
+2. ca.crt and ca.key will be built in your KEY_DIR
+   directory
+
+BUILD AN INTERMEDIATE CERTIFICATE AUTHORITY CERTIFICATE/KEY (optional)
+
+1. ./build-inter inter
+2. inter.crt and inter.key will be built in your KEY_DIR
+   directory and signed with your root certificate.
+
+BUILD DIFFIE-HELLMAN PARAMETERS (necessary for
+the server end of a SSL/TLS connection).
+
+1. ./build-dh
+
+BUILD A CERTIFICATE SIGNING REQUEST (If
+you want to sign your certificate with a root
+certificate controlled by another individual
+or organization, or residing on a different machine).
+
+1. Get ca.crt (the root certificate) from your
+   certificate authority.  Though this
+   transfer can be over an insecure channel, to prevent
+   man-in-the-middle attacks you must confirm that
+   ca.crt was not tampered with.  Large CAs solve this
+   problem by hardwiring their root certificates into
+   popular web browsers.  A simple way to verify a root
+   CA is to call the issuer on the telephone and confirm
+   that the md5sum or sha1sum signatures on the ca.crt
+   files match (such as with the command: "md5sum ca.crt").
+2. Choose a name for your certificate such as your computer
+   name.  In our example we will use "mycert".
+3. ./build-req mycert
+4. You can ignore most of the fields, but set
+   "Common Name" to something unique such as your
+   computer's host name.  Leave all password
+   fields blank, unless you want your private key
+   to be protected by password.  Using a password
+   is not required -- it will make your key more secure
+   but also more inconvenient to use, because you will
+   need to supply your password anytime the key is used.
+   NOTE: if you are using a password, use ./build-req-pass
+   instead of ./build-req
+5. Your key will be written to $KEY_DIR/mycert.key
+6. Your certificate signing request will be written to
+   to $KEY_DIR/mycert.csr
+7. Email mycert.csr to the individual or organization
+   which controls the root certificate.  This can be
+   done over an insecure channel.
+8. After the .csr file is signed by the root certificate
+   authority, you will receive a file mycert.crt
+   (your certificate).  Place mycert.crt in your
+   KEY_DIR directory.
+9. The combined files of mycert.crt, mycert.key,
+   and ca.crt can now be used to secure one end of
+   an SSL/TLS connection.
+
+SIGN A CERTIFICATE SIGNING REQUEST
+
+1. ./sign-req mycert
+2. mycert.crt will be built in your KEY_DIR
+   directory using mycert.csr and your root CA
+   file as input.
+
+BUILD AND SIGN A CERTIFICATE SIGNING REQUEST
+USING A LOCALLY INSTALLED ROOT CERTIFICATE/KEY -- this
+script generates and signs a certificate in one step,
+but it requires that the generated certificate and private
+key files be copied to the destination host over a
+secure channel.
+
+1. ./build-key mycert (no password protection)
+2. OR ./build-key-pass mycert (with password protection)
+3. OR ./build-key-pkcs12 mycert (PKCS #12 format)
+4. OR ./build-key-server mycert (with nsCertType=server)
+5. mycert.crt and mycert.key will be built in your
+   KEY_DIR directory, and mycert.crt will be signed
+   by your root CA. If ./build-key-pkcs12 was used a
+   mycert.p12 file will also be created including the
+   private key, certificate and the ca certificate.
+
+IMPORTANT
+
+To avoid a possible Man-in-the-Middle attack where an authorized
+client tries to connect to another client by impersonating the
+server, make sure to enforce some kind of server certificate
+verification by clients.  There are currently four different ways
+of accomplishing this, listed in the order of preference:
+
+(1) Build your server certificates with the build-key-server
+    script.  This will designate the certificate as a
+    server-only certificate by setting nsCertType=server.
+    Now add the following line to your client configuration:
+      
+    ns-cert-type server
+
+    This will block clients from connecting to any
+    server which lacks the nsCertType=server designation
+    in its certificate, even if the certificate has been
+    signed by the CA which is cited in the OpenVPN configuration
+    file (--ca directive).
+
+(2) Use the --tls-remote directive on the client to
+    accept/reject the server connection based on the common
+    name of the server certificate.
+
+(3) Use a --tls-verify script or plugin to accept/reject the
+    server connection based on a custom test of the server
+    certificate's embedded X509 subject details.
+
+(4) Sign server certificates with one CA and client certificates
+    with a different CA.  The client config "ca" directive should
+    reference the server-signing CA while the server config "ca"
+    directive should reference the client-signing CA.
+
+NOTES
+
+Show certificate fields:
+  openssl x509 -in cert.crt -text
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/revoke-crt buildroot/package/base-files/files/etc/easy-rsa/revoke-crt
--- buildroot.orig/package/base-files/files/etc/easy-rsa/revoke-crt	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/revoke-crt	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,18 @@
+#!/bin/sh
+
+#
+# revoke a certificate
+#
+#
+
+if test $# -ne 1; then
+        echo "usage: revoke-crt <file.crt>";
+        exit 1
+fi
+
+if test $KEY_DIR; then
+       cd $KEY_DIR && \
+       openssl ca -revoke $1 -config $KEY_CONFIG
+else
+       echo you must define KEY_DIR
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/revoke-full buildroot/package/base-files/files/etc/easy-rsa/revoke-full
--- buildroot.orig/package/base-files/files/etc/easy-rsa/revoke-full	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/revoke-full	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,29 @@
+#!/bin/sh
+
+# revoke a certificate, regenerate CRL,
+# and verify revocation
+
+CRL=crl.pem
+RT=revoke-test.pem
+
+if test $# -ne 1; then
+        echo "usage: revoke-full <name>";
+        exit 1
+fi
+
+if test $KEY_DIR; then
+       cd $KEY_DIR
+       rm -f $RT
+
+       # revoke key and generate a new CRL
+       openssl ca -revoke $1.crt -config $KEY_CONFIG
+
+       # generate a new CRL
+       openssl ca -gencrl -out $CRL -config $KEY_CONFIG
+       cat ca.crt $CRL >$RT
+    
+       # verify the revocation
+       openssl verify -CAfile $RT -crl_check $1.crt
+else
+       echo you must define KEY_DIR
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/sign-req buildroot/package/base-files/files/etc/easy-rsa/sign-req
--- buildroot.orig/package/base-files/files/etc/easy-rsa/sign-req	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/sign-req	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,18 @@
+#!/bin/sh
+
+#
+# Sign a certificate signing request (a .csr file)
+# with a local root certificate and key.
+#
+
+if test $# -ne 1; then
+        echo "usage: sign-req <name>";
+        exit 1
+fi                                                                             
+
+if test $KEY_DIR; then
+	cd $KEY_DIR && \
+	openssl ca -days 3650 -out $1.crt -in $1.csr -config $KEY_CONFIG
+else
+	echo you must define KEY_DIR
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/vars buildroot/package/base-files/files/etc/easy-rsa/vars
--- buildroot.orig/package/base-files/files/etc/easy-rsa/vars	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/vars	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,49 @@
+# easy-rsa parameter settings
+
+# NOTE: If you installed from an RPM,
+# don't edit this file in place in
+# /usr/share/openvpn/easy-rsa --
+# instead, you should copy the whole
+# easy-rsa directory to another location
+# (such as /etc/openvpn) so that your
+# edits will not be wiped out by a future
+# OpenVPN package upgrade.
+
+# This variable should point to
+# the top level of the easy-rsa
+# tree.
+export D=`pwd`
+
+# This variable should point to
+# the openssl.cnf file included
+# with easy-rsa.
+export KEY_CONFIG=$D/openssl.cnf
+
+# Edit this variable to point to
+# your soon-to-be-created key
+# directory.
+#
+# WARNING: clean-all will do
+# a rm -rf on this directory
+# so make sure you define
+# it correctly!
+export KEY_DIR=$D/keys
+
+# Issue rm -rf warning
+echo NOTE: when you run ./clean-all, I will be doing a rm -rf on $KEY_DIR
+
+# Increase this to 2048 if you
+# are paranoid.  This will slow
+# down TLS negotiation performance
+# as well as the one-time DH parms
+# generation process.
+export KEY_SIZE=1024
+
+# These are the default values for fields
+# which will be placed in the certificate.
+# Don't leave any of these fields blank.
+export KEY_COUNTRY=US
+export KEY_PROVINCE=MD
+export KEY_CITY="Gaithersburg"
+export KEY_ORG="PacketProtector.org"
+export KEY_EMAIL="charlie@packetprotector.org"
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/easy-rsa/xpextensions buildroot/package/base-files/files/etc/easy-rsa/xpextensions
--- buildroot.orig/package/base-files/files/etc/easy-rsa/xpextensions	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/easy-rsa/xpextensions	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,4 @@
+[ xpclient_ext]
+extendedKeyUsage = 1.3.6.1.5.5.7.3.2
+[ xpserver_ext ]
+extendedKeyUsage = 1.3.6.1.5.5.7.3.1
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/ethers buildroot/package/base-files/files/etc/ethers
--- buildroot.orig/package/base-files/files/etc/ethers	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/ethers	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,2 @@
+# example
+# 11:22:33:44:55:66 192.168.1.2
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/freeradius/users buildroot/package/base-files/files/etc/freeradius/users
--- buildroot.orig/package/base-files/files/etc/freeradius/users	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/freeradius/users	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1 @@
+"root"		Cleartext-Password := "packetprotector"
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/hotplug.d/usb/01-mount buildroot/package/base-files/files/etc/hotplug.d/usb/01-mount
--- buildroot.orig/package/base-files/files/etc/hotplug.d/usb/01-mount	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/hotplug.d/usb/01-mount	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,51 @@
+mount_storage() {
+	cd /dev/discs
+	for dev in disc*; do
+		[ -f /tmp/.${dev}_id ] || {
+			echo ${INTERFACE}${PRODUCT} > /tmp/.${dev}_id
+			mount | grep /mnt/${dev} || (
+				[ -d /mnt/. ] || {
+					mkdir -p /tmp/mnt
+					ln -s /tmp/mnt /
+				}
+				cd $dev
+				for part in part*; do
+					if [ $part != "part*" ] ; then
+						path=/mnt/${dev}_${part##*part}
+						mkdir -p ${path}
+						mount ${part} ${path}
+					fi
+				done
+			)
+		}
+	done
+}
+
+umount_storage() {
+	for tmp in /tmp/.*_id; do
+		id=$(cat $tmp 2>&-)
+		[ "${INTERFACE}${PRODUCT}" = "$id" ] && {
+			rm -f $tmp
+			disc=${tmp##*disc}
+			disc=${disc%%_id}
+			for disc in /mnt/disc${disc}*; do
+				umount -f $disc || umount -l $disc
+			done
+		}
+	done
+}
+
+[ -f /proc/bus/usb/devices ] || mount -t usbfs none /proc/bus/usb
+
+case "$ACTION" in
+	add)
+		case "${INTERFACE%%/*}" in
+			8) mount_storage ;;
+		esac
+	;;
+	remove)
+		case "${INTERFACE%%/*}" in
+			8) umount_storage ;;
+		esac
+	;;
+esac
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/init.d/dns buildroot/package/base-files/files/etc/init.d/dns
--- buildroot.orig/package/base-files/files/etc/init.d/dns	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/init.d/dns	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,13 @@
+#!/bin/sh /etc/rc.common
+
+LANIP=`uci get network.lan.ipaddr`
+HOSTNAME=`uci get system.@system[0].hostname`
+
+start () {
+	sed "1d;2d" /etc/hosts > /tmp/hosts
+	rm /etc/hosts
+	echo "127.0.0.1 localhost $HOSTNAME" > /etc/hosts
+	[ -n "$LANIP" ] && (echo "$LANIP local.packetprotector.org local" >> /etc/hosts)
+	cat /tmp/hosts >> /etc/hosts
+	rm /tmp/hosts
+}
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/init.d/packetprotector buildroot/package/base-files/files/etc/init.d/packetprotector
--- buildroot.orig/package/base-files/files/etc/init.d/packetprotector	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/init.d/packetprotector	2010-09-24 23:07:27.000000000 -0400
@@ -0,0 +1,211 @@
+#!/bin/sh /etc/rc.common
+START=75
+
+CONFIG_FILE="/etc/packetprotector.conf"
+
+start () {
+
+####################
+# check ntpclient
+####################
+
+ash /etc/hotplug.d/iface/20-ntpclient
+
+########################
+# setup USB directory 
+########################
+
+USB_D=/mnt/disc0_1/packetprotector/
+
+# cleanup /packetprotector
+[ -e /packetprotector ] && rm -r /packetprotector
+
+# symlink USB directory to /packetprotector
+if [ -d $USB_D ] ; then
+	chown -R root:root $USB_D
+	ln -s $USB_D /packetprotector
+fi
+
+USB_D=/packetprotector
+
+####################
+# setup swap
+####################
+
+if [ -e /mnt/disc0_1/packetprotector_swap ] ; then
+	echo "Swap file found!"
+else
+	/bin/dd if=/dev/zero of=/mnt/disc0_1/packetprotector_swap bs=1024 count=65536
+	/sbin/mkswap /mnt/disc0_1/packetprotector_swap
+fi
+
+/sbin/swapon /mnt/disc0_1/packetprotector_swap
+
+SWAP_SIZE=`du -sk /mnt/disc0_1/packetprotector_swap | cut -f 1`
+if [ $SWAP_SIZE -ge 65536 ] ; then
+	SWAP_STARTED=1
+else
+	SWAP_STARTED=0
+	echo "Swap file not found or size incorrect (should be at least 65536 KB)."
+fi
+
+####################
+# set version/name
+####################
+
+if [ -d $USB_D ] ; then
+	/sbin/uci set webif.general.firmware_version=`cat /packetprotector/etc/version`
+else
+	/sbin/uci set webif.general.firmware_version=`cat /etc/version`
+fi
+/sbin/uci set webif.general.firmware_name="PacketProtector"
+/sbin/uci commit
+
+####################
+# link /etc/services
+####################
+
+[ -e /etc/services ] && rm -f /etc/services
+if [ -d $USB_D ] ; then
+	ln -s $USB_D/etc/services /etc/services
+fi
+
+####################
+# clean tmp dir
+####################
+
+[ -d $USB_D ] && rm -rf /packetprotector/tmp/*
+
+####################
+# setup opkg.conf
+####################
+
+grep -e "^src" /etc/opkg.conf > /etc/opkg.conf.TEMP
+
+if [ -d $USB_D ] ; then
+	echo "dest packetprotector /packetprotector" >> /etc/opkg.conf.TEMP
+fi
+
+echo "dest root /" >> /etc/opkg.conf.TEMP
+echo "dest ram /tmp" >> /etc/opkg.conf.TEMP
+echo "lists_dir ext /var/opkg-lists" >> /etc/opkg.conf.TEMP
+echo "option overlay_root /overlay" >> /etc/opkg.conf.TEMP
+echo "arch mipsel 100" >> /etc/opkg.conf.TEMP
+
+mv /etc/opkg.conf.TEMP /etc/opkg.conf
+
+####################
+# setup CA
+####################
+
+cd /etc/easy-rsa
+if ([ -s keys/ca.crt ] && [ -s keys/ca.key ] && [ -s keys/server.crt ] && [ -s keys/server.key ]) ; then
+	echo "CA initialized"
+else
+	# start with a random serial number between 10 and 99
+	echo $(($RANDOM % 89 + 10)) > keys/serial
+	touch keys/index.txt
+	. ./vars
+	./build-ca-batch
+	./build-key-server-batch server
+	./build-key-radius-batch radius
+fi	
+
+if [ -s keys/crl.pem ] ; then
+	echo "CRL found"
+else
+	. ./vars
+	cp openssl-revoked.cnf openssl-client.cnf
+	./build-key-pass-batch examplerevokedcert
+	rm openssl-client.cnf
+	./revoke-full examplerevokedcert
+fi
+
+if [ -s keys/dh1024.pem ] ; then
+	echo "dh1024.pem found"
+else
+	. ./vars
+	./build-dh &
+fi	
+
+if [ ! -h /www/ca.crt ] ; then
+	ln -s /etc/easy-rsa/keys/ca.crt /www/ca.crt
+fi
+
+
+####################
+# setup/start webif
+####################
+
+rm /www/index.html
+rm /www/cgi-bin/webif/.categories
+rm /www/cgi-bin/webif/*.sh
+rm -r /www/cgi-bin/webif/login
+rm -r /www/cgi-bin/webif/proxy
+rm -r /www/cgi-bin/webif/vpn
+
+cd /rom/www/cgi-bin/webif
+for i in *.sh; do
+	ln -fs /rom/www/cgi-bin/webif/$i /www/cgi-bin/webif/$i
+done
+
+if [ -d $USB_D/www ] && [ $SWAP_STARTED = 1 ] ; then
+	ln -s $USB_D/www/index.html /www/index.html
+	ln -s $USB_D/www/cgi-bin/webif/.categories /www/cgi-bin/webif/.categories
+
+	mkdir /www/cgi-bin/webif/login
+	mkdir /www/cgi-bin/webif/proxy
+	mkdir /www/cgi-bin/webif/vpn
+	grep -v '^nobody:' /etc/shadow | cut -d: -f1,2 > /www/cgi-bin/webif/login/.htpasswd
+	grep -v '^nobody:' /etc/shadow | cut -d: -f1,2 > /www/cgi-bin/webif/proxy/.htpasswd
+	grep -v '^nobody:' /etc/shadow | cut -d: -f1,2 > /www/cgi-bin/webif/vpn/.htpasswd
+	chmod 600 /www/cgi-bin/webif/login/.htpasswd
+	chmod 600 /www/cgi-bin/webif/proxy/.htpasswd
+	chmod 600 /www/cgi-bin/webif/vpn/.htpasswd
+
+	cd $USB_D/www/cgi-bin/webif
+	for i in *.sh; do
+		ln -fs $USB_D/www/cgi-bin/webif/$i /www/cgi-bin/webif/$i
+	done
+	cd $USB_D/www/cgi-bin/webif/login
+	for i in *.sh; do
+		ln -fs $USB_D/www/cgi-bin/webif/login/$i /www/cgi-bin/webif/login/$i
+	done
+	cd $USB_D/www/cgi-bin/webif/proxy
+	for i in *.sh; do
+		ln -fs $USB_D/www/cgi-bin/webif/proxy/$i /www/cgi-bin/webif/proxy/$i
+	done
+	cd $USB_D/www/cgi-bin/webif/vpn
+	for i in *.sh; do
+		ln -fs $USB_D/www/cgi-bin/webif/vpn/$i /www/cgi-bin/webif/vpn/$i
+	done
+else
+	ln -s /rom/www/index.html /www/index.html
+	ln -s /rom/www/cgi-bin/webif/.categories /www/cgi-bin/webif/.categories
+fi
+
+grep '^root:' /etc/shadow | cut -d: -f1,2 > /www/cgi-bin/webif/.htpasswd
+chmod 600 /www/cgi-bin/webif/.htpasswd
+
+if [ -s /etc/mini_httpd/server.pem ] ; then
+	echo "server.pem found"
+else
+	cd /etc/easy-rsa/keys
+	cat server.crt server.key > /etc/mini_httpd/server.pem
+fi
+
+/usr/sbin/mini_httpd -C /etc/mini_httpd.conf
+
+
+#########################################
+# run /packetprotector/etc/init.d scripts 
+#########################################
+
+if [ -d $USB_D ] && [ $SWAP_STARTED = 1 ] ; then
+
+	for i in `ls /packetprotector/etc/init.d/S*`; do
+		$i
+	done
+
+fi
+}
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/packetprotector.conf buildroot/package/base-files/files/etc/packetprotector.conf
--- buildroot.orig/package/base-files/files/etc/packetprotector.conf	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/packetprotector.conf	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,9 @@
+# no spaces before the equals signs!
+# 1 is enabled; 0 is disabled
+
+dansguardian=1
+dansguardian_cf=0
+dansguardian_av=1
+freeradius=1
+openvpn=1
+snort-inline=1
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/passwd buildroot/package/base-files/files/etc/passwd
--- buildroot.orig/package/base-files/files/etc/passwd	2010-09-24 22:19:20.000000000 -0400
+++ buildroot/package/base-files/files/etc/passwd	2010-09-24 22:25:55.000000000 -0400
@@ -1,3 +1,2 @@
-root:!:0:0:root:/root:/bin/ash
+root:x:0:0:root:/root:/bin/ash
 nobody:*:65534:65534:nobody:/var:/bin/false
-daemon:*:65534:65534:daemon:/var:/bin/false
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/shadow buildroot/package/base-files/files/etc/shadow
--- buildroot.orig/package/base-files/files/etc/shadow	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/shadow	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,3 @@
+root:$1$$3PU5jOpctFwuSGxWSJxAn0:13136:0:99999:7:::
+nobody:*:13136:0:99999:7:::
+
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/sysctl.conf buildroot/package/base-files/files/etc/sysctl.conf
--- buildroot.orig/package/base-files/files/etc/sysctl.conf	2010-09-24 22:19:20.000000000 -0400
+++ buildroot/package/base-files/files/etc/sysctl.conf	2010-09-24 22:25:55.000000000 -0400
@@ -1,6 +1,7 @@
 kernel.panic=3
 net.ipv4.conf.default.arp_ignore=1
 net.ipv4.conf.all.arp_ignore=1
+net.ipv4.conf.all.rp_filter=2
 net.ipv4.ip_forward=1
 net.ipv4.icmp_echo_ignore_broadcasts=1
 net.ipv4.icmp_ignore_bogus_error_responses=1
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/etc/version buildroot/package/base-files/files/etc/version
--- buildroot.orig/package/base-files/files/etc/version	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/etc/version	2010-09-24 22:41:30.000000000 -0400
@@ -0,0 +1 @@
+4.0
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/lib/preinit/10_essential_fs buildroot/package/base-files/files/lib/preinit/10_essential_fs
--- buildroot.orig/package/base-files/files/lib/preinit/10_essential_fs	2010-09-24 22:19:19.000000000 -0400
+++ buildroot/package/base-files/files/lib/preinit/10_essential_fs	2010-09-24 22:25:55.000000000 -0400
@@ -16,7 +16,7 @@
 
 do_mount_tmpfs() {
     calc_tmpfs_size
-    mount tmpfs /tmp -t tmpfs -o size=$pi_size,nosuid,nodev,mode=1777
+    mount tmpfs /tmp -t tmpfs -o size=4m,nosuid,nodev,mode=1777
 }
 
 boot_hook_add preinit_essential do_mount_procfs
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/root/.profile buildroot/package/base-files/files/root/.profile
--- buildroot.orig/package/base-files/files/root/.profile	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/root/.profile	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,17 @@
+#!/bin/sh
+
+#setup environment variables
+export LD_LIBRARY_PATH=/packetprotector/usr/lib:/packetprotector/usr/lib/freeradius
+export PATH=/bin:/sbin:/usr/bin:/usr/sbin:/packetprotector/bin:/packetprotector/sbin:/packetprotector/usr/bin:/packetprotector/usr/sbin
+export CURL_CA_BUNDLE=/packetprotector/usr/sbin/curl-ca-bundle.crt
+
+#check for default password hash
+PASSWORD=`grep root /etc/shadow | cut -d: -f2`
+if [ $PASSWORD = "\$1\$\$3PU5jOpctFwuSGxWSJxAn0" ] ; then
+        echo ""
+        echo "Default password hash found!  Please change your password."
+        echo ""
+	echo "CLI-    pp_passwd (no USB drive required)"
+	echo "webif-  https://local.packetprotector.org/cgi-bin/webif/users.sh"
+	echo ""
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/sbin/diskutils buildroot/package/base-files/files/sbin/diskutils
--- buildroot.orig/package/base-files/files/sbin/diskutils	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/sbin/diskutils	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,24 @@
+#!/bin/sh
+
+if [ "$1" = "-h" ] ; then
+	echo "usage- diskutils"
+	echo "installs fdisk, e2fsprogs, hdparm, and usbutils to /tmp"
+	exit 0
+elif [ "$1" = "--help" ] ; then
+	echo "usage- diskutils"
+	echo "installs fdisk, e2fsprogs, hdparm, and usbutils to /tmp"
+	exit 0
+else
+	opkg update
+	opkg -d ram install fdisk
+	opkg -d ram install e2fsprogs
+	opkg -d ram install hdparm
+	opkg -d ram install usbutils
+	echo ""
+	echo "Done!"
+	echo ""
+	echo "(Optional) Update your path-"
+	echo ""
+	echo "export PATH=\$PATH:/tmp/sbin:/tmp/usr/sbin"
+	echo ""
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/sbin/pp_passwd buildroot/package/base-files/files/sbin/pp_passwd
--- buildroot.orig/package/base-files/files/sbin/pp_passwd	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/base-files/files/sbin/pp_passwd	2010-09-24 22:25:55.000000000 -0400
@@ -0,0 +1,64 @@
+#!/bin/sh
+#requires ash 'read -s' support
+
+if [ "$1" = "-h" ] ; then
+	echo "usage- pp_passwd [optional username]"
+	echo "updates password in /etc/shadow, /etc/freeradius/users, and .htpasswd files"
+	exit 0
+elif [ "$1" = "--help" ] ; then
+	echo "usage- pp_passwd [optional username]"
+	echo "updates password in /etc/shadow, /etc/freeradius/users, and .htpasswd files"
+	exit 0
+else
+	if [ $# = 0 ] ; then	
+		PP_USERNAME=$USER
+	else
+		PP_USERNAME=$1
+	fi
+fi
+
+#check to see if user exists
+grep -e "^$PP_USERNAME:" /etc/passwd > /dev/null
+if [ $? = 0 ] ; then
+	echo "Changing password for $PP_USERNAME"
+else
+	echo "pp_passwd: unknown user $PP_USERNAME"
+	exit 1
+fi
+
+echo -n "New password:"
+read -rs password
+echo -n "Retype password:"
+read -rs confirm
+
+if [ "$password" = "$confirm" ] ; then
+	# update /etc/shadow and /etc/freeradius/users
+	(echo $password; sleep 1; echo $password) | passwd $PP_USERNAME > /dev/null
+	sed -i "s/\"$PP_USERNAME\".*/\"$PP_USERNAME\"		Cleartext-Password := \"$password\"/" /etc/freeradius/users
+	
+	# update .htpasswd in the VPN download directory
+
+	if [ -s /www/$PP_USERNAME/.htpasswd ] ; then
+		sed -i "s/^$PP_USERNAME:.*$//" /www/$PP_USERNAME/.htpasswd
+		grep '^'$PP_USERNAME':' /etc/shadow | cut -d: -f1,2 >> /www/$PP_USERNAME/.htpasswd				
+	fi
+
+        # update .htpasswd in the VPN directory
+
+        if [ -s /www/cgi-bin/webif/vpn/.htpasswd ] ; then
+		sed -i "s/^$PP_USERNAME:.*$//" /www/cgi-bin/webif/vpn/.htpasswd
+		grep '^'$PP_USERNAME':' /etc/shadow | cut -d: -f1,2 >> /www/cgi-bin/webif/vpn/.htpasswd
+	fi
+
+	# update /www/cgi-bin/webif/.htpasswd (root only)
+
+	if [ "$PP_USERNAME" = "root" ] ; then
+		sed -i "s/^$PP_USERNAME:.*$//" /www/cgi-bin/webif/.htpasswd
+		grep '^'$PP_USERNAME':' /etc/shadow | cut -d: -f1,2 >> /www/cgi-bin/webif/.htpasswd
+	fi
+
+	echo "Password for $PP_USERNAME changed by $USER"
+
+else
+	echo "Passwords do not match.  Please try again."
+fi
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/files/usr/lib/common.awk buildroot/package/base-files/files/usr/lib/common.awk
--- buildroot.orig/package/base-files/files/usr/lib/common.awk	2010-09-24 22:19:20.000000000 -0400
+++ buildroot/package/base-files/files/usr/lib/common.awk	2010-09-24 22:25:55.000000000 -0400
@@ -1,5 +1,43 @@
 # Copyright (C) 2006 OpenWrt.org
 
+function portstr(type, str) {
+	gsub(/-/, ":", str)
+	if (type == "src") return " --sport " str
+	else return " --dport " str
+}
+
+function str2ipt(str) {
+	str2data(str)
+	_cmd = ""
+	if (_l["src"] != "") _cmd = _cmd " -s " _l["src"]
+	if (_l["dest"] != "") _cmd = _cmd " -d " _l["dest"]
+	if (_l["proto"] != "") {
+		_cmd = _cmd " -p " _l["proto"]
+	}
+	# scripts need to check for proto="" and emit two rules in that case
+	if ((_l["proto"] == "") || (_l["proto"] == "tcp") || (_l["proto"] == "udp")) {
+		if (_l["sport"] != "") _cmd = _cmd portstr("src", _l["sport"])
+		if (_l["dport"] != "") _cmd = _cmd portstr("dest", _l["dport"])
+	}
+	if (_l["layer7"] != "") {
+		if (insmod_l7 != 1) {
+			print "insmod ipt_layer7 >&- 2>&-"
+			insmod_l7 = 1
+		}
+		_cmd = _cmd " -m layer7 --l7proto " _l["layer7"]
+	}
+	return _cmd
+}
+
+function str2data(str) {
+	delete _l
+	_n = split(str, _o, "[\t ]")
+	for (_i = 1; _i <= _n; _i++) {
+		_n2 = split(_o[_i], _c, "=")
+		if (_n2 == 2) _l[_c[1]] = _c[2]
+	}
+}
+
 function bitcount(c) {
 	c=and(rshift(c, 1),0x55555555)+and(c,0x55555555)
 	c=and(rshift(c, 2),0x33333333)+and(c,0x33333333)
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/base-files/Makefile buildroot/package/base-files/Makefile
--- buildroot.orig/package/base-files/Makefile	2010-09-24 22:19:20.000000000 -0400
+++ buildroot/package/base-files/Makefile	2010-09-24 22:25:55.000000000 -0400
@@ -351,12 +351,6 @@
 			$(CP) $(PLATFORM_SUBDIR)/$(PROFILE)/base-files/* $(1)/; \
 		fi \
 	)
-# Form valid /etc/shadow entries, by copying the user:pw pairs
-# from /etc/passwd, and adding on pw change data
-	$(if $(CONFIG_BUSYBOX_CONFIG_FEATURE_SHADOWPASSWDS), \
-		cut -d ':' -f 1-2 $(1)/etc/passwd > $(1)/etc/shadow; \
-		$(SED) 's/$$$$/:13848:0:99999:7:::/' $(1)/etc/shadow \
-	)
 	$(SED) 's,$$$$R,$(REVISION),g' $(1)/etc/banner
 	mkdir -p $(1)/CONTROL
 	mkdir -p $(1)/dev
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/broadcom-wl/files/lib/wifi/broadcom.sh buildroot/package/broadcom-wl/files/lib/wifi/broadcom.sh
--- buildroot.orig/package/broadcom-wl/files/lib/wifi/broadcom.sh	2010-09-24 22:19:24.000000000 -0400
+++ buildroot/package/broadcom-wl/files/lib/wifi/broadcom.sh	2010-09-24 22:25:55.000000000 -0400
@@ -372,7 +372,7 @@
 	option device   wl${i}
 	option network	lan
 	option mode     ap
-	option ssid     OpenWrt${i#0}
+	option ssid     PacketProtector
 	option encryption none
 
 EOF
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/busybox/files/telnet buildroot/package/busybox/files/telnet
--- buildroot.orig/package/busybox/files/telnet	2010-09-24 22:19:27.000000000 -0400
+++ buildroot/package/busybox/files/telnet	1969-12-31 19:00:00.000000000 -0500
@@ -1,24 +0,0 @@
-#!/bin/sh /etc/rc.common
-# Copyright (C) 2006-2010 OpenWrt.org
-START=50
-
-has_root_pwd() {
-	local pwd=$([ -f "$1" ] && cat "$1")
-	      pwd="${pwd#*root:}"
-	      pwd="${pwd%%:*}"
-
-	test -n "${pwd#!}"
-}
-
-start() {
-	if ( ! has_root_pwd /etc/passwd && ! has_root_pwd /etc/shadow ) || \
-	   ( [ ! -x /usr/sbin/dropbear ] && [ ! -x /usr/sbin/sshd ] );
-	then
-		telnetd -l /bin/login.sh
-	fi
-}
-
-stop() {
-	killall telnetd 2>/dev/null
-}
-
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/busybox/Makefile buildroot/package/busybox/Makefile
--- buildroot.orig/package/busybox/Makefile	2010-09-24 22:19:29.000000000 -0400
+++ buildroot/package/busybox/Makefile	2010-09-24 22:26:57.000000000 -0400
@@ -27,7 +27,6 @@
 init-y :=
 init-$(CONFIG_BUSYBOX_CONFIG_HTTPD) += httpd
 init-$(CONFIG_BUSYBOX_CONFIG_CROND) += cron
-init-$(CONFIG_BUSYBOX_CONFIG_TELNETD) += telnet
 
 define Package/busybox
   SECTION:=base
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/dnsmasq/files/dhcp.conf buildroot/package/dnsmasq/files/dhcp.conf
--- buildroot.orig/package/dnsmasq/files/dhcp.conf	2010-09-24 22:19:21.000000000 -0400
+++ buildroot/package/dnsmasq/files/dhcp.conf	2010-09-24 22:26:57.000000000 -0400
@@ -13,7 +13,7 @@
 	option authoritative	1
 	option readethers	1
 	option leasefile	'/tmp/dhcp.leases'
-	option resolvfile	'/tmp/resolv.conf.auto'
+	option resolvfile	'/tmp/resolv.conf'
 	#list server		'/mycompany.local/1.2.3.4'
 	#option nonwildcard	1
 	#list interface		br-lan
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/dnsmasq/files/dnsmasq.init buildroot/package/dnsmasq/files/dnsmasq.init
--- buildroot.orig/package/dnsmasq/files/dnsmasq.init	2010-09-24 22:19:21.000000000 -0400
+++ buildroot/package/dnsmasq/files/dnsmasq.init	2010-09-24 22:26:57.000000000 -0400
@@ -2,7 +2,7 @@
 # Copyright (C) 2007 OpenWrt.org
 
 START=60
-DNS_SERVERS=""
+DNS_SERVERS="208.67.222.222 208.67.220.220"
 DOMAIN=""
 
 dhcp_calc() {
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/dropbear/Makefile buildroot/package/dropbear/Makefile
--- buildroot.orig/package/dropbear/Makefile	2010-09-24 22:19:23.000000000 -0400
+++ buildroot/package/dropbear/Makefile	2010-09-24 22:26:57.000000000 -0400
@@ -54,7 +54,7 @@
 	--disable-pam \
 	--enable-openpty \
 	--enable-syslog \
-	$(if $(CONFIG_SHADOW_PASSWORDS),,--disable-shadow) \
+	--enable-shadow \
 	--disable-lastlog \
 	--disable-utmp \
 	--disable-utmpx \
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/firewall/files/bin/fw buildroot/package/firewall/files/bin/fw
--- buildroot.orig/package/firewall/files/bin/fw	2010-09-24 22:19:29.000000000 -0400
+++ buildroot/package/firewall/files/bin/fw	1969-12-31 19:00:00.000000000 -0500
@@ -1,49 +0,0 @@
-#!/bin/sh
-FW_LIBDIR=/lib/firewall
-
-. /etc/functions.sh
-. ${FW_LIBDIR}/fw.sh
-
-case "$(type fw)" in
-	*function) ;;
-	*) exit 255;;
-esac
-
-usage() {
-	echo $0 "<command>" "<family>" "<table>" "<chain>" "<target>" "{" "<rules>" "}"
-	exit 0
-}
-
-cmd=$1
-shift
-case "$cmd" in
-	--help|help) usage ;;
-	start|stop|reload|restart)
-		. ${FW_LIBDIR}/core.sh
-		fw_$cmd
-		exit $?
-	;;
-esac
-
-fam=$1
-shift
-case "$fam" in
-	ip)
-		fam=i
-		if [ $# -gt 2 ]; then
-			for p in $(seq 2 $(($# - 1))); do
-				if eval "[ \$$p == '}' ]"; then
-					fam=I
-					break
-				fi
-			done
-		fi ;;
-	ip4) fam=4 ;;
-	ip6) fam=6 ;;
-	arp) fam=a ;;
-	eth) fam=e ;;
-	-*) exec $0 $cmd ${fam##*-} "$@" ;;
-esac
-
-fw "$cmd" "$fam" "$@"
-exit $?
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/firewall/files/firewall.config buildroot/package/firewall/files/firewall.config
--- buildroot.orig/package/firewall/files/firewall.config	2010-09-24 22:19:29.000000000 -0400
+++ buildroot/package/firewall/files/firewall.config	1969-12-31 19:00:00.000000000 -0500
@@ -1,99 +0,0 @@
-config defaults
-	option syn_flood	1
-	option input		ACCEPT
-	option output		ACCEPT 
-	option forward		REJECT
-# Uncomment this line to disable ipv6 rules
-#	option disable_ipv6	1
-
-config zone
-	option name		lan
-	option input	ACCEPT 
-	option output	ACCEPT 
-	option forward	REJECT
-
-config zone
-	option name		wan
-	option input	REJECT
-	option output	ACCEPT 
-	option forward	REJECT
-	option masq		1 
-	option mtu_fix	1
-
-config forwarding 
-	option src      lan
-	option dest     wan
-
-# We need to accept udp packets on port 68,
-# see https://dev.openwrt.org/ticket/4108
-config rule
-	option src		wan
-	option proto		udp
-	option dest_port	68
-	option target		ACCEPT
-	option family	ipv4
-
-#Allow ping
-config rule
-	option src wan
-	option proto icmp
-	option icmp_type echo-request
-	option target ACCEPT
-
-# include a file with users custom iptables rules
-config include
-	option path /etc/firewall.user
-
-
-### EXAMPLE CONFIG SECTIONS
-# do not allow a specific ip to access wan
-#config rule
-#	option src		lan
-#	option src_ip	192.168.45.2
-#	option dest		wan
-#	option proto	tcp
-#	option target	REJECT 
-
-# block a specific mac on wan
-#config rule
-#	option dest		wan
-#	option src_mac	00:11:22:33:44:66
-#	option target	REJECT 
-
-# block incoming ICMP traffic on a zone
-#config rule
-#	option src		lan
-#	option proto	ICMP
-#	option target	DROP
-
-# port redirect port coming in on wan to lan
-#config redirect
-#	option src			wan
-#	option src_dport	80
-#	option dest			lan
-#	option dest_ip		192.168.16.235
-#	option dest_port	80 
-#	option proto		tcp
-
-
-### FULL CONFIG SECTIONS
-#config rule
-#	option src		lan
-#	option src_ip	192.168.45.2
-#	option src_mac	00:11:22:33:44:55
-#	option src_port	80
-#	option dest		wan
-#	option dest_ip	194.25.2.129
-#	option dest_port	120
-#	option proto	tcp
-#	option target	REJECT 
-
-#config redirect
-#	option src		lan
-#	option src_ip	192.168.45.2
-#	option src_mac	00:11:22:33:44:55
-#	option src_port		1024
-#	option src_dport	80
-#	option dest_ip	194.25.2.129
-#	option dest_port	120
-#	option proto	tcp
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/firewall/files/firewall.hotplug buildroot/package/firewall/files/firewall.hotplug
--- buildroot.orig/package/firewall/files/firewall.hotplug	2010-09-24 22:19:29.000000000 -0400
+++ buildroot/package/firewall/files/firewall.hotplug	1969-12-31 19:00:00.000000000 -0500
@@ -1,22 +0,0 @@
-#!/bin/sh
-# This script is executed as part of the hotplug event with
-# HOTPLUG_TYPE=iface, triggered by various scripts when an interface
-# is configured (ACTION=ifup) or deconfigured (ACTION=ifdown).  The
-# interface is available as INTERFACE, the real device as DEVICE.
-
-[ "$DEVICE" == "lo" ] && exit 0
-
-. /etc/functions.sh
-. /lib/firewall/core.sh
-
-fw_init
-fw_is_loaded || exit 0
-
-case "$ACTION" in
-	ifup)
-		fw_configure_interface "$INTERFACE" add "$DEVICE" &
-	;;
-	ifdown)
-		fw_configure_interface "$INTERFACE" del "$DEVICE"
-	;;
-esac
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/firewall/files/firewall.init buildroot/package/firewall/files/firewall.init
--- buildroot.orig/package/firewall/files/firewall.init	2010-09-24 22:19:29.000000000 -0400
+++ buildroot/package/firewall/files/firewall.init	1969-12-31 19:00:00.000000000 -0500
@@ -1,27 +0,0 @@
-#!/bin/sh /etc/rc.common
-# Copyright (C) 2008-2010 OpenWrt.org
-
-START=45
-
-FW_LIBDIR=/lib/firewall
-
-fw() {
-	. $FW_LIBDIR/core.sh
-	fw_$1
-}
-
-start() {
-	fw start
-}
-
-stop() {
-	fw stop
-}
-
-restart() {
-	fw restart
-}
-
-reload() {
-	fw reload
-}
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/firewall/files/firewall.user buildroot/package/firewall/files/firewall.user
--- buildroot.orig/package/firewall/files/firewall.user	2010-09-24 22:19:29.000000000 -0400
+++ buildroot/package/firewall/files/firewall.user	1969-12-31 19:00:00.000000000 -0500
@@ -1,4 +0,0 @@
-# This file is interpreted as shell script.
-# Put your custom iptables rules here, they will
-# be executed with each firewall (re-)start.
-
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/firewall/files/lib/config.sh buildroot/package/firewall/files/lib/config.sh
--- buildroot.orig/package/firewall/files/lib/config.sh	2010-09-24 22:19:29.000000000 -0400
+++ buildroot/package/firewall/files/lib/config.sh	1969-12-31 19:00:00.000000000 -0500
@@ -1,97 +0,0 @@
-# Copyright (C) 2009-2010 OpenWrt.org
-# Copyright (C) 2009 Malte S. Stretz <http://msquadrat.de>
-#
-# This is a temporary file, I hope to have some of this stuff merged into
-# /lib/functions.sh (without the fw_ prefix of course) one day.
-
-fw_config_append() { # <package>
-	CONFIG_APPEND=1 config_load "$@"
-	unset CONFIG_APPEND
-}
-
-fw_config_once() { # <function> <type>
-	local func=$1
-	local type=$2
-	shift 2
-
-	local config=cfg00nil
-	fw_config__once() {
-		config=$1
-	}
-	config_foreach fw_config__once "$type"
-
-	$func $config "$@"
-}
-
-fw_config_get_section() { # <config> <prefix> <type> <name> <default> ...
-	local config=$1
-	local prefix=$2
-	shift 2
-
-	[ -n "$config" ] || return 1
-	[ -n "$prefix" ] && {
-		prefix="${prefix}_"
-		export ${NO_EXPORT:+-n} -- "${prefix}NAME"="${config}"
-		config_get "${prefix}TYPE" "$config" TYPE
-	}
-	
-	[ "$1" == '{' ] && shift
-	while [ $# -ge 3 ]; do
-		local type=$1
-		local name=$2
-		local dflt=$3
-		shift 3
-		# TODO: Move handling of defaults to /lib/functions.sh
-		# and get replace the case block with the following 
-		# two lines:
-		# type=${type#string}
-		# config_get${type:+_${type}} "${prefix}${name}" "$config" "$name" "$dflt" || return
-		case "$type" in
-			string)
-				local tmp
-				config_get tmp "$config" "$name" || return
-				[ -z "$tmp" ] && tmp=$dflt
-				export ${NO_EXPORT:+-n} -- "${prefix}${name}=${tmp}"
-				continue
-			;;
-			boolean)
-				type=bool
-			;;
-		esac;
-		
-		local cmd=${prefix}config_get_${type}
-		type $cmd > /dev/null || {
-			cmd=config_get_${type} 
-		}
-		type $cmd > /dev/null || {
-			echo "config type $type (for $name) not supported" >&2
-			return 1
-		}
-		$cmd "${prefix}${name}" "$config" "$name" "$dflt" || return
-	done
-}
-
-config_get_ipaddr() {
-	local varn=$1
-	local conf=$2
-	local name=$3
-	local dflt=$4
-
-	local addr
-	config_get addr "$conf" "$name" || return
-	[ -n "$addr" ] || addr=$dflt
-
-	local mask=${addr#*/}
-	[ "$mask" != "$addr" ] || mask=
-	addr=${addr%/*}
-
-	local vers=
-	case "$addr" in
-		*:*) vers=6; mask="${mask:-128}" ;;
-		*.*) vers=4; mask="${mask:-32}" ;;
-	esac
-	
-	export ${NO_EXPORT:+-n} -- "${varn}=${addr}"
-	export ${NO_EXPORT:+-n} -- "${varn}_prefixlen=${mask}"
-	export ${NO_EXPORT:+-n} -- "${varn}_version=${vers}"
-}
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/firewall/files/lib/core_forwarding.sh buildroot/package/firewall/files/lib/core_forwarding.sh
--- buildroot.orig/package/firewall/files/lib/core_forwarding.sh	2010-09-24 22:19:29.000000000 -0400
+++ buildroot/package/firewall/files/lib/core_forwarding.sh	1969-12-31 19:00:00.000000000 -0500
@@ -1,44 +0,0 @@
-# Copyright (C) 2009-2010 OpenWrt.org
-
-fw_config_get_forwarding() {
-	[ "${forwarding_NAME}" != "$1" ] || return
-	fw_config_get_section "$1" forwarding { \
-		string _name "$1" \
-		string name "" \
-		string src "" \
-		string dest "" \
-		string family "" \
-	} || return
-	[ -n "$forwarding_name" ] || forwarding_name=$forwarding__name
-}
-
-fw_load_forwarding() {
-	fw_config_get_forwarding "$1"
-
-	fw_callback pre forwarding
-
-	local chain=forward
-	[ -n "$forwarding_src" ] && {
-		chain=zone_${forwarding_src}_forward 
-	}
-
-	local target=ACCEPT
-	[ -n "$forwarding_dest" ] && {
-		target=zone_${forwarding_dest}_ACCEPT
-	}
-
-	local mode
-	fw_get_family_mode mode ${forwarding_family:-x} ${forwarding_dest:-${forwarding_src:--}} i
-
-	fw add $mode f $chain $target ^
-
-	# propagate masq zone flag
-	[ -n "$forwarding_src" ] && list_contains FW_CONNTRACK_ZONES $forwarding_src && {
-		append FW_CONNTRACK_ZONES $forwarding_dest
-	}
-	[ -n "$forwarding_dest" ] && list_contains FW_CONNTRACK_ZONES $forwarding_dest && {
-		append FW_CONNTRACK_ZONES $forwarding_src
-	}
-
-	fw_callback post forwarding
-}
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/firewall/files/lib/core_init.sh buildroot/package/firewall/files/lib/core_init.sh
--- buildroot.orig/package/firewall/files/lib/core_init.sh	2010-09-24 22:19:29.000000000 -0400
+++ buildroot/package/firewall/files/lib/core_init.sh	1969-12-31 19:00:00.000000000 -0500
@@ -1,316 +0,0 @@
-# Copyright (C) 2009-2010 OpenWrt.org
-# Copyright (C) 2008 John Crispin <blogic@openwrt.org>
-
-FW_INITIALIZED=
-
-FW_ZONES=
-FW_ZONES4=
-FW_ZONES6=
-FW_CONNTRACK_ZONES=
-FW_NOTRACK_DISABLED=
-
-FW_DEFAULTS_APPLIED=
-FW_ADD_CUSTOM_CHAINS=
-FW_ACCEPT_REDIRECTS=
-FW_ACCEPT_SRC_ROUTE=
-
-FW_DEFAULT_INPUT_POLICY=REJECT
-FW_DEFAULT_OUTPUT_POLICY=REJECT
-FW_DEFAULT_FORWARD_POLICY=REJECT
-
-FW_DISABLE_IPV4=0
-FW_DISABLE_IPV6=0
-
-
-fw_load_defaults() {
-	fw_config_get_section "$1" defaults { \
-		string input $FW_DEFAULT_INPUT_POLICY \
-		string output $FW_DEFAULT_OUTPUT_POLICY \
-		string forward $FW_DEFAULT_FORWARD_POLICY \
-		boolean drop_invalid 0 \
-		boolean syn_flood 0 \
-		boolean synflood_protect 0 \
-		string synflood_rate 25 \
-		string synflood_burst 50 \
-		boolean tcp_syncookies 1 \
-		boolean tcp_ecn 0 \
-		boolean tcp_westwood 0 \
-		boolean tcp_window_scaling 1 \
-		boolean accept_redirects 0 \
-		boolean accept_source_route 0 \
-		boolean custom_chains 1 \
-		boolean disable_ipv6 0 \
-	} || return
-	[ -n "$FW_DEFAULTS_APPLIED" ] && {
-		fw_log error "duplicate defaults section detected, skipping"
-		return 1
-	}
-	FW_DEFAULTS_APPLIED=1
-
-	FW_DEFAULT_INPUT_POLICY=$defaults_input
-	FW_DEFAULT_OUTPUT_POLICY=$defaults_output
-	FW_DEFAULT_FORWARD_POLICY=$defaults_forward
-
-	FW_ADD_CUSTOM_CHAINS=$defaults_custom_chains
-
-	FW_ACCEPT_REDIRECTS=$defaults_accept_redirects
-	FW_ACCEPT_SRC_ROUTE=$defaults_accept_source_route
-
-	FW_DISABLE_IPV6=$defaults_disable_ipv6
-
-	fw_callback pre defaults
-
-	# Seems like there are only one sysctl for both IP versions.
-	for s in syncookies ecn westwood window_scaling; do
-		eval "sysctl -e -w net.ipv4.tcp_${s}=\$defaults_tcp_${s}" >/dev/null
-	done
-	fw_sysctl_interface all
-
-	[ $defaults_drop_invalid == 1 ] && {
-		fw add i f INPUT   DROP { -m state --state INVALID }
-		fw add i f OUTPUT  DROP { -m state --state INVALID }
-		fw add i f FORWARD DROP { -m state --state INVALID }
-		FW_NOTRACK_DISABLED=1
-	}
-
-	fw add i f INPUT   ACCEPT { -m state --state RELATED,ESTABLISHED }
-	fw add i f OUTPUT  ACCEPT { -m state --state RELATED,ESTABLISHED }
-	fw add i f FORWARD ACCEPT { -m state --state RELATED,ESTABLISHED }
-
-	fw add i f INPUT  ACCEPT { -i lo }
-	fw add i f OUTPUT ACCEPT { -o lo }
-
-	# Compatibility to old 'syn_flood' parameter
-	[ $defaults_syn_flood == 1 ] && \
-		defaults_synflood_protect=1
-
-	[ "${defaults_synflood_rate%/*}" == "$defaults_synflood_rate" ] && \
-		defaults_synflood_rate="$defaults_synflood_rate/second"
-
-	[ $defaults_synflood_protect == 1 ] && {
-		echo "Loading synflood protection"
-		fw_callback pre synflood
-		fw add i f syn_flood
-		fw add i f syn_flood RETURN { \
-			-p tcp --syn \
-			-m limit --limit "${defaults_synflood_rate}" --limit-burst "${defaults_synflood_burst}" \
-		}
-		fw add i f syn_flood DROP
-		fw add i f INPUT syn_flood { -p tcp --syn }
-		fw_callback post synflood
-	}
-
-	[ $defaults_custom_chains == 1 ] && {
-		echo "Adding custom chains"
-		fw add i f input_rule
-		fw add i f output_rule
-		fw add i f forwarding_rule
-		fw add i n prerouting_rule
-		fw add i n postrouting_rule
-
-		fw add i f INPUT       input_rule
-		fw add i f OUTPUT      output_rule
-		fw add i f FORWARD     forwarding_rule
-		fw add i n PREROUTING  prerouting_rule
-		fw add i n POSTROUTING postrouting_rule
-	}
-
-	fw add i f input
-	fw add i f output
-	fw add i f forward
-
-	fw add i f INPUT   input
-	fw add i f OUTPUT  output
-	fw add i f FORWARD forward
-
-	fw add i f reject
-	fw add i f reject REJECT { --reject-with tcp-reset -p tcp }
-	fw add i f reject REJECT { --reject-with port-unreach }
-
-	fw_set_filter_policy
-
-	fw_callback post defaults
-}
-
-
-fw_config_get_zone() {
-	[ "${zone_NAME}" != "$1" ] || return
-	fw_config_get_section "$1" zone { \
-		string name "$1" \
-		string network "" \
-		string input "$FW_DEFAULT_INPUT_POLICY" \
-		string output "$FW_DEFAULT_OUTPUT_POLICY" \
-		string forward "$FW_DEFAULT_FORWARD_POLICY" \
-		boolean masq 0 \
-		string masq_src "" \
-		string masq_dest "" \
-		boolean conntrack 0 \
-		boolean mtu_fix 0 \
-		boolean custom_chains "$FW_ADD_CUSTOM_CHAINS" \
-		boolean log 0 \
-		string log_limit 10 \
-		string family "" \
-	} || return
-	[ -n "$zone_name" ] || zone_name=$zone_NAME
-	[ -n "$zone_network" ] || zone_network=$zone_name
-}
-
-fw_load_zone() {
-	fw_config_get_zone "$1"
-
-	list_contains FW_ZONES $zone_name && {
-		fw_log error "zone ${zone_name}: duplicated zone, skipping"
-		return 0
-	}
-	append FW_ZONES $zone_name
-
-	fw_callback pre zone
-
-	[ $zone_conntrack = 1 -o $zone_masq = 1 ] && \
-		append FW_CONNTRACK_ZONES "$zone_name"
-
-	local mode
-	case "$zone_family" in
-		*4)
-			mode=4
-			append FW_ZONES4 $zone_name
-			uci_set_state firewall core ${zone_name}_ipv4 1
-		;;
-		*6)
-			mode=6
-			append FW_ZONES6 $zone_name
-			uci_set_state firewall core ${zone_name}_ipv6 1
-		;;
-		*)
-			mode=i
-			append FW_ZONES4 $zone_name
-			append FW_ZONES6 $zone_name
-			uci_set_state firewall core ${zone_name}_ipv4 1
-			uci_set_state firewall core ${zone_name}_ipv6 1
-		;;
-	esac
-
-	local chain=zone_${zone_name}
-
-	fw add $mode f ${chain}_ACCEPT
-	fw add $mode f ${chain}_DROP
-	fw add $mode f ${chain}_REJECT
-	fw add $mode f ${chain}_MSSFIX
-
-	# TODO: Rename to ${chain}_input
-	fw add $mode f ${chain}
-	fw add $mode f ${chain} ${chain}_${zone_input} $
-
-	fw add $mode f ${chain}_forward
-	fw add $mode f ${chain}_forward ${chain}_${zone_forward} $
-
-	# TODO: add ${chain}_output
-	fw add $mode f output ${chain}_${zone_output} $
-
-	# TODO: Rename to ${chain}_MASQUERADE
-	fw add $mode n ${chain}_nat
-	fw add $mode n ${chain}_prerouting
-
-	fw add $mode r ${chain}_notrack
-
-	[ $zone_mtu_fix == 1 ] && \
-		fw add $mode f FORWARD ${chain}_MSSFIX ^
-
-	[ $zone_custom_chains == 1 ] && {
-		[ $FW_ADD_CUSTOM_CHAINS == 1 ] || \
-			fw_die "zone ${zone_name}: custom_chains globally disabled"
-
-		fw add $mode f input_${zone_name}
-		fw add $mode f ${chain} input_${zone_name} ^
-
-		fw add $mode f forwarding_${zone_name}
-		fw add $mode f ${chain}_forward forwarding_${zone_name} ^
-
-		fw add $mode n prerouting_${zone_name}
-		fw add $mode n ${chain}_prerouting prerouting_${zone_name} ^
-	}
-
-	[ "$zone_log" == 1 ] && {
-		[ "${zone_log_limit%/*}" == "$zone_log_limit" ] && \
-			zone_log_limit="$zone_log_limit/minute"
-
-		local t
-		for t in REJECT DROP MSSFIX; do
-			fw add $mode f ${chain}_${t} LOG ^ \
-				{ -m limit --limit $zone_log_limit --log-prefix "$t($zone_name): "  }
-		done
-	}
-
-	# NB: if MASQUERADING for IPv6 becomes available we'll need a family check here
-	if [ "$zone_masq" == 1 ]; then
-		local msrc mdst
-		for msrc in ${zone_masq_src:-0.0.0.0/0}; do
-			[ "${msrc#!}" != "$msrc" ] && msrc="! -s ${msrc#!}" || msrc="-s $msrc"
-			for mdst in ${zone_masq_dest:-0.0.0.0/0}; do
-				[ "${mdst#!}" != "$mdst" ] && mdst="! -d ${mdst#!}" || mdst="-d $mdst"
-				fw add $mode n ${chain}_nat MASQUERADE $ { $msrc $mdst }
-			done
-		done
-	fi
-
-	fw_callback post zone
-}
-
-fw_load_notrack_zone() {
-	fw_config_get_zone "$1"
-	list_contains FW_CONNTRACK_ZONES "${zone_name}" && return
-
-	fw_callback pre notrack
-
-	fw add i r zone_${zone_name}_notrack NOTRACK $
-
-	fw_callback post notrack
-}
-
-
-fw_load_include() {
-	local name="$1"
-
-	local path; config_get path ${name} path
-	[ -e $path ] && . $path
-}
-
-
-fw_clear() {
-	local policy=$1
-
-	fw_set_filter_policy $policy
-
-	local tab
-	for tab in f n r; do
-		fw del i $tab
-	done
-}
-
-fw_set_filter_policy() {
-	local policy=$1
-
-	local chn tgt
-	for chn in INPUT OUTPUT FORWARD; do
-		eval "tgt=\${policy:-\${FW_DEFAULT_${chn}_POLICY}}"
-		[ $tgt == "REJECT" ] && tgt=reject
-		[ $tgt == "ACCEPT" -o $tgt == "DROP" ] || {
-			fw add i f $chn $tgt $
-			tgt=DROP
-		}
-		fw policy i f $chn $tgt
-	done
-}
-
-
-fw_callback() {
-	local pp=$1
-	local hk=$2
-
-	local libs lib
-	eval "libs=\$FW_CB_${pp}_${hk}"
-	[ -n "$libs" ] || return
-	for lib in $libs; do
-		${lib}_${pp}_${hk}_cb
-	done
-}
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/firewall/files/lib/core_interface.sh buildroot/package/firewall/files/lib/core_interface.sh
--- buildroot.orig/package/firewall/files/lib/core_interface.sh	2010-09-24 22:19:29.000000000 -0400
+++ buildroot/package/firewall/files/lib/core_interface.sh	1969-12-31 19:00:00.000000000 -0500
@@ -1,188 +0,0 @@
-# Copyright (C) 2009-2010 OpenWrt.org
-
-fw__uci_state_add() {
-	local var="$1"
-	local item="$2"
-
-	local val="$(uci_get_state firewall core $var)"
-	uci_set_state firewall core $var "${val:+$val }$item"
-}
-
-fw__uci_state_del() {
-	local var="$1"
-	local item="$2"
-
-	local val=" $(uci_get_state firewall core $var) "
-	val="${val// $item / }"
-	val="${val# }"
-	val="${val% }"
-	uci_set_state firewall core $var "$val"
-}
-
-fw_configure_interface() {
-	local iface=$1
-	local action=$2
-	local ifname=$3
-	local aliasnet=$4
-
-	[ "$action" == "add" ] && {
-		local status=$(uci_get_state network "$iface" up 0)
-		[ "$status" == 1 ] || [ -n "$aliasnet" ] || return 0
-	}
-
-	[ -n "$ifname" ] || {
-		ifname=$(uci_get_state network "$iface" ifname)
-		ifname="${ifname%%:*}"
-		[ -z "$ifname" ] && return 0
-	}
-
-	[ "$ifname" == "lo" ] && return 0
-
-	fw_callback pre interface
-
-	fw__do_rules() {
-		local action=$1
-		local zone=$2
-		local chain=zone_${zone}
-		local ifname=$3
-		local subnet=$4
-
-		local inet onet mode
-		fw_get_family_mode mode x $zone i
-
-		case "$mode/$subnet" in
-			# Zone supports v6 only or dual, need v6
-			G6/*:*|i/*:*)
-				inet="-s $subnet -d ::/0"
-				onet="-s ::/0 -d $subnet"
-				mode=6
-			;;
-
-			# Zone supports v4 only or dual, need v4
-			G4/*.*.*.*|i/*.*.*.*)
-				inet="-s $subnet -d 0.0.0.0/0"
-				onet="-s 0.0.0.0/0 -d $subnet"
-				mode=4
-			;;
-
-			# Need v6 while zone is v4
-			*/*:*) fw_log info "zone $zone does not support IPv6 address family, skipping"; return ;;
-
-			# Need v4 while zone is v6
-			*/*.*) fw_log info "zone $zone does not support IPv4 address family, skipping"; return ;;
-		esac
-
-		lock /var/run/firewall-interface.lock
-
-		fw $action $mode f ${chain}_ACCEPT ACCEPT $ { -o "$ifname" $onet }
-		fw $action $mode f ${chain}_ACCEPT ACCEPT $ { -i "$ifname" $inet }
-		fw $action $mode f ${chain}_DROP   DROP   $ { -o "$ifname" $onet }
-		fw $action $mode f ${chain}_DROP   DROP   $ { -i "$ifname" $inet }
-		fw $action $mode f ${chain}_REJECT reject $ { -o "$ifname" $onet }
-		fw $action $mode f ${chain}_REJECT reject $ { -i "$ifname" $inet }
-
-		fw $action $mode f ${chain}_MSSFIX TCPMSS  $ { -o "$ifname" -p tcp --tcp-flags SYN,RST SYN --clamp-mss-to-pmtu $onet }
-
-		fw $action $mode f input   ${chain}         $ { -i "$ifname" $inet }
-		fw $action $mode f forward ${chain}_forward $ { -i "$ifname" $inet }
-		fw $action $mode n PREROUTING ${chain}_prerouting $ { -i "$ifname" $inet }
-		fw $action $mode r PREROUTING ${chain}_notrack    $ { -i "$ifname" $inet }
-		fw $action $mode n POSTROUTING ${chain}_nat       $ { -o "$ifname" $onet }
-
-		lock -u /var/run/firewall-interface.lock
-	}
-
-	local old_zones old_ifname old_subnets
-	config_get old_zones core "${iface}_zone"
-	[ -n "$old_zones" ] && {
-		config_get old_ifname core "${iface}_ifname"
-		config_get old_subnets core "${iface}_subnets"
-
-		local z
-		for z in $old_zones; do
-			local n
-			for n in ${old_subnets:-""}; do
-				fw_log info "removing $iface ($old_ifname${n:+ alias $n}) from zone $z"
-				fw__do_rules del $z $old_ifname $n
-			done
-
-			[ -n "$old_subnets" ] || {
-				fw__uci_state_del "${z}_networks" "$iface"
-				env -i ACTION=remove ZONE="$z" INTERFACE="$iface" DEVICE="$ifname" /sbin/hotplug-call firewall
-			}
-		done
-
-		local old_aliases
-		config_get old_aliases core "${iface}_aliases"
-
-		local a
-		for a in $old_aliases; do
-			fw_configure_interface "$a" del "$old_ifname"
-		done
-
-		uci_revert_state firewall core "${iface}_zone"
-		uci_revert_state firewall core "${iface}_ifname"
-		uci_revert_state firewall core "${iface}_subnets"
-		uci_revert_state firewall core "${iface}_aliases"
-	}
-
-	[ "$action" == del ] && return
-
-	[ -z "$aliasnet" ] && {
-		local aliases
-		config_get aliases "$iface" aliases
-
-		local a
-		for a in $aliases; do
-			local ipaddr netmask ip6addr
-			config_get ipaddr "$a" ipaddr
-			config_get netmask "$a" netmask
-			config_get ip6addr "$a" ip6addr
-
-			[ -n "$ipaddr" ] && fw_configure_interface "$a" add "" "$ipaddr${netmask:+/$netmask}"
-			[ -n "$ip6addr" ] && fw_configure_interface "$a" add "" "$ip6addr"
-		done
-
-		fw_sysctl_interface $ifname
-		fw_callback post interface
-
-		uci_set_state firewall core "${iface}_aliases" "$aliases"
-	} || {
-		local subnets=
-		config_get subnets core "${iface}_subnets"
-		append subnets "$aliasnet"
-
-		config_set core "${iface}_subnets" "$subnets"
-		uci_set_state firewall core "${iface}_subnets" "$subnets"
-	}
-
-	local new_zones=
-	load_zone() {
-		fw_config_get_zone "$1"
-		list_contains zone_network "$iface" || return
-
-		fw_log info "adding $iface ($ifname${aliasnet:+ alias $aliasnet}) to zone $zone_name"
-		fw__do_rules add ${zone_name} "$ifname" "$aliasnet"
-		append new_zones $zone_name
-
-		[ -n "$aliasnet" ] || {
-			fw__uci_state_add "${zone_name}_networks" "${zone_network}"
-			env -i ACTION=add ZONE="$zone_name" INTERFACE="$iface" DEVICE="$ifname" /sbin/hotplug-call firewall
-		}
-	}
-	config_foreach load_zone zone
-
-	uci_set_state firewall core "${iface}_zone" "$new_zones"
-	uci_set_state firewall core "${iface}_ifname" "$ifname"
-}
-
-fw_sysctl_interface() {
-	local ifname=$1
-	{
-		sysctl -w net.ipv4.conf.${ifname}.accept_redirects=$FW_ACCEPT_REDIRECTS
-		sysctl -w net.ipv6.conf.${ifname}.accept_redirects=$FW_ACCEPT_REDIRECTS
-		sysctl -w net.ipv4.conf.${ifname}.accept_source_route=$FW_ACCEPT_SRC_ROUTE
-		sysctl -w net.ipv6.conf.${ifname}.accept_source_route=$FW_ACCEPT_SRC_ROUTE
-	} >/dev/null 2>/dev/null
-}
-
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/firewall/files/lib/core_redirect.sh buildroot/package/firewall/files/lib/core_redirect.sh
--- buildroot.orig/package/firewall/files/lib/core_redirect.sh	2010-09-24 22:19:29.000000000 -0400
+++ buildroot/package/firewall/files/lib/core_redirect.sh	1969-12-31 19:00:00.000000000 -0500
@@ -1,109 +0,0 @@
-# Copyright (C) 2009-2010 OpenWrt.org
-
-fw_config_get_redirect() {
-	[ "${redirect_NAME}" != "$1" ] || return
-	fw_config_get_section "$1" redirect { \
-		string _name "$1" \
-		string name "" \
-		string src "" \
-		ipaddr src_ip "" \
-		ipaddr src_dip "" \
-		string src_mac "" \
-		string src_port "" \
-		string src_dport "" \
-		string dest "" \
-		ipaddr dest_ip "" \
-		string dest_mac "" \
-		string dest_port "" \
-		string proto "tcpudp" \
-		string family "" \
-		string target "DNAT" \
-	} || return
-	[ -n "$redirect_name" ] || redirect_name=$redirect__name
-}
-
-fw_load_redirect() {
-	fw_config_get_redirect "$1"
-
-	fw_callback pre redirect
-
-	local fwdchain natchain natopt nataddr natports srcdaddr srcdports
-	if [ "$redirect_target" == "DNAT" ]; then
-		[ -n "$redirect_src" -a -n "$redirect_dest_ip$redirect_dest_port" ] || {
-			fw_log error "DNAT redirect ${redirect_name}: needs src and dest_ip or dest_port, skipping"
-			return 0
-		}
-
-		fwdchain="zone_${redirect_src}_forward"
-
-		natopt="--to-destination"
-		natchain="zone_${redirect_src}_prerouting"
-		nataddr="$redirect_dest_ip"
-		fw_get_port_range natports "$redirect_dest_port" "-"
-
-		srcdaddr="${redirect_src_dip:+$redirect_src_dip/$redirect_src_dip_prefixlen}"
-		fw_get_port_range srcdports "$redirect_src_dport" ":"
-
-		list_contains FW_CONNTRACK_ZONES $redirect_src || \
-			append FW_CONNTRACK_ZONES $redirect_src
-
-	elif [ "$redirect_target" == "SNAT" ]; then
-		[ -n "$redirect_dest" -a -n "$redirect_src_dip" ] || {
-			fw_log error "SNAT redirect ${redirect_name}: needs dest and src_dip, skipping"
-			return 0
-		}
-
-		fwdchain="${redirect_src:+zone_${redirect_src}_forward}"
-
-		natopt="--to-source"
-		natchain="zone_${redirect_dest}_nat"
-		nataddr="$redirect_src_dip"
-		fw_get_port_range natports "$redirect_src_dport" "-"
-
-		srcdaddr="${redirect_dest_ip:+$redirect_dest_ip/$redirect_dest_ip_prefixlen}"
-		fw_get_port_range srcdports "$redirect_dest_port" ":"
-
-		list_contains FW_CONNTRACK_ZONES $redirect_dest || \
-			append FW_CONNTRACK_ZONES $redirect_dest
-
-	else
-		fw_log error "redirect ${redirect_name}: target must be either DNAT or SNAT, skipping"
-		return 0
-	fi
-
-	local mode
-	fw_get_family_mode mode ${redirect_family:-x} ${redirect_src:-$redirect_dest} I
-
-	local srcaddr="${redirect_src_ip:+$redirect_src_ip/$redirect_src_ip_prefixlen}"
-	local srcports
-	fw_get_port_range srcports "$redirect_src_port" ":"
-
-	local destaddr="${redirect_dest_ip:+$redirect_dest_ip/$redirect_dest_ip_prefixlen}"
-	local destports
-	fw_get_port_range destports "${redirect_dest_port:-$redirect_src_dport}" ":"
-
-	[ "$redirect_proto" == "tcpudp" ] && redirect_proto="tcp udp"
-	for redirect_proto in $redirect_proto; do
-		fw add $mode n $natchain $redirect_target ^ { $redirect_src_ip $redirect_dest_ip } { \
-			${redirect_proto:+-p $redirect_proto} \
-			${srcaddr:+-s $srcaddr} \
-			${srcports:+--sport $srcports} \
-			${srcdaddr:+-d $srcdaddr} \
-			${srcdports:+--dport $srcdports} \
-			${redirect_src_mac:+-m mac --mac-source $redirect_src_mac} \
-			$natopt $nataddr${natports:+:$natports} \
-		}
-
-		[ -n "$destaddr" ] && \
-		fw add $mode f ${fwdchain:-forward} ACCEPT ^ { $redirect_src_ip $redirect_dest_ip } { \
-			${redirect_proto:+-p $redirect_proto} \
-			${srcaddr:+-s $srcaddr} \
-			${srcports:+--sport $srcports} \
-			${destaddr:+-d $destaddr} \
-			${destports:+--dport $destports} \
-			${redirect_src_mac:+-m mac --mac-source $redirect_src_mac} \
-		}
-	done
-
-	fw_callback post redirect
-}
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/firewall/files/lib/core_rule.sh buildroot/package/firewall/files/lib/core_rule.sh
--- buildroot.orig/package/firewall/files/lib/core_rule.sh	2010-09-24 22:19:29.000000000 -0400
+++ buildroot/package/firewall/files/lib/core_rule.sh	1969-12-31 19:00:00.000000000 -0500
@@ -1,69 +0,0 @@
-# Copyright (C) 2009-2010 OpenWrt.org
-
-fw_config_get_rule() {
-	[ "${rule_NAME}" != "$1" ] || return
-	fw_config_get_section "$1" rule { \
-		string _name "$1" \
-		string name "" \
-		string src "" \
-		ipaddr src_ip "" \
-		string src_mac "" \
-		string src_port "" \
-		string dest "" \
-		ipaddr dest_ip "" \
-		string dest_port "" \
-		string icmp_type "" \
-		string proto "tcpudp" \
-		string target "" \
-		string family "" \
-	} || return
-	[ -n "$rule_name" ] || rule_name=$rule__name
-	[ "$rule_proto" == "icmp" ] || rule_icmp_type=
-}
-
-fw_load_rule() {
-	fw_config_get_rule "$1"
-
-	fw_callback pre rule
-
-	fw_get_port_range rule_src_port $rule_src_port
-	fw_get_port_range rule_dest_port $rule_dest_port
-
-	local chain=input
-	[ -n "$rule_src" ] && {
-		[ -z "$rule_dest" ] && {
-			chain=zone_${rule_src}
-		} || {
-			chain=zone_${rule_src}_forward
-		}
-	}
-
-	local target=$rule_target
-	[ -z "$target" ] && {
-		target=REJECT
-	}
-	[ -n "$dest" ] && {
-		target=zone_${rule_dest}_${target}
-	}
-
-	local mode
-	fw_get_family_mode mode ${rule_family:-x} $rule_src I
-
-	local rule_pos
-	eval 'rule_pos=$((++FW__RULE_COUNT_'$mode'_'$chain'))'
-
-	[ "$rule_proto" == "tcpudp" ] && rule_proto="tcp udp"
-	for rule_proto in $rule_proto; do
-		fw add $mode f $chain $target $rule_pos { $rule_src_ip $rule_dest_ip } { \
-			${rule_proto:+-p $rule_proto} \
-			${rule_src_ip:+-s $rule_src_ip/$rule_src_ip_prefixlen} \
-			${rule_src_port:+--sport $rule_src_port} \
-			${rule_src_mac:+-m mac --mac-source $rule_src_mac} \
-			${rule_dest_ip:+-d $rule_dest_ip/$rule_dest_ip_prefixlen} \
-			${rule_dest_port:+--dport $rule_dest_port} \
-			${rule_icmp_type:+--icmp-type $rule_icmp_type} \
-		}
-	done
-
-	fw_callback post rule
-}
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/firewall/files/lib/core.sh buildroot/package/firewall/files/lib/core.sh
--- buildroot.orig/package/firewall/files/lib/core.sh	2010-09-24 22:19:29.000000000 -0400
+++ buildroot/package/firewall/files/lib/core.sh	1969-12-31 19:00:00.000000000 -0500
@@ -1,153 +0,0 @@
-# Copyright (C) 2009-2010 OpenWrt.org
-
-FW_LIBDIR=${FW_LIBDIR:-/lib/firewall}
-
-. $FW_LIBDIR/fw.sh
-include /lib/network
-
-fw_start() {
-	fw_init
-
-	FW_DEFAULTS_APPLIED=
-
-	fw_is_loaded && {
-		echo "firewall already loaded" >&2
-		exit 1
-	}
-
-	uci_set_state firewall core "" firewall_state
-
-	fw_clear DROP
-
-	fw_callback pre core
-
-	echo "Loading defaults"
-	fw_config_once fw_load_defaults defaults
-
-	echo "Loading zones"
-	config_foreach fw_load_zone zone
-
-	echo "Loading forwardings"
-	config_foreach fw_load_forwarding forwarding
-
-	echo "Loading redirects"
-	config_foreach fw_load_redirect redirect
-
-	echo "Loading rules"
-	config_foreach fw_load_rule rule
-
-	echo "Loading includes"
-	config_foreach fw_load_include include
-
-	[ -z "$FW_NOTRACK_DISABLED" ] && {
-		echo "Optimizing conntrack"
-		config_foreach fw_load_notrack_zone zone
-	}
-
-	echo "Loading interfaces"
-	config_foreach fw_configure_interface interface add
-
-	fw_callback post core
-
-	uci_set_state firewall core zones "$FW_ZONES"
-	uci_set_state firewall core loaded 1
-}
-
-fw_stop() {
-	fw_init
-
-	fw_callback pre stop
-
-	local z n i
-	config_get z core zones
-	for z in $z; do
-		config_get n core "${z}_networks"
-		for n in $n; do
-			config_get i core "${n}_ifname"
-			[ -n "$i" ] && env -i ACTION=remove ZONE="$z" \
-				INTERFACE="$n" DEVICE="$i" /sbin/hotplug-call firewall
-		done
-	done
-
-	fw_clear ACCEPT
-
-	fw_callback post stop
-
-	uci_revert_state firewall
-	config_clear
-
-	local h
-	for h in $FW_HOOKS; do unset $h; done
-
-	unset FW_HOOKS
-	unset FW_INITIALIZED
-}
-
-fw_restart() {
-	fw_stop
-	fw_start
-}
-
-fw_reload() {
-	fw_restart
-}
-
-fw_is_loaded() {
-	local bool=$(uci_get_state firewall.core.loaded)
-	return $((! ${bool:-0}))
-}
-
-
-fw_die() {
-	echo "Error:" "$@" >&2
-	fw_log error "$@"
-	fw_stop
-	exit 1
-}
-
-fw_log() {
-	local level="$1"
-	[ -n "$2" ] && shift || level=notice
-	[ "$level" != error ] || echo "Error: $@" >&2
-	logger -t firewall -p user.$level "$@"
-}
-
-
-fw_init() {
-	[ -z "$FW_INITIALIZED" ] || return 0
-
-	. $FW_LIBDIR/config.sh
-
-	scan_interfaces
-	fw_config_append firewall
-
-	local hooks="core stop defaults zone notrack synflood"
-	local file lib hk pp
-	for file in $FW_LIBDIR/core_*.sh; do
-		. $file
-		hk=$(basename $file .sh)
-		hk=${hk#core_}
-		append hooks $hk
-	done
-	for file in $FW_LIBDIR/*.sh; do
-		lib=$(basename $file .sh)
-		lib=${lib##[0-9][0-9]_}
-		case $lib in
-			core*|fw|config|uci_firewall) continue ;;
-		esac
-		. $file
-		for hk in $hooks; do
-			for pp in pre post; do
-				type ${lib}_${pp}_${hk}_cb >/dev/null && {
-					append FW_CB_${pp}_${hk} ${lib}
-					append FW_HOOKS FW_CB_${pp}_${hk}
-				}
-			done
-		done
-	done
-
-	fw_callback post init
-
-	FW_INITIALIZED=1
-	return 0
-}
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/firewall/files/lib/fw.sh buildroot/package/firewall/files/lib/fw.sh
--- buildroot.orig/package/firewall/files/lib/fw.sh	2010-09-24 22:19:29.000000000 -0400
+++ buildroot/package/firewall/files/lib/fw.sh	1969-12-31 19:00:00.000000000 -0500
@@ -1,220 +0,0 @@
-# Copyright (C) 2009-2010 OpenWrt.org
-# Copyright (C) 2009 Malte S. Stretz
-
-export FW_4_ERROR=0
-export FW_6_ERROR=0
-export FW_i_ERROR=0
-export FW_e_ERROR=0
-export FW_a_ERROR=0
-
-#TODO: remove this
-[ "${-#*x}" == "$-" ] && {
-	fw() {
-		fw__exec "$@"
-	}
-} || {
-	fw() {
-		local os=$-
-		set +x
-		fw__exec "$@"
-		local rc=$?
-		set -$os
-		return $rc
-	}
-}
-
-fw__exec() { # <action> <family> <table> <chain> <target> <position> { <rules> }
-	local cmd fam tab chn tgt pos
-	local i
-	for i in cmd fam tab chn tgt pos; do
-		if [ "$1" -a "$1" != '{' ]; then
-			eval "$i='$1'"
-			shift
-		else
-			eval "$i=-"
-		fi
-	done
-
-	fw__rc() {
-		export FW_${fam#G}_ERROR=$1
-		return $1
-	}
-
-	fw__dualip() {
-		fw $cmd 4 $tab $chn $tgt $pos "$@"
-		fw $cmd 6 $tab $chn $tgt $pos "$@"
-		fw__rc $((FW_4_ERROR | FW_6_ERROR))
-	}
-
-	fw__autoip() {
-		local ip4 ip6
-		shift
-		while [ "$1" != '}' ]; do
-			case "$1" in
-				*:*) ip6=1 ;;
-				*.*.*.*) ip4=1 ;;
-			esac
-			shift
-		done
-		shift
-		if [ "${ip4:-4}" == "${ip6:-6}" ]; then
-			echo "fw: can't mix ip4 and ip6" >&2
- 			return 1
-		fi
-		local ver=${ip4:+4}${ip6:+6}
-		fam=i
-		fw $cmd ${ver:-i} $tab $chn $tgt $pos "$@"
-		fw__rc $?
-	}
-
-	fw__has() {
-		local tab=${1:-$tab}
-		if [ $tab == '-' ]; then
-			type $app > /dev/null 2> /dev/null
-			fw__rc $(($? & 1))
-			return
-		fi
-		local mod
-		eval "mod=\$FW_${fam#G}_${tab}"
-		if [ "$mod" ]; then
-			fw__rc $mod
-			return
-		fi
-		case "$fam" in
-			*4) mod=iptable_${tab} ;;
-			*6) mod=ip6table_${tab} ;;
-			*) mod=. ;;
-		esac
-		grep -q "^${mod} " /proc/modules
-		mod=$?
-		export FW_${fam}_${tab}=$mod
-		fw__rc $mod
-	}
-
-	fw__err() {
-		local err
-		eval "err=\$FW_${fam}_ERROR"
-		fw__rc $err
-	}
-
-	local app=
-	local pol=
-	case "$fam" in
-		*4) [ $FW_DISABLE_IPV4 == 0 ] && app=iptables  || return ;;
-		*6) [ $FW_DISABLE_IPV6 == 0 ] && app=ip6tables || return ;;
-		i) fw__dualip "$@"; return ;;
-		I) fw__autoip "$@"; return ;;
-		e) app=ebtables ;;
-		a) app=arptables ;;
-		-) fw $cmd i $tab $chn $tgt $pos "$@"; return ;;
-		*) return 254 ;;
-	esac
-	case "$tab" in
-		f) tab=filter ;;
-		m) tab=mangle ;;
-		n) tab=nat ;;
-		r) tab=raw ;;
-		-) tab=filter ;;
-	esac
-	case "$cmd:$chn:$tgt:$pos" in
-		add:*:-:*) cmd=new-chain ;;
-		add:*:*:-) cmd=append ;;
-		add:*:*:$) cmd=append ;;
-		add:*:*:*) cmd=insert ;;
-		del:-:*:*) cmd=delete-chain; fw flush $fam $tab ;;
-		del:*:-:*) cmd=delete-chain; fw flush $fam $tab $chn ;;
-		del:*:*:*) cmd=delete ;;
-		flush:*) ;;
-		policy:*) pol=$tgt; tgt=- ;;
-		has:*) fw__has; return ;;
-		err:*) fw__err; return ;;
-		list:*) cmd="numeric --verbose --$cmd" ;;
-		*) return 254 ;;
-	esac
-	case "$chn" in
-		-) chn= ;;
-	esac
-	case "$tgt" in
-		-) tgt= ;;
-	esac
-	case "$pos" in
-		^) pos=1 ;;
-		$) pos= ;;
-		-) pos= ;;
-	esac
-
-	if ! fw__has - family || ! fw__has $tab ; then
-		export FW_${fam}_ERROR=0
-		return 0
-	fi
-
-	case "$fam" in
-		G*) shift; while [ $# -gt 0 ] && [ "$1" != "{" ]; do shift; done ;;
-	esac
-
-	if [ $# -gt 0 ]; then
-		shift
-		if [ $cmd == delete ]; then
-			pos=
-		fi
-	fi
-
-	local cmdline="$app --table ${tab} --${cmd} ${chn} ${pol} ${pos} ${tgt:+--jump "$tgt"}"
-	while [ $# -gt 1 ]; do
-		case "$app:$1" in
-			ip6tables:--icmp-type) cmdline="$cmdline --icmpv6-type" ;;
-			ip6tables:icmp|ip6tables:ICMP) cmdline="$cmdline icmpv6" ;;
-			iptables:--icmpv6-type) cmdline="$cmdline --icmp-type" ;;
-			iptables:icmpv6) cmdline="$cmdline icmp" ;;
-			*) cmdline="$cmdline $1" ;;
-		esac
-		shift
-	done
-
-	[ -n "$FW_TRACE" ] && echo $cmdline >&2
-
-	$cmdline
-
-	fw__rc $?
-}
-
-fw_get_port_range() {
-	local _var=$1
-	local _ports=$2
-	local _delim=${3:-:}
-	if [ "$4" ]; then
-		fw_get_port_range $_var "${_ports}-${4}" $_delim
-		return
-	fi
-
-	local _first=${_ports%-*}
-	local _last=${_ports#*-}
-	if [ "$_first" != "$_last" ]; then
-		export -- "$_var=$_first$_delim$_last"
-	else
-		export -- "$_var=$_first"
-	fi
-}
-
-fw_get_family_mode() {
-	local _var="$1"
-	local _hint="$2"
-	local _zone="$3"
-	local _mode="$4"
-
-	local _ipv4 _ipv6
-	[ -n "$FW_ZONES4$FW_ZONES6" ] && {
-		list_contains FW_ZONES4 $_zone && _ipv4=1 || _ipv4=0
-		list_contains FW_ZONES6 $_zone && _ipv6=1 || _ipv6=0
-	} || {
-		_ipv4=$(uci_get_state firewall core ${_zone}_ipv4 0)
-		_ipv6=$(uci_get_state firewall core ${_zone}_ipv6 0)
-	}
-
-	case "$_hint:$_ipv4:$_ipv6" in
-		*4:1:*|*:1:0) export -n -- "$_var=G4" ;;
-		*6:*:1|*:0:1) export -n -- "$_var=G6" ;;
-		*) export -n -- "$_var=$_mode" ;;
-	esac
-}
-
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/firewall/files/lib/uci_firewall.sh buildroot/package/firewall/files/lib/uci_firewall.sh
--- buildroot.orig/package/firewall/files/lib/uci_firewall.sh	2010-09-24 22:19:29.000000000 -0400
+++ buildroot/package/firewall/files/lib/uci_firewall.sh	1969-12-31 19:00:00.000000000 -0500
@@ -1,5 +0,0 @@
-# This file is here for backwards compatibility and to override the
-# uci_firewall.sh from an earlier version.
-type fw_is_loaded >/dev/null || {
-	. /lib/firewall/core.sh
-}
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/firewall/files/reflection.hotplug buildroot/package/firewall/files/reflection.hotplug
--- buildroot.orig/package/firewall/files/reflection.hotplug	2010-09-24 22:19:29.000000000 -0400
+++ buildroot/package/firewall/files/reflection.hotplug	1969-12-31 19:00:00.000000000 -0500
@@ -1,108 +0,0 @@
-#!/bin/sh
-
-. /etc/functions.sh
-
-if [ "$ACTION" = "add" ] && [ "$INTERFACE" = "wan" ]; then
-	local wanip=$(uci -P/var/state get network.wan.ipaddr)
-
-	iptables -t nat -F nat_reflection_in 2>/dev/null || {
-		iptables -t nat -N nat_reflection_in
-		iptables -t nat -A prerouting_rule -j nat_reflection_in
-	}
-
-	iptables -t nat -F nat_reflection_out 2>/dev/null || {
-		iptables -t nat -N nat_reflection_out
-		iptables -t nat -A postrouting_rule -j nat_reflection_out
-	}
-
-	find_networks() {
-		find_networks_cb() {
-			local cfg="$1"
-			local zone="$2"
-
-			local name
-			config_get name "$cfg" name
-
-			[ "$name" = "$zone" ] && {
-				local network
-				config_get network "$cfg" network
-
-				echo ${network:-$zone}
-				return 1
-			}
-		}
-
-		config_foreach find_networks_cb zone "$1"
-	}
-	
-	setup_fwd() {
-		local cfg="$1"
-
-		local src
-		config_get src "$cfg" src
-
-		local target
-		config_get target "$cfg" target DNAT
-
-		[ "$src" = wan ] && [ "$target" = DNAT ] && {
-			local dest
-			config_get dest "$cfg" dest "lan"
-
-			local net
-			for net in $(find_networks "$dest"); do
-				local lanip=$(uci -P/var/state get network.$net.ipaddr)
-				local lanmk=$(uci -P/var/state get network.$net.netmask)
-
-				local proto
-				config_get proto "$cfg" proto
-
-				local reflection
-				config_get_bool reflection "$cfg" reflection 1
-				[ "$reflection" == 1 ] || return
-
-				local epmin epmax extport
-				config_get extport "$cfg" src_dport
-				[ -n "$extport" ] || return
-
-				epmin="${extport%[-:]*}"; epmax="${extport#*[-:]}"
-				[ "$epmin" != "$epmax" ] || epmax=""
-
-				local ipmin ipmax intport
-				config_get intport "$cfg" dest_port "$extport"
-
-				ipmin="${intport%[-:]*}"; ipmax="${intport#*[-:]}"
-				[ "$ipmin" != "$ipmax" ] || ipmax=""
-
-				local exthost
-				config_get exthost "$cfg" src_dip "$wanip"
-
-				local inthost
-				config_get inthost "$cfg" dest_ip
-				[ -n "$inthost" ] || return
-
-				[ "$proto" = tcpudp ] && proto="tcp udp"
-
-				local p
-				for p in ${proto:-tcp udp}; do
-					case "$p" in
-						tcp|udp)
-							iptables -t nat -A nat_reflection_in \
-								-s $lanip/$lanmk -d $exthost \
-								-p $p --dport $epmin${epmax:+:$epmax} \
-								-j DNAT --to $inthost:$ipmin${ipmax:+-$ipmax}
-
-							iptables -t nat -A nat_reflection_out \
-								-s $lanip/$lanmk -d $inthost \
-								-p $p --dport $ipmin${ipmax:+:$ipmax} \
-								-j SNAT --to-source $lanip
-						;;
-					esac
-				done
-			done
-		}
-	}
-
-	config_load firewall
-	config_foreach setup_fwd redirect
-fi
-
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/firewall/Makefile buildroot/package/firewall/Makefile
--- buildroot.orig/package/firewall/Makefile	2010-09-24 22:19:29.000000000 -0400
+++ buildroot/package/firewall/Makefile	1969-12-31 19:00:00.000000000 -0500
@@ -1,54 +0,0 @@
-#
-# Copyright (C) 2008-2010 OpenWrt.org
-#
-# This is free software, licensed under the GNU General Public License v2.
-# See /LICENSE for more information.
-
-include $(TOPDIR)/rules.mk
-
-PKG_NAME:=firewall
-
-PKG_VERSION:=2
-PKG_RELEASE:=17
-
-include $(INCLUDE_DIR)/package.mk
-
-define Package/firewall
-  SECTION:=net
-  CATEGORY:=Base system
-  URL:=http://openwrt.org/
-  TITLE:=OpenWrt firewall
-  DEPENDS:=+iptables +iptables-mod-conntrack +iptables-mod-nat
-  PKGARCH:=all
-endef
-
-define Package/firewall/description
- UCI based firewall for OpenWrt
-endef
-
-define Build/Compile
-	true
-endef
-
-define Package/firewall/conffiles
-/etc/config/firewall
-endef
-
-define Package/firewall/install
-	$(INSTALL_DIR) $(1)/lib/firewall
-	$(INSTALL_DATA) ./files/lib/*.sh $(1)/lib/firewall
-	$(INSTALL_DIR) $(1)/sbin
-	$(INSTALL_BIN) ./files/bin/fw $(1)/sbin
-	$(INSTALL_DIR) $(1)/etc/config
-	$(INSTALL_DATA) ./files/firewall.config $(1)/etc/config/firewall
-	$(INSTALL_DIR) $(1)/etc/init.d/
-	$(INSTALL_BIN) ./files/firewall.init $(1)/etc/init.d/firewall
-	$(INSTALL_DIR) $(1)/etc/hotplug.d/iface
-	$(INSTALL_DATA) ./files/firewall.hotplug $(1)/etc/hotplug.d/iface/20-firewall
-	$(INSTALL_DIR) $(1)/etc/hotplug.d/firewall
-	$(INSTALL_DATA) ./files/reflection.hotplug $(1)/etc/hotplug.d/firewall/10-nat-reflection
-	$(INSTALL_DIR) $(1)/etc
-	$(INSTALL_DATA) ./files/firewall.user $(1)/etc
-endef
-
-$(eval $(call BuildPackage,firewall))
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/haserl/Makefile buildroot/package/haserl/Makefile
--- buildroot.orig/package/haserl/Makefile	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/haserl/Makefile	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,33 @@
+# 
+# Copyright (C) 2006 OpenWrt.org
+#
+# This is free software, licensed under the GNU General Public License v2.
+# See /LICENSE for more information.
+#
+# $Id: Makefile 11849 2008-07-16 23:05:47Z thepeople $
+
+include $(TOPDIR)/rules.mk
+
+PKG_NAME:=haserl
+PKG_VERSION:=0.9.24
+PKG_RELEASE:=1
+
+PKG_SOURCE:=$(PKG_NAME)-$(PKG_VERSION).tar.gz
+PKG_SOURCE_URL:=@SF/haserl
+PKG_MD5SUM:=f0cdb34f5ea50482fb6b7961bb158332
+
+include $(INCLUDE_DIR)/package.mk
+
+define Package/haserl
+  SECTION:=utils
+  CATEGORY:=Utilities
+  TITLE:=A CGI wrapper to embed shell scripts in HTML documents
+  URL:=http://haserl.sourceforge.net/
+endef
+
+define Package/haserl/install
+	$(INSTALL_DIR) $(1)/usr/bin
+	$(INSTALL_BIN) $(PKG_BUILD_DIR)/src/haserl $(1)/usr/bin/
+endef
+
+$(eval $(call BuildPackage,haserl))
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/hdparm/Makefile buildroot/package/hdparm/Makefile
--- buildroot.orig/package/hdparm/Makefile	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/hdparm/Makefile	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,43 @@
+#
+# Copyright (C) 2006-2008 OpenWrt.org
+#
+# This is free software, licensed under the GNU General Public License v2.
+# See /LICENSE for more information.
+#
+# $Id: Makefile 11647 2008-07-05 12:33:14Z florian $
+
+include $(TOPDIR)/rules.mk
+
+PKG_NAME:=hdparm
+PKG_VERSION:=8.9
+PKG_RELEASE:=1
+
+PKG_SOURCE:=$(PKG_NAME)-$(PKG_VERSION).tar.gz
+PKG_SOURCE_URL:=@SF/$(PKG_NAME)
+PKG_MD5SUM:=19fa013956612581af7d00907990ac84
+
+include $(INCLUDE_DIR)/package.mk
+
+define Package/hdparm
+  SECTION:=utils
+  CATEGORY:=Utilities
+  TITLE:=Hard disk drive configuration utilitity
+  URL:=http://sourceforge.net/projects/hdparm/
+endef
+
+define Package/hdparm/description
+	Tune hard disk parameters for high performance.
+	Get/set hard disk parameters for Linux IDE drives.
+	Primary use is for enabling irq-unmasking and IDE multiplemode.
+endef
+
+MAKE_FLAGS += \
+	CFLAGS="$(EXTRA_CFLAGS)" \
+	LDFLAGS="$(EXTRA_LDFLAGS)" \
+
+define Package/hdparm/install
+	$(INSTALL_DIR) $(1)/sbin
+	$(INSTALL_BIN) $(PKG_BUILD_DIR)/$(PKG_NAME) $(1)/sbin
+endef
+
+$(eval $(call BuildPackage,hdparm))
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/hdparm/patches/100-compile-fix.patch buildroot/package/hdparm/patches/100-compile-fix.patch
--- buildroot.orig/package/hdparm/patches/100-compile-fix.patch	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/hdparm/patches/100-compile-fix.patch	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,11 @@
+--- a/Makefile
++++ b/Makefile
+@@ -29,7 +29,7 @@
+ 
+ hdparm: hdparm.h sgio.h $(OBJS)
+ 	$(CC) $(LDFLAGS) -o hdparm $(OBJS)
+-	strip hdparm
++	$(STRIP) hdparm
+ 
+ sgio.o:	sgio.h
+ 
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/iptables/files/firewall.awk buildroot/package/iptables/files/firewall.awk
--- buildroot.orig/package/iptables/files/firewall.awk	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/iptables/files/firewall.awk	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,50 @@
+# Copyright (C) 2006 OpenWrt.org
+
+BEGIN {
+	FS=":"
+}
+
+($1 == "accept") || ($1 == "drop") || ($1 == "forward") {
+	delete _opt
+	str2data($2)
+	if ((_l["proto"] == "") && (_l["sport"] _l["dport"] != "")) {
+		_opt[0] = " -p tcp"
+		_opt[1] = " -p udp"
+	} else {
+		_opt[0] = ""
+	}
+}
+
+($1 == "accept") {
+	target = " -j ACCEPT"
+	for (o in _opt) {
+		print "iptables -t nat -A prerouting_wan" _opt[o] str2ipt($2) target
+		print "iptables        -A input_wan     " _opt[o] str2ipt($2) target
+		print ""
+	}
+}
+
+($1 == "drop") {
+	for (o in _opt) {
+		print "iptables -t nat -A prerouting_wan" _opt[o] str2ipt($2) " -j DROP"
+		print ""
+	}
+}
+
+($1 == "forward") {
+	target = " -j DNAT --to " $3
+	fwopts = ""
+	if ($4 != "") {
+		if ((_l["proto"] == "tcp") || (_l["proto"] == "udp") || (_l["proto"] == "")) {
+			if (_l["proto"] != "") fwopts = " -p " _l["proto"]
+			fwopts = fwopts " --dport " $4
+			target = target ":" $4
+		}
+		else fwopts = ""
+	}
+	for (o in _opt) {
+		print "iptables -t nat -A prerouting_wan" _opt[o] str2ipt($2) target
+		print "iptables        -A forwarding_wan   " _opt[o] " -d " $3 fwopts " -j ACCEPT"
+		print ""
+	}
+}
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/iptables/files/firewall.config buildroot/package/iptables/files/firewall.config
--- buildroot.orig/package/iptables/files/firewall.config	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/iptables/files/firewall.config	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,48 @@
+# Copyright (C) 2006 OpenWrt.org
+
+# RULE SYNTAX:
+#
+# forward:<match>:<target>[:<port>]
+# 	- forwards all packets matched by <match> to <target>,
+# 	  optionally changing the port to <port>
+#
+# accept:<match>
+# 	- accepts all traffic matched by <match>
+#
+# drop:<match>
+#	- drops all traffic matched by <match>
+#
+#
+# MATCHING OPTIONS:
+#
+# src=<ip>
+# 	- match the source ip <ip>
+#
+# dest=<ip>
+# 	- match the destination ip <ip>
+#
+# proto=<proto>
+# 	- match the protocol by name or number
+#
+# sport=<port(s)>
+# 	- match the source port(s), see below for syntax
+#
+# dport=<port(s)>
+# 	- match the destination port(s), see below for syntax
+#
+#
+#
+# PORT SYNTAX:
+#
+# You can enter an arbitrary list of ports and port ranges in the following format:
+#   - 22,53,993,1000-1024 
+#
+# If you don't set the protocol to tcp or udp, it will apply to both
+#
+#
+#
+# EXAMPLES:
+#
+# drop:dport=22 src=1.3.3.7
+# accept:proto=tcp dport=22
+# forward:dport=60168:192.168.1.2:60169
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/iptables/files/firewall.init buildroot/package/iptables/files/firewall.init
--- buildroot.orig/package/iptables/files/firewall.init	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/iptables/files/firewall.init	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,160 @@
+#!/bin/sh /etc/rc.common
+# Copyright (C) 2006 OpenWrt.org
+
+START=45
+start() {
+	USB_D=/mnt/disc0_1/packetprotector/
+	if [ -d $USB_D ] ; then
+		PROXY=`grep "dansguardian=" /etc/packetprotector.conf | cut -d "=" -f 2`
+	else
+		PROXY=0
+	fi
+	include /lib/network
+	scan_interfaces
+	config_load /var/state/network
+	
+	config_get WAN wan ifname
+	config_get WANDEV wan device
+	config_get LAN lan ifname
+	
+	## CLEAR TABLES
+	for T in filter nat; do
+		iptables -t $T -F
+		iptables -t $T -X
+	done
+	
+	iptables -N input_rule
+	iptables -N input_queue
+	iptables -A input_queue -j ACCEPT
+	iptables -N input_wan
+	iptables -N output_rule
+	iptables -N output_queue
+	iptables -A output_queue -j ACCEPT
+	iptables -N forwarding_rule
+	iptables -N forwarding_queue
+	iptables -A forwarding_queue -j ACCEPT
+	iptables -N forwarding_wan
+
+	iptables -t nat -N NEW
+	iptables -t nat -N prerouting_rule
+	iptables -t nat -N prerouting_wan
+	iptables -t nat -N postrouting_rule
+	
+	iptables -N LAN_ACCEPT
+	[ -z "$WAN" ] || iptables -A LAN_ACCEPT -i "$WAN" -j RETURN
+	[ -z "$WANDEV" -o "$WANDEV" = "$WAN" ] || iptables -A LAN_ACCEPT -i "$WANDEV" -j RETURN
+	iptables -A LAN_ACCEPT -j ACCEPT
+	
+	### INPUT
+	###  (connections with the router as destination)
+	
+	# base case
+	iptables -P INPUT DROP
+	iptables -A INPUT -m state --state INVALID -j DROP
+	iptables -A INPUT -i lo -j ACCEPT
+	iptables -A INPUT -i $LAN -m state --state RELATED,ESTABLISHED -j ACCEPT
+	iptables -A INPUT -m state --state RELATED,ESTABLISHED -j input_queue
+	iptables -A INPUT -p tcp --tcp-flags SYN SYN \! --tcp-option 2 -j  DROP
+	
+	#
+	# insert accept rule or to jump to new accept-check table here
+	#
+	iptables -A INPUT -j input_rule
+	[ -z "$WAN" ] || iptables -A INPUT -i $WAN -j input_wan
+	
+	# allow
+	iptables -A INPUT -j LAN_ACCEPT	# allow from lan/wifi interfaces 
+	iptables -A INPUT -p icmp	-j ACCEPT	# allow ICMP
+	iptables -A INPUT -p gre	-j ACCEPT	# allow GRE
+	
+	# reject (what to do with anything not allowed earlier)
+	# iptables -A INPUT -p tcp -j REJECT --reject-with tcp-reset
+	# iptables -A INPUT -j REJECT --reject-with icmp-port-unreachable
+	iptables -A INPUT -j DROP
+	
+	### OUTPUT
+	### (connections with the router as source)
+	
+	# base case
+	iptables -P OUTPUT DROP
+	iptables -A OUTPUT -m state --state INVALID -j DROP
+	iptables -A OUTPUT -o lo -j ACCEPT
+	iptables -A OUTPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
+	
+	#
+	# insert accept rule or to jump to new accept-check table here
+	#
+	iptables -A OUTPUT -j output_rule
+	
+	# allow
+	iptables -A OUTPUT -j output_queue
+	
+	# reject (what to do with anything not allowed earlier)
+	iptables -A OUTPUT -p tcp -j REJECT --reject-with tcp-reset
+	iptables -A OUTPUT -j REJECT --reject-with icmp-port-unreachable
+	
+	### FORWARDING
+	### (connections routed through the router)
+	
+	# base case
+	iptables -P FORWARD DROP 
+	iptables -A FORWARD -m state --state INVALID -j DROP
+	iptables -A FORWARD -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu
+	iptables -A FORWARD -m state --state RELATED,ESTABLISHED -j forwarding_queue
+	
+	#
+	# insert accept rule or to jump to new accept-check table here
+	#
+	iptables -A FORWARD -j forwarding_rule
+	[ -z "$WAN" ] || iptables -A FORWARD -i $WAN -j forwarding_wan
+	
+	# allow
+	iptables -A FORWARD -i $LAN -o $LAN -j forwarding_queue
+	[ -z "$WAN" ] || iptables -A FORWARD -i $LAN -o $WAN -j forwarding_queue
+	iptables -A FORWARD -i $LAN -o tun0 -j forwarding_queue
+	iptables -A FORWARD -i tun0 -o $LAN -j forwarding_queue
+
+	# reject (what to do with anything not allowed earlier)
+	# uses the default -P DROP
+	
+	### MASQ
+	iptables -t nat -A PREROUTING -m state --state NEW -p tcp -j NEW 
+	iptables -t nat -A PREROUTING -j prerouting_rule
+	[ -z "$WAN" ] || iptables -t nat -A PREROUTING -i "$WAN" -j prerouting_wan
+	iptables -t nat -A POSTROUTING -j postrouting_rule
+	[ -z "$WAN" ] || iptables -t nat -A POSTROUTING -o $WAN -j MASQUERADE
+
+	## USER RULES
+	[ -f /etc/firewall.user ] && . /etc/firewall.user
+	[ -n "$WAN" -a -e /etc/firewall.config ] && {
+		export WAN
+		awk -f /usr/lib/common.awk -f /usr/lib/firewall.awk /etc/firewall.config | ash
+	}
+	/etc/init.d/dns start
+	[ -f /packetprotector/etc/firewall/firewall.packetprotector ] && . /packetprotector/etc/firewall/firewall.packetprotector
+
+	## ENABLE IP FORWARDING
+	echo 1 > /proc/sys/net/ipv4/ip_forward
+}
+
+stop() {
+	iptables -P INPUT ACCEPT
+	iptables -P OUTPUT ACCEPT
+	iptables -P FORWARD ACCEPT
+	iptables -F
+	iptables -X
+	iptables -t nat -P PREROUTING ACCEPT
+	iptables -t nat -P POSTROUTING ACCEPT
+	iptables -t nat -P OUTPUT ACCEPT
+	iptables -t nat -F
+	iptables -t nat -X
+}
+
+restart () {
+	start
+	/packetprotector/usr/sbin/queue_redirect.sh
+	if [ "X$PROXY" = "X1" ] ; then
+		/packetprotector/usr/sbin/http_redirect.sh
+	fi
+	/etc/init.d/webiffirewalllog start
+}
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/iptables/files/firewall.user buildroot/package/iptables/files/firewall.user
--- buildroot.orig/package/iptables/files/firewall.user	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/iptables/files/firewall.user	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,30 @@
+#!/bin/sh
+# Copyright (C) 2006 OpenWrt.org
+
+iptables -F input_rule
+iptables -F output_rule
+iptables -F forwarding_rule
+iptables -t nat -F prerouting_rule
+iptables -t nat -F postrouting_rule
+
+# The following chains are for traffic directed at the IP of the 
+# WAN interface
+
+iptables -F input_wan
+iptables -F forwarding_wan
+iptables -t nat -F prerouting_wan
+
+### Open port to WAN
+## -- This allows port 22 to be answered by (dropbear on) the router
+# iptables -t nat -A prerouting_wan -p tcp --dport 22 -j ACCEPT 
+# iptables        -A input_wan      -p tcp --dport 22 -j ACCEPT
+
+### Port forwarding
+## -- This forwards port 8080 on the WAN to port 80 on 192.168.1.2
+# iptables -t nat -A prerouting_wan -p tcp --dport 8080 -j DNAT --to 192.168.1.2:80
+# iptables        -A forwarding_wan -p tcp --dport 80 -d 192.168.1.2 -j ACCEPT
+
+### DMZ
+## -- Connections to ports not handled above will be forwarded to 192.168.1.2
+# iptables -t nat -A prerouting_wan -j DNAT --to 192.168.1.2
+# iptables        -A forwarding_wan -d 192.168.1.2 -j ACCEPT
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/iptables/files/l7/applejuice.pat buildroot/package/iptables/files/l7/applejuice.pat
--- buildroot.orig/package/iptables/files/l7/applejuice.pat	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/iptables/files/l7/applejuice.pat	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,12 @@
+# Apple Juice - P2P filesharing - http://www.applejuicenet.de
+# Pattern attributes: great veryfast fast
+# Protocol groups: p2p
+# Wiki: http://www.protocolinfo.org/wiki/AppleJuice
+# Copyright (C) 2008 Matthew Strait, Ethan Sommer; See ../LICENSE
+#
+# This pattern has been tested with the Linux version (version
+# 0,29,142,229).  It matches search reqests and file transfers.
+
+applejuice
+# this pattern extracted from ipp2p, by Eicke Friedrich.
+^ajprot\x0d\x0a
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/iptables/files/l7/ares.pat buildroot/package/iptables/files/l7/ares.pat
--- buildroot.orig/package/iptables/files/l7/ares.pat	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/iptables/files/l7/ares.pat	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,63 @@
+# Ares - P2P filesharing - http://aresgalaxy.sf.net
+# Pattern attributes: good veryfast fast undermatch
+# Protocol groups: p2p open_source
+# Wiki: http://www.protocolinfo.org/wiki/Ares
+# Copyright (C) 2008 Matthew Strait, Ethan Sommer; See ../LICENSE
+
+# This pattern catches only client-server connect messages.  This is
+# sufficient for blocking, but not for shaping, since it doesn't catch
+# the actual file transfers (see below).
+
+# Original pattern by Brandon Enright <bmenrigh at the server known as ucsd.edu>
+
+# This pattern has been tested with Ares 1.8.8.2998.
+
+ares
+# regular expression madness: "[]Z]" means ']' or 'Z'.
+^\x03[]Z].?.?\x05$
+
+# It appears that the general packet format is:
+# - Two byte little endian integer giving the data length
+# - One byte packet type
+# - data
+#
+# Login packets (TCP) have the following format:
+# - \x03\x00 (the length appears to always be 3)
+# - \x5a - The login packet type.
+#   The source code suggests that for supernodes \x5d is used instead.
+# - Three more bytes.  I don't know the meaning of these, but for me they 
+#   are always \x06\x06\x05 (in Ares 1.8.8.2998).  From the comments in IPP2P, 
+#   it seems that they are not always exactly that, but seem to always end in 
+#   \x05.
+#
+# Search packets have the following format:
+# - Two byte little endian integer giving the data length
+#   A single two letter word make this \x0a
+#   The biggest I could get it was \x4f
+# - Packet type = \x09
+# - One byte document type:
+#   - "all"      = 00
+#   - "audio"    = 01
+#   - "software" = 03
+#   - "video"    = 05
+#   - "document" = 06
+#   - "image"    = 07
+#   - "other"    = 08
+# - \x0f - I don't know what this means, but it is always this for me
+# - Two bytes of unknown meaning that change
+# - Some number search words: 
+#   - \x14 - I don't know what this means, but it is always this for me
+#   - One byte length of the first search word 
+#     Between 2 and \x14 in my tests with Ares 1.8.8.2998
+#     It ignores single letter words and truncates ones longer than \x14
+#   - Two bytes of unknown meaning that change
+#   - The search word (not null terminated)
+# This was all investigated by searching for strings in "all".  Searches
+# can also be performed in "title" and "author".  I'm not going to
+# bother to research these because I new realize that searches are done
+# on the same TCP connection as the login packets, so there is no need
+# to match them separately.
+#
+# File transfers appear to be encrypted or at least obfuscated.  (The
+# files themselves, at least, are not transmitted in the clear.) I
+# haven't found any patterns.
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/iptables/files/l7/h323.pat buildroot/package/iptables/files/l7/h323.pat
--- buildroot.orig/package/iptables/files/l7/h323.pat	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/iptables/files/l7/h323.pat	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,36 @@
+# H.323 - Voice over IP.
+# Pattern attributes: ok veryfast fast
+# Protocol groups: voip itu-t_standard
+# Wiki: http://www.protocolinfo.org/wiki/H.323
+# Copyright (C) 2008 Matthew Strait, Ethan Sommer; See ../LICENSE
+#
+# This pattern is written without knowledge of the principles of H.323.
+# It has only been tested with gnomemeeting and may not work for other
+# clients. 
+#
+# Also, it has been reported that:
+# "the pattern ... match[es] only first H.323 stream (conntrack for H.323 was 
+# enabled).  Also the major chunk of traffic was of RTP which went untracked."
+#
+# Also, it may very well match other things that use TPKT and
+# Q.931. 
+
+# Note that to take full advantage of this pattern, you will need to
+# have connection tracking of H.323 support in your kernel.  This
+# support is not in the stock kernel.  A patch can be found at
+# http://netfilter.org
+
+h323
+# TPKT format: http://www.ietf.org/rfc/rfc1006.txt
+# \x03 = TPKT version.  It was 3 in May 1987 and gnomemeeting still uses 3.
+# ..? = null reserved byte and packet length field.
+# Q.931 format: http://www.freesoft.org/CIE/Topics/126.htm
+# \x08  = Q.931
+# . = length of call reference
+# The next byte was: \x18 = message sent from originating side.
+# But based on experimentation, it seems that just . is better. 
+# .?.?.?.?.?.?.?.?.?.?.?.?.?.?.? = call reference (0-15 bytes (0 for nulls))
+# \x05 = setup message
+#
+# Yup, it doesn't actually include any H.323 protocol information.
+^\x03..?\x08...?.?.?.?.?.?.?.?.?.?.?.?.?.?.?\x05
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/iptables/files/l7/sip.pat buildroot/package/iptables/files/l7/sip.pat
--- buildroot.orig/package/iptables/files/l7/sip.pat	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/iptables/files/l7/sip.pat	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,19 @@
+# SIP - Session Initiation Protocol - Internet telephony - RFC 3261
+# Pattern attributes: ok fast fast
+# Protocol groups: voip ietf_proposed_standard
+# Wiki: http://www.protocolinfo.org/wiki/SIP
+# Copyright (C) 2008 Matthew Strait, Ethan Sommer; See ../LICENSE
+#
+# This pattern has been tested with the Ubiquity SIP user agent.
+#
+# Thanks to Ankit Desai for this pattern.
+#
+# SIP typically uses port 5060.
+#
+# This pattern is based on SIP request format as per RFC 3261. I'm not
+# sure about the version part. The RFC doesn't say anything about it, so
+# I have allowed version ranging from 0.x to 2.x.
+
+#Request-Line  =  Method SP Request-URI SP SIP-Version CRLF
+sip
+^(invite|register|cancel) sip[\x09-\x0d -~]*sip/[0-2]\.[0-9]
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/iptables/files/l7/skypeout.pat buildroot/package/iptables/files/l7/skypeout.pat
--- buildroot.orig/package/iptables/files/l7/skypeout.pat	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/iptables/files/l7/skypeout.pat	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,50 @@
+# Skype to phone - UDP voice call (program to POTS phone) - http://skype.com
+# Pattern attributes: ok slow notsofast overmatch
+# Protocol groups: voip p2p proprietary
+# Wiki: http://www.protocolinfo.org/wiki/Skype
+# Copyright (C) 2008 Matthew Strait, Ethan Sommer; See ../LICENSE
+
+# Thanks to Myles Uyema, mylesuyema AT gmail.com
+
+# Taken using Ethereal traces of Windows Skype v1.2.037, same in v1.2.0.18_API
+#
+# Skype will attempt to use the same UDP port for all its connections as
+# configured in its options.  However, this is a random port by default.
+# Skype has some preference for ports 80 and 443.
+#
+# Example sessions:
+#
+#SkypeOut <USA phone number>
+#c6 5c bf 41 8e 8d d6 d2 08 <-- this is sometimes as short as 1 byte and 
+#c6 5c bf 41 8e 8d d6 d2 08 <-- sometimes as long as 9 (or more?)
+#00 6b 2c f5 87 f1 06
+#00 6b 2c f5 87 f1 06
+#00 6b 2c f5 36 ea 85
+#00 6b 2c f5 36 ea 85
+#00 6b 2c f5 57 27 d4
+#00 6b 2c f5 57 27 d4
+#00 6b 2c f5 43 5b 00
+#00 6b 2c f5 43 5b 00
+#
+#SkypeOut <USA phone number>
+#7e 4f e5 b8
+#7e 4f e5 b8
+#00 6b 88 61 80 52 93
+#00 6b 88 61 80 52 93
+#00 6b 88 61 1a 09 e9
+#00 6b 88 61 1a 09 e9
+#00 6b 88 61 47 43 c4
+#00 6b 88 61 47 43 c4
+
+skypeout
+
+# Scary.  Our regular expressions suck.  This is a prime candidate for 
+# some sort of a scheme to support two different regular expressions 
+# when there's a major difference between what the two libraries allow.  
+# For the Henry Spencer library, there's not much that can be done 
+# except requiring that we see the same byte twice.
+
+# This matches about %4 of random streams and 13% of printable random streams
+
+# This is slow, but not as bad as you might think.
+^(\x01.?.?.?.?.?.?.?.?\x01|\x02.?.?.?.?.?.?.?.?\x02|\x03.?.?.?.?.?.?.?.?\x03|\x04.?.?.?.?.?.?.?.?\x04|\x05.?.?.?.?.?.?.?.?\x05|\x06.?.?.?.?.?.?.?.?\x06|\x07.?.?.?.?.?.?.?.?\x07|\x08.?.?.?.?.?.?.?.?\x08|\x09.?.?.?.?.?.?.?.?\x09|\x0a.?.?.?.?.?.?.?.?\x0a|\x0b.?.?.?.?.?.?.?.?\x0b|\x0c.?.?.?.?.?.?.?.?\x0c|\x0d.?.?.?.?.?.?.?.?\x0d|\x0e.?.?.?.?.?.?.?.?\x0e|\x0f.?.?.?.?.?.?.?.?\x0f|\x10.?.?.?.?.?.?.?.?\x10|\x11.?.?.?.?.?.?.?.?\x11|\x12.?.?.?.?.?.?.?.?\x12|\x13.?.?.?.?.?.?.?.?\x13|\x14.?.?.?.?.?.?.?.?\x14|\x15.?.?.?.?.?.?.?.?\x15|\x16.?.?.?.?.?.?.?.?\x16|\x17.?.?.?.?.?.?.?.?\x17|\x18.?.?.?.?.?.?.?.?\x18|\x19.?.?.?.?.?.?.?.?\x19|\x1a.?.?.?.?.?.?.?.?\x1a|\x1b.?.?.?.?.?.?.?.?\x1b|\x1c.?.?.?.?.?.?.?.?\x1c|\x1d.?.?.?.?.?.?.?.?\x1d|\x1e.?.?.?.?.?.?.?.?\x1e|\x1f.?.?.?.?.?.?.?.?\x1f|\x20.?.?.?.?.?.?.?.?\x20|\x21.?.?.?.?.?.?.?.?\x21|\x22.?.?.?.?.?.?.?.?\x22|\x23.?.?.?.?.?.?.?.?\x23|\$.?.?.?.?.?.?.?.?\$|\x25.?.?.?.?.?.?.?.?\x25|\x26.?.?.?.?.?.?.?.?\x26|\x27.?.?.?.?.?.?.?.?\x27|\(.?.?.?.?.?.?.?.?\(|\).?.?.?.?.?.?.?.?\)|\*.?.?.?.?.?.?.?.?\*|\+.?.?.?.?.?.?.?.?\+|\x2c.?.?.?.?.?.?.?.?\x2c|\x2d.?.?.?.?.?.?.?.?\x2d|\..?.?.?.?.?.?.?.?\.|\x2f.?.?.?.?.?.?.?.?\x2f|\x30.?.?.?.?.?.?.?.?\x30|\x31.?.?.?.?.?.?.?.?\x31|\x32.?.?.?.?.?.?.?.?\x32|\x33.?.?.?.?.?.?.?.?\x33|\x34.?.?.?.?.?.?.?.?\x34|\x35.?.?.?.?.?.?.?.?\x35|\x36.?.?.?.?.?.?.?.?\x36|\x37.?.?.?.?.?.?.?.?\x37|\x38.?.?.?.?.?.?.?.?\x38|\x39.?.?.?.?.?.?.?.?\x39|\x3a.?.?.?.?.?.?.?.?\x3a|\x3b.?.?.?.?.?.?.?.?\x3b|\x3c.?.?.?.?.?.?.?.?\x3c|\x3d.?.?.?.?.?.?.?.?\x3d|\x3e.?.?.?.?.?.?.?.?\x3e|\?.?.?.?.?.?.?.?.?\?|\x40.?.?.?.?.?.?.?.?\x40|\x41.?.?.?.?.?.?.?.?\x41|\x42.?.?.?.?.?.?.?.?\x42|\x43.?.?.?.?.?.?.?.?\x43|\x44.?.?.?.?.?.?.?.?\x44|\x45.?.?.?.?.?.?.?.?\x45|\x46.?.?.?.?.?.?.?.?\x46|\x47.?.?.?.?.?.?.?.?\x47|\x48.?.?.?.?.?.?.?.?\x48|\x49.?.?.?.?.?.?.?.?\x49|\x4a.?.?.?.?.?.?.?.?\x4a|\x4b.?.?.?.?.?.?.?.?\x4b|\x4c.?.?.?.?.?.?.?.?\x4c|\x4d.?.?.?.?.?.?.?.?\x4d|\x4e.?.?.?.?.?.?.?.?\x4e|\x4f.?.?.?.?.?.?.?.?\x4f|\x50.?.?.?.?.?.?.?.?\x50|\x51.?.?.?.?.?.?.?.?\x51|\x52.?.?.?.?.?.?.?.?\x52|\x53.?.?.?.?.?.?.?.?\x53|\x54.?.?.?.?.?.?.?.?\x54|\x55.?.?.?.?.?.?.?.?\x55|\x56.?.?.?.?.?.?.?.?\x56|\x57.?.?.?.?.?.?.?.?\x57|\x58.?.?.?.?.?.?.?.?\x58|\x59.?.?.?.?.?.?.?.?\x59|\x5a.?.?.?.?.?.?.?.?\x5a|\[.?.?.?.?.?.?.?.?\[|\\.?.?.?.?.?.?.?.?\\|\].?.?.?.?.?.?.?.?\]|\^.?.?.?.?.?.?.?.?\^|\x5f.?.?.?.?.?.?.?.?\x5f|\x60.?.?.?.?.?.?.?.?\x60|\x61.?.?.?.?.?.?.?.?\x61|\x62.?.?.?.?.?.?.?.?\x62|\x63.?.?.?.?.?.?.?.?\x63|\x64.?.?.?.?.?.?.?.?\x64|\x65.?.?.?.?.?.?.?.?\x65|\x66.?.?.?.?.?.?.?.?\x66|\x67.?.?.?.?.?.?.?.?\x67|\x68.?.?.?.?.?.?.?.?\x68|\x69.?.?.?.?.?.?.?.?\x69|\x6a.?.?.?.?.?.?.?.?\x6a|\x6b.?.?.?.?.?.?.?.?\x6b|\x6c.?.?.?.?.?.?.?.?\x6c|\x6d.?.?.?.?.?.?.?.?\x6d|\x6e.?.?.?.?.?.?.?.?\x6e|\x6f.?.?.?.?.?.?.?.?\x6f|\x70.?.?.?.?.?.?.?.?\x70|\x71.?.?.?.?.?.?.?.?\x71|\x72.?.?.?.?.?.?.?.?\x72|\x73.?.?.?.?.?.?.?.?\x73|\x74.?.?.?.?.?.?.?.?\x74|\x75.?.?.?.?.?.?.?.?\x75|\x76.?.?.?.?.?.?.?.?\x76|\x77.?.?.?.?.?.?.?.?\x77|\x78.?.?.?.?.?.?.?.?\x78|\x79.?.?.?.?.?.?.?.?\x79|\x7a.?.?.?.?.?.?.?.?\x7a|\{.?.?.?.?.?.?.?.?\{|\|.?.?.?.?.?.?.?.?\||\}.?.?.?.?.?.?.?.?\}|\x7e.?.?.?.?.?.?.?.?\x7e|\x7f.?.?.?.?.?.?.?.?\x7f|\x80.?.?.?.?.?.?.?.?\x80|\x81.?.?.?.?.?.?.?.?\x81|\x82.?.?.?.?.?.?.?.?\x82|\x83.?.?.?.?.?.?.?.?\x83|\x84.?.?.?.?.?.?.?.?\x84|\x85.?.?.?.?.?.?.?.?\x85|\x86.?.?.?.?.?.?.?.?\x86|\x87.?.?.?.?.?.?.?.?\x87|\x88.?.?.?.?.?.?.?.?\x88|\x89.?.?.?.?.?.?.?.?\x89|\x8a.?.?.?.?.?.?.?.?\x8a|\x8b.?.?.?.?.?.?.?.?\x8b|\x8c.?.?.?.?.?.?.?.?\x8c|\x8d.?.?.?.?.?.?.?.?\x8d|\x8e.?.?.?.?.?.?.?.?\x8e|\x8f.?.?.?.?.?.?.?.?\x8f|\x90.?.?.?.?.?.?.?.?\x90|\x91.?.?.?.?.?.?.?.?\x91|\x92.?.?.?.?.?.?.?.?\x92|\x93.?.?.?.?.?.?.?.?\x93|\x94.?.?.?.?.?.?.?.?\x94|\x95.?.?.?.?.?.?.?.?\x95|\x96.?.?.?.?.?.?.?.?\x96|\x97.?.?.?.?.?.?.?.?\x97|\x98.?.?.?.?.?.?.?.?\x98|\x99.?.?.?.?.?.?.?.?\x99|\x9a.?.?.?.?.?.?.?.?\x9a|\x9b.?.?.?.?.?.?.?.?\x9b|\x9c.?.?.?.?.?.?.?.?\x9c|\x9d.?.?.?.?.?.?.?.?\x9d|\x9e.?.?.?.?.?.?.?.?\x9e|\x9f.?.?.?.?.?.?.?.?\x9f|\xa0.?.?.?.?.?.?.?.?\xa0|\xa1.?.?.?.?.?.?.?.?\xa1|\xa2.?.?.?.?.?.?.?.?\xa2|\xa3.?.?.?.?.?.?.?.?\xa3|\xa4.?.?.?.?.?.?.?.?\xa4|\xa5.?.?.?.?.?.?.?.?\xa5|\xa6.?.?.?.?.?.?.?.?\xa6|\xa7.?.?.?.?.?.?.?.?\xa7|\xa8.?.?.?.?.?.?.?.?\xa8|\xa9.?.?.?.?.?.?.?.?\xa9|\xaa.?.?.?.?.?.?.?.?\xaa|\xab.?.?.?.?.?.?.?.?\xab|\xac.?.?.?.?.?.?.?.?\xac|\xad.?.?.?.?.?.?.?.?\xad|\xae.?.?.?.?.?.?.?.?\xae|\xaf.?.?.?.?.?.?.?.?\xaf|\xb0.?.?.?.?.?.?.?.?\xb0|\xb1.?.?.?.?.?.?.?.?\xb1|\xb2.?.?.?.?.?.?.?.?\xb2|\xb3.?.?.?.?.?.?.?.?\xb3|\xb4.?.?.?.?.?.?.?.?\xb4|\xb5.?.?.?.?.?.?.?.?\xb5|\xb6.?.?.?.?.?.?.?.?\xb6|\xb7.?.?.?.?.?.?.?.?\xb7|\xb8.?.?.?.?.?.?.?.?\xb8|\xb9.?.?.?.?.?.?.?.?\xb9|\xba.?.?.?.?.?.?.?.?\xba|\xbb.?.?.?.?.?.?.?.?\xbb|\xbc.?.?.?.?.?.?.?.?\xbc|\xbd.?.?.?.?.?.?.?.?\xbd|\xbe.?.?.?.?.?.?.?.?\xbe|\xbf.?.?.?.?.?.?.?.?\xbf|\xc0.?.?.?.?.?.?.?.?\xc0|\xc1.?.?.?.?.?.?.?.?\xc1|\xc2.?.?.?.?.?.?.?.?\xc2|\xc3.?.?.?.?.?.?.?.?\xc3|\xc4.?.?.?.?.?.?.?.?\xc4|\xc5.?.?.?.?.?.?.?.?\xc5|\xc6.?.?.?.?.?.?.?.?\xc6|\xc7.?.?.?.?.?.?.?.?\xc7|\xc8.?.?.?.?.?.?.?.?\xc8|\xc9.?.?.?.?.?.?.?.?\xc9|\xca.?.?.?.?.?.?.?.?\xca|\xcb.?.?.?.?.?.?.?.?\xcb|\xcc.?.?.?.?.?.?.?.?\xcc|\xcd.?.?.?.?.?.?.?.?\xcd|\xce.?.?.?.?.?.?.?.?\xce|\xcf.?.?.?.?.?.?.?.?\xcf|\xd0.?.?.?.?.?.?.?.?\xd0|\xd1.?.?.?.?.?.?.?.?\xd1|\xd2.?.?.?.?.?.?.?.?\xd2|\xd3.?.?.?.?.?.?.?.?\xd3|\xd4.?.?.?.?.?.?.?.?\xd4|\xd5.?.?.?.?.?.?.?.?\xd5|\xd6.?.?.?.?.?.?.?.?\xd6|\xd7.?.?.?.?.?.?.?.?\xd7|\xd8.?.?.?.?.?.?.?.?\xd8|\xd9.?.?.?.?.?.?.?.?\xd9|\xda.?.?.?.?.?.?.?.?\xda|\xdb.?.?.?.?.?.?.?.?\xdb|\xdc.?.?.?.?.?.?.?.?\xdc|\xdd.?.?.?.?.?.?.?.?\xdd|\xde.?.?.?.?.?.?.?.?\xde|\xdf.?.?.?.?.?.?.?.?\xdf|\xe0.?.?.?.?.?.?.?.?\xe0|\xe1.?.?.?.?.?.?.?.?\xe1|\xe2.?.?.?.?.?.?.?.?\xe2|\xe3.?.?.?.?.?.?.?.?\xe3|\xe4.?.?.?.?.?.?.?.?\xe4|\xe5.?.?.?.?.?.?.?.?\xe5|\xe6.?.?.?.?.?.?.?.?\xe6|\xe7.?.?.?.?.?.?.?.?\xe7|\xe8.?.?.?.?.?.?.?.?\xe8|\xe9.?.?.?.?.?.?.?.?\xe9|\xea.?.?.?.?.?.?.?.?\xea|\xeb.?.?.?.?.?.?.?.?\xeb|\xec.?.?.?.?.?.?.?.?\xec|\xed.?.?.?.?.?.?.?.?\xed|\xee.?.?.?.?.?.?.?.?\xee|\xef.?.?.?.?.?.?.?.?\xef|\xf0.?.?.?.?.?.?.?.?\xf0|\xf1.?.?.?.?.?.?.?.?\xf1|\xf2.?.?.?.?.?.?.?.?\xf2|\xf3.?.?.?.?.?.?.?.?\xf3|\xf4.?.?.?.?.?.?.?.?\xf4|\xf5.?.?.?.?.?.?.?.?\xf5|\xf6.?.?.?.?.?.?.?.?\xf6|\xf7.?.?.?.?.?.?.?.?\xf7|\xf8.?.?.?.?.?.?.?.?\xf8|\xf9.?.?.?.?.?.?.?.?\xf9|\xfa.?.?.?.?.?.?.?.?\xfa|\xfb.?.?.?.?.?.?.?.?\xfb|\xfc.?.?.?.?.?.?.?.?\xfc|\xfd.?.?.?.?.?.?.?.?\xfd|\xfe.?.?.?.?.?.?.?.?\xfe|\xff.?.?.?.?.?.?.?.?\xff)
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/iptables/files/l7/skypetoskype.pat buildroot/package/iptables/files/l7/skypetoskype.pat
--- buildroot.orig/package/iptables/files/l7/skypetoskype.pat	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/iptables/files/l7/skypetoskype.pat	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,14 @@
+# Skype to Skype - UDP voice call (program to program) - http://skype.com
+# Pattern attributes: ok veryfast fast overmatch
+# Protocol groups: voip p2p proprietary
+# Wiki: http://www.protocolinfo.org/wiki/Skype
+# Copyright (C) 2008 Matthew Strait, Ethan Sommer; See ../LICENSE
+
+# This matches at least some of the general chatter that occurs when the
+# user isn't doing anything as well as actual calls.
+# Thanks to Myles Uyema, mylesuyema AT gmail.com
+
+skypetoskype
+# require at least 16 bytes (my limited tests always get at least 18)
+^..\x02.............
+
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/iptables/files/l7/soulseek.pat buildroot/package/iptables/files/l7/soulseek.pat
--- buildroot.orig/package/iptables/files/l7/soulseek.pat	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/iptables/files/l7/soulseek.pat	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,17 @@
+# Soulseek - P2P filesharing - http://slsknet.org
+# Pattern attributes: good fast fast
+# Protocol groups: p2p
+# Wiki: http://www.protocolinfo.org/wiki/Soulseek
+# Copyright (C) 2008 Matthew Strait, Ethan Sommer; See ../LICENSE
+#
+# All my tests show that this pattern is fast, but one user has reported that
+# it is slow.  Your milage may vary.
+
+# This has been tested and works for "pierce firewall" commands and file
+# transfers.  It does *not* match all the various sorts of chatter that go on, 
+# such as searches, pings and whatnot.
+
+soulseek
+# (Pierce firewall: in theory the token could be 4 bytes, but the last two 
+# seem to always be zero.|download: Peer Init)
+^(\x05..?|.\x01.[ -~]+\x01F..?.?.?.?.?.?.?)$
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/iptables/files/l7/teamspeak.pat buildroot/package/iptables/files/l7/teamspeak.pat
--- buildroot.orig/package/iptables/files/l7/teamspeak.pat	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/iptables/files/l7/teamspeak.pat	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,15 @@
+# TeamSpeak - VoIP application - http://goteamspeak.com
+# Pattern attributes: good veryfast fast
+# Protocol groups: voip proprietary
+# Wiki: http://www.protocolinfo.org/wiki/TeamSpeak
+# Copyright (C) 2008 Matthew Strait, Ethan Sommer; See ../LICENSE
+#
+# This pattern has been tested by Matthew Strait and verified by packet
+# traces by at least two other people.  The meaning of f4b303 is not
+# known, but it seems to appear in all first packets.  This pattern only
+# matches the actual UDP voice traffic, not the TeamSpeak web interface
+# or "TCP query".
+
+teamspeak
+^\xf4\xbe\x03.*teamspeak
+
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/iptables/files/l7/tor.pat buildroot/package/iptables/files/l7/tor.pat
--- buildroot.orig/package/iptables/files/l7/tor.pat	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/iptables/files/l7/tor.pat	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,17 @@
+# Tor - The Onion Router - used for anonymization - http://tor.eff.org
+# Pattern attributes: good notsofast notsofast
+# Protocol groups: networking
+# Wiki: http://protocolinfo.org/wiki/Tor
+# Copyright (C) 2008 Matthew Strait, Ethan Sommer; See ../LICENSE
+#
+# This pattern has been tested and is believed to work well.
+#
+# It matches on the second packet.  I have no idea how the protocol
+# works, but this matches every stream I have made using Tor 0.1.0.16 as
+# a client on Linux.
+#
+# It does NOT attempt to match the HTTP request that fetches the list of
+# Tor servers.
+
+tor
+TOR1.*<identity>
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/iptables/Makefile buildroot/package/iptables/Makefile
--- buildroot.orig/package/iptables/Makefile	2010-09-24 22:19:19.000000000 -0400
+++ buildroot/package/iptables/Makefile	2010-09-24 22:27:13.000000000 -0400
@@ -89,7 +89,7 @@
 
 define Package/iptables-mod-filter
 $(call Package/iptables/Module, +kmod-ipt-filter)
-  TITLE:=Content inspection extensions
+  TITLE:=filter modules
 endef
 
 define Package/iptables-mod-filter/description
@@ -133,7 +133,7 @@
 
 define Package/iptables-mod-ipsec
 $(call Package/iptables/Module, +kmod-ipt-ipsec)
-  TITLE:=IPsec extensions
+  TITLE:=IPSec extensions
 endef
 
 define Package/iptables-mod-ipsec/description
@@ -204,7 +204,7 @@
 
 define Package/iptables-mod-iprange
 $(call Package/iptables/Module, +kmod-ipt-iprange)
-  TITLE:=IP range extension
+  TITLE:=ip range module
 endef
 
 define Package/iptables-mod-iprange/description
@@ -334,6 +334,13 @@
 endef
 
 define Package/iptables/install
+	$(INSTALL_DIR) $(1)/etc
+	$(INSTALL_DATA) ./files/firewall.config $(1)/etc/
+	$(INSTALL_DIR) $(1)/etc/init.d
+	$(INSTALL_BIN) ./files/firewall.init $(1)/etc/init.d/firewall
+	$(INSTALL_BIN) ./files/firewall.user $(1)/etc/
+	$(INSTALL_DIR) $(1)/usr/lib
+	$(INSTALL_DATA) ./files/firewall.awk $(1)/usr/lib
 	$(INSTALL_DIR) $(1)/usr/sbin
 	$(INSTALL_BIN) $(PKG_INSTALL_DIR)/usr/sbin/iptables $(1)/usr/sbin/
 	$(INSTALL_DIR) $(1)/usr/lib/iptables
@@ -402,7 +409,6 @@
 $(eval $(call BuildPackage,iptables))
 $(eval $(call BuildPackage,iptables-utils))
 $(eval $(call BuildPlugin,iptables-mod-conntrack,$(IPT_CONNTRACK-m)))
-$(eval $(call BuildPlugin,iptables-mod-conntrack-extra,$(IPT_CONNTRACK_EXTRA-m)))
 $(eval $(call BuildPlugin,iptables-mod-extra,$(IPT_EXTRA-m)))
 $(eval $(call BuildPlugin,iptables-mod-filter,$(IPT_FILTER-m),$(L7_INSTALL)))
 $(eval $(call BuildPlugin,iptables-mod-imq,$(IPT_IMQ-m)))
@@ -410,7 +416,6 @@
 $(eval $(call BuildPlugin,iptables-mod-ipsec,$(IPT_IPSEC-m)))
 $(eval $(call BuildPlugin,iptables-mod-ipset,ipt_set ipt_SET))
 $(eval $(call BuildPlugin,iptables-mod-nat,$(IPT_NAT-m)))
-$(eval $(call BuildPlugin,iptables-mod-nat-extra,$(IPT_NAT_EXTRA-m)))
 $(eval $(call BuildPlugin,iptables-mod-iprange,$(IPT_IPRANGE-m)))
 $(eval $(call BuildPlugin,iptables-mod-ulog,$(IPT_ULOG-m)))
 $(eval $(call BuildPlugin,iptables-mod-hashlimit,$(IPT_HASHLIMIT-m)))
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/kernel/modules/usb.mk buildroot/package/kernel/modules/usb.mk
--- buildroot.orig/package/kernel/modules/usb.mk	2010-09-24 22:19:22.000000000 -0400
+++ buildroot/package/kernel/modules/usb.mk	2010-09-24 22:29:56.000000000 -0400
@@ -169,7 +169,7 @@
   KCONFIG:=CONFIG_USB_EHCI_HCD \
     CONFIG_USB_EHCI_AR71XX=y
   FILES:=$(LINUX_DIR)/drivers/usb/host/ehci-hcd.ko
-  AUTOLOAD:=$(call AutoLoad,40,ehci-hcd,1)
+  AUTOLOAD:=$(call AutoLoad,50,ehci-hcd,1)
   $(call AddDepends/usb)
 endef
 
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/libusb/Makefile buildroot/package/libusb/Makefile
--- buildroot.orig/package/libusb/Makefile	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/libusb/Makefile	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,72 @@
+#
+# Copyright (C) 2006-2008 OpenWrt.org
+#
+# This is free software, licensed under the GNU General Public License v2.
+# See /LICENSE for more information.
+#
+# $Id: Makefile 12966 2008-10-13 15:42:09Z nbd $
+
+include $(TOPDIR)/rules.mk
+
+PKG_NAME:=libusb
+PKG_VERSION:=0.1.12
+PKG_RELEASE:=1
+
+PKG_SOURCE:=$(PKG_NAME)-$(PKG_VERSION).tar.gz
+PKG_SOURCE_URL:=@SF/libusb
+PKG_MD5SUM:=caf182cbc7565dac0fd72155919672e6
+PKG_FIXUP:=libtool
+
+include $(INCLUDE_DIR)/package.mk
+
+PKG_INSTALL=1
+
+define Package/libusb
+  SECTION:=libs
+  CATEGORY:=Libraries
+  TITLE:=A library for accessing Linux USB devices
+  URL:=http://libusb.sourceforge.net/
+endef
+
+define Build/Configure
+	$(call Build/Configure/Default, \
+		--enable-shared \
+		--enable-static \
+	)
+endef
+
+TARGET_CFLAGS += $(FPIC)
+
+define Build/InstallDev
+	$(INSTALL_DIR) $(2)/bin
+	$(INSTALL_BIN) \
+		$(PKG_INSTALL_DIR)/usr/bin/libusb-config \
+		$(2)/bin/
+	$(SED) \
+		's,^\(prefix\|exec_prefix\)=.*,\1=$(STAGING_DIR)/usr,g' \
+		$(2)/bin/libusb-config
+
+	$(INSTALL_DIR) $(1)/usr/include
+	$(INSTALL_DATA) \
+		$(PKG_INSTALL_DIR)/usr/include/usb.h \
+		$(1)/usr/include/
+
+	$(INSTALL_DIR) $(1)/usr/lib
+	$(INSTALL_DATA) \
+		$(PKG_INSTALL_DIR)/usr/lib/libusb*.{la,so*,a} \
+		$(1)/usr/lib/
+
+	$(INSTALL_DIR) $(1)/usr/lib/pkgconfig
+	$(INSTALL_DATA) \
+		$(PKG_INSTALL_DIR)/usr/lib/pkgconfig/libusb.pc \
+		$(1)/usr/lib/pkgconfig/
+endef
+
+define Package/libusb/install
+	$(INSTALL_DIR) $(1)/usr/lib
+	$(INSTALL_DATA) \
+		$(PKG_INSTALL_DIR)/usr/lib/libusb*.so.* \
+		$(1)/usr/lib/
+endef
+
+$(eval $(call BuildPackage,libusb))
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/libusb/patches/001-no_libusbpp.patch buildroot/package/libusb/patches/001-no_libusbpp.patch
--- buildroot.orig/package/libusb/patches/001-no_libusbpp.patch	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/libusb/patches/001-no_libusbpp.patch	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,106 @@
+--- libusb-0.1.12/Makefile.in.old	2007-01-04 16:36:50.000000000 -0700
++++ libusb-0.1.12/Makefile.in	2007-01-04 16:42:55.000000000 -0700
+@@ -17,7 +17,7 @@
+ 
+ 
+ 
+-SOURCES = $(libusb_la_SOURCES) $(libusbpp_la_SOURCES)
++SOURCES = $(libusb_la_SOURCES)
+ 
+ srcdir = @srcdir@
+ top_srcdir = @top_srcdir@
+@@ -73,8 +73,8 @@
+ am_libusb_la_OBJECTS = usb.lo error.lo descriptors.lo $(am__objects_1)
+ libusb_la_OBJECTS = $(am_libusb_la_OBJECTS)
+ libusbpp_la_LIBADD =
+-am_libusbpp_la_OBJECTS = usbpp.lo
+-libusbpp_la_OBJECTS = $(am_libusbpp_la_OBJECTS)
++am_libusbpp_la_OBJECTS =
++libusbpp_la_OBJECTS =
+ binSCRIPT_INSTALL = $(INSTALL_SCRIPT)
+ SCRIPTS = $(bin_SCRIPTS)
+ DEFAULT_INCLUDES = 
+@@ -82,8 +82,7 @@
+ am__depfiles_maybe = depfiles
+ @AMDEP_TRUE@DEP_FILES = ./$(DEPDIR)/bsd.Plo ./$(DEPDIR)/darwin.Plo \
+ @AMDEP_TRUE@	./$(DEPDIR)/descriptors.Plo ./$(DEPDIR)/error.Plo \
+-@AMDEP_TRUE@	./$(DEPDIR)/linux.Plo ./$(DEPDIR)/usb.Plo \
+-@AMDEP_TRUE@	./$(DEPDIR)/usbpp.Plo
++@AMDEP_TRUE@	./$(DEPDIR)/linux.Plo ./$(DEPDIR)/usb.Plo
+ COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
+ 	$(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)
+ LTCOMPILE = $(LIBTOOL) --mode=compile $(CC) $(DEFS) \
+@@ -100,8 +99,8 @@
+ CXXLD = $(CXX)
+ CXXLINK = $(LIBTOOL) --mode=link $(CXXLD) $(AM_CXXFLAGS) $(CXXFLAGS) \
+ 	$(AM_LDFLAGS) $(LDFLAGS) -o $@
+-SOURCES = $(libusb_la_SOURCES) $(libusbpp_la_SOURCES)
+-DIST_SOURCES = $(am__libusb_la_SOURCES_DIST) $(libusbpp_la_SOURCES)
++SOURCES = $(libusb_la_SOURCES)
++DIST_SOURCES = $(am__libusb_la_SOURCES_DIST)
+ RECURSIVE_TARGETS = all-recursive check-recursive dvi-recursive \
+ 	html-recursive info-recursive install-data-recursive \
+ 	install-exec-recursive install-info-recursive \
+@@ -256,7 +255,7 @@
+ # require automake 1.4
+ # gnu strictness chokes on README being autogenerated
+ AUTOMAKE_OPTIONS = 1.4 foreign
+-SUBDIRS = . tests doc
++SUBDIRS = .
+ AM_CFLAGS = -Werror $(AM_CFLAGS_EXT)
+ configincludedir = $(pkglibdir)/include
+ bin_SCRIPTS = libusb-config
+@@ -265,7 +264,7 @@
+              apidocs/footer.html apidocs/doxygen.css apidocs/doxygen.png libusb.pc.in
+ 
+ EXTRA_libusb_la_SOURCE = linux.c linux.h bsd.c darwin.c
+-lib_LTLIBRARIES = libusb.la libusbpp.la
++lib_LTLIBRARIES = libusb.la
+ pkgconfig_DATA = libusb.pc
+ @BSD_API_FALSE@@DARWIN_API_FALSE@@LINUX_API_FALSE@OS_SUPPORT = 
+ @BSD_API_FALSE@@DARWIN_API_TRUE@@LINUX_API_FALSE@OS_SUPPORT = darwin.c
+@@ -278,25 +277,19 @@
+ AM_CPPFLAGS = -I.
+ AM_CXXFLAGS = 
+ libusb_la_SOURCES = usb.c usbi.h error.c error.h descriptors.c $(OS_SUPPORT)
+-libusbpp_la_SOURCES = usbpp.cpp usbpp.h
++libusbpp_la_SOURCES =
+ libusbpp_la_DEPENDENCIES = libusb.la
+ 
+ # Do not add usb.h to *_SOURCES, regardless of dependencies.
+ # It would be added to the dist tarball, which it shouldn't be.
+ nodist_include_HEADERS = usb.h
+-include_HEADERS = usbpp.h
++include_HEADERS =
+ libusb_la_LDFLAGS = \
+ 	-version-info $(LT_CURRENT):$(LT_REVISION):$(LT_AGE) \
+ 	-release $(LT_RELEASE) \
+ 	-export-dynamic \
+ 	$(LDADDS) $(PREBIND_FLAGS)
+ 
+-libusbpp_la_LDFLAGS = \
+-	-version-info $(LT_CURRENT):$(LT_REVISION):$(LT_AGE) \
+-	-release $(LT_RELEASE) \
+-	-export-dynamic \
+-	$(LDADDS) -lusb $(PREBIND_FLAGSPP)
+-
+ all: config.h
+ 	$(MAKE) $(AM_MAKEFLAGS) all-recursive
+ 
+@@ -395,8 +388,6 @@
+ 	done
+ libusb.la: $(libusb_la_OBJECTS) $(libusb_la_DEPENDENCIES) 
+ 	$(LINK) -rpath $(libdir) $(libusb_la_LDFLAGS) $(libusb_la_OBJECTS) $(libusb_la_LIBADD) $(LIBS)
+-libusbpp.la: $(libusbpp_la_OBJECTS) $(libusbpp_la_DEPENDENCIES) 
+-	$(CXXLINK) -rpath $(libdir) $(libusbpp_la_LDFLAGS) $(libusbpp_la_OBJECTS) $(libusbpp_la_LIBADD) $(LIBS)
+ install-binSCRIPTS: $(bin_SCRIPTS)
+ 	@$(NORMAL_INSTALL)
+ 	test -z "$(bindir)" || $(mkdir_p) "$(DESTDIR)$(bindir)"
+@@ -429,7 +420,6 @@
+ @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/error.Plo@am__quote@
+ @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/linux.Plo@am__quote@
+ @AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/usb.Plo@am__quote@
+-@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/usbpp.Plo@am__quote@
+ 
+ .c.o:
+ @am__fastdepCC_TRUE@	if $(COMPILE) -MT $@ -MD -MP -MF "$(DEPDIR)/$*.Tpo" -c -o $@ $<; \
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/mini_httpd/files/mini_httpd.conf buildroot/package/mini_httpd/files/mini_httpd.conf
--- buildroot.orig/package/mini_httpd/files/mini_httpd.conf	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/mini_httpd/files/mini_httpd.conf	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,7 @@
+cgipat=cgi-bin/**|**.sh
+dir=/www
+nochroot
+pidfile=/var/run/mini_httpd.pid
+user=root
+ssl
+certfile=/etc/mini_httpd/server.pem
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/mini_httpd/Makefile buildroot/package/mini_httpd/Makefile
--- buildroot.orig/package/mini_httpd/Makefile	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/mini_httpd/Makefile	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,178 @@
+#
+# Copyright (C) 2006 OpenWrt.org
+#
+# This is free software, licensed under the GNU General Public License v2.
+# See /LICENSE for more information.
+#
+# $Id: Makefile 9116 2007-10-04 10:09:28Z nico $
+
+include $(TOPDIR)/rules.mk
+
+PKG_NAME:=mini-httpd
+PKG_VERSION:=1.19
+PKG_RELEASE:=1
+
+PKG_SOURCE:=mini_httpd-$(PKG_VERSION).tar.gz
+PKG_SOURCE_URL:=http://www.acme.com/software/mini_httpd/
+PKG_MD5SUM:=792a529dfe974355aad8ba6c80e54e7a
+
+PKG_BUILD_DIR:=$(BUILD_DIR)/mini_httpd-$(PKG_VERSION)
+
+include $(INCLUDE_DIR)/package.mk
+
+define Package/mini-httpd/Default
+  SUBMENU:=Web
+  SECTION:=net
+  CATEGORY:=Network
+  TITLE:=A small web server
+  URL:=http://www.acme.com/software/mini_httpd/
+endef
+
+define Package/mini-httpd/Default/conffiles
+/etc/mini_httpd.conf
+endef
+
+define Package/mini-httpd/Default/description
+ mini_httpd is a small HTTP server. Its performance is not great, but for 
+ low or medium traffic sites it's quite adequate. It implements all the 
+ basic features of an HTTP server, including: 
+ - GET, HEAD, and POST methods
+ - CGI
+ - Basic authentication
+ - Security against ".." filename snooping
+ - The common MIME types
+ - Trailing-slash redirection
+ - index.html, index.htm, index.cgi
+ - Directory listings
+ - Multihoming / virtual hosting
+ - Standard logging
+ - Custom error pages
+ It can also be configured to do IPv6.
+endef
+
+define Package/mini-httpd
+$(call Package/mini-httpd/Default)
+endef
+
+define Package/mini-httpd/conffiles
+$(call Package/mini-httpd/Default/conffiles)
+endef
+
+define Package/mini-httpd/description
+$(call Package/mini-httpd/Default/description)
+endef
+
+define Package/mini-httpd-matrixssl
+$(call Package/mini-httpd/Default)
+  DEPENDS:= +libmatrixssl
+  TITLE+= (built with MatrixSSL)
+endef
+
+define Package/mini-httpd-matrixssl/conffiles
+$(call Package/mini-httpd/Default/conffiles)
+endef
+
+define Package/mini-httpd-matrixssl/description
+$(call Package/mini-httpd/Default/description)
+ This package is built with SSL/HTTPS using MatrixSSL.
+endef
+
+define Package/mini-httpd-openssl
+$(call Package/mini-httpd/Default)
+  DEPENDS:= +libopenssl
+  TITLE+= (built with OpenSSL)
+endef
+
+define Package/mini-httpd-openssl/conffiles
+$(call Package/mini-httpd/Default/conffiles)
+endef
+
+define Package/mini-httpd-openssl/description
+$(call Package/mini-httpd/Default/description)
+ This package is built with SSL/HTTPS using OpenSSL.
+endef
+
+define Package/mini-httpd-htpasswd
+  $(call Package/mini-httpd/Default)
+  TITLE:=Utility to generate HTTP access files
+endef
+
+define Package/mini-httpd-htpasswd/description
+$(call Package/mini-httpd/Default/description)
+ This package generates .htaccess/.htpasswd files to use HTTP access authentication.
+endef
+
+
+define Build/Template
+
+$(STAMP_BUILT)-$(2): $(STAMP_PREPARED)
+	-$(MAKE) -C $(PKG_BUILD_DIR) clean
+	$(MAKE) -C $(PKG_BUILD_DIR) \
+		$(TARGET_CONFIGURE_OPTS) \
+		OFLAGS="$(TARGET_CFLAGS)" \
+		$(3) \
+		all
+	( cd $(PKG_BUILD_DIR); mv -f mini_httpd mini_httpd-$(2) )
+	touch $$@
+
+$(STAMP_BUILT): $(STAMP_BUILT)-$(2)
+
+define Package/$(1)/install
+	$(INSTALL_DIR) $$(1)/etc
+ifeq ($(2),without-ssl)
+	$(INSTALL_DATA) ./files/mini_httpd.conf $$(1)/etc/mini_httpd.conf
+else
+	$(INSTALL_DATA) ./files/mini_httpd.conf $$(1)/etc/mini_httpd.conf
+endif
+	$(INSTALL_DIR) $$(1)/etc/default
+	$(INSTALL_DIR) $$(1)/usr/sbin
+	$(INSTALL_BIN) $(PKG_BUILD_DIR)/mini_httpd-$(2) $$(1)/usr/sbin/mini_httpd
+endef
+
+endef
+
+
+define Build/Configure
+endef
+
+define Build/Compile
+endef
+
+# always build without SSL because we might need htpassd
+define Build/without-ssl
+  $(call Build/Template,mini-httpd,without-ssl,)
+endef
+$(eval $(Build/without-ssl))
+
+ifneq ($(SDK)$(CONFIG_PACKAGE_mini-httpd-matrixssl),)
+  define Build/with-matrixssl
+    $(call Build/Template,mini-httpd-matrixssl,with-matrixssl, \
+		SSL_DEFS="-DUSE_SSL -DHAVE_MATRIXSSL" \
+		SSL_INC="$(TARGET_CPPFLAGS)" \
+		SSL_LIBS="$(TARGET_LDFLAGS) -lmatrixssl" \
+		SSL_OBJS="matrixssl_helper.o" \
+    )
+  endef
+endif
+$(eval $(Build/with-matrixssl))
+
+ifneq ($(SDK)$(CONFIG_PACKAGE_mini-httpd-openssl),)
+  define Build/with-openssl
+    $(call Build/Template,mini-httpd-openssl,with-openssl, \
+		SSL_DEFS="-DUSE_SSL -DHAVE_OPENSSL" \
+		SSL_INC="$(TARGET_CPPFLAGS)" \
+		SSL_LIBS="$(TARGET_LDFLAGS) -lcrypto -lssl" \
+    )
+  endef
+endif
+$(eval $(Build/with-openssl))
+
+define Package/mini-httpd-htpasswd/install
+	$(INSTALL_DIR) $(1)/usr/sbin
+	$(INSTALL_BIN) $(PKG_BUILD_DIR)/htpasswd $(1)/usr/sbin/
+endef
+
+$(eval $(call BuildPackage,mini-httpd))
+$(eval $(call BuildPackage,mini-httpd-matrixssl))
+$(eval $(call BuildPackage,mini-httpd-openssl))
+$(eval $(call BuildPackage,mini-httpd-htpasswd))
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/mini_httpd/patches/001-cgi_path.patch buildroot/package/mini_httpd/patches/001-cgi_path.patch
--- buildroot.orig/package/mini_httpd/patches/001-cgi_path.patch	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/mini_httpd/patches/001-cgi_path.patch	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,16 @@
+diff -ruN mini_httpd-1.19-old/mini_httpd.c mini_httpd-1.19-new/mini_httpd.c
+--- mini_httpd-1.19-old/mini_httpd.c	2005-10-19 01:11:24.000000000 +0200
++++ mini_httpd-1.19-new/mini_httpd.c	2005-10-19 01:13:05.000000000 +0200
+@@ -138,10 +138,10 @@
+ #define CGI_NICE 10
+ #endif /* CGI_NICE */
+ #ifndef CGI_PATH
+-#define CGI_PATH "/usr/local/bin:/usr/ucb:/bin:/usr/bin"
++#define CGI_PATH "/usr/bin:/bin:/usr/sbin:/sbin"
+ #endif /* CGI_PATH */
+ #ifndef CGI_LD_LIBRARY_PATH
+-#define CGI_LD_LIBRARY_PATH "/usr/local/lib:/usr/lib"
++#define CGI_LD_LIBRARY_PATH "/usr/lib:/lib"
+ #endif /* CGI_LD_LIBRARY_PATH */
+ #ifndef AUTH_FILE
+ #define AUTH_FILE ".htpasswd"
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/mini_httpd/patches/002-realm.patch buildroot/package/mini_httpd/patches/002-realm.patch
--- buildroot.orig/package/mini_httpd/patches/002-realm.patch	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/mini_httpd/patches/002-realm.patch	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,10 @@
+--- mini_httpd-1.19-old/mini_httpd.c	2005-06-29 13:31:17.000000000 -0400
++++ mini_httpd-1.19-new/mini_httpd.c	2008-11-19 23:51:31.000000000 -0500
+@@ -2299,6 +2299,7 @@
+ send_authenticate( char* realm )
+     {
+     char header[10000];
++    realm = "PacketProtector";
+ 
+     (void) snprintf(
+ 	header, sizeof(header), "WWW-Authenticate: Basic realm=\"%s\"", realm );
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/ntpclient/files/ntpclient.config buildroot/package/ntpclient/files/ntpclient.config
--- buildroot.orig/package/ntpclient/files/ntpclient.config	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/ntpclient/files/ntpclient.config	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,22 @@
+config ntpserver
+	option hostname '0.openwrt.pool.ntp.org'
+	option port     '123'
+
+config ntpserver
+	option hostname '1.openwrt.pool.ntp.org'
+	option port     '123'
+
+config ntpserver
+	option hostname '2.openwrt.pool.ntp.org'
+	option port     '123'
+
+config ntpserver
+	option hostname '3.openwrt.pool.ntp.org'
+	option port     '123'
+
+config ntpdrift
+	option freq     '0'
+
+config ntpclient
+	option interval	60
+	#option count	10
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/ntpclient/files/ntpclient.hotplug buildroot/package/ntpclient/files/ntpclient.hotplug
--- buildroot.orig/package/ntpclient/files/ntpclient.hotplug	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/ntpclient/files/ntpclient.hotplug	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,65 @@
+#!/bin/sh
+# Copyright (C) 2006 OpenWrt.org
+
+. /etc/functions.sh
+
+unset SERVER
+unset PORT
+unset INTERVAL
+unset COUNT
+NTPC=`which ntpclient`
+
+check_server() {
+	local hostname
+	local port
+	[ -n "$SERVER" ] && return
+	config_get hostname $1 hostname
+	config_get port $1 port
+	[ -z "$hostname" ] && return
+	$NTPC -c 1 -p ${port:-123} -h $hostname > /dev/null && { SERVER=$hostname; PORT=${port:-123}; }
+}
+
+set_drift() {
+	config_get freq $1 freq
+	[ -n "$freq" ] && adjtimex -f $freq >/dev/null
+}
+
+start_ntpclient() {
+	config_foreach set_drift ntpdrift
+	config_foreach check_server ntpserver
+	[ -z "$SERVER" ] && exit 0
+	logger starting ntpclient
+	$NTPC ${COUNT:+-c $COUNT} ${INTERVAL:+-i $INTERVAL} -s -l -D -p $PORT -h $SERVER 2> /dev/null
+}
+
+stop_ntpclient() {
+	logger stopping ntpclient
+	killall ntpclient
+}
+
+load_settings() {
+	local interval
+	local count
+	local iface
+	
+	config_get interval $1 interval
+	config_get count $1 count
+	
+	[ -n "$count" ] && COUNT=$count
+	[ -n "$interval" ] && INTERVAL=$interval
+}
+
+config_load ntpclient
+config_foreach load_settings ntpclient
+
+DEF_ROUTE=`route -n | grep '^0.0.0.0'`
+NTP_RUNNING=`ps  | grep $NTPC | grep -v grep`
+
+case "${ACTION:-ifup}" in
+	ifup)
+		[ -n "$DEF_ROUTE" -a -z "$NTP_RUNNING" ] && start_ntpclient 
+	;;
+	ifdown)
+		[ -n "$NTP_RUNNING" ] && stop_ntpclient 
+	;;
+esac
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/ntpclient/Makefile buildroot/package/ntpclient/Makefile
--- buildroot.orig/package/ntpclient/Makefile	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/ntpclient/Makefile	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,49 @@
+#
+# Copyright (C) 2006 OpenWrt.org
+#
+# This is free software, licensed under the GNU General Public License v2.
+# See /LICENSE for more information.
+#
+# $Id: Makefile 12305 2008-08-14 12:03:55Z blogic $
+
+include $(TOPDIR)/rules.mk
+
+PKG_NAME:=ntpclient
+PKG_VERSION:=2007_365
+PKG_RELEASE:=1
+
+PKG_SOURCE:=$(PKG_NAME)_$(PKG_VERSION).tar.gz
+PKG_SOURCE_URL:=http://doolittle.icarus.com/ntpclient/
+PKG_MD5SUM:=cb98711f11769cdd22fc592844cef414
+
+PKG_BUILD_DIR:=$(BUILD_DIR)/$(PKG_NAME)-2007
+
+include $(INCLUDE_DIR)/package.mk
+
+define Package/ntpclient
+  SUBMENU:=Time Synchronization
+  SECTION:=net
+  CATEGORY:=Network
+  TITLE:=NTP (Network Time Protocol) client
+  URL:=http://doolittle.icarus.com/ntpclient/
+endef
+
+define Package/ntpclient/description
+	NTP client for setting system time from NTP servers.
+endef
+
+MAKE_FLAGS += \
+	all adjtimex
+
+define Package/ntpclient/install
+	$(INSTALL_DIR) $(1)/etc/hotplug.d/iface
+	$(INSTALL_DATA) ./files/ntpclient.hotplug $(1)/etc/hotplug.d/iface/20-ntpclient
+	$(INSTALL_DIR) $(1)/etc/config
+	$(INSTALL_CONF) ./files/ntpclient.config $(1)/etc/config/ntpclient
+	$(INSTALL_DIR) $(1)/usr/sbin
+	$(INSTALL_BIN) $(PKG_BUILD_DIR)/ntpclient $(1)/usr/sbin/
+	$(INSTALL_BIN) $(PKG_BUILD_DIR)/adjtimex $(1)/usr/sbin/
+	$(INSTALL_BIN) $(PKG_BUILD_DIR)/rate.awk $(1)/usr/sbin/
+endef
+
+$(eval $(call BuildPackage,ntpclient))
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/ntpclient/patches/100-daemon.patch buildroot/package/ntpclient/patches/100-daemon.patch
--- buildroot.orig/package/ntpclient/patches/100-daemon.patch	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/ntpclient/patches/100-daemon.patch	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,24 @@
+Index: ntpclient-2007/ntpclient.c
+===================================================================
+--- ntpclient-2007.orig/ntpclient.c	2008-08-12 03:11:34.000000000 +0200
++++ ntpclient-2007/ntpclient.c	2008-08-12 03:11:36.000000000 +0200
+@@ -614,7 +614,7 @@
+ 	ntpc.cross_check=1;
+ 
+ 	for (;;) {
+-		c = getopt( argc, argv, "c:" DEBUG_OPTION "f:g:h:i:lp:q:" REPLAY_OPTION "st");
++		c = getopt( argc, argv, "c:" DEBUG_OPTION "f:g:h:i:lp:q:" REPLAY_OPTION "stD");
+ 		if (c == EOF) break;
+ 		switch (c) {
+ 			case 'c':
+@@ -663,6 +663,10 @@
+ 				(ntpc.cross_check)=0;
+ 				break;
+ 
++			case 'D':
++				daemon();
++				break;
++
+ 			default:
+ 				usage(argv[0]);
+ 				exit(1);
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/usbutils/Makefile buildroot/package/usbutils/Makefile
--- buildroot.orig/package/usbutils/Makefile	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/usbutils/Makefile	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,52 @@
+#
+# Copyright (C) 2007 OpenWrt.org
+#
+# This is free software, licensed under the GNU General Public License v2.
+# See /LICENSE for more information.
+#
+# $Id: Makefile 12173 2008-08-05 22:02:15Z florian $
+
+include $(TOPDIR)/rules.mk
+
+PKG_NAME:=usbutils
+PKG_VERSION:=0.73
+PKG_RELEASE:=1
+
+PKG_SOURCE:=$(PKG_NAME)-$(PKG_VERSION).tar.gz
+PKG_SOURCE_URL:=@SF/linux-usb
+PKG_MD5SUM:=88978b4ad891f610620b1b8e5e0f43eb
+
+PKG_BUILD_DEPENDS:=zlib
+
+include $(INCLUDE_DIR)/package.mk
+
+define Package/usbutils
+  SECTION:=utils
+  CATEGORY:=Utilities
+  DEPENDS:=+libusb +zlib
+  TITLE:=USB devices listing utilities
+  URL:=http://linux-usb.sourceforge.net/
+endef
+
+define Package/usbutils/postinst
+#!/bin/sh
+$${IPKG_INSTROOT}/usr/sbin/update-usbids.sh
+endef
+
+# uses GNU configure
+
+define Build/Compile
+	$(MAKE) -C $(PKG_BUILD_DIR) \
+		DESTDIR="$(PKG_INSTALL_DIR)" \
+		all install
+endef
+
+define Package/usbutils/install
+	$(INSTALL_DIR) $(1)/usr/sbin
+	$(INSTALL_BIN) $(PKG_INSTALL_DIR)/usr/sbin/lsusb $(1)/usr/sbin/
+	$(INSTALL_BIN) $(PKG_BUILD_DIR)/update-usbids.sh $(1)/usr/sbin/
+	$(INSTALL_DIR) $(1)/usr/share
+	$(INSTALL_DATA) $(PKG_INSTALL_DIR)/usr/share/usb.ids.gz $(1)/usr/share/
+endef
+
+$(eval $(call BuildPackage,usbutils))
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/etc/config/webif buildroot/package/webif/files/etc/config/webif
--- buildroot.orig/package/webif/files/etc/config/webif	2010-09-24 22:20:29.000000000 -0400
+++ buildroot/package/webif/files/etc/config/webif	2010-09-24 22:27:13.000000000 -0400
@@ -1,6 +1,6 @@
 config webif general
 	option lang "en"
-	option firmware_name ""
+	option firmware_name "PacketProtector"
 	option firmware_version ""
 	option firmware_subtitle "With X-Wrt Extensions"
 	option device_name ""
@@ -8,7 +8,7 @@
 	option firstboot	"1"
 
 config webif theme
-	option id "clubman"
+	option id "xwrt"
 
 config webif qos
 	option show_advanced_rules "0"
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/etc/httpd.conf buildroot/package/webif/files/etc/httpd.conf
--- buildroot.orig/package/webif/files/etc/httpd.conf	2010-09-24 22:20:29.000000000 -0400
+++ buildroot/package/webif/files/etc/httpd.conf	1969-12-31 19:00:00.000000000 -0500
@@ -1,9 +0,0 @@
-/cgi-bin/webif/:root:$p$root
-/cgi-bin/webif/:admin:$p$root
-.asp:text/html
-.svg:image/svg+xml
-.png:image/png
-.gif:image/gif
-.jpg:image/jpg
-.js:application/x-javascript
-
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/etc/init.d/webif buildroot/package/webif/files/etc/init.d/webif
--- buildroot.orig/package/webif/files/etc/init.d/webif	2010-09-24 22:20:29.000000000 -0400
+++ buildroot/package/webif/files/etc/init.d/webif	2010-09-24 22:27:13.000000000 -0400
@@ -128,24 +128,7 @@
 	firmware_subtitle=$CONFIG_general_firmware_subtitle
 	firmware_version=$CONFIG_general_firmware_version
 
-	if grep -qi "KAMIKAZE" "/etc/banner"; then
-		firmware_name="OpenWrt Kamikaze"
-	elif grep -qi "BackFire" "/etc/banner"; then
-		firmware_name="OpenWrt BackFire"
-	else
-		firmware_name="Unknown Wrt"
-	fi	
-	firmware_subtitle="With X-Wrt Extensions"
-
-	if [ -f "/etc/openwrt_version" ]; then
-		firmware_version=$(cat "/etc/openwrt_version")
-	elif grep -q "KAMIKAZE" "/etc/banner"; then
-		firmware_version=$(cat /etc/banner |grep KAMIKAZE |cut -d '(' -f 2 |cut -d ')' -f 1)
-	elif grep -q "BackFire" "/etc/banner"; then
-		firmware_version=$(cat /etc/banner |grep BackFire |cut -d '(' -f 2 |cut -d ')' -f 1)
-	else
-		firmware_version="unknown"
-	fi
+	firmware_subtitle="with X-Wrt Extensions"
 
 	if [ "$CONFIG_general_firstboot" = "1" ]; then
 		opkg update
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/usr/lib/webif/apply.sh buildroot/package/webif/files/usr/lib/webif/apply.sh
--- buildroot.orig/package/webif/files/usr/lib/webif/apply.sh	2010-09-24 22:20:29.000000000 -0400
+++ buildroot/package/webif/files/usr/lib/webif/apply.sh	2010-09-24 22:27:13.000000000 -0400
@@ -27,6 +27,7 @@
 HANDLERS_file='
 	hosts) rm -f /etc/hosts; mv $config /etc/hosts; killall -HUP dnsmasq ;;
 	ethers) rm -f /etc/ethers; mv $config /etc/ethers; killall -HUP dnsmasq ;;
+	firewall) mv /tmp/.webif/file-firewall /etc/firewall.config && /etc/init.d/firewall restart && reload_upnpd;;
 	dnsmasq.conf) mv /tmp/.webif/file-dnsmasq.conf /etc/dnsmasq.conf && /etc/init.d/dnsmasq restart;;
 	httpd.conf) mv -f /tmp/.webif/file-httpd.conf /etc/httpd.conf && HTTP_RESTART=1 ;;
 '
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/usr/lib/webif/functions.sh buildroot/package/webif/files/usr/lib/webif/functions.sh
--- buildroot.orig/package/webif/files/usr/lib/webif/functions.sh	2010-09-24 22:20:29.000000000 -0400
+++ buildroot/package/webif/files/usr/lib/webif/functions.sh	2010-09-24 22:27:13.000000000 -0400
@@ -135,14 +135,14 @@
 	# emit output to std devices.
 	echo "@TR<<Installing package>>..."
 	local retval
-	opkg -force-overwrite install "$@" | sed 's/&/\&amp;/; s/"/\&#34;/; s/'\''/\&#39;/; s/\$/\&#36;/; s/</\&lt;/; s/>/\&gt;/; s/\\/\&#92;/; s/|/\&#124;/;'
+	opkg -d root -force-overwrite install "$@" | sed 's/&/\&amp;/; s/"/\&#34;/; s/'\''/\&#39;/; s/\$/\&#36;/; s/</\&lt;/; s/>/\&gt;/; s/\\/\&#92;/; s/|/\&#124;/;'
 	retval="$?"
 	[ "$retval" != "0" ] && {
 		! equal "$(echo "$1" | grep -q ":\/\/")" "0" && {
 			# wasn't a URL, so update
 			echo "@TR<<Refreshing outdated packages lists>>..."
 			opkg update
-			opkg -force-overwrite -force-defaults install "$@"
+			opkg -force-overwrite install "$@"
 			retval="$?"
 		}
 	}
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/usr/lib/webif/webif.sh buildroot/package/webif/files/usr/lib/webif/webif.sh
--- buildroot.orig/package/webif/files/usr/lib/webif/webif.sh	2010-09-24 22:20:29.000000000 -0400
+++ buildroot/package/webif/files/usr/lib/webif/webif.sh	2010-09-24 22:27:13.000000000 -0400
@@ -312,7 +312,7 @@
 $_endform
 <hr />
 <div id="footer">
-	<h3>X-Wrt</h3>
+	<h3>PacketProtector</h3>
 	<em>@TR<<making_usable#End user extensions for OpenWrt>></em>
 </div>
 </div> <!-- End #container -->
@@ -325,7 +325,8 @@
 apply_passwd() {
 	case ${SERVER_SOFTWARE%% *} in
 		mini_httpd/*)
-			grep '^root:' /etc/passwd | cut -d: -f1,2 > $cgidir/.htpasswd
+			grep '^root:' /etc/shadow | cut -d: -f1,2 > $cgidir/.htpasswd
+			chmod 600 $cgidir/.htpasswd
 			killall -HUP mini_httpd
 			;;
 	esac
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/cgi-bin/webif/.categories buildroot/package/webif/files/www/cgi-bin/webif/.categories
--- buildroot.orig/package/webif/files/www/cgi-bin/webif/.categories	2010-09-24 22:20:28.000000000 -0400
+++ buildroot/package/webif/files/www/cgi-bin/webif/.categories	2010-09-24 22:27:13.000000000 -0400
@@ -1,5 +1,4 @@
 ##WEBIF:category:Info
-##WEBIF:category:Graphs
 ##WEBIF:category:Status
 ##WEBIF:category:Log
 ##WEBIF:category:-
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/cgi-bin/webif/info.sh buildroot/package/webif/files/www/cgi-bin/webif/info.sh
--- buildroot.orig/package/webif/files/www/cgi-bin/webif/info.sh	2010-09-24 22:20:28.000000000 -0400
+++ buildroot/package/webif/files/www/cgi-bin/webif/info.sh	2010-09-24 22:27:13.000000000 -0400
@@ -70,6 +70,12 @@
 	echo "</pre><br />"
 }
 
+#check for default password hash
+PASSWORD=`grep root /etc/shadow | cut -d: -f2`
+if [ $PASSWORD = "\$1\$\$3PU5jOpctFwuSGxWSJxAn0" ] ; then
+	echo "<h1><b>Default password hash found!  Please <a href='/cgi-bin/webif/users.sh'>change your password</a> (USB drive required).</b></h1><br/><br/>"
+fi
+
 cat <<EOF
 <table summary="System Information">
 <tbody>
@@ -110,19 +116,6 @@
 </tbody>
 </table>
 
-<form action="" enctype="multipart/form-data" method="post">
-<table summary="Update webif">
-<tbody>
-	<tr>
-		<td colspan="2">
-		<input type="submit" value=" @TR<<info_check_update#Check For Webif Update>> " name="update_check" />
-		$upgrade_button
-		</td>
-	</tr>
-</tbody>
-</table>
-</form>
-
 EOF
 
 footer
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/cgi-bin/webif/network-firewall.sh buildroot/package/webif/files/www/cgi-bin/webif/network-firewall.sh
--- buildroot.orig/package/webif/files/www/cgi-bin/webif/network-firewall.sh	2010-09-24 22:20:28.000000000 -0400
+++ buildroot/package/webif/files/www/cgi-bin/webif/network-firewall.sh	1969-12-31 19:00:00.000000000 -0500
@@ -1,483 +0,0 @@
-#!/usr/bin/webif-page
-<?
-. /usr/lib/webif/webif.sh
-###################################################################
-# Firewall configuration
-#
-# Description:
-#	Firewall configuration.
-#
-# Author(s) [in order of work date]:
-#	Original webif authors.
-#	Travis Kemen	<kemen04@gmail.com>
-# Major revisions:
-#
-# UCI variables referenced:
-#
-# Configuration files referenced:
-#	firewall
-#
-
-#remove rule
-if ! empty "$FORM_remove_vcfg"; then
-	uci_remove "firewall" "$FORM_remove_vcfg"
-fi
-#The following check needs to remain or we have no good way of knowing if a rule should be added.
-[ -z "$FORM_port_select_rule" ] && FORM_port_select_rule=custom
-#Add new rules
-if [ -n "$FORM_port_rule" -o "$FORM_port_select_rule" != "custom" ]; then
-	validate <<EOF
-string|FORM_name|@TR<<Name>>|nospaces|$FORM_name
-ip|FORM_src_ip_rule|@TR<<Source IP Address>>||$FORM_src_ip_rule
-ip|FORM_dest_ip_rule|@TR<<Destination IP Address>>||$FORM_dest_ip_rule
-ports|FORM_port_rule|@TR<<Destination Port>>||$FORM_port_rule
-EOF
-	equal "$?" 0 && {
-		[ "$FORM_port_select_rule" != "custom" ] && FORM_port_rule="$FORM_port_select_rule"
-		uci_add firewall rule "$FORM_name"; add_rule_cfg="$CONFIG_SECTION"
-		uci_set firewall "$add_rule_cfg" proto "$FORM_protocol_rule"
-		uci_set firewall "$add_rule_cfg" src "$FORM_src_rule"
-		uci_set firewall "$add_rule_cfg" dest "$FORM_dest_rule"
-		uci_set firewall "$add_rule_cfg" src_ip "$FORM_src_ip_rule"
-		uci_set firewall "$add_rule_cfg" dest_ip "$FORM_dest_ip_rule"
-		uci_set firewall "$add_rule_cfg" dest_port "$FORM_port_rule"
-		uci_set firewall "$add_rule_cfg" target "$FORM_target_rule"
-		unset FORM_port_rule FORM_dest_ip_rule FORM_src_ip_rule FORM_protocol_rule FORM_name FORM_src FORM_dest
-		FORM_port_select_rule=custom
-		FORM_src=wan
-	}
-fi
-if [ -n "$FORM_dest_ip_redirect" ]; then
-	validate <<EOF
-string|FORM_name_redirect|@TR<<Name>>|nospaces|$FORM_name_redirect
-ip|FORM_src_ip_redirect|@TR<<Source IP Address>>||$FORM_src_ip_redirect
-ports|FORM_src_dport_redirect|@TR<<Destination Port>>|required|$FORM_src_dport_redirect
-ip|FORM_dest_ip_redirect|@TR<<To IP Address>>|required|$FORM_dest_ip_redirect
-ports|FORM_dest_port_redirect|@TR<<To Port>>||$FORM_dest_port_redirect
-EOF
-	equal "$?" 0 && {
-		[ "$FORM_port_select_redirect" != "custom" ] && FORM_port_rule="$FORM_port_select_redirect"
-		uci_add firewall redirect "$FORM_name_redirect"; add_redirect_cfg="$CONFIG_SECTION"
-		uci_set firewall "$add_redirect_cfg" src wan
-		uci_set firewall "$add_redirect_cfg" proto "$FORM_protocol_redirect"
-		uci_set firewall "$add_redirect_cfg" src_ip "$FORM_src_ip_redirect"
-		uci_set firewall "$add_redirect_cfg" src_dport "$FORM_src_dport_redirect"
-		uci_set firewall "$add_redirect_cfg" dest_ip "$FORM_dest_ip_redirect"
-		[ "$FORM_dest_port_redirect" = "" -a "0" != "$(echo "$FORM_src_dport_redirect" |grep -q "-" -e ":";echo "$?")" ] && FORM_dest_port_redirect="$FORM_src_dport_redirect"
-		uci_set firewall "$add_redirect_cfg" dest_port "$FORM_dest_port_redirect"
-		unset FORM_dest_port_redirect FORM_dest_ip_redirect FORM_src_dport_redirect FORM_src_ip_redirect FORM_protocol_redirect FORM_name_redirect
-		FORM_port_select_redirect=custom
-	}
-fi
-if [ -n "$FORM_add_rule_add" ]; then
-	uci_add firewall forwarding ""; add_forward_cfg="$CONFIG_SECTION"
-	uci_set firewall "$add_forward_cfg" src "$FORM_src_add"
-	uci_set firewall "$add_forward_cfg" dest "$FORM_dest_add"
-fi
-config_cb() {
-	local cfg_type="$1"
-	local cfg_name="$2"
-
-	case "$cfg_type" in
-		forwarding)
-			append forwarding_cfgs "$cfg_name"
-		;;
-		zone)
-			append zone_cfgs "$cfg_name" "$N"
-		;;
-		rule)
-			append rule_cfgs "$cfg_name" "$N"
-		;;
-		redirect)
-			append redirect_cfgs "$cfg_name" "$N"
-		;;
-		interface)
-			if [ "$cfg_name" != "loopback" ]; then
-				append networks "option|$cfg_name" "$N"
-			fi
-		;;
-	esac
-}
-cur_color="odd"
-get_tr() {
-	if equal "$cur_color" "odd"; then
-		cur_color="even"
-		tr="string|<tr>"
-	else
-		cur_color="odd"
-		tr="string|<tr class=\"odd\">"
-	fi
-}
-
-uci_load firewall
-uci_load network
-append forms "start_form|@TR<<Forwarding Configuration>>" "$N"
-for zone in $forwarding_cfgs; do
-	eval FORM_remove="\$FORM_remove_rule_$zone"
-	if [ "$FORM_remove" != "" ]; then
-		uci_remove firewall "$zone"
-	fi
-	if [ "$FORM_submit" = "" -o "$add_forward_cfg" = "$zone" ]; then
-		config_get FORM_src "$zone" src
-		config_get FORM_dest "$zone" dest
-	else
-		eval FORM_src="\$FORM_src_$zone"
-		eval FORM_dest="\$FORM_dest_$zone"
-		eval FORM_mss="\$FORM_mss_$zone"
-		uci_set firewall "$zone" src "$FORM_src"
-		uci_set firewall "$zone" dest "$FORM_dest"
-	fi
-	if [ "$FORM_remove" = "" ]; then
-		form="field|@TR<<Allow traffic originating from>>
-			select|src_$zone|$FORM_src
-			$networks
-			string|@TR<<to>>
-			select|dest_$zone|$FORM_dest
-			$networks
-			submit|remove_rule_$zone|@TR<<Remove Rule>>"
-		append forms "$form" "$N"
-	fi
-done
-form="field|@TR<<Allow traffic originating from>>
-	select|src_add
-	$networks
-	string|@TR<<to>>
-	select|dest_add
-	$networks
-	submit|add_rule_add|@TR<<Add Rule>>
-	end_form"
-append forms "$form" "$N"
-
-for zone in $zone_cfgs; do
-	if [ "$FORM_submit" = "" ]; then
-		config_get FORM_name $zone name
-		config_get FORM_input $zone input
-		config_get FORM_output $zone output
-		config_get FORM_forward $zone forward
-		config_get_bool FORM_masq $zone masq 0
-		config_get_bool FORM_mtu_fix $zone mtu_fix 0
-	else
-		config_get FORM_name $zone name
-		eval FORM_input="\$FORM_input_$zone"
-		eval FORM_output="\$FORM_output_$zone"
-		eval FORM_forward="\$FORM_forward_$zone"
-		eval FORM_masq="\$FORM_masq_$zone"
-		eval FORM_mtu_fix="\$FORM_mtu_fix_$zone"
-
-	fi
-	form="start_form|@TR<<$FORM_name Zone Settings>>
-		field|@TR<<Input>>
-		select|input_$zone|$FORM_input
-		option|ACCEPT|@TR<<Accept>>
-		option|REJECT|@TR<<Reject>>
-		option|DROP|@TR<<Drop>>
-		field|@TR<<Output>>
-		select|output_$zone|$FORM_output
-		option|ACCEPT|@TR<<Accept>>
-		option|REJECT|@TR<<Reject>>
-		option|DROP|@TR<<Drop>>
-		field|@TR<<Forward>>
-		select|forward_$zone|$FORM_forward
-		option|ACCEPT|@TR<<Accept>>
-		option|REJECT|@TR<<Reject>>
-		option|DROP|@TR<<Drop>>
-		field|@TR<<NAT>>
-		checkbox|masq_$zone|$FORM_masq|1
-		field|@TR<<MTU Fix>>
-		checkbox|mtu_fix_$zone|$FORM_mtu_fix|1
-		end_form"
-	append forms "$form" "$N"
-done
-
-get_tr
-form="string|<div class=\"settings\">
-	string|<h3><strong>@TR<<Incoming Ports>></strong></h3>
-	string|<table style=\"width: 90%; margin-left: 2.5em; text-align: left; font-size: 0.8em;\" border=\"0\" cellpadding=\"3\" cellspacing=\"2\" summary=\"@TR<<Incomimg Ports>>\">
-	$tr
-	string|<th>@TR<<Name>></th>
-	string|<th>@TR<<Source>></th>
-	string|<th>@TR<<Destination>></th>
-	string|<th>@TR<<Protocol>></th>
-	string|<th>@TR<<Source IP>></th>
-	string|<th>@TR<<Destination IP>></th>
-	string|<th>@TR<<Port>></th>
-	string|</tr>"
-append forms "$form" "$N"
-for rule in $rule_cfgs; do
-	if [ "$FORM_submit" = "" -o "$add_rule_cfg" = "$rule" ]; then
-		config_get FORM_src "$rule" src "wan"
-		config_get FORM_dest "$rule" dest
-		config_get FORM_protocol "$rule" proto
-		config_get FORM_src_ip "$rule" src_ip
-		config_get FORM_dest_ip "$rule" dest_ip
-		config_get FORM_target "$rule" target "ACCEPT"
-		config_get FORM_port "$rule" dest_port
-		FORM_port_select_rule=custom
-	else
-		eval FORM_src="\$FORM_src_$rule"
-		eval FORM_dest="\$FORM_dest_$rule"
-		eval FORM_protocol="\$FORM_protocol_$rule"
-		eval FORM_src_ip="\$FORM_src_ip_$rule"
-		eval FORM_dest_ip="\$FORM_dest_ip_$rule"
-		eval FORM_port="\$FORM_port_$rule"
-		eval FORM_target="\$FORM_target_$rule"
-		validate <<EOF
-ip|FORM_src_ip|@TR<<Source IP Address>>||$FORM_src_ip
-ip|FORM_dest_ip|@TR<<Destination IP Address>>||$FORM_dest_ip
-ports|FORM_port|@TR<<Destination Port>>||$FORM_port
-EOF
-		equal "$?" 0 && {
-			uci_set firewall "$rule" src "$FORM_src"
-			uci_set firewall "$rule" dest "$FORM_dest"
-			uci_set firewall "$rule" proto "$FORM_protocol"
-			uci_set firewall "$rule" src_ip "$FORM_src_ip"
-			uci_set firewall "$rule" dest_ip "$FORM_dest_ip"
-			uci_set firewall "$rule" dest_port "$FORM_port"
-			uci_set firewall "$rule" target "$FORM_target"
-		}
-	fi
-
-	echo "$rule" |grep -q "cfg*****" && name="" || name="$rule"
-	get_tr
-	form="$tr
-		string|<td>$name</td>
-		string|<td>
-		select|src_$rule|$FORM_src
-		option||@TR<<Router>>
-		$networks
-		string|</td>
-		string|<td>
-		select|dest_$rule|$FORM_dest
-		option||@TR<<Router>>
-		$networks
-		string|</td>
-		string|<td>
-		select|protocol_$rule|$FORM_protocol
-		option|tcp|TCP
-		option|udp|UDP
-		option|tcpudp|Both
-		option|icmp|ICMP
-		string|</td>
-		string|<td>
-		text|src_ip_$rule|$FORM_src_ip
-		string|</td>
-		string|<td>
-		text|dest_ip_$rule|$FORM_dest_ip
-		string|</td>
-		string|<td>
-		text|port_$rule|$FORM_port
-		string|</td>
-		string|<td>
-		select|target_$rule|$FORM_target
-		option|ACCEPT|@TR<<Accept>>
-		option|DROP|@TR<<Drop>>
-		option|REJECT|@TR<<Reject>>
-		string|</td>
-		string|<td>
-		string|<a href=\"$SCRIPT_NAME?remove_vcfg=$rule\">@TR<<Remove Rule>></a>
-		string|</td>
-		string|</tr>"
-	append forms "$form" "$N"
-done
-get_tr
-form="$tr
-	string|<td>
-	text|name|$FORM_name
-	string|</td>
-	string|<td>
-	select|src_rule|wan
-	option||@TR<<Router>>
-	$networks
-	string|</td>
-	string|<td>
-	select|dest_rule|
-	option||@TR<<Router>>
-	$networks
-	string|</td>
-	string|<td>
-	select|protocol_rule|$FORM_protocol_rule
-	option|tcp|TCP
-	option|udp|UDP
-	option|tcpudp|Both
-	option|icmp|ICMP
-	string|</td>
-	string|<td>
-	text|src_ip_rule|$FORM_src_ip_rule
-	string|</td>
-	string|<td>
-	text|dest_ip_rule|$FORM_dest_ip_rule
-	string|</td>
-	string|<td>
-	select|port_select_rule|$FORM_port_select_rule
-	option|custom|@TR<<Custom>>
-	option|22|SSH
-	option|25|SMTP
-	option|110|POP3
-	option|143|IMAP
-	option|80|HTTP
-	option|443|HTTPS
-	text|port_rule|$FORM_port_rule
-	string|</td>
-	string|<td>
-	select|target_rule|ACCEPT
-	option|ACCEPT|@TR<<Accept>>
-	option|DROP|@TR<<Drop>>
-	option|REJECT|@TR<<Reject>>
-	string|</td>
-	string|<td>
-	string|&nbsp;
-	string|</td>
-	string|</tr>
-	string|</table></div>"
-append forms "$form" "$N"
-
-#PORT Forwarding
-cur_color="odd"
-get_tr
-form="string|<div class=\"settings\">
-	string|<h3><strong>@TR<<Port Forwarding>></strong></h3>
-	string|<table style=\"width: 90%; margin-left: 2.5em; text-align: left; font-size: 0.8em;\" border=\"0\" cellpadding=\"3\" cellspacing=\"2\" summary=\"@TR<<Port Forwarding>>\">
-	$tr
-	string|<th>@TR<<Name>></th>
-	string|<th>@TR<<Protocol>></th>
-	string|<th>@TR<<Source IP>></th>
-	string|<th>@TR<<Destination Port>></th>
-	string|<th>@TR<<To IP Address>></th>
-	string|<th>@TR<<To Port>></th>
-	string|</tr>"
-append forms "$form" "$N"
-
-for rule in $redirect_cfgs; do
-	if [ "$FORM_submit" = "" -o "$add_redirect_cfg" = "$rule" ]; then
-		config_get FORM_protocol "$rule" proto
-		config_get FORM_src_ip "$rule" src_ip
-		config_get FORM_dest_ip "$rule" dest_ip
-		config_get FORM_src_dport "$rule" src_dport
-		config_get FORM_dest_port "$rule" dest_port
-		FORM_port_select_redirect=custom
-	else
-		eval FORM_protocol="\$FORM_protocol_$rule"
-		eval FORM_src_ip="\$FORM_src_ip_$rule"
-		eval FORM_dest_ip="\$FORM_dest_ip_$rule"
-		eval FORM_dest_port="\$FORM_dest_port_$rule"
-		eval FORM_src_dport="\$FORM_src_dport_$rule"
-		validate <<EOF
-ip|FORM_src_ip_rule|@TR<<Source IP Address>>||$FORM_src_ip_rule
-ip|FORM_dest_ip_rule|@TR<<Destination IP Address>>||$FORM_dest_ip_rule
-ports|FORM_src_dport|@TR<<Destination Port>>|required|$FORM_src_dport
-ip|FORM_dest_ip|@TR<<To IP>>|required|$FORM_dest_ip
-ports|FORM_dest_dport|@TR<<To Port>>||$FORM_dest_dport
-EOF
-		equal "$?" 0 && {
-			uci_set firewall "$rule" proto "$FORM_protocol"
-			uci_set firewall "$rule" src_ip "$FORM_src_ip"
-			uci_set firewall "$rule" dest_ip "$FORM_dest_ip"
-			uci_set firewall "$rule" src_dport "$FORM_src_dport"
-			[ "$FORM_dest_port" = "" -a "0" != "$(echo "$FORM_src_dport_redirect" |grep -q "-" -e ":";echo "$?")" ] && FORM_dest_port="$FORM_src_dport"
-			uci_set firewall "$rule" dest_port "$FORM_dest_port"
-		}
-	fi
-
-	echo "$rule" |grep -q "cfg*****" && name="" || name="$rule"
-	get_tr
-	form="$tr
-		string|<td>$name</td>
-		string|<td>
-		select|protocol_$rule|$FORM_protocol
-		option|tcp|TCP
-		option|udp|UDP
-		option|tcpudp|Both
-		string|</td>
-		string|<td>
-		text|src_ip_$rule|$FORM_src_ip
-		string|</td>
-		string|<td>
-		text|src_dport_$rule|$FORM_src_dport
-		string|</td>
-		string|<td>
-		text|dest_ip_$rule|$FORM_dest_ip
-		string|</td>
-		string|<td>
-		text|dest_port_$rule|$FORM_dest_port
-		string|</td>
-		string|<td>
-		string|<a href=\"$SCRIPT_NAME?remove_vcfg=$rule\">@TR<<Remove Rule>></a>
-		string|</td>
-		string|</tr>"
-	append forms "$form" "$N"
-done
-get_tr
-form="$tr
-	string|<td>
-	text|name_redirect|$FORM_name_redirect
-	string|</td>
-	string|<td>
-	select|protocol_redirect|$FORM_protocol_redirect
-	option|tcp|TCP
-	option|udp|UDP
-	option|tcpudp|Both
-	string|</td>
-	string|<td>
-	text|src_ip_redirect|$FORM_src_ip_redirect
-	string|</td>
-	string|<td>
-	text|src_dport_redirect|$FORM_src_dport_redirect
-	string|</td>
-	string|<td>
-	text|dest_ip_redirect|$FORM_dest_ip_redirect
-	string|</td>
-	string|<td>
-	select|port_select_redirect|$FORM_port_select_redirect
-	option|custom|@TR<<Custom>>
-	option|22|SSH
-	option|25|SMTP
-	option|110|POP3
-	option|143|IMAP
-	option|80|HTTP
-	option|443|HTTPS
-	text|dest_port_redirect|$FORM_dest_port_redirect
-	string|</td>
-	string|<td>
-	string|&nbsp;
-	string|</td>
-	string|</tr>
-	string|</table></div>"
-append forms "$form" "$N"
-
-header_inject_head="<script type=\"text/javascript\" src=\"/webif.js\"></script>"
-
-header "Network" "Firewall" "@TR<<Firewall>>" 'onload="modechange()" onkeydown="return processKey(event)"' "$SCRIPT_NAME"
-#####################################################################
-# modechange script
-#
-cat <<EOF
-<script type="text/javascript">
-<!--
-function modechange()
-{
-	var v;
-	$js
-
-	v = (isset('port_select_rule','custom'));
-	set_visible('port_rule', v);
-	v = (isset('port_select_redirect','custom'));
-	set_visible('port_redirect', v);
-
-	hide('save');
-	show('save');
-}
--->
-</script>
-
-EOF
-
-display_form <<EOF
-onchange|modechange
-$validate_error
-$forms
-EOF
-
-footer ?>
-<!--
-##WEBIF:name:Network:415:Firewall
--->
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/cgi-bin/webif/network-qos.sh buildroot/package/webif/files/www/cgi-bin/webif/network-qos.sh
--- buildroot.orig/package/webif/files/www/cgi-bin/webif/network-qos.sh	2010-09-24 22:20:28.000000000 -0400
+++ buildroot/package/webif/files/www/cgi-bin/webif/network-qos.sh	1969-12-31 19:00:00.000000000 -0500
@@ -1,491 +0,0 @@
-#!/usr/bin/webif-page
-<?
-###################################################################
-# qos-scripts configuration page
-# (c)2007 X-Wrt project (http://www.x-wrt.org)
-# (c)2007 Jeremy Collake
-#
-# Description:
-#	Configures the qos-scripts package.
-#
-# Author(s) [in order of work date]:
-#	Jeremy Collake <jeremy.collake@gmail.com>
-#
-# Major revisions:
-#
-# NVRAM variables referenced:
-#   none
-#
-# Configuration files referenced:
-#   /etc/config/qos
-#
-#
-. /usr/lib/webif/webif.sh
-
-header "Network" "QoS" "@TR<<QOS Configuration>>" ' onload="modechange()" ' "$SCRIPT_NAME"
-
-if ! empty "$FORM_install_nbd"; then
-	echo "@TR<<qos_installing#Installing Nbd's QoS scripts>> ...<pre>"
-	install_package qos-scripts
-	echo "</pre>"
-fi
-
-is_package_installed "qos-re" && {
-	echo "<div class=\"warning\">@TR<<qos_found_rudys#Rudy's QoS scripts are found installed. Be sure to uninstall Rudy's scripts before using the new qos-scripts package.>></div>"
-}
-
-# TODO: move this to shared functions somewhere
-# set an option, or remove it if the value is empty
-uci_set_value_remove_if_empty() {
-	local _package="$1"
-	local _config="$2"
-	local _option="$3"
-	local _value="$4"
-	if ! empty "$_value"; then
-		uci_set "$_package" "$_config" "$_option" "$_value"
-	else
-		uci_remove "$_package" "$_config" "$_option"
-	fi
-}
-
-#########################################################################################
-# if qos-scripts installed ... (encapsulates most of remainder)
-#
-if is_package_installed "qos-scripts"; then
-
-uci_load "webif"
-
-#
-# if form submit, then ...
-# else ...
-#
-! empty "$FORM_submit" && empty "$FORM_install_nbd" && {
-	current_qos_item="$FORM_current_rule_index"
-	! empty "$current_qos_item" && {
-		# for validation purposes, replace non-numeric stuff in
-		# ports list and port range with integer.
-		ports_validate=$(echo "$FORM_current_ports" | sed s/','/'0'/g)
-		portrange_validate=$(echo "$FORM_current_portrange" | sed s/'-'/'0'/g)
-validate <<EOF
-int|ports_validate|@TR<<Port Listing>>||$ports_validate
-int|portrange_validate|@TR<<Port Range>>||$portrange_validate
-ip|FORM_current_srchost|@TR<<Source IP>>||$FORM_current_srchost
-ip|FORM_current_dsthost|@TR<<Dest IP>>||$FORM_current_dsthost
-EOF
-		if ! equal "$?" "0"; then
-			echo "<div class=\"warning\">@TR<<qos_validation_failed#Validation of one or more fields failed! Not saving.>></div>"
-		else
-			SAVED=1
-			uci_set "qos" "$current_qos_item" "target" "$FORM_current_target"
-			uci_set_value_remove_if_empty "qos" "$current_qos_item" "srchost" "$FORM_current_srchost"
-			uci_set_value_remove_if_empty "qos" "$current_qos_item" "dsthost" "$FORM_current_dsthost"
-			uci_set_value_remove_if_empty "qos" "$current_qos_item" "proto" "$FORM_current_proto"
-			uci_set_value_remove_if_empty "qos" "$current_qos_item" "ports" "$FORM_current_ports"
-			uci_set_value_remove_if_empty "qos" "$current_qos_item" "portrange" "$FORM_current_portrange"
-			uci_set_value_remove_if_empty "qos" "$current_qos_item" "layer7" "$FORM_current_layer7"
-			uci_set_value_remove_if_empty "qos" "$current_qos_item" "ipp2p" "$FORM_current_ipp2p"
-			uci_set_value_remove_if_empty "qos" "$current_qos_item" "mark" "$FORM_current_mark"
-			uci_set_value_remove_if_empty "qos" "$current_qos_item" "tcpflags" "$FORM_current_tcpflags"
-			uci_set_value_remove_if_empty "qos" "$current_qos_item" "pktsize" "$FORM_current_pktsize"
-		fi
-	}
-
-	validate <<EOF
-int|FORM_wan_dowload|@TR<<WAN Download Speed>>||$FORM_wan_download
-int|FORM_wan_upload|@TR<<WAN Upload Speed>>||$FORM_wan_upload
-EOF
-	equal "$?" "0" && {
-		SAVED=1
-		uci_load qos # to check existing variables
-		! equal "$FORM_wan_enabled" "$CONFIG_wan_enabled" && {
-		 	uci_set "qos" "wan" "enabled" "$FORM_wan_enabled"
-		}
-		! equal "FORM_wan_overhead" "$CONFIG_wan_overhead" && {
-			uci_set "qos" "wan" "overhead" "$FORM_wan_overhead"
-		}
-		! empty "$FORM_wan_download" && ! equal "$FORM_wan_download" "$CONFIG_wan_download" && {
-			uci_set "qos" "wan" "download" "$FORM_wan_download"
-		}
-		! empty "$FORM_wan_upload" && ! equal "$FORM_wan_upload" "$CONFIG_wan_upload" && {
-			uci_set "qos" "wan" "upload" "$FORM_wan_upload"
-		}
-		! empty "$FORM_webif_advanced" && ! equal "$FORM_webif_advanced" "$CONFIG_qos_show_advanced_rules" && {
-			uci_set "webif" "qos" "show_advanced_rules" "$FORM_webif_advanced"
-		}
-	}
-}
-
-#
-# handle 'add new rule'
-#
-! empty "$FORM_qos_add" && {
-	# todo: this add needs to be in the save area, causes instant save here	of
-	#       an empty rule here. However, requires more work than a simple move ;).
-	uci_add "qos" "classify" ""
-}
-
-#
-# handle 'remove' (qos rule)
-#
-! empty "$FORM_qos_remove" && {
-	current_qos_item=$(echo "$QUERY_STRING" | grep "qos_remove=" | cut -d'=' -f2)
-	! empty "$current_qos_item" && {
-		# also manually clear the other options so they are immediately empty
-		uci_remove "qos" "$current_qos_item"
-	}
-}
-
-# copy a rule to another - used by swap_rule()
-copy_rule()
-{
-	local section_src=$1
-	local section_dest=$2
-	local _target
-	local _srchost
-	local _dsthost
-	local _proto
-	local _ports
-	local _portrange
-	local _layer7
-	local _ipp2p
-	local _mark
-	local _tcpflags
-	local _pktsize
-	config_get _target "${section_dest}" "target"
-	config_get _srchost "${section_dest}" "srchost"
-	config_get _dsthost "${section_dest}" "dsthost"
-	config_get _proto "${section_dest}" "proto"
-	config_get _ports "${section_dest}" "ports"
-	config_get _portrange "${section_dest}" "portrange"
-	config_get _layer7 "${section_dest}" "layer7"
-	config_get _ipp2p "${section_dest}" "ipp2p"
-	config_get _mark "${section_dest}" "mark"
-	config_get _tcpflags "${section_dest}" "tcpflags"
-	config_get _pktsize "${section_dest}" "pktsize"
-	uci_set_value_remove_if_empty "qos" "$section_src" "target" "$_target"
-	uci_set_value_remove_if_empty "qos" "$section_src" "srchost" "$_srchost"
-	uci_set_value_remove_if_empty "qos" "$section_src" "dsthost" "$_dsthost"
-	uci_set_value_remove_if_empty "qos" "$section_src" "proto" "$_proto"
-	uci_set_value_remove_if_empty "qos" "$section_src" "layer7" "$_layer7"
-	uci_set_value_remove_if_empty "qos" "$section_src" "ipp2p" "$_ipp2p"
-	uci_set_value_remove_if_empty "qos" "$section_src" "ports" "$_ports"
-	uci_set_value_remove_if_empty "qos" "$section_src" "portrange" "$_portrange"
-	uci_set_value_remove_if_empty "qos" "$section_src" "mark" "$_mark"
-	uci_set_value_remove_if_empty "qos" "$section_src" "tcpflags" "$_tcpflags"
-	uci_set_value_remove_if_empty "qos" "$section_src" "pktsize" "$_pktsize"
-}
-
-# swap a rule with another - for up/down
-swap_rule()
-{
-	local section_src=$1
-	local section_dest=$2
-	copy_rule "$1" "$2"
-	copy_rule "$2" "$1"
-	# now a uci_load will reload swapped rules
-}
-
-#
-# handle 'up' or 'down' (qos rule)
-#
-! empty "$FORM_qos_swap_dest" && ! empty "$FORM_qos_swap_src" && {
-	uci_load "qos"
-	swap_rule "$FORM_qos_swap_dest" "$FORM_qos_swap_src"
-}
-
-#
-# show advanced
-#
-FORM_webif_advanced=${FORM_webif_advanced:-$CONFIG_qos_show_advanced_rules}
-
-#
-# load qos-scripts config
-#
-uci_load "qos"
-
-FORM_wan_enabled="$CONFIG_wan_enabled"
-FORM_wan_download="$CONFIG_wan_download"
-FORM_wan_upload="$CONFIG_wan_upload"
-FORM_wan_overhead="$CONFIG_wan_overhead"
-
-######################################################################
-cat <<EOF
-<script type="text/javascript" src="/webif.js"></script>
-<script type="text/javascript">
-
-function modechange()
-{
-	if(isset('wan_enabled','1'))
-	{
-		document.getElementById('wan_upload').disabled = false;
-		document.getElementById('wan_download').disabled = false;
-	}
-	else
-	{
-		document.getElementById('wan_upload').disabled = true;
-		document.getElementById('wan_download').disabled = true;
-	}
-}
-</script>
-EOF
-######################################################################
-
-display_form <<EOF
-onchange|modechange
-start_form|@TR<<QoS Options>>
-field|@TR<<QoS Service>>|field_n_enabled
-select|wan_enabled|$FORM_wan_enabled
-option|1|@TR<<qos_enabled#Enabled>>
-option|0|@TR<<qos_disabled#Disabled>>
-field|@TR<<QoS Overhead Calculation>>|field_wan_overhead
-select|wan_overhead|$FORM_wan_overhead
-option|1|@TR<<qos_overhead_enabled#Enabled>>
-option|0|@TR<<qos_overhead_disabled#Disabled>>
-field|@TR<<WAN Upload Speed>>|field_n_wan_upload
-text|wan_upload|$FORM_wan_upload| @TR<<kilobits>>
-helpitem|Maximum Upload/Download
-helptext|HelpText Maximum Upload#Your maximum sustained upload and download speeds, in kilobits.
-field|@TR<<WAN Download Speed>>|field_n_wan_download
-text|wan_download|$FORM_wan_download| @TR<<kilobits>>
-field|@TR<<Show Advanced Rules>>|field_webif_advanced
-select|webif_advanced|$FORM_webif_advanced
-option|1|@TR<<qos_adv_enabled#Enabled>>
-option|0|@TR<<qos_adv_disabled#Disabled>>
-helpitem|Advanced
-helptext|HelpText Advanced#Normally users just use the form below to configure QoS. Some people may need access to the more advanced settings. Alternatively, you can <a href="./system-editor.sh?path=/etc/config&amp;edit=qos">manually edit the config</a>.
-end_form
-EOF
-
-# show the current ruleset in a table
-cat <<EOF
-<div class="settings">
-<h3><strong>@TR<<QoS Traffic Classification Rules>></strong></h3>
-<table style="width: 90%; margin-left: 2.5em; text-align: left; font-size: 0.8em;" border="0" cellpadding="3" cellspacing="2" summary="QoS Traffic Classification Rules">
-<tbody>
-<tr>
-<th>@TR<<Group>></th>
-EOF
-equal "$FORM_webif_advanced" "1" && {
-	cat <<EOF
-	<th>@TR<<Type>></th>
-EOF
-}
-cat <<EOF
-<th>@TR<<Source IP>></th>
-<th>@TR<<Dest. IP>></th>
-<th>@TR<<Protocol>></th>
-<th>@TR<<Layer-7>></th>
-<th>@TR<<Port range>></th>
-<th>@TR<<Ports>></th>
-EOF
-equal "$FORM_webif_advanced" "1" && {
-	cat <<EOF
-	<th>@TR<<Flags>></th>
-	<th>@TR<<PktSize>></th>
-	<th>@TR<<Mark>></th>
-EOF
-}
-cat <<EOF
-<th></th>
-</tr>
-EOF
-
-# outputs variable to a column
-show_column()
-{
-	# section name
-	# option name
-	# over-ride text (if config option is empty)
-	local _val
-	# config_get returns TYPE if OPTION ($2) is empty, else returns value
-	config_get _val "$1" "$2"
-	echo "<td>${_val:-$4}</td>"
-}
-
-#
-# callback for sections
-#
-local last_shown_rule="-1"
-callback_foreach_rule() {
-	local section_name=$1
-	config_get _type "$section_name" "TYPE"
-	case $_type in
-		"classify") ;;
-		"reclassify") equal "$FORM_webif_advanced" "0" && return;;
-		"default") equal "$FORM_webif_advanced" "0" && return;;
-		*) return;;
-	esac
-	## finishing previous table entry
-	# for 'down' since we didn't know index of next classify item.
-	# if there is a last shown rule, show 'up' option for PREVIOUS rule
-	! equal "$last_shown_rule" "-1" && {
-		echo "<a href=\"$SCRIPT_NAME?qos_swap_dest=$section_name&amp;qos_swap_src=$last_shown_rule\"><img alt=\"@TR<<down>>\" src=\"/images/down.gif\" title=\"@TR<<down>>\" /></a>"
-		echo "</td></tr>"
-	}
-	## end finishing last iteration
-	if equal "$cur_color" "odd"; then
-		cur_color="even"
-		echo "<tr>"
-	else
-		cur_color="odd"
-		echo "<tr class=\"$cur_color\">"
-	fi
-	show_column "$section_name" "target" "" "..."
-	equal "$FORM_webif_advanced" "1" && show_column "$section_name" "TYPE" "" ""
-	show_column "$section_name" "srchost" ""
-	show_column "$section_name" "dsthost" ""
-	eval _val="\"\$CONFIG_${section_name}_ipp2p\""
-	if empty "$_val"; then
-	 	show_column "$section_name" "proto" ""
-	else
-		equal "$_val" "all" && _val="peer-2-peer"
-		show_column "$section_name" "proto" "" "$_val"
-	fi
-	show_column "$section_name" "layer7" ""
-	show_column "$section_name" "portrange" ""
-	show_column "$section_name" "ports" ""
-	equal "$FORM_webif_advanced" "1" && show_column "$section_name" "tcpflags" "" ""
-	equal "$FORM_webif_advanced" "1" && show_column "$section_name" "pktsize" "" ""
-	equal "$FORM_webif_advanced" "1" && show_column "$section_name" "mark" "" ""
-	echo "<td>"
-	echo "<a href=\"$SCRIPT_NAME?qos_remove=$section_name\"><img alt=\"@TR<<delete>>\" src=\"/images/x.gif\" title=\"@TR<<delete>>\" /></a>"
-	echo "<a href=\"$SCRIPT_NAME?qos_edit=$section_name\"><img alt=\"@TR<<edit>>\" src=\"/images/edit.gif\" title=\"@TR<<edit>>\" /></a>"
-	# if there is a last shown rule, show 'up' option
-	! equal "$last_shown_rule" "-1" && {
-		echo "<a href=\"$SCRIPT_NAME?qos_swap_src=$section_name&amp;qos_swap_dest=$last_shown_rule\"><img alt=\"@TR<<up>>\" src=\"/images/up.gif\" title=\"@TR<<up>>\" /></a>"
-	}
-	# if we are adding, always keep last index in FORM_qos_edit
-	! empty "$FORM_qos_add" && FORM_qos_edit="$section_name"
-	last_shown_rule="$section_name"	
-}
-
-config_foreach callback_foreach_rule
-
-# if we showed any rules, finish table row
-! equal "$last_shown_rule" "-1" && {
-	echo "</td></tr>"
-}
-
-cat <<EOF
-<tr><td><a href="$SCRIPT_NAME?qos_add=1">@TR<<new rule>></a></td></tr>
-</tbody></table>
-<div class="clearfix">&nbsp;</div></div>
-EOF
-
-#
-# handle 'edit' (qos rule)
-#
-#
-! empty "$FORM_qos_edit" && {
-	# for padding as if the qos table was encpasulated in std form
-	display_form <<EOF
-	start_form
-	end_form
-EOF
-	#
-	# build list of available L7-protocols
-	#
-	l7_protocols="option||None"
-	for curfile in /etc/l7-protocols/*; do
-		_l7basename=$(basename "$curfile" | sed s/'.pat'//g)
-		l7_protocols="$l7_protocols
-			option|$_l7basename|$_l7basename"
-	done
-
-	current_item="$FORM_qos_edit"
-	config_get _target "${current_item}" "target"
-	config_get _srchost "${current_item}" "srchost"
-	config_get _dsthost "${current_item}" "dsthost"
-	config_get _proto "${current_item}" "proto"
-	config_get _ports "${current_item}" "ports"
-	config_get _portrange "${current_item}" "portrange"
-	config_get _layer7 "${current_item}" "layer7"
-	config_get _ipp2p "${current_item}" "ipp2p"
-	ADVANCED_FIELD_FORM=""
-	equal "$FORM_webif_advanced" "1" && {
-		# config_get returns TYPE if OPTION ($2) is empty, else returns value
-		#config_get _type "${current_item}"
-		config_get _mark "${current_item}" "mark"
-		config_get _tcpflags "${current_item}" "tcpflags"
-		config_get _pktsize "${current_item}" "pktsize"
-		ADVANCED_FIELD_FORM1=""
-		#ADVANCED_FIELD_FORM1="
-		#	field|@TR<<Rule Type>>
-		#	select|current_type|$_type
-		#	option|classify|@TR<<Classify>>
-		#	option|default|@TR<<Default>>
-		#	option|reclassify|@TR<<Reclassify>>
-		#"
-		ADVANCED_FIELD_FORM2="
-			field|@TR<<TCP Flags>>
-			text|current_tcpflags|$_tcpflags
-			field|@TR<<Mark>>
-			text|current_mark|$_mark
-			field|@TR<<Packet Size>>
-			text|current_mark|$_pktsize"
-	}
-
-	display_form <<EOF
-	start_form|@TR<<QoS Rule Edit>>
-	field|@TR<<Rules Index>>|rule_number|hidden
-	text|current_rule_index|$current_item|hidden
-	$ADVANCED_FIELD_FORM1
-	field|@TR<<Classify As>>|current_target
-	select|current_target|$_target
-	option|Bulk|@TR<<Bulk>>
-	option|Normal|@TR<<Normal>>
-	option|Priority|@TR<<Priority>>
-	option|Express|@TR<<Express>>
-	field|@TR<<Source IP>>|current_srchost
-	text|current_srchost|$_srchost
-	field|@TR<<Dest IP>>|current_dsthost
-	text|current_dsthost|$_dsthost
-	field|@TR<<Protocol>>|proto
-	select|current_proto|$_proto
-	option||@TR<<qos_prot_any#Any>>
-	option|tcp|@TR<<qos_prot_tcp#TCP>>
-	option|udp|@TR<<qos_prot_udp#UDP>>
-	option|icmp|@TR<<qos_prot_icmp#ICMP>>
-	$ADVANCED_FIELD_FORM2
-	field|@TR<<Ports>>|current_ports
-	text|current_ports|$_ports
-	field|@TR<<Port Range>>|current_portrange
-	text|current_portrange|$_portrange
-	field|@TR<<Layer7>>|current_layer7
-	select|current_layer7|$_layer7
-	$l7_protocols
-	field|@TR<<Peer-2-Peer>>|ipp2p
-	select|current_ipp2p|$_ipp2p
-	option||@TR<<qos_p2p_none#None>>
-	option|all|@TR<<qos_p2p_all#All>>
-	option|bit|@TR<<qos_p2p_bittorrent#bitTorrent>>
-	option|dc|@TR<<qos_p2p_dc#DirectConnect>>
-	option|edk|@TR<<qos_p2p_ed2k#eDonkey>>
-	option|gnu|@TR<<qos_p2p_gnutella#Gnutella>>
-	option|kazaa|@TR<<qos_p2p_kazaa#Kazaa>>
-	helpitem|QoS Rule Edit
-	helptext|HelPText qos_rule_edit_help#You need only set fields you wish to match traffic on. Leave the others blank.
-	helpitem|Layer-7
-	helptext|HelpText layer7_help#Layer-7 filters are used to identify types of traffic based on content inspection. Numerous layer-7 filters are available on the web, though not all are efficient and accurate. To install more filters, download them and put them in /etc/l7-protocols.
-	helpitem|Peer-2-Peer
-	helptext|HelpText p2p_help#The difference between the Peer-2-Peer field and layer-7 filters is simply that the Peer-2-Peer option uses a special tool, ipp2p, to match traffic of common p2p protocols. It is typically more efficient than layer-7 filters.
-	end_form
-EOF
-}
-#########################################################################################
-# else if qos-scripts NOT installed
-else
-	echo "<div class=\"warning\">@TR<<qos_no_compatible#A compatible QOS package was not found to be installed.>></div>"
-display_form <<EOF
-onchange|modechange
-start_form|@TR<<QoS Packages>>
-field|@TR<<qos_nbds#Nbd's QoS Scripts (recommended)>>|nbd_qos
-submit|install_nbd|@TR<<qos_nbds_install#Install>>
-end_form
-EOF
-fi
-
-footer ?>
-<!--
-##WEBIF:name:Network:600:QoS
--->
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/cgi-bin/webif/reboot.sh buildroot/package/webif/files/www/cgi-bin/webif/reboot.sh
--- buildroot.orig/package/webif/files/www/cgi-bin/webif/reboot.sh	2010-09-24 22:20:28.000000000 -0400
+++ buildroot/package/webif/files/www/cgi-bin/webif/reboot.sh	2010-09-24 22:27:13.000000000 -0400
@@ -9,7 +9,7 @@
 	uci_load "network"
 	router_ip="$CONFIG_lan_ipaddr"
 	[ -n "$SERVER_PORT" ] && [ "$SERVER_PORT" != "80" ] && router_ip="$router_ip:$SERVER_PORT"
-	header_inject_head="<meta http-equiv=\"refresh\" content=\"$timeout;http://$router_ip\" />"
+	header_inject_head="<meta http-equiv=\"refresh\" content=\"$timeout;https://$router_ip\" />"
 	reboot_msg="@TR<<Rebooting now>>...
 <br/><br/>
 @TR<<reboot_wait#Please wait about>> $timeout @TR<<reboot_seconds#seconds.>> @TR<<reboot_reload#The webif&sup2; should automatically reload.>>
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/cgi-bin/webif/status-asterisk.sh buildroot/package/webif/files/www/cgi-bin/webif/status-asterisk.sh
--- buildroot.orig/package/webif/files/www/cgi-bin/webif/status-asterisk.sh	2010-09-24 22:20:28.000000000 -0400
+++ buildroot/package/webif/files/www/cgi-bin/webif/status-asterisk.sh	1969-12-31 19:00:00.000000000 -0500
@@ -1,128 +0,0 @@
-#!/usr/bin/webif-page
-<?
-. /usr/lib/webif/webif.sh
-header "Status" "Asterisk" "@TR<<Asterisk Simple Managment>>"
-
-if [ -e /var/run/asterisk.pid ]; then
-
-ast_pid=$(cat /var/run/asterisk.pid)
-
-ast_proc_info="$(cat /proc/$ast_pid/cmdline | tr '\0' ' ')"
-
-asterisk_exec="$(echo $ast_proc_info | awk '{print $1}')"
-
-if [ -z "$asterisk_exec" ]; then
-	asterisk_exec="/usr/sbin/asterisk"
-fi
-
-ast_conf_file="$(echo $ast_proc_info | awk '{for (i=2; i<=NF; i++) if ($i == "-C") print $(i+1)}')"
-
-if [ -e "$ast_conf_file" ]; then
-	ast_conf_path="$(cat $ast_conf_file | grep '^astetcdir => ')"
-
-	if [ -n "$ast_conf_path" ]; then
-		ast_conf_path="$(echo $ast_conf_path | awk '{print $3}')"
-	else
-		ast_conf_path=/etc/asterisk
-	fi
-else
-	ast_conf_path=/etc/asterisk
-fi
-
-echo '<center>'
-echo '<a href="'$SCRIPT_NAME'">Version</a>'
-echo '<a href="'$SCRIPT_NAME'?action=sip_peers">SIP/Peers</a>'
-echo '<a href="'$SCRIPT_NAME'?action=sip_channels">SIP/Channels</a>'
-echo '<a href="'$SCRIPT_NAME'?action=sip_registry">SIP/Registry</a>'
-echo '<a href="'$SCRIPT_NAME'?action=iax_peers">IAX/Peers</a>'
-echo '<a href="'$SCRIPT_NAME'?action=iax_channels">IAX/Channels</a>'
-echo '<a href="'$SCRIPT_NAME'?action=iax_registry">IAX/Registry</a>'
-echo '<a href="'$SCRIPT_NAME'?action=modules">Global/Modules</a>'
-echo '<a href="'$SCRIPT_NAME'?action=cust_com">Custom/Command</a>'
-echo '<a href="'$SCRIPT_NAME'?action=editor">.conf Editor</a>'
-echo '<a href="'$SCRIPT_NAME'?action=reload">Reload</a>'
-echo '<br /><br /><br />'
-echo '<table><tr><td align=left border=0>'
-echo '<pre>'
-if [ "$FORM_action" = "reload" ]; then
-	echo "<h3>Reloading...</h3>"
-	$asterisk_exec -r -x 'reload'
-elif [ "$FORM_action" = "sip_peers" ]; then
-	echo "<h3>SIP/Peers</h3>"
-	$asterisk_exec -r -x 'sip show peers'
-elif [ "$FORM_action" = "sip_channels" ]; then
-	echo "<h3>SIP/Channels</h3>"
-	$asterisk_exec -r -x 'sip show channels'
-elif [ "$FORM_action" = "sip_registry" ]; then
-	echo "<h3>SIP/Registry</h3>"
-	$asterisk_exec -r -x 'sip show registry'
-elif [ "$FORM_action" = "iax_peers" ]; then
-	echo "<h3>IAX/Peers</h3>"
-	$asterisk_exec -r -x 'iax2 show peers'
-elif [ "$FORM_action" = "iax_channels" ]; then
-	echo "<h3>IAX/Channels</h3>"
-	$asterisk_exec -r -x 'iax2 show channels'
-elif [ "$FORM_action" = "iax_registry" ]; then
-	echo "<h3>IAX/Registration</h3>"
-	$asterisk_exec -r -x 'iax2 show registry'
-elif [ "$FORM_action" = "modules" ]; then
-	echo "<h3>Global/Modules</h3>"
-	$asterisk_exec -r -x 'module show'
-elif [ "$FORM_action" = "execute" ]; then
-	echo "<h3>$FORM_exec_com</h3>"
-	$asterisk_exec -r -x "$FORM_exec_com"
-elif [ "$FORM_action" = "" ]; then
-	$asterisk_exec -r -x 'core show version'
-fi
-echo '</pre>'
-echo '</td></tr></table>'
-echo '</center>'
-if [ "$FORM_action" = "cust_com" ]; then
-	echo '<form action="'$SCRIPT_NAME'" method=POST>'
-	echo '<center>'
-	echo '<INPUT type=text name="exec_com" value="'$FORM_exec_com'" size="25" maxlength="150">'
-	echo '<br /><br /><INPUT type="submit" value="@TR<<Accept>>">'
-	echo '<INPUT name="action" type="hidden" value="execute">'
-	echo "<br /><br />Enter 'help' for commands details."
-	echo '</center>'
-	echo '</form>'
-fi
-if [ "$FORM_action" = "editor" ]; then
-	echo '<center><form action="'$SCRIPT_NAME'" method=POST>'
-	echo '<table style="width: 25%; text-align: left;" border="0" cellpadding="2" cellspacing="2" align="center">'
-	ls $ast_conf_path/.  | awk -F' ' '
-	{
-		link=$1
-		gsub(/\+/,"%2B",link)
-		print "<tr><td><a href=\"'$SCRIPT_NAME'?action=edit&target=" link "\">@TR<<Edit>></td><td>" $1 "</td></tr></a>"
-	}'
-	echo '</table></form></center>'
-fi
-if [ "$FORM_conf" != "" ]; then
-	echo "$FORM_conf" | tr -d '\r' > $ast_conf_path/$FORM_target
-fi
-if [ "$FORM_action" = "edit" ]; then
-	conf_file="$( cat $ast_conf_path/$FORM_target )"
-	echo '<form action="'$SCRIPT_NAME'" method=POST>'
-	echo '<center>'
-	echo '<TEXTAREA name="conf" rows="30" cols="100">'
-	echo -n "$conf_file"
-	echo '</TEXTAREA>'
-	echo '<INPUT name="target" type="hidden" value="'$FORM_target'">'
-	echo '<br /><INPUT type="submit" value="@TR<<Save Changes>>">'
-	echo '</center>'
-	echo '</form>'
-fi
-else
-	if [ -x /usr/sbin/asterisk ]; then
-		echo "@TR<<Asterisk is not running.>>"
-	else
-		echo "@TR<<Asterisk is not installed.>>"
-		echo "@TR<<Install one of asterisk packages:>>"
-		has_pkgs asterisk14 asterisk14-mini asterisk16
-	fi
-fi
-footer ?>
-<!--
-##WEBIF:name:Status:901:Asterisk
--->
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/cgi-bin/webif/status-basic.sh buildroot/package/webif/files/www/cgi-bin/webif/status-basic.sh
--- buildroot.orig/package/webif/files/www/cgi-bin/webif/status-basic.sh	2010-09-24 22:20:28.000000000 -0400
+++ buildroot/package/webif/files/www/cgi-bin/webif/status-basic.sh	2010-09-24 22:27:13.000000000 -0400
@@ -99,7 +99,7 @@
 		else
 			swap_type="@TR<<status_basic_swap_file#swap file>>"
 		print "string|<tr><td><strong>"swap_type" "$5"</strong><br /><em>"$1"</em></td><td>"
-		print "progressbar|swap_" mcount "|" $4 "@TR<<KiB>> @TR<<mount_of#of>> " $3 "@TR<<KiB>>|200|" $4 "|" filled_caption "%|"; mcount+=1
+		print "progressbar|swap_" mcount "|" $4 "@TR<<KiB>> @TR<<mount_of#of>> " $3 "@TR<<KiB>>|200|" filled_caption "|" filled_caption "%|"; mcount+=1
 		print "string|</td></tr>"
 	}'
 )
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/cgi-bin/webif/status-qos.sh buildroot/package/webif/files/www/cgi-bin/webif/status-qos.sh
--- buildroot.orig/package/webif/files/www/cgi-bin/webif/status-qos.sh	2010-09-24 22:20:28.000000000 -0400
+++ buildroot/package/webif/files/www/cgi-bin/webif/status-qos.sh	1969-12-31 19:00:00.000000000 -0500
@@ -1,221 +0,0 @@
-#!/usr/bin/webif-page
-<?
-. /usr/lib/webif/webif.sh
-###################################################################
-# QoS status page
-#
-# Description:
-#	Shows QoS numbers.
-#
-# Author(s) [in order of work date]:
-#	Original webif developers
-#	Jeremy Collake <jeremy.collake@gmail.com>
-#
-# Major revisions:
-#
-# NVRAM variables referenced:
-#	none
-#
-# Configuration files referenced:
-#	/etc/config/qos
-#
-
-header_inject_head=$(cat <<EOF
-<style type="text/css">
-<!--
-.qostable table {
-	margin-left: 2em;
-	margin-right: 2em;
-	border-style: none;
-	border-spacing: 0;
-	padding: 0.5em;
-	padding-bottom: 1em;
-}
-.qostable th,
-.qostable td {
-	text-align: right;
-	padding-top: 0.30em;
-	padding-bottom: 0.30em;
-	padding-left: 0.30em;
-	padding-right: 0.30em;
-}
-.qostable th.text,
-.qostable td.text {
-	text-align: left;
-}
-.qosraw table {
-	width: 90%;
-	border-style: none;
-	border-spacing: 0;
-}
-.qosraw th,
-.qosraw td {
-	text-align: left;
-}
--->
-</style>
-
-EOF
-)
-
-header "Status" "QoS" "@TR<<Quality of Service Statistics>>"
-
-gress_stats() {
-	awk \
-		-v root_class="$root_class" \
-		-v parent_class="$parent_class" \
-		-v priority_class="$priority_class" \
-		-v express_class="$express_class" \
-		-v normal_class="$normal_class" \
-		-v bulk_class="$bulk_class" \
-	'BEGIN {
-		total_packets = 0
-		total_bytes = 0
-	}
-	function bytes2human(num) {
-		if (num == "") return "&nbsp;"
-		if (num >= 2 ** 30) {
-			return sprintf("(%.1f @TR<<GiB>>)", num / (2 ** 30))
-		} else if (num >= 2 ** 20) {
-			return sprintf("(%.1f @TR<<MiB>>)", num / (2 ** 20))
-		} else if (num >= 2 ** 10) {
-			return sprintf("(%.1f @TR<<KiB>>)", num / (2 ** 10))
-		} else {
-			return "&nbsp;"
-		}
-	}
-	/class/ {
-		if ($3 != root_class && $3 != parent_class) {
-			if ($3 == priority_class) {
-				class="@TR<<qos_class_Priority#Priority>>"
-			} else if ($3 == express_class) {
-				class="@TR<<qos_class_Express#Express>>"
-			} else if ($3 == normal_class) {
-				class="@TR<<qos_class_Normal#Normal>>"
-			} else if ($3 == bulk_class) {
-				class="@TR<<qos_class_Bulk#Bulk>>"
-			} else {
-				class="@TR<<qos_class_Unknown#Unknown>> " $3
-			}
-			getline
-			if (length($0) > 0) {
-				print "<tr>"
-				print "	<td class=\"text\">" class "</td>"
-				print "	<td>" $4 "</td>"
-				total_packets += $4
-				print "	<td>" $2 "</td>"
-				total_bytes += $2
-				print "	<td>" bytes2human($2) "</td>"
-				print "</tr>"
-			}
-		}
-	}
-	END {
-		print "<tr>"
-			print "	<td class=\"text\">@TR<<qos_line_Total#Total>></td>"
-			print "	<td>" total_packets "</td>"
-			print "	<td>" total_bytes "</td>"
-			print "	<td>" bytes2human(total_bytes) "</td>"
-		print "</tr>"
-	}'
-}
-
-uci_load "qos"
-if equal "$CONFIG_wan_enabled" "1"; then
-
-	# todo: don't do these statically..
-	root_class="1:"
-	parent_class="1:1"
-	priority_class="1:10"
-	express_class="1:20"
-	normal_class="1:30"
-	bulk_class="1:40"
-
-	qos_status=$(qos-stat 2>&-)
-	if ! empty "$qos_status" && exists "/usr/bin/qos-stat"; then
-		ingress_start_line=$(echo "$qos_status" | grep INGRESS -n | cut -d ':' -f 1)
-		ingress_start_line=$(( $ingress_start_line - 2 )) 2>/dev/null
-		egress_status=$(echo "$qos_status" | sed "$ingress_start_line,\$ d")
-		ingress_status=$(echo "$qos_status" | sed "1,$ingress_start_line d")
-		ingress_stats_table=$(echo -e "$ingress_status\n" | gress_stats)
-		cat <<EOF
-<div class="settings">
-<h3><strong>@TR<<Incoming Traffic>></strong></h3>
-<div id="qostable1" class="qostable">
-<table summary="@TR<<Incoming Traffic>>">
-<tbody>
-<tr>
-	<th class="text">@TR<<Class>></th>
-	<th>@TR<<Packets>></th>
-	<th>@TR<<Bytes>></th>
-	<th>&nbsp;</th>
-</tr>
-$ingress_stats_table
-</tbody>
-</table>
-</div>
-EOF
-		egress_stats_table=$(echo -e "$egress_status\n" | gress_stats)
-		cat <<EOF
-<h3><strong>@TR<<Outgoing Traffic>></strong></h3>
-<div id="qostable2" class="qostable">
-<table summary="@TR<<Outgoing Traffic>>">
-<tbody>
-<tr>
-	<th class="text">@TR<<Class>></th>
-	<th>@TR<<Packets>></th>
-	<th>@TR<<Bytes>></th>
-	<th>&nbsp;</th>
-</tr>
-$egress_stats_table
-</tbody>
-</table>
-</div>
-<div class="settings-content">
-<table>
-EOF
-		display_form <<EOF
-field||spacer1
-string|<br /><br />
-field||show_raw
-formtag_begin|raw_stats|$SCRIPT_NAME
-submit|show_raw_stats| @TR<<&nbsp;Show raw statistics&nbsp;>>
-formtag_end
-end_form
-EOF
-
-		#########################################
-		# raw stats
-		! empty "$FORM_show_raw_stats" && {
-			echo "<br />"
-			echo "<div id=\"qostable3\" class=\"qosraw\">"
-			echo "<table>"
-			echo "<tbody>"
-			echo "<tr>"
-			echo "	<th>@TR<<QoS Packets | Raw Stats>></th>"
-			echo "</tr>"
-			echo "<tr>"
-			echo "	<td><br /><div class=\"smalltext\"><pre>"
-			qos-stat
-			echo "</pre></div></td>"
-			echo "</tr>"
-			echo "<tr>"
-			echo "<td><br /></td>"
-			echo "</tr>"
-			echo "</tbody>"
-			echo "</table>"
-			echo "</div>"
-		}
-	else
-		#########################################
-		# no QoS Service
-		echo "<br />@TR<<no_qos#No QoS Service found running so no parsed QoS statistics can be shown! We recommend to install nbd's QoS scripts.>><br />"	
-	fi
-else	
-	echo "@TR<<qos_scripts_disabled#The qos-scripts package is not active. Visit the <a href=\"./network-qos.sh\">QoS page</a> to install and/or enable it.>>"
-fi
-
-footer ?>
-<!--
-##WEBIF:name:Status:425:QoS
--->
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/cgi-bin/webif/status-wwaninfo.sh buildroot/package/webif/files/www/cgi-bin/webif/status-wwaninfo.sh
--- buildroot.orig/package/webif/files/www/cgi-bin/webif/status-wwaninfo.sh	2010-09-24 22:20:28.000000000 -0400
+++ buildroot/package/webif/files/www/cgi-bin/webif/status-wwaninfo.sh	1969-12-31 19:00:00.000000000 -0500
@@ -1,273 +0,0 @@
-#!/usr/bin/webif-page
-<?
-. /usr/lib/webif/webif.sh
-
-header_inject_head=$(cat <<EOF
-<style type="text/css">
-/*<![CDATA[*/
-<!--
-
-#wwanbars * { padding: 0; margin: 0; }
-
-#wwanbars body {
-	font-family: Verdana;
-	font-size: 1em;
-	line-height: 1em;
-	padding: 1em;
-}
-
-#wwanbars .wwan_status { padding-top: 5em; }
-
-#wwanbars ul { list-style-type: none; }
-
-#wwanbars ul li { clear: both; height: 1.2em; }
-
-#wwanbars .title { width: 10em; float: left; }
-
-#wwanbars .progress {
-	text-align: right;
-	display: block;
-	float: left;
-	clear: right;
-	font-size: 0.964em;
-	padding: 0.1em;
-	margin-bottom: 0.2em;
-}
-
-#wwanbars h4 { display: none; }
-
-/* Legend */
-
-#wwanbars .legend {
-	position: absolute;
-	margin-top: -5.3em;
-	margin-left: 10em;
-	clear: both;
-	width: 30em;
-	border-left: 1px solid Gray;
-	border-right: 1px solid Gray;
-}
-
-#wwanbars dl {
-	float: left;
-	text-align: center;
-	width: 30%;
-	font-size: 0.8em;
-	line-height: 1.5em;
-}
-
-#wwanbars dl.workable { width: 16%; }
-
-#wwanbars dl.good { width: 16%; }
-
-#wwanbars dl.excellent { width: 38%; }
-
-#wwanbars dl+dl dt, dl+dl dd { border-left: 1px solid Gray; }
-
-#wwanbars dd .title { display: none; }
-
-#wwanbars dd.dbm { margin-top: 4em; }
-
-/* Colors for status health */
-
-#wwanbars dl.unreliable dt, span.progress.unreliable { background-color: #ff7474; }
-
-#wwanbars dl.workable dt, span.progress.workable { background-color: #fffa74; }
-
-#wwanbars dl.good dt, span.progress.good { background-color: #ace4ff; }
-
-#wwanbars dl.excellent dt, span.progress.excellent { background-color: #6fff6c; }
-
--->
-/*]]>*/
-</style>
-
-EOF
-)
-
-# the comgt package has changed the executable
-COMGT=$(which comgt 2>/dev/null)
-empty "$COMGT" && COMGT=$(which gcom 2>/dev/null)
-# the webif^2's comgt query script
-COMGTWEBIF="/usr/lib/webif/comgt.webif"
-
-[ -x "$COMGT" ] && [ -s "$COMGTWEBIF" ] && {
-	DEVICES="/dev/usb/tts/2 /dev/noz2"
-	for DEV in $DEVICES
-	do
-		[ -c "$DEV" ] && [ -x "$COMGT" ] && {
-			INFO=$($COMGT -d "$DEV" -s "$COMGTWEBIF" 2>/dev/null)
-			STRENGTH=$(echo "$INFO" | grep "+CSQ:" | cut -d: -f2 | cut -d, -f1)
-			CHARGING=$(echo "$INFO" | grep "+CBC:" | cut -d: -f2 | cut -d, -f1)
-			CAPACITY=$(echo "$INFO" | grep "+CBC:" | cut -d: -f2 | cut -d, -f2)
-		}
-	done
-}
-
-header "Status" "UMTS" "@TR<<status_wwaninfo_UG_Status#UMTS/GPRS Status>>"
-
-equal "$INFO" "" && {
-	cat << EOF
-<p>@TR<<status_wwaninfo_no_UG_device#UMTS / GPRS device not found.>></p>
-EOF
-	equal "$COMGT" "" || equal "$COMGTWEBIF" "" && {
-		cat << EOF
-<p>@TR<<status_wwaninfo_no_req_app#The required components are missing. Please install the latest <a href="system-ipkg.sh">comgt</a> package and <a href="info.sh">webif&sup2;</a>.>></p>
-EOF
-	}
-	footer
-	exit
-}
-
-cat << EOF
-<div class="settings">
-<h3><strong>@TR<<status_wwaninfo_device_info#Device Information>></strong></h3>
-<table style="text-align: left;" border="0" cellpadding="3" cellspacing="3">
-<tbody>
-EOF
-
-if ! empty "$INFO"; then
-	echo "$INFO" | awk -F: '
-		BEGIN {
-			print "	<tr>"
-			print "		<th>@TR<<status_wwaninfo_dev_th_Information#Information>></th>"
-			print "		<th>@TR<<status_wwaninfo_dev_th_Value#Value>></th>"
-			print "	</tr>"
-			odd=1
-		}
-		/^[#+ ]/ {next}
-		{
-			if (length($2) > 0) {
-				if (odd == 1) {
-					print "	<tr>"
-					odd--
-				} else {
-					print "	<tr class=\"odd\">"
-					odd++
-				}
-				col2=$2
-				for (i=3; i<=NF; i++)
-					col2 = col2 ":" $i
-				print "		<td>" $1 "</td>"
-				print "		<td>" col2 "</td>"
-				print "	</tr>"
-			}
-		}'
-else
-	cat << EOF
-	<tr>
-		<td colspan="2">@TR<<status_wwaninfo_no_UG_device_info#No device information reported.>></td>
-	</tr>
-EOF
-fi
-
-cat << EOF
-</tbody>
-</table>
-</div>
-<br />
-EOF
-
-[ "$CHARGING" -ge 0 ] >/dev/null 2>&1 &&  [ "$CAPACITY" -ge 0 ] >/dev/null 2>&1 && {
-	[  "$CHARGING" -eq 0 ] && charg_text="@TR<<status_wwaninfo_Notcharging#Not charging>>" || charg_text="@TR<<status_wwaninfo_Charging#Charging>>"
-	display_form << EOF
-start_form|@TR<<status_wwaninfo_Battery_Status#Battery Status>>
-field|@TR<<status_wwaninfo_Status#Status>>
-string|<div style="text-align: left">$charg_text</div>
-field|@TR<<status_wwaninfo_Capacity#Capacity>>
-progressbar|capacity||200|$CAPACITY|${CAPACITY}%||
-end_form
-EOF
-}
-
-! empty "$STRENGTH" && {
-	cat << EOF
-<div class="settings">
-<h3><strong>@TR<<status_wwaninfo_Signal_Quality#Signal Quality>></strong></h3>
-EOF
-
-	# check if numeric
-	[ "$STRENGTH" -ge 0 ] >/dev/null 2>&1 && {
-		if [ "$STRENGTH" -gt 31 ]; then
-			echo "<p>@TR<<status_wwaninfo_quality_unknown#Signal quality is invalid/unknown>>: ${STRENGTH}</p>"
-		else
-			progress_type="unreliable"
-			[ "$STRENGTH" -gt 9 ] && progress_type="workable"
-			[ "$STRENGTH" -gt 14 ] && progress_type="good"
-			[ "$STRENGTH" -gt 19 ] && progress_type="excellent"
-			cat << EOF
-<div id="wwanbars"><div class="wwan_status">
-	<ul>
-		<li>
-			<span class="title">@TR<<status_wwaninfo_Signal_Quality#Signal Quality>>:</span> <span class="progress ${progress_type}" style="width: ${STRENGTH}em;">${STRENGTH}</span>
-		</li>
-		<li>
-			<span class="title">@TR<<status_wwaninfo_Power_Ratio#Power (dBm)>>:</span> <span class="progress ${progress_type}" style="width: ${STRENGTH}em;">$((-113 + $STRENGTH * 2))</span>
-		</li>
-	</ul>
-	<h4>@TR<<status_wwaninfo_Legend#Legend>>:</h4>
-	<div class="legend">
-		<dl class="unreliable">
-EOF
-			if equal "$progress_type" "unreliable"; then
-				echo "			<dt><strong>@TR<<status_wwaninfo_quality_Unreliable#Unreliable>></strong></dt>"
-			else
-				echo "			<dt>@TR<<status_wwaninfo_quality_Unreliable#Unreliable>></dt>"
-			fi
-			cat << EOF
-			<dd><span class="title">@TR<<status_wwaninfo_Signal_Quality#Signal Quality>>:</span> 0..9</dd>
-			<dd class="dbm"><span class="title">@TR<<status_wwaninfo_Power_Ratio#Power (dBm)>>:</span> -113..-95</dd>
-		</dl>
-		<dl class="workable">
-EOF
-			if equal "$progress_type" "workable"; then
-				echo "			<dt><strong>@TR<<status_wwaninfo_quality_Workable#Workable>></strong></dt>"
-			else
-				echo "			<dt>@TR<<status_wwaninfo_quality_Workable#Workable>></dt>"
-			fi
-			cat << EOF
- 			<dd><span class="title">@TR<<status_wwaninfo_Signal_Quality#Signal Quality>>:</span> 10..14</dd>
-			<dd class="dbm"><span class="title">@TR<<status_wwaninfo_Power_Ratio#Power (dBm)>>:</span> -93..-85</dd>
-		</dl>
-		<dl class="good">
-EOF
-			if equal "$progress_type" "good"; then
-				echo "			<dt><strong>@TR<<status_wwaninfo_quality_Good#Good>></strong></dt>"
-			else
-				echo "			<dt>@TR<<status_wwaninfo_quality_Good#Good>></dt>"
-			fi
-			cat << EOF
-			<dd><span class="title">@TR<<status_wwaninfo_Signal_Quality#Signal Quality>>:</span> 15..19</dd>
-			<dd class="dbm"><span class="title">@TR<<status_wwaninfo_Power_Ratio#Power (dBm)>>:</span> -83..-75</dd>
-		</dl>
-		<dl class="excellent">
-EOF
-			if equal "$progress_type" "excellent"; then
-				echo "			<dt><strong>@TR<<status_wwaninfo_quality_Excellent#Excellent>></strong></dt>"
-			else
-				echo "			<dt>@TR<<status_wwaninfo_quality_Excellent#Excellent>></dt>"
-			fi
-			cat << EOF
-			<dd><span class="title">@TR<<status_wwaninfo_Signal_Quality#Signal Quality>>:</span> 20..31</dd>
-			<dd class="dbm"><span class="title">@TR<<status_wwaninfo_Power_Ratio#Power (dBm)>>:</span> -73..-51</dd>
-		</dl>
-	</div>
-</div></div>
-<br />
-EOF
-		fi
-	} || {
-		echo "<p>@TR<<status_wwaninfo_wrong_value#Wrong signal quality value>>: ${STRENGTH}</p>"
-	}
-}
-
-cat << EOF
-</div>
-<br />
-EOF
-
-footer
-?>
-<!--
-##WEBIF:name:Status:170:UMTS
--->
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/cgi-bin/webif/system-access-control.sh buildroot/package/webif/files/www/cgi-bin/webif/system-access-control.sh
--- buildroot.orig/package/webif/files/www/cgi-bin/webif/system-access-control.sh	2010-09-24 22:20:28.000000000 -0400
+++ buildroot/package/webif/files/www/cgi-bin/webif/system-access-control.sh	1969-12-31 19:00:00.000000000 -0500
@@ -1,180 +0,0 @@
-#!/usr/bin/webif-page
-<?
-. /usr/lib/webif/webif.sh
-
-###################################################################
-#
-# System configuration page
-#
-# Description:
-#	Configures access control for the webif
-#
-# Author(s) [in order of work date]:
-#	Travis Kemen <kemen04@gmail.com>
-#
-# Major revisions:
-#
-# Configuration files referenced:
-#   /etc/config/webif_access_control
-#
-
-cachedir=/tmp/.webcache
-#admin is also a superuser but maybe removed in the future.
-superuser=root
-mkdir /tmp/.webif/
-exists /etc/config/webif_access_control || touch /etc/config/webif_access_control
-
-if [ "$FORM_user_add" != "" ]; then
-	validate <<EOF
-string|FORM_password_add|@TR<<Password>>|required min=5|$FORM_password_add
-EOF
-	equal "$FORM_password_add" "$FORM_password2_add" || {
-		[ -n "$ERROR" ] && ERROR="${ERROR}<br />"
-		ERROR="${ERROR}@TR<<password_mismatch#The passwords do not match!>><br />"
-	}
-	if [ "${FORM_user_add}" = "root" -o "${FORM_user_add}" = "admin" ]; then
-		[ -n "$ERROR" ] && ERROR="${ERROR}<br />"
-		ERROR="${ERROR}@TR<<root and admin are already users>>.<br />"
-	fi
-	[ -e /tmp/.webif/file-httpd.conf ] && HTTPD_CONFIG_FILE=/tmp/.webif/file-httpd.conf
-	[ -e /etc/httpd.conf ] && HTTPD_CONFIG_FILE="$HTTPD_CONFIG_FILE /etc/httpd.conf"
-	[ -n "HTTPD_CONFIG_FILE" ] && grep -q "$FORM_user_add" $HTTPD_CONFIG_FILE
-	if [ "$?" = "0" ]; then
-		[ -n "$ERROR" ] && ERROR="${ERROR}<br />"
-		ERROR="${ERROR}$FORM_user_add @TR<<already exists.>>.<br />"
-	fi
-	empty "$ERROR" && {
-		password=$(uhttpd -m $FORM_password_add)
-		[ -e /tmp/.webif/file-httpd.conf ] || cp /etc/httpd.conf /tmp/.webif/file-httpd.conf
-		echo "/cgi-bin/webif/:${FORM_user_add}:${password}" >>/tmp/.webif/file-httpd.conf
-		uci_add "webif_access_control" "accesscontrol" "${FORM_user_add}"
-		unset FORM_user_add
-	}
-	unset FORM_submit
-fi
-header "System" "Access Control" "@TR<<Access Control>>" '' "$SCRIPT_NAME"
-
-exists /tmp/.webif/file-httpd.conf && HTTPD_CONFIG_FILE=/tmp/.webif/file-httpd.conf || HTTPD_CONFIG_FILE=/etc/httpd.conf
-
-awk -F: -v "cachedir=$cachedir" -v "superuser=$superuser" '
-BEGIN { ucount = 0;
-	include("/usr/lib/webif/common.awk");
-	start_form("@TR<<Users>>");
-
-	if (ENVIRON["FORM_submit"] != "") {
-		if (ENVIRON["FORM_remove_user_"$2] != "") {
-			system("/bin/rm -f " cachedir "/cat" $2);
-			system("/bin/rm -f " cachedir "/subcat" $2);
-			system("touch /tmp/.webif/file-httpd.conf.2");
-		} else if (ENVIRON["FORM_change_password_"$2] != "")
-			system("touch /tmp/.webif/file-httpd.conf.2");
-	}
-}
-($1 == "/cgi-bin/webif/" && $2 != superuser && $2 != "admin") {
-	if (ENVIRON["FORM_remove_user_" $2] == "") {
-		field($2);
-		password("user_"$2, ENVIRON["FORM_user_" $2]);
-		submit("change_password_"$2, "@TR<<system_acl_changepw#Change Password>>");
-		field("&nbsp;");
-		print "<span class=\"smalltext\"><a href=\"" ENVIRON["SCRIPT_NAME"] "?remove_user_" $2 "=" $2 "&submit=1" "\">@TR<<system_acl_remove_user#Remove user>> " $2 "</a></span>";
-		field("&nbsp;");
-		ucount = ucount + 1;
-	}
-}
-((ENVIRON["FORM_submit"] != "") && ($1 != "")) {
-	if (($1 == "/cgi-bin/webif/") && (ENVIRON["FORM_remove_user_"$2] != $2) && (ENVIRON["FORM_change_password_"$2] == "")) {
-		print $1":"$2":"$3 >>"/tmp/.webif/file-httpd.conf.2";
-	}
-	if ($1 != "/cgi-bin/webif/") {
-		print $0 >>"/tmp/.webif/file-httpd.conf.2";
-	}
-	if (ENVIRON["FORM_change_password_"$2] != "") {
-		("uhttpd -m " ENVIRON["FORM_user_"$2]) | getline password;
-		print $1":"$2":"password >>"/tmp/.webif/file-httpd.conf.2";
-	}
-}
-END {
-	if (ucount == 0)
-		print "<tr><td>No users defined.";
-
-	end_form("","",1);
-	start_form("@TR<<Add User>>");
-	field("@TR<<Username>>");
-	textinput3("user_add", ENVIRON["FORM_user_add"]);
-	field("@TR<<Password>>");
-	password("password_add");
-	field("@TR<<Confirm Password>>");
-	password("password2_add");
-	field("&nbsp;","");
-	submit("add_user", "@TR<<Add User>>");
-	end_form("","",1);
-}' $HTTPD_CONFIG_FILE 2>/dev/null
-
-[ -e /tmp/.webif/file-httpd.conf.2 ] && mv -f /tmp/.webif/file-httpd.conf.2 /tmp/.webif/file-httpd.conf
-exists /tmp/.webif/file-httpd.conf && HTTPD_CONFIG_FILE=/tmp/.webif/file-httpd.conf || HTTPD_CONFIG_FILE=/etc/httpd.conf
-users=$(awk -F":" '($1 == "/cgi-bin/webif/") { if (($2 != "root") && ($2 != "admin")) print $2 }' $HTTPD_CONFIG_FILE 2>/dev/null)
-
-for user in $users; do
-	export user
-	#[ -s $cachedir/subcat_${user} ] || init_cache "$user"
-	awk -F: '
-BEGIN {
-	include("/usr/lib/webif/common.awk")
-	config_load("webif_access_control")
-	start_form("@TR<<ACL User>>: " ENVIRON["user"])
-}
-{
-	if (ENVIRON["FORM_submit"] == "") {
-		if ($1 != "Graphs") {
-			var = config_get_bool(ENVIRON["user"], $1"_"$2, "0")
-		} else {
-			var = config_get_bool(ENVIRON["user"], "Graphs", "0")
-		}
-	} else {
-		if ($1 != "Graphs") {
-			varorig = config_get_bool(ENVIRON["user"], $1"_"$2, "0")
-			var2 = "FORM_" ENVIRON["user"] "_" $1 "_" $2
-			var = ENVIRON[var2]
-			if (varorig != var) {
-				uci_set("webif_access_control", ENVIRON["user"], $1 "_" $2, var)
-			}
-		} else {
-			varorig = config_get_bool(ENVIRON["user"], "Graphs", "0")
-			var2 = "FORM_" ENVIRON["user"] "_Graphs"
-			var = ENVIRON[var2]
-			if (varorig != var) {
-				uci_set("webif_access_control", ENVIRON["user"], "Graphs", var)
-			}
-		}
-	}
-	if (($1 != category) && ($1 != GRAPHS)) {
-		field("<h2>@TR<<"$1">></h2>")
-	}
-	category = $1
-	if ($1 != GRAPHS) {
-		if ($1 == "Graphs") {
-			GRAPHS = $1
-			field("@TR<<Graphs>>")
-			select(ENVIRON["user"]"_Graphs", var)
-		} else {
-			field("@TR<<"$3">>")
-			select(ENVIRON["user"]"_"$1"_"$2, var)
-		}
-		option("1", "@TR<<Enabled>>")
-		option("0", "@TR<<Disabled>>")
-		print "</select>"
-		select_open = 0
-	}
-}
-	END {
-		end_form("","",1)
-	}' $cachedir/subcat_$superuser
-done
-
-footer
-
-?>
-
-<!--
-##WEBIF:name:System:160:Access Control
--->
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/cgi-bin/webif/system-crontabs.sh buildroot/package/webif/files/www/cgi-bin/webif/system-crontabs.sh
--- buildroot.orig/package/webif/files/www/cgi-bin/webif/system-crontabs.sh	2010-09-24 22:20:28.000000000 -0400
+++ buildroot/package/webif/files/www/cgi-bin/webif/system-crontabs.sh	1969-12-31 19:00:00.000000000 -0500
@@ -1,618 +0,0 @@
-#!/usr/bin/webif-page
-<%
-. /usr/lib/webif/webif.sh
-###################################################################
-# Crontabs
-#
-# Description:
-#
-# Author(s) [in order of work date]:
-#       m4rc0 <jansssenmaj@gmail.com>
-#
-# Major revisions:
-#		Initial release 2008-11-28
-#
-# NVRAM variables referenced:
-#       none
-#
-# Configuration files referenced:
-#       various crontab files
-#
-# Required components:
-# 
-
-header "System" "Crontabs" "@TR<<Crontabs>>" '' "$SCRIPT_NAME"
-
-#Check if config file exists
-if [ ! -f /etc/config/crontabs ]; then
-	touch /etc/config/crontabs
-fi 
-
-
-# Remove selected crontabentry
-if  ! empty "$FORM_remove_crontabentry" ; then
-	uci_remove "crontabs" "$FORM_remove_crontabentry"
-fi
-
-# Add new cron-entry
-if ! empty "$FORM_MINUTES_newCron"; then
-	uci_add "crontabs" "crontab" ""; crontab="$CONFIG_SECTION"
-	uci_set "crontabs" "$crontab" "minutes" "$FORM_MINUTES_newCron"
-	uci_set "crontabs" "$crontab" "hours" "$FORM_HOURS_newCron"
-	uci_set "crontabs" "$crontab" "days" "$FORM_DAYS_newCron"
-	uci_set "crontabs" "$crontab" "months" "$FORM_MONTHS_newCron"
-	uci_set "crontabs" "$crontab" "weekdays" "$FORM_WEEKDAYS_newCron"
-	#uci_set "crontabs" "$crontab" "user" "$FORM_USER_newCron"
-	uci_set "crontabs" "$crontab" "command" "$FORM_COMMAND_newCron"
-	uci_set "crontabs" "$crontab" "enabled" "$FORM_ENABLED_newCron"
-	FORM_MINUTES_newCron=""
-fi
-
-
-config_cb() {
-	local cfg_type="$1"
-	local cfg_name="$2"
-
-	case "$cfg_type" in
-		crontab)
-			append CRONTABS_cfg "$cfg_name"
-		;;
-		
-	esac
-}
-
-# change rowcolors
-get_tr() {
-	if equal "$cur_color" "odd"; then
-		cur_color="even"
-		tr="<tr>"
-	else
-		cur_color="odd"
-		tr="<tr class=\"odd\">"
-	fi
-}
-
-
-cat <<EOF
-<script type="text/javascript" language="JavaScript"><!--
-
- 
-var cX = 0; var cY = 0; var rX = 0; var rY = 0; var CronTab = ''; ConfigChanged = false;
-
-function UpdateCursorPosition(e){ cX = e.pageX; cY = e.pageY;}
-function UpdateCursorPositionDocAll(e){ cX = event.clientX; cY = event.clientY;}
-
-if(document.all) { document.onmousemove = UpdateCursorPositionDocAll; }
-else { document.onmousemove = UpdateCursorPosition; }
-
-function AssignPosition(d,offsetX,offsetY) {
-if(self.pageYOffset) {
-	rX = self.pageXOffset;
-	rY = self.pageYOffset;
-	}
-else if(document.documentElement && document.documentElement.scrollTop) {
-	rX = document.documentElement.scrollLeft;
-	rY = document.documentElement.scrollTop;
-	}
-else if(document.body) {
-	rX = document.body.scrollLeft;
-	rY = document.body.scrollTop;
-	}
-if(document.all) {
-	cX += rX; 
-	cY += rY;
-	}
-
-if (cY < 280) { cY = cY + 100; }
-	
-d.style.left = (cX-offsetX) + "px";
-d.style.top = (cY-offsetY) + "px";
-
-}
-
-
-function OpenEditWindow(d,CRONTAB) {
-if(d.length < 1) { return; }
-
-document.getElementById('EditWindow').style.display = "none";
-
-if (CRONTAB == 'newCron') {
-	ResetForm();
-}
-else {
-	SetValueSelect('sltMinutes','ddEveryXminute',document.getElementById('MINUTES_'+CRONTAB).value,1);
-	SetValueSelect('sltHours','ddEveryXhour',document.getElementById('HOURS_'+CRONTAB).value,1);
-	SetValueSelect('sltDays','ddEveryXday',document.getElementById('DAYS_'+CRONTAB).value,0);
-	SetValueSelect('sltMonths','',document.getElementById('MONTHS_'+CRONTAB).value,0);
-	SetValueSelect('sltDaysOfWeek','',document.getElementById('WEEKDAYS_'+CRONTAB).value,1);
-
-	//document.getElementById('txtUsername').value = document.getElementById('USER_'+CRONTAB).value;
-	document.getElementById('txtCommand').value = document.getElementById('COMMAND_'+CRONTAB).value;
-
-	if (document.getElementById('ENABLED_'+CRONTAB).value == '1') {
-			document.forms[0].chkCronEnabled.checked = true;
-			document.getElementById('txthCronEnabled').value = '1';
-	}
-	else {
-			document.forms[0].chkCronEnabled.checked = false;
-			document.getElementById('txthCronEnabled').value = '0';
-	}
-
-	BuildInterval(false);
-}
-
-var dd = document.getElementById(d);
-AssignPosition(dd,710,480);
-dd.style.display = "block";
-
-CronTab = CRONTAB;
-}
-
-
-function HideContent(d,doAction) {
-
-	if(d.length < 1) { return; }
-	document.getElementById(d).style.display = "none";
-
-	//if (doAction == 'update' && document.getElementById('txtUsername').value != '' && document.getElementById('txtCommand').value != ''){
-	if (doAction == 'update' && document.getElementById('txtCommand').value != ''){
-		document.getElementById('MINUTES_'+CronTab).value = document.getElementById('txthMinutes').value;
-		document.getElementById('HOURS_'+CronTab).value = document.getElementById('txthHours').value;
-		document.getElementById('DAYS_'+CronTab).value = document.getElementById('txthDays').value;
-		document.getElementById('MONTHS_'+CronTab).value = document.getElementById('txthMonths').value;
-		document.getElementById('WEEKDAYS_'+CronTab).value = document.getElementById('txthDaysOfWeek').value;
-		//document.getElementById('USER_'+CronTab).value = document.getElementById('txtUsername').value;
-		document.getElementById('COMMAND_'+CronTab).value = document.getElementById('txtCommand').value;
-		document.getElementById('ENABLED_'+CronTab).value = document.getElementById('txthCronEnabled').value;
-	}
-
-	if (ConfigChanged == true) {
-			document.getElementById('WarningConfigChange').style.display = "block";
-	}
-
-}
-
-function SetConfigChanged() {
-	
-	ConfigChanged = true;
-
-}
-
-
-function CheckValueSelect(SelectControl,IntervalControl) {
-	
-	var len = document.forms[0][SelectControl].length;
-	var i = 0;
-	var intervalSelected = '';
-	var CurrentValue = -1;
-	var sequenceCounter = 0;
-	var chainStatus = false;
-	var booleanSelected = false;
-	var firstSelect = -1;
-	var intervalCompleted = '';
-
-	for (i = 0; i < len; i++) {
-
-		booleanSelected = document.forms[0][SelectControl][i].selected;
-
-		if ( booleanSelected ) {
-
-			if ( document.forms[0][SelectControl][i].value != "" ) {
-				var CurrentValue = parseInt(document.forms[0][SelectControl][i].value);
-				
-				sequenceCounter = sequenceCounter + 1;
-				if ( sequenceCounter > 2 ) { chainStatus = true; }
-
-				if ( i+1 == len ) { booleanSelected = false; }
-				else { booleanSelected = document.forms[0][SelectControl][i+1].selected;}
-
-				if ( intervalSelected == "" ) { 
-					intervalSelected = CurrentValue + '';
-					firstSelect = i;
-				}
-				
-				
-				if ( !booleanSelected ) {
-					if ( chainStatus == true ) {
-						intervalSelected = intervalSelected + '-' + CurrentValue;
-					}
-					else {
-						if ( firstSelect != i ) {
-							intervalSelected = intervalSelected + ',' + CurrentValue;
-						}
-					}
-					
-					chainStatus = false;
-					sequenceCounter = 0;
-					if ( intervalCompleted == '' ) {intervalCompleted = intervalCompleted + intervalSelected;}
-					else { intervalCompleted = intervalCompleted + ',' + intervalSelected; }
-					intervalSelected = '';
-				}
-			}
-		}
-	}
-
-	if (intervalCompleted == "" ) {intervalCompleted = '*';}
-	if ( IntervalControl != '' ) {
-		var SelectedIntervalValue = document.forms[0][IntervalControl].value;
-		if (SelectedIntervalValue != '' ) {
-			intervalCompleted = intervalCompleted + '/' + SelectedIntervalValue;	
-		}
-	}
-
-	
-	return intervalCompleted;
-}
-
-function BuildInterval(ChangeConfig) {
-
-	if (ConfigChanged == true) {
-			document.getElementById('WarningConfigChange').style.display = "none";
-	}
-	
-	document.getElementById('txthMinutes').value = CheckValueSelect('sltMinutes','ddEveryXminute');
-	document.getElementById('txthHours').value = CheckValueSelect('sltHours','ddEveryXhour');
-	document.getElementById('txthDays').value = CheckValueSelect('sltDays','ddEveryXday');
-	document.getElementById('txthMonths').value = CheckValueSelect('sltMonths','');
-	document.getElementById('txthDaysOfWeek').value = CheckValueSelect('sltDaysOfWeek','');
-	
-
-	var IntervalString = CheckValueSelect('sltMinutes','ddEveryXminute') + ' ';
-	IntervalString = IntervalString + CheckValueSelect('sltHours','ddEveryXhour') + ' ';
-	IntervalString = IntervalString + CheckValueSelect('sltDays','ddEveryXday') + ' ';
-	IntervalString = IntervalString + CheckValueSelect('sltMonths','') + ' ';
-	IntervalString = IntervalString + CheckValueSelect('sltDaysOfWeek','') + ' ';
-
-//	if ( document.getElementById('txtUsername').value != '' ) {
-//		IntervalString = IntervalString + document.getElementById('txtUsername').value + ' ';
-//	}
-//	else {
-//		IntervalString = IntervalString + 'user' + ' ';
-//		document.getElementById('txtUsername').value = 'user';
-//	}
-
-	if ( document.getElementById('txtCommand').value != '' ) {
-		IntervalString = IntervalString + document.getElementById('txtCommand').value;
-	}
-	else {
-		IntervalString = IntervalString + 'echo "X-WRT \-\- End user extensions for OpenWrt" | logger' + ' ';
-		document.getElementById('txtCommand').value = 'echo "X-WRT \-\- End user extensions for OpenWrt" | logger';
-	}
-	
-	document.getElementById('txtCrontabEntry').value = IntervalString;
-	
-	if (ChangeConfig == true) {
-		SetConfigChanged();
-	}
-}
-
-function ResetForm() {
-	document.getElementById('sltMinutes').selectedIndex = 0;
-	document.getElementById('sltHours').selectedIndex = 0;
-	document.getElementById('sltDays').selectedIndex = 0;
-	document.getElementById('sltMonths').selectedIndex = 0;
-	document.getElementById('sltDaysOfWeek').selectedIndex = 0;
-	
-	document.getElementById('ddEveryXminute').selectedIndex = 0;
-	document.getElementById('ddEveryXhour').selectedIndex = 0;
-	document.getElementById('ddEveryXday').selectedIndex = 0;
-
-	document.getElementById('chkCronEnabled').checked = false;
-	
-	//document.getElementById('txtUsername').value = '$selectedcrontab';
-	document.getElementById('txtCommand').value = '';
-	document.getElementById('txtCrontabEntry').value = '';
-	
-	ConfigChanged = false;
-
-}
-
-function SetValueSelect(SelectControl,IntervalControl,IntervalString,offset) {
-
-	if (IntervalString.indexOf('/') > 0) {
-		
-		// Handle */5 and 20-40/5 variants
-		var arrInterval = IntervalString.split('/');
-		if (arrInterval[0] == '*') {
-			SetControTopOption(SelectControl);
-		}
-		else {
-			SetControlSelected(SelectControl,arrInterval[0],offset);
-		}
-		document.getElementById(IntervalControl).selectedIndex = arrInterval[1];
-	}
-	else {
-		var arrIntervalString = IntervalString.split(',');
-		if (arrIntervalString[0] == '*') {
-			SetControTopOption(SelectControl);
-		}
-		else {	
-			SetControlSelected(SelectControl,IntervalString,offset);
-		}
-		if (IntervalControl != '') {
-				document.getElementById(IntervalControl).selectedIndex = 0;
-		}
-	}
-}
-
-function SetControlSelected(SelectControl,IntervalString,offset) {
-
-	var arrIntervalString = IntervalString.split(',');
-	var ArrayLen = arrIntervalString.length;
-	var tempIntervalString = '';
-	var j = 0;
-	var i = 0;
-	var len = document.forms[0][SelectControl].length;
-	var arrIntervalString = IntervalString.split(',');
-
-	// translate 2-5 into 2,3,4,5
-	for (i = 0; i < ArrayLen; i ++) {
-		var PositionOfChar = arrIntervalString[i].indexOf('-');;
-		if ( PositionOfChar > 0 ) {
-			var arrInterval = arrIntervalString[i].split('-');
-			tempIntervalString = arrInterval[0];
-			var StartIndex = parseInt(arrInterval[0]);
-			while ( StartIndex != arrInterval[1] ) {
-				StartIndex = StartIndex + 1;
-				tempIntervalString = tempIntervalString + ',' + StartIndex;
-			}
-		IntervalString = IntervalString.replace(arrIntervalString[i],tempIntervalString);
-		}
-	}
-
-	// Set all the members in the select control
-	var i = 0;
-	var arrIntervalString = IntervalString.split(',');
-	len = len - 1;
-
-	document.forms[0][SelectControl].options[0].selected = false;
-
-	for (i = 0; i < len; i++) {
-		if ( i == parseInt(arrIntervalString[j]) ) {
-			document.forms[0][SelectControl].options[i+offset].selected = true;
-			j = j + 1;
-		}
-		else {
-			document.forms[0][SelectControl].options[i+offset].selected = false;
-		}
-	}
-}
-
-function SetAllSelect(SelectControl) {
-	document.forms[0][SelectControl].options[0].selected = false;
-	var len = document.forms[0][SelectControl].length;
-	var i = 1;
-	for (i = 1; i < len; i++) {
-		document.forms[0][SelectControl].options[i].selected = true;
-		
-	}
-
-}
-
-function SetControTopOption(SelectControl) {
-	// Set the first member and reset all others
-	document.forms[0][SelectControl].options[0].selected = true;
-	var len = document.forms[0][SelectControl].length;
-	var i = 1;
-	for (i = 1; i < len; i++) {
-		document.forms[0][SelectControl].options[i].selected = false;
-	}
-
-}
-
-function SetEnabledStatusCron() {
-
-	if (document.forms[0].chkCronEnabled.checked == false) {
-		document.getElementById('txthCronEnabled').value ='0';
-		}
-		
-	else {
-		document.getElementById('txthCronEnabled').value ='1';
-		}
-		SetConfigChanged();
-}
-
-function RemoveCrontabEntry(crontabentry) {
-	document.location.href='$SCRIPT_NAME?remove_crontabentry='+crontabentry;
-}
-
-
-//--></script>
-EOF
-
-echo "<div id=\"EditWindow\" style=\"display:none;position:absolute;border-style: solid;background-color: white;padding: 5px;\">"
-echo "<table style=\"text-align: left; font-size: 0.8em;\" border=\"0\" cellpadding=\"2\" cellspacing=\"1\" summary=\"@TR<<Crontab>>\">"
-echo "<tr>"
-echo "<td><strong>Minutes</strong></td>"
-echo "<td><strong>Hours</strong></td>"
-echo "<td><strong>Days</strong></td>"
-echo "<td><strong>Months</strong></td>"
-echo "<td><strong>Days of the week</strong></td>"
-echo "</tr>"
-echo "<tr>"
-echo "<td>"
-echo "<select id=\"sltMinutes\" size=\"8\" name=\"sltMinutes\" class=\"input\" style=\"width:160px;\" multiple=\"multiple\">"
-echo "<option selected=\"selected\" value=\"\">every minute</option>"
-i=0; while [ $i -le 59 ]; do echo "<option value=\"$i\">$i</option>"; i=$(($i+1)); done
-echo "</select>"
-echo "</td>"
-echo "<td>"
-echo "<select id=\"sltHours\" size=\"8\" name=\"sltHours\" class=\"input\" style=\"width:160px;\" multiple=\"multiple\">"
-echo "<option selected=\"selected\" value=\"\">every hour</option>"
-i=0; while [ $i -le 23 ]; do echo "<option value=\"$i\">$i</option>"; i=$(($i+1)); done
-echo "</select>"
-echo "</td>"
-echo "<td>"
-echo "<select id=\"sltDays\" size=\"8\" name=\"sltDays\" class=\"input\" style=\"width:160px;\" multiple=\"multiple\">"
-echo "<option selected=\"selected\" value=\"\">every day</option>"
-i=1; while [ $i -le 31 ]; do echo "<option value=\"$i\">$i</option>"; i=$(($i+1)); done
-echo "</select>"
-echo "</td>"
-echo "<td>"
-echo "<select id=\"sltMonths\" size=\"8\" name=\"sltMonths\" class=\"input\" style=\"width:160px;\" multiple=\"multiple\">"
-echo "<option selected=\"selected\" value=\"\">every month</option>"
-echo "<option value=\"1\">January</option>"
-echo "<option value=\"2\">February</option>"
-echo "<option value=\"3\">March</option>"
-echo "<option value=\"4\">April</option>"
-echo "<option value=\"5\">May</option>"
-echo "<option value=\"6\">June</option>"
-echo "<option value=\"7\">July</option>"
-echo "<option value=\"8\">August</option>"
-echo "<option value=\"9\">September</option>"
-echo "<option value=\"10\">October</option>"
-echo "<option value=\"11\">November</option>"
-echo "<option value=\"12\">December</option>"
-echo "</select>"
-echo "</td>"
-echo "<td>"
-echo "<select id=\"sltDaysOfWeek\" size=\"8\" name=\"sltDaysOfWeek\" class=\"input\" style=\"width:160px;\" multiple=\"multiple\">"
-echo "<option selected=\"selected\" value=\"\">every day of the week</option>"
-echo "<option value=\"0\">Sunday</option>"
-echo "<option value=\"1\">Monday</option>"
-echo "<option value=\"2\">Tuesday</option>"
-echo "<option value=\"3\">Wednesday</option>"
-echo "<option value=\"4\">Thursday</option>"
-echo "<option value=\"5\">Friday</option>"
-echo "<option value=\"6\">Saturday</option>"
-echo "</select>"
-echo "</td>"
-echo "</tr>"
-echo "<tr>"
-echo "<td align=\"right\"><input type=\"hidden\" id=\"txthMinutes\" name=\"txthMinutes\" value=\"\" /><a href=\"javascript:SetAllSelect('sltMinutes');\">set all</a>&nbsp;&nbsp;<a href=\"javascript:SetControTopOption('sltMinutes');\">clear</a></td>"
-echo "<td align=\"right\"><input type=\"hidden\" id=\"txthHours\" name=\"txthHours\" value=\"\" /><a href=\"javascript:SetAllSelect('sltHours');\">set all</a>&nbsp;&nbsp;<a href=\"javascript:SetControTopOption('sltHours');\">clear</a></td>"
-echo "<td align=\"right\"><input type=\"hidden\" id=\"txthDays\" name=\"txthDays\" value=\"\" /><a href=\"javascript:SetAllSelect('sltDays');\">set all</a>&nbsp;&nbsp;<a href=\"javascript:SetControTopOption('sltDays');\">clear</a></td>"
-echo "<td align=\"right\"><input type=\"hidden\" id=\"txthMonths\" name=\"txthMonths\" value=\"\" /><a href=\"javascript:SetAllSelect('sltMonths');\">set all</a>&nbsp;&nbsp;<a href=\"javascript:SetControTopOption('sltMonths');\">clear</a></td>"
-echo "<td align=\"right\"><input type=\"hidden\" id=\"txthDaysOfWeek\" name=\"txthDaysOfWeek\" value=\"\" /><a href=\"javascript:SetAllSelect('sltDaysOfWeek');\">set all</a>&nbsp;&nbsp;<a href=\"javascript:SetControTopOption('sltDaysOfWeek');\">clear</a></td>"
-echo "</tr>"
-echo "<tr>"
-echo "<td>Every"
-echo "<select id=\"ddEveryXminute\" name=\"ddEveryXminute\">"
-echo "<option selected=\"selected\" value=\"\">none</option>"
-i=1; while [ $i -le 59 ]; do echo "<option value=\"$i\">$i</option>"; i=$(($i+1)); done
-echo "</select>"
-echo "th"
-echo "</td>"
-echo "<td>Every"
-echo "<select id=\"ddEveryXhour\" name=\"ddEveryXhour\">"
-echo "<option selected=\"selected\" value=\"\">none</option>"
-i=0; while [ $i -le 23 ]; do echo "<option value=\"$i\">$i</option>"; i=$(($i+1)); done
-echo "</select>"
-echo "th"
-echo "</td>"
-echo "<td>Every"
-echo "<select id=\"ddEveryXday\" name=\"ddEveryXday\">"
-echo "<option selected=\"selected\" value=\"\">none</option>"
-i=1; while [ $i -le 31 ]; do echo "<option value=\"$i\">$i</option>"; i=$(($i+1)); done
-echo "</select>"
-echo "th"
-echo "</td>"
-echo "<td>&nbsp;</td>"
-echo "<td>&nbsp;</td>"
-echo "</tr>"
-echo "<tr><td colspan=\"5\">&nbsp;</td></tr>"
-#echo "<tr><td align=\"right\"><strong>User</strong></td><td colspan=\"3\"><input style=\"width:400px;\" id=\"txtUsername\" type=\"text\" name=\"txtUsername\" value=\"\" /></td><td><a href=\"javascript:BuildInterval(true);\">generate crontab entry</a></td></tr>"
-echo "<tr><td align=\"right\"><strong>Command</strong></td><td colspan=\"3\"><input style=\"width:400px;\" id=\"txtCommand\" type=\"text\" name=\"txtCommand\" value=\"\" /></td><td><a href=\"javascript:BuildInterval(true);\">generate crontab entry</a></td></tr>"
-echo "<tr><td align=\"right\"><strong>Enabled</strong></td><td colspan=\"3\"><input type=\"checkbox\" id=\"chkCronEnabled\" name=\"chkCronEnabled\" onchange=\"SetEnabledStatusCron();\"/><input type=\"hidden\" id=\"txthCronEnabled\" name=\"txthCronEnabled\" value=\"0\" /></td><td><a href=\"javascript:ResetForm();\">reset form</a></td></tr>"
-echo "<tr><td colspan=\"5\">&nbsp;</td></tr>"
-echo "<tr><td align=\"right\"><strong>Crontab entry</strong></td><td colspan=\"4\"><input readonly=\"readonly\" style=\"width:400px;\" id=\"txtCrontabEntry\" type=\"text\" name=\"txtCrontabEntry\" value=\"\" /></td></tr>"
-echo "<tr><td colspan=\"5\"></td></tr>"
-echo "<tr><td colspan=\"3\">&nbsp;</td><td colspan=\"2\"><a href=\"javascript:HideContent('EditWindow','update');\">update crontab entry</a>&nbsp;&nbsp;&nbsp;<a href=\"javascript:HideContent('EditWindow','cancel')\">cancel</a></td></tr>"
-echo "</table>"
-echo "</div>"
-
-echo "<h3><strong>@TR<<Crontab configuration root>></strong></h3>"
-echo "<div id=\"WarningConfigChange\" style=\"left:300px;top:0px;display:none;position:absolute;border-style: solid;background-color: white;padding: 5px;\"><img width=\"17\" src=\"/images/warning.png\" alt=\"Configuration changed\" /> Configuration changed. Press 'Save Changes'</div>"
-echo "<table style=\"width: 90%; margin-left: 2.5em; text-align: left; font-size: 0.8em;\" border=\"0\" cellpadding=\"2\" cellspacing=\"1\" summary=\"@TR<<Crontabs>>\">"
-
-uci_load crontabs
-cur_color="odd"
-
-for crontab in $CRONTABS_cfg; do
-
-	if  [ "$FORM_submit" = "" ]; then
-		config_get FORM_MINUTES $crontab minutes
-		config_get FORM_HOURS $crontab hours
-		config_get FORM_DAYS $crontab days
-		config_get FORM_MONTHS $crontab months
-		config_get FORM_WEEKDAYS $crontab weekdays
-		#config_get FORM_USER $crontab user
-		config_get FORM_COMMAND $crontab command
-		config_get FORM_ENABLED $crontab enabled
-	else
-		
-		
-		eval FORM_MINUTES="\$FORM_MINUTES_${crontab}"
-		eval FORM_HOURS="\$FORM_HOURS_${crontab}"
-		eval FORM_DAYS="\$FORM_DAYS_${crontab}"
-		eval FORM_MONTHS="\$FORM_MONTHS_${crontab}"
-		eval FORM_WEEKDAYS="\$FORM_WEEKDAYS_${crontab}"
-		#eval FORM_USER="\$FORM_USER_${crontab}"
-		eval FORM_COMMAND="\$FORM_COMMAND_${crontab}"
-		eval FORM_ENABLED="\$FORM_ENABLED_${crontab}"
-
-		if [ "$FORM_MINUTES" != "" ]; then
-		
-			uci_set "crontabs" "$crontab" "minutes" "$FORM_MINUTES"
-			uci_set "crontabs" "$crontab" "hours" "$FORM_HOURS"
-			uci_set "crontabs" "$crontab" "days" "$FORM_DAYS"
-			uci_set "crontabs" "$crontab" "months" "$FORM_MONTHS"
-			uci_set "crontabs" "$crontab" "weekdays" "$FORM_WEEKDAYS"
-			#uci_set "crontabs" "$crontab" "user" "$FORM_USER"
-			uci_set "crontabs" "$crontab" "command" "$FORM_COMMAND"
-			uci_set "crontabs" "$crontab" "enabled" "$FORM_ENABLED"
-		else
-			config_get FORM_MINUTES $crontab minutes
-			config_get FORM_HOURS $crontab hours
-			config_get FORM_DAYS $crontab days
-			config_get FORM_MONTHS $crontab months
-			config_get FORM_WEEKDAYS $crontab weekdays
-			#config_get FORM_USER $crontab user
-			config_get FORM_COMMAND $crontab command
-			config_get FORM_ENABLED $crontab enabled
-		fi
-	fi
-
-	#check if crontab is enabled
-	if [ "$FORM_ENABLED" = "1" ]; then
-		ENABLEDIMAGE="<img width=\"17\" src=\"/images/service_enabled.png\" alt=\"Cron entry Enabled\" />"
-		CRON_ENABLED="Yes"
-	else
-		ENABLEDIMAGE="<img width=\"17\" src=\"/images/service_disabled.png\" alt=\"Cron entry Disabled\" />"
-		CRON_ENABLED="No"
-	fi
-
-	FORM_escCOMMAND=`echo "$FORM_COMMAND" | sed -e 's/\&/\&amp;/g' -e 's/"/\&quot;/g' -e 's/</\&lt;/g' -e 's/>/\&gt;/g'` 	
-	
-	get_tr
-	echo $tr"<td width=\"35\" align=\"center\" valign=\"middle\" rowspan=\"7\">$ENABLEDIMAGE</td><td width=\"100\"><strong>Minutes</strong></td><td>$FORM_MINUTES</td><td width=\"35\" align=\"center\" valign=\"middle\" rowspan=\"7\"><a href=\"javascript:OpenEditWindow('EditWindow','$crontab')\">@TR<<edit>></a></td><td width=\"35\" align=\"center\" valign=\"middle\" rowspan=\"7\"><a href=\"javascript:RemoveCrontabEntry('$crontab')\">@TR<<remove>></a></td><td><input id=\"MINUTES_$crontab\" type=\"hidden\" name=\"MINUTES_$crontab\" value=\"$FORM_MINUTES\" /></td></tr>"
-	echo $tr"<td width=\"100\"><strong>Hours</strong></td><td>$FORM_HOURS</td><td><input id=\"HOURS_$crontab\" type=\"hidden\" name=\"HOURS_$crontab\" value=\"$FORM_HOURS\" /></td></tr>"
-	echo $tr"<td width=\"100\"><strong>Days</strong></td><td>$FORM_DAYS</td><td><input id=\"DAYS_$crontab\" type=\"hidden\" name=\"DAYS_$crontab\" value=\"$FORM_DAYS\" /></td></tr>"
-	echo $tr"<td width=\"100\"><strong>Months</strong></td><td>$FORM_MONTHS</td><td><input id=\"MONTHS_$crontab\" type=\"hidden\" name=\"MONTHS_$crontab\" value=\"$FORM_MONTHS\" /></td></tr>"
-	echo $tr"<td width=\"100\"><strong>Weekdays</strong></td><td>$FORM_WEEKDAYS</td><td><input id=\"WEEKDAYS_$crontab\" type=\"hidden\" name=\"WEEKDAYS_$crontab\" value=\"$FORM_WEEKDAYS\" /></td></tr>"
-	#echo $tr"<td width=\"100\"><strong>User</strong></td><td>$FORM_USER</td><td><input id=\"USER_$crontab\" type=\"hidden\" name=\"USER_$crontab\" value=\"$FORM_USER\" /></td></tr>"
-	echo $tr"<td width=\"100\"><strong>Command</strong></td><td>$FORM_escCOMMAND</td><td><input id=\"COMMAND_$crontab\" type=\"hidden\" name=\"COMMAND_$crontab\" value=\"$FORM_escCOMMAND\" /></td></tr>"
-	echo $tr"<td width=\"100\"><strong>Enabled</strong></td><td>$CRON_ENABLED</td><td><input id=\"ENABLED_$crontab\" type=\"hidden\" name=\"ENABLED_$crontab\" value=\"$FORM_ENABLED\" /></td></tr>"
-	echo "<tr><td colspan=\"6\"><img alt=\"\" height=\"5\" width=\"1\" src=\"/images/pixel.gif\" /></td></tr>"
-	
-done
-
-echo "<tr><td colspan=\"3\">&nbsp;</td><td>&nbsp;</td><td align=\"center\"><a href=\"javascript:OpenEditWindow('EditWindow','newCron')\">@TR<<add>></a></td><td></td></tr>"
-
-echo "</table>"
-
-
-echo "<input id=\"MINUTES_newCron\" type=\"hidden\" name=\"MINUTES_newCron\" value=\"\" />"
-echo "<input id=\"HOURS_newCron\" type=\"hidden\" name=\"HOURS_newCron\" value=\"\" />"
-echo "<input id=\"DAYS_newCron\" type=\"hidden\" name=\"DAYS_newCron\" value=\"\" />"
-echo "<input id=\"MONTHS_newCron\" type=\"hidden\" name=\"MONTHS_newCron\" value=\"\" />"
-echo "<input id=\"WEEKDAYS_newCron\" type=\"hidden\" name=\"WEEKDAYS_newCron\" value=\"\" />"
-#echo "<input id=\"USER_newCron\" type=\"hidden\" name=\"USER_newCron\" value=\"\" />"
-echo "<input id=\"COMMAND_newCron\" type=\"hidden\" name=\"COMMAND_newCron\" value=\"\" />"
-echo "<input id=\"ENABLED_newCron\" type=\"hidden\" name=\"ENABLED_newCron\" value=\"\" />"
-
-
-footer %>
-<!--
-##WEBIF:name:System:130:Crontabs
--->
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/cgi-bin/webif/system-mount.sh buildroot/package/webif/files/www/cgi-bin/webif/system-mount.sh
--- buildroot.orig/package/webif/files/www/cgi-bin/webif/system-mount.sh	2010-09-24 22:20:28.000000000 -0400
+++ buildroot/package/webif/files/www/cgi-bin/webif/system-mount.sh	1969-12-31 19:00:00.000000000 -0500
@@ -1,395 +0,0 @@
-#!/usr/bin/webif-page
-<?
-. /usr/lib/webif/webif.sh
-###################################################################
-# Mount points
-#
-# Description:
-#		Mountpoints
-#			Add mount points to fstab 
-#
-# Author(s) [in order of work date]:
-#       m4rc0 <jansssenmaj@gmail.com>
-#       IVBela <ivbela@gmail.com>
-#
-# Major revisions:
-#		2008-11-12	Initial release
-#		2008-11-15  Made editable
-#		2008-12-20  Added mount/umount support
-#
-# NVRAM variables referenced:
-#       none
-#
-# Configuration files referenced:
-#		/etc/config/fstab
-#
-# Required components:
-
-header "System" "Mountpoints" "@TR<<Mountpoints>>" '' "$SCRIPT_NAME"
-
-# Add new mountpint
-if ! empty "$FORM_TARGET_newMount"; then
-	uci_add "fstab" "mount" ""; mountpoint="$CONFIG_SECTION"
-	uci_set "fstab" "$mountpoint" "target" "$FORM_TARGET_newMount"
-	uci_set "fstab" "$mountpoint" "device" "$FORM_DEVICE_newMount"
-	uci_set "fstab" "$mountpoint" "fstype" "$FORM_FSTYPE_newMount"
-	uci_set "fstab" "$mountpoint" "options" "$FORM_OPTIONS_newMount"
-	uci_set "fstab" "$mountpoint" "enabled" "$FORM_ENABLED_newMount"
-	FORM_TARGET_newMount=""
-fi
-
-# Remove selected mountpoint
-if ! empty "$FORM_remove_mountpoint"; then
-	uci_remove "fstab" "$FORM_remove_mountpoint"
-fi
-
-# Mount/Unmount selected mountpoint
-if ! empty "$FORM_domount_mountpoint"; then
-  case "$FORM_domount_action" in
-    mount)
-      mount $FORM_domount_mountpoint
-    ;;
-    umount)
-      umount $FORM_domount_mountpoint
-    ;;
-  esac
-fi
-
-config_cb() {
-	local cfg_type="$1"
-	local cfg_name="$2"
-
-	case "$cfg_type" in
-	        mount)
-	                append MOUNTPOINTS "$cfg_name"
-	        ;;
-	        swap)
-	                append SWAP "$cfg_name"
-	        ;;	esac
-}
-
-# change rowcolors
-get_tr() {
-	if equal "$cur_color" "odd"; then
-		cur_color="even"
-		tr="<tr>"
-	else
-		cur_color="odd"
-		tr="<tr class=\"odd\">"
-	fi
-}
-
-
-cat <<EOF
-
-<script type="text/javascript" language="JavaScript"><!--
- 
-var cX = 0; var cY = 0; var rX = 0; var rY = 0; var MountPoint = ''; var SwapMountPoint = ''; ConfigChanged = false;
-
-function UpdateCursorPosition(e){ cX = e.pageX; cY = e.pageY;}
-function UpdateCursorPositionDocAll(e){ cX = event.clientX; cY = event.clientY;}
-
-if(document.all) { document.onmousemove = UpdateCursorPositionDocAll; }
-else { document.onmousemove = UpdateCursorPosition; }
-
-function AssignPosition(d) {
-if(self.pageYOffset) {
-	rX = self.pageXOffset;
-	rY = self.pageYOffset;
-	}
-else if(document.documentElement && document.documentElement.scrollTop) {
-	rX = document.documentElement.scrollLeft;
-	rY = document.documentElement.scrollTop;
-	}
-else if(document.body) {
-	rX = document.body.scrollLeft;
-	rY = document.body.scrollTop;
-	}
-if(document.all) {
-	cX += rX; 
-	cY += rY;
-	}
-
-d.style.left = (cX-150) + "px";
-d.style.top = (cY-240) + "px";
-
-}
-
-function HideContent(d,doAction) {
-if(d.length < 1) { return; }
-document.getElementById(d).style.display = "none";
-
-if (doAction == 'update' && ConfigChanged == true ){
-
-	document.getElementById('TARGET_'+MountPoint).value = document.getElementById('txtTarget').value;
-	document.getElementById('DEVICE_'+MountPoint).value = document.getElementById('txtDevice').value;
-	document.getElementById('FSTYPE_'+MountPoint).value = document.getElementById('txtFStype').value;
-	document.getElementById('OPTIONS_'+MountPoint).value = document.getElementById('txtOptions').value;
-	document.getElementById('ENABLED_'+MountPoint).value = document.getElementById('txtEnabled').value;
-	document.getElementById('WarningConfigChange').style.display = "block";
-	}
-
-}
-
-function RemoveMount(mountpoint) {
-	document.location.href='$SCRIPT_NAME?remove_mountpoint='+mountpoint;
-	}
-
-function DoMount(mountpoint,doAction) {
-	document.location.href='$SCRIPT_NAME?domount_mountpoint='+mountpoint+'&domount_action='+doAction;
-	}
-
-function OpenEditWindow(d,MOUNTPOINT) {
-if(d.length < 1) { return; }
-
-document.getElementById('txtTarget').value = document.getElementById('TARGET_'+MOUNTPOINT).value;
-document.getElementById('txtDevice').value = document.getElementById('DEVICE_'+MOUNTPOINT).value;
-document.getElementById('txtFStype').value = document.getElementById('FSTYPE_'+MOUNTPOINT).value;
-document.getElementById('txtOptions').value = document.getElementById('OPTIONS_'+MOUNTPOINT).value;
-document.getElementById('txtEnabled').value = document.getElementById('ENABLED_'+MOUNTPOINT).value;
-
-if (document.getElementById('ENABLED_'+MOUNTPOINT).value == '1') {
-		document.forms[0].MountEnable.checked = true;
-	}
-	else {
-		document.forms[0].MountEnable.checked = false;
-	}
-
-
-var dd = document.getElementById(d);
-AssignPosition(dd);
-dd.style.display = "block";
-
-MountPoint = MOUNTPOINT;
-}
-
-function OpenEditSwapWindow(d, SWAP) {
-if(d.length < 1) { return; }
-
-document.getElementById('txtDeviceSwap').value = document.getElementById('DEVICESWAP_'+SWAP).value;
-document.getElementById('txtEnabledSwap').value = document.getElementById('ENABLEDSWAP_'+SWAP).value;
-
-if (document.getElementById('ENABLEDSWAP_'+SWAP).value == '1') {
-		document.forms[0].SwapEnable.checked = true;
-	}
-	else {
-		document.forms[0].SwapEnable.checked = false;
-	}
-
-
-var dd = document.getElementById(d);
-AssignPosition(dd);
-dd.style.display = "block";
-
-SwapMountPoint = SWAP;
-
-}
-
-function HideContentSwap(d,doAction) {
-if(d.length < 1) { return; }
-document.getElementById(d).style.display = "none";
-
-if (doAction == 'update' && ConfigChanged == true ){
-
-	document.getElementById('DEVICESWAP_'+SwapMountPoint).value = document.getElementById('txtDeviceSwap').value;
-	document.getElementById('ENABLEDSWAP_'+SwapMountPoint).value = document.getElementById('txtEnabledSwap').value;
-	document.getElementById('WarningConfigChange').style.display = "block";
-	}
-
-
-	
-}
-function SetConfigChanged() {
-	
-	ConfigChanged = true;
-	
-	}
-
-function SetEnabledStatusMount() {
-
-	if (document.forms[0].MountEnable.checked == false) {
-		document.getElementById('txtEnabled').value ='0';
-		}
-		
-	else {
-		document.getElementById('txtEnabled').value ='1';
-		}
-	ConfigChanged = true;
-	}
-
-function SetEnabledStatusSwap() {
-
-	if (document.forms[0].SwapEnable.checked == false) {
-		document.getElementById('txtEnabledSwap').value ='0';
-		}
-		
-	else {
-		document.getElementById('txtEnabledSwap').value ='1';
-		}
-	ConfigChanged = true;
-	}
-	
-	
-//--></script>
-EOF
-
-# floating div for editing the mountpoints
-echo "<div id=\"EditWindow\" style=\"display:none;position:absolute;border-style: solid;background-color: white;padding: 5px;\">"
-echo "<table style=\"text-align: left; font-size: 0.8em;\" border=\"0\" cellpadding=\"2\" cellspacing=\"1\" summary=\"@TR<<Mountpoints>>\">"
-echo "<tr><td width=\"100\"><strong>Target</strong></td><td colspan=\"2\"><input type=\"text\" id=\"txtTarget\" name=\"txtTarget\" value=\"\" onChange=\"SetConfigChanged()\" /></td></tr>"
-echo "<tr><td width=\"100\"><strong>Device</strong></td><td colspan=\"2\"><input type=\"text\" id=\"txtDevice\" name=\"txtDevice\" value=\"\" onChange=\"SetConfigChanged()\" /></td></tr>"
-echo "<tr><td width=\"100\"><strong>FStype</strong></td><td colspan=\"2\"><input type=\"text\" id=\"txtFStype\" name=\"txtFStype\" value=\"\" onChange=\"SetConfigChanged()\" /></td></tr>"
-echo "<tr><td width=\"100\"><strong>Options</strong></td><td colspan=\"2\"><input type=\"text\" id=\"txtOptions\" name=\"txtOptions\" value=\"\" onChange=\"SetConfigChanged()\" /></td></tr>"
-echo "<tr>"
-echo "<td width=\"100\"><strong>Enabled</strong></td>"
-echo "<td colspan=\"2\"><input type=\"checkbox\" id=\"MountEnable\" name=\"MountEnable\" onchange=\"SetEnabledStatusMount();\" /><input type=\"hidden\" id=\"txtEnabled\" name=\"txtEnabled\" value=\"\" /></td>"
-echo "</tr>"
-echo "<tr>"
-echo "<td colspan=\"2\"><a href=\"javascript:HideContent('EditWindow','update')\">@TR<<Update>></a></td>"
-echo "<td><a href=\"javascript:HideContent('EditWindow','cancel')\">@TR<<Cancel>></a></td>"
-echo "</tr>"
-echo "</table>"
-echo "</div>"
-
-# floating div for editing swap
-echo "<div id=\"EditSwapWindow\" style=\"display:none;position:absolute;border-style: solid;background-color: white;padding: 5px;\">"
-echo "<table style=\"text-align: left; font-size: 0.8em;\" border=\"0\" cellpadding=\"2\" cellspacing=\"1\" summary=\"@TR<<swap>>\">"
-echo "<tr><td width=\"100\"><strong>Device</strong></td><td colspan=\"2\"><input type=\"text\" id=\"txtDeviceSwap\" name=\"txtDeviceSwap\" value=\"\" onChange=\"SetConfigChanged()\" /></td></tr>"
-echo "<tr>"
-echo "<td width=\"100\"><strong>Enabled</strong></td>"
-echo "<td colspan=\"2\"><input type=\"checkbox\" id=\"SwapEnable\" name=\"SwapEnable\" onchange=\"SetEnabledStatusSwap();\" /><input type=\"hidden\" id=\"txtEnabledSwap\" name=\"txtEnabledSwap\" value=\"\" onChange=\"SetConfigChanged()\" /></td>"
-echo "</tr>"
-echo "<tr>"
-echo "<td colspan=\"2\"><a href=\"javascript:HideContentSwap('EditSwapWindow','update')\">@TR<<Update>></a></td>"
-echo "<td><a href=\"javascript:HideContentSwap('EditSwapWindow','cancel')\">@TR<<Cancel>></a></td>"
-echo "</tr>"
-echo "</table>"
-echo "</div>"
-
-uci_load fstab
-
-cur_color="odd"
-echo "<h3><strong>@TR<<Mountpoint configurations>></strong></h3>"
-echo "<div id=\"WarningConfigChange\" style=\"left:300px;top:0px;display:none;position:absolute;border-style: solid;background-color: white;padding: 5px;\"><img width=\"17\" src=\"/images/warning.png\" alt=\"Configuration changed\" /> Configuration changed. Press 'Save Changes'</div>"
-echo "<table style=\"width: 90%; margin-left: 2.5em; text-align: left; font-size: 0.8em;\" border=\"0\" cellpadding=\"2\" cellspacing=\"1\" summary=\"@TR<<Mountpoints>>\">"
-for mountpoint in $MOUNTPOINTS; do
-
-	if  [ "$FORM_submit" = "" ]; then
-		config_get FORM_TARGET $mountpoint target
-		config_get FORM_DEVICE $mountpoint device
-		config_get FORM_FSTYPE $mountpoint fstype
-		config_get FORM_OPTIONS $mountpoint options
-		config_get FORM_ENABLED $mountpoint enabled
-	else
-		
-		eval FORM_TARGET="\$FORM_TARGET_${mountpoint}"
-		eval FORM_DEVICE="\$FORM_DEVICE_${mountpoint}"
-		eval FORM_FSTYPE="\$FORM_FSTYPE_${mountpoint}"
-		eval FORM_OPTIONS="\$FORM_OPTIONS_${mountpoint}"
-		eval FORM_ENABLED="\$FORM_ENABLED_${mountpoint}"
-	
-		if [ "$FORM_TARGET" != "" ]; then
-			uci_set "fstab" "$mountpoint" "target" "$FORM_TARGET"
-			uci_set "fstab" "$mountpoint" "device" "$FORM_DEVICE"
-			uci_set "fstab" "$mountpoint" "fstype" "$FORM_FSTYPE"
-			uci_set "fstab" "$mountpoint" "options" "$FORM_OPTIONS"
-			uci_set "fstab" "$mountpoint" "enabled" "$FORM_ENABLED"
-		else
-			config_get FORM_TARGET $mountpoint target
-			config_get FORM_DEVICE $mountpoint device
-			config_get FORM_FSTYPE $mountpoint fstype
-			config_get FORM_OPTIONS $mountpoint options
-			config_get FORM_ENABLED $mountpoint enabled
-
-		fi
-	fi
-
-	#check if mountpoint is enabled
-	if [ "$FORM_ENABLED" == "1" ]; then
-		ENABLEDIMAGE="<img width=\"17\" src=\"/images/service_enabled.png\" alt=\"Mountpoint Enabled\" />"
-		MOUNT_ENABLED="Yes"
-	else
-		ENABLEDIMAGE="<img width=\"17\" src=\"/images/service_disabled.png\" alt=\"Mountpoint Disabled\" />"
-		MOUNT_ENABLED="No"
-	fi
-	
-	#check if mountpoint is mounted
-	if grep -q $FORM_TARGET /proc/mounts; then
-		MOUNT_MOUNTED="Yes"
-		MOUNT_TEXT="umount"
-		MOUNT_ACTION="umount"
-	else
-		MOUNT_MOUNTED="No"
-		MOUNT_TEXT="mount"
-		MOUNT_ACTION="mount"
-	fi
-	
-	#                  1              23                                       4567
-	# de '\\\\\\\' --> \ = escape SH, \\ becomes \ which will escape CAT, last: \\\\ om java te escapen om \\ te krijgen
-	#FORM_escOPTIONS=`echo "$FORM_OPTIONS" | sed -e 's/"/%22/g' | sed -e 's/\\\/\\\\\\\/g'` 
-	
-	FORM_escOPTIONS=`echo "$FORM_OPTIONS" | sed -e 's/"/\&#34;/g'` 
-
-	get_tr
-	echo $tr"<td width=\"35\" align=\"center\" valign=\"middle\" rowspan=\"6\">$ENABLEDIMAGE</td><td width=\"100\"><strong>Target</strong></td><td>$FORM_TARGET</td><td width=\"35\" align=\"center\" valign=\"middle\" rowspan=\"6\"><a href=\"javascript:OpenEditWindow('EditWindow','$mountpoint')\">@TR<<edit>></a></td><td width=\"35\" align=\"center\" valign=\"middle\" rowspan=\"6\"><a href=\"javascript:RemoveMount('$mountpoint')\">@TR<<remove>></a></td><td width=\"35\" align=\"center\" valign=\"middle\" rowspan=\"6\"><a href=\"javascript:DoMount('$FORM_TARGET','$MOUNT_ACTION')\">$MOUNT_TEXT</a></td><td><input id=\"TARGET_$mountpoint\" type=\"hidden\" name=\"TARGET_$mountpoint\" value=\"$FORM_TARGET\" /></td></tr>"
-	echo $tr"<td width=\"100\"><strong>Device</strong></td><td>$FORM_DEVICE</td><td><input id=\"DEVICE_$mountpoint\" type=\"hidden\" name=\"DEVICE_$mountpoint\" value=\"$FORM_DEVICE\" /></td></tr>"
-	echo $tr"<td width=\"100\"><strong>FStype</strong></td><td>$FORM_FSTYPE</td><td><input id=\"FSTYPE_$mountpoint\" type=\"hidden\" name=\"FSTYPE_$mountpoint\" value=\"$FORM_FSTYPE\" /></td></tr>"
-	echo $tr"<td width=\"100\"><strong>Options</strong></td><td>$FORM_OPTIONS</td><td><input id=\"OPTIONS_$mountpoint\" type=\"hidden\" name=\"OPTIONS_$mountpoint\" value=\"$FORM_escOPTIONS\" /></td></tr>"
-	echo $tr"<td width=\"100\"><strong>Enabled</strong></td><td>$MOUNT_ENABLED</td><td><input id=\"ENABLED_$mountpoint\" type=\"hidden\" name=\"ENABLED_$mountpoint\" value=\"$FORM_ENABLED\" /></td></tr>"
-	echo $tr"<td width=\"100\"><strong>Mounted</strong></td><td>$MOUNT_MOUNTED</td><td><input id=\"MOUNTED_$mountpoint\" type=\"hidden\" name=\"MOUNTED_$mountpoint\" value=\"$FORM_MOUNTED\" /></td></tr>"
-	echo "<tr><td colspan=\"6\"><img alt=\"\" height=\"5\" width=\"1\" src=\"/images/pixel.gif\" /></td></tr>"
-done
-
-echo "<tr><td colspan=\"3\">&nbsp;</td><td>&nbsp;</td><td align=\"center\"><a href=\"javascript:OpenEditWindow('EditWindow','newMount')\">@TR<<add>></a></td><td></td></tr>"
-
-echo "</table><br />"
-
-echo "<input id=\"TARGET_newMount\" type=\"hidden\" name=\"TARGET_newMount\" value=\"\" />"
-echo "<input id=\"DEVICE_newMount\" type=\"hidden\" name=\"DEVICE_newMount\" value=\"\" />"
-echo "<input id=\"FSTYPE_newMount\" type=\"hidden\" name=\"FSTYPE_newMount\" value=\"\" />"
-echo "<input id=\"OPTIONS_newMount\" type=\"hidden\" name=\"OPTIONS_newMount\" value=\"\" />"
-echo "<input id=\"ENABLED_newMount\" type=\"hidden\" name=\"ENABLED_newMount\" value=\"0\" />"
-
-
-cur_color="odd"
-echo "<h3><strong>@TR<<Swap configuration>></strong></h3>"
-echo "<table style=\"width: 90%; margin-left: 2.5em; text-align: left; font-size: 0.8em;\" border=\"0\" cellpadding=\"2\" cellspacing=\"1\" summary=\"@TR<<Swap>>\">"
-for swap in $SWAP; do
-
-	if  [ "$FORM_submit" = "" ]; then 
-		config_get FORM_DEVICESWAP $swap device
-		config_get FORM_ENABLEDSWAP $swap enabled
-	else
-		eval FORM_DEVICESWAP="\$FORM_DEVICESWAP_${swap}"
-		eval FORM_ENABLEDSWAP="\$FORM_ENABLEDSWAP_${swap}"
-		
-		if [ "$FORM_DEVICESWAP" != "" ]; then
-			uci_set fstab $swap "device" $FORM_DEVICESWAP
-			uci_set fstab $swap "enabled" $FORM_ENABLEDSWAP
-		else
-			config_get FORM_DEVICESWAP $swap device
-			config_get FORM_ENABLEDSWAP $swap enabled
-		fi
-	fi
-		
-		
-	#check if swap is enabled
-	if [ "$FORM_ENABLEDSWAP" == "1" ]; then
-		ENABLEDIMAGE="<img width=\"17\" src=\"/images/service_enabled.png\" alt=\"Swap Enabled\" />"
-		SWAP_ENABLEDSWAP="Yes"
-	else
-		ENABLEDIMAGE="<img width=\"17\" src=\"/images/service_disabled.png\" alt=\"Swap Disabled\" />"
-		SWAP_ENABLEDSWAP="No"
-	fi
-
-	get_tr
-	echo $tr"<td width=\"35\" align=\"center\" valign=\"middle\" rowspan=\"2\">$ENABLEDIMAGE</td><td width=\"100\"><strong>Device</strong></td><td>$FORM_DEVICESWAP</td><td width=\"35\" align=\"center\" valign=\"middle\" rowspan=\"5\"><a href=\"javascript:OpenEditSwapWindow('EditSwapWindow','$swap')\">@TR<<edit>></a></td><td><input id=\"DEVICESWAP_$swap\" type=\"hidden\" name=\"DEVICESWAP_$swap\" value=\"$FORM_DEVICESWAP\" /></td></tr>"
-	echo $tr"<td width=\"100\"><strong>Enabled</strong></td><td>$SWAP_ENABLEDSWAP</td><td><input id=\"ENABLEDSWAP_$swap\" type=\"hidden\" name=\"ENABLEDSWAP_$swap\" value=\"$FORM_ENABLEDSWAP\" /></td></tr>"
-	echo "<tr><td colspan=\"3\"><img alt=\"\" height=\"5\" width=\"1\" src=\"/images/pixel.gif\" /></td></tr>"
-done
-echo "</table>"
-
-footer ?>
-<!--
-##WEBIF:name:System:330:Mountpoints
--->
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/cgi-bin/webif/system-password.sh buildroot/package/webif/files/www/cgi-bin/webif/system-password.sh
--- buildroot.orig/package/webif/files/www/cgi-bin/webif/system-password.sh	2010-09-24 22:20:28.000000000 -0400
+++ buildroot/package/webif/files/www/cgi-bin/webif/system-password.sh	1969-12-31 19:00:00.000000000 -0500
@@ -1,64 +0,0 @@
-#!/usr/bin/webif-page
-<? 
-. /usr/lib/webif/webif.sh
-
-if ! empty "$FORM_submit" ; then
-	SAVED=1
-	validate <<EOF
-string|FORM_pw1|@TR<<Password>>|required min=5|$FORM_pw1
-EOF
-	equal "$FORM_pw1" "$FORM_pw2" || {
-		[ -n "$ERROR" ] && ERROR="${ERROR}<br />"
-		ERROR="${ERROR}@TR<<Passwords do not match>><br />"
-	}
-	if [ "$REMOTE_USER" = "root" -o "$REMOTE_USER" = "admin" ]; then
-		empty "$ERROR" && {
-			RES=$(
-				(
-					echo "$FORM_pw1"
-					sleep 1
-					echo "$FORM_pw2"
-				) | passwd root 2>&1
-			)
-			equal "$?" 0 || ERROR="<pre>$RES</pre>"
-		}
-	else
-		exists /tmp/.webif/file-httpd.conf && HTTPD_CONFIG_FILE=/tmp/.webif/file-httpd.conf || HTTPD_CONFIG_FILE=/etc/httpd.conf
-		empty "$ERROR" && {
-			cat $HTTPD_CONFIG_FILE | awk '
-BEGIN {
-	FS=":"
-	system("/bin/rm /tmp/.webif/file-httpd.conf; mkdir /tmp/.webif/; touch /tmp/.webif/file-httpd.conf");
-}
-($1 != "") {
-	if (($1 == "/cgi-bin/webif/") && (ENVIRON["REMOTE_USER"] != $2)) {
-		print $1":"$2":"$3 >> "/tmp/.webif/file-httpd.conf"
-	}
-	if ($1 != "/cgi-bin/webif/") {
-		print $1":"$2 >> "/tmp/.webif/file-httpd.conf"
-	}
-	if (ENVIRON["REMOTE_USER"] == $2) {
-		("uhttpd -m " ENVIRON["FORM_pw1"]) | getline password
-		print $1":"$2":"password >> "/tmp/.webif/file-httpd.conf"
-	}
-}'
-	}
-	fi
-fi
-
-header "System" "Password" "@TR<<Password>>" '' "$SCRIPT_NAME"
-
-display_form <<EOF
-start_form|@TR<<Password Change>>
-field|@TR<<New Password>>:
-password|pw1
-field|@TR<<Confirm Password>>:
-password|pw2
-end_form
-EOF
-
-footer ?>
-
-<!--
-##WEBIF:name:System:250:Password
--->
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/cgi-bin/webif/system-settings.sh buildroot/package/webif/files/www/cgi-bin/webif/system-settings.sh
--- buildroot.orig/package/webif/files/www/cgi-bin/webif/system-settings.sh	2010-09-24 22:20:28.000000000 -0400
+++ buildroot/package/webif/files/www/cgi-bin/webif/system-settings.sh	2010-09-24 22:27:13.000000000 -0400
@@ -442,7 +442,6 @@
 field|@TR<<Theme>>
 select|theme|$FORM_theme
 $THEMES
-$WEBIF_SSL
 end_form
 start_form|@TR<<Web Configurator Settings>>
 field|@TR<<HTTP Port>>
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/cgi-bin/webif/system-upgrade.sh buildroot/package/webif/files/www/cgi-bin/webif/system-upgrade.sh
--- buildroot.orig/package/webif/files/www/cgi-bin/webif/system-upgrade.sh	2010-09-24 22:20:28.000000000 -0400
+++ buildroot/package/webif/files/www/cgi-bin/webif/system-upgrade.sh	2010-09-24 22:27:13.000000000 -0400
@@ -37,6 +37,8 @@
 EOF
 	else
 		echo "<br />Upgrading firmware, please wait ... <br />"
+		echo "<br />Deleting /tmp/opkg-lists ... <br />"
+		rm -rf /tmp/opkg-lists
 		if [ "$FORM_nokeepconfig" = "1" ]; then
 			uci_set webif general firstboot 1
 			uci_commit "webif"
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/errors/err400.html buildroot/package/webif/files/www/errors/err400.html
--- buildroot.orig/package/webif/files/www/errors/err400.html	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/webif/files/www/errors/err400.html	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,44 @@
+<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
+<head>
+<title>PacketProtector Administrative Console</title>
+	<link rel="stylesheet" type="text/css" href="/themes/active/waitbox.css" media="screen" />
+	<link rel="stylesheet" type="text/css" href="/themes/active/webif.css" />
+	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
+	<meta http-equiv="expires" content="-1" />
+</head>
+<body >
+
+
+<div id="container">
+	<div id="header">
+
+		<h1>X-Wrt Administration Console</h1>
+		<div id="short-status">
+		<h3>Status:</h3>
+		<ul>
+			<li><strong>*</strong></li>
+			<li><strong>*</strong></li>
+
+			<li><strong>*</strong></li>
+			<li><strong>*</strong></li>
+		</ul>
+		</div>
+	</div>
+
+	<div id="mainmenu"><h3>400</h3></div>
+	<div id="submenu"><ul><li><b>Bad Request</b></li></ul></div>
+	
+        <div id="content">
+
+<h2>400 Bad Request</h2>
+
+        </div>
+	<div id="footer">
+	<h3>PacketProtector</h3>
+	<em>with X-Wrt Extensions</em>
+
+	</div>
+</div>
+</body>
+
+</html>
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/errors/err401.html buildroot/package/webif/files/www/errors/err401.html
--- buildroot.orig/package/webif/files/www/errors/err401.html	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/webif/files/www/errors/err401.html	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,44 @@
+<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
+<head>
+<title>PacketProtector Administrative Console</title>
+	<link rel="stylesheet" type="text/css" href="/themes/active/waitbox.css" media="screen" />
+	<link rel="stylesheet" type="text/css" href="/themes/active/webif.css" />
+	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
+	<meta http-equiv="expires" content="-1" />
+</head>
+<body >
+
+
+<div id="container">
+	<div id="header">
+
+		<h1>X-Wrt Administration Console</h1>
+		<div id="short-status">
+		<h3>Status:</h3>
+		<ul>
+			<li><strong>*</strong></li>
+			<li><strong>*</strong></li>
+
+			<li><strong>*</strong></li>
+			<li><strong>*</strong></li>
+		</ul>
+		</div>
+	</div>
+
+	<div id="mainmenu"><h3>401</h3></div>
+	<div id="submenu"><ul><li><b>Not Authorized</b></li></ul></div>
+	
+        <div id="content">
+
+<h2>401 Not Authorized</h2>
+
+        </div>
+	<div id="footer">
+	<h3>PacketProtector</h3>
+	<em>with X-Wrt Extensions</em>
+
+	</div>
+</div>
+</body>
+
+</html>
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/errors/err403.html buildroot/package/webif/files/www/errors/err403.html
--- buildroot.orig/package/webif/files/www/errors/err403.html	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/webif/files/www/errors/err403.html	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,44 @@
+<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
+<head>
+<title>PacketProtector Administrative Console</title>
+	<link rel="stylesheet" type="text/css" href="/themes/active/waitbox.css" media="screen" />
+	<link rel="stylesheet" type="text/css" href="/themes/active/webif.css" />
+	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
+	<meta http-equiv="expires" content="-1" />
+</head>
+<body >
+
+
+<div id="container">
+	<div id="header">
+
+		<h1>X-Wrt Administration Console</h1>
+		<div id="short-status">
+		<h3>Status:</h3>
+		<ul>
+			<li><strong>*</strong></li>
+			<li><strong>*</strong></li>
+
+			<li><strong>*</strong></li>
+			<li><strong>*</strong></li>
+		</ul>
+		</div>
+	</div>
+
+	<div id="mainmenu"><h3>403</h3></div>
+	<div id="submenu"><ul><li><b>Forbidden</b></li></ul></div>
+	
+        <div id="content">
+
+<h2>403 Forbidden</h2>
+
+        </div>
+	<div id="footer">
+	<h3>PacketProtector</h3>
+	<em>with X-Wrt Extensions</em>
+
+	</div>
+</div>
+</body>
+
+</html>
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/errors/err404.html buildroot/package/webif/files/www/errors/err404.html
--- buildroot.orig/package/webif/files/www/errors/err404.html	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/webif/files/www/errors/err404.html	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,44 @@
+<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
+<head>
+<title>PacketProtector Administrative Console</title>
+	<link rel="stylesheet" type="text/css" href="/themes/active/waitbox.css" media="screen" />
+	<link rel="stylesheet" type="text/css" href="/themes/active/webif.css" />
+	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
+	<meta http-equiv="expires" content="-1" />
+</head>
+<body >
+
+
+<div id="container">
+	<div id="header">
+
+		<h1>X-Wrt Administration Console</h1>
+		<div id="short-status">
+		<h3>Status:</h3>
+		<ul>
+			<li><strong>*</strong></li>
+			<li><strong>*</strong></li>
+
+			<li><strong>*</strong></li>
+			<li><strong>*</strong></li>
+		</ul>
+		</div>
+	</div>
+
+	<div id="mainmenu"><h3>404</h3></div>
+	<div id="submenu"><ul><li><b>File Not Found</b></li></ul></div>
+	
+        <div id="content">
+
+<h2>404 File Not Found</h2>
+
+        </div>
+	<div id="footer">
+	<h3>PacketProtector</h3>
+	<em>with X-Wrt Extensions</em>
+
+	</div>
+</div>
+</body>
+
+</html>
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/errors/err500.html buildroot/package/webif/files/www/errors/err500.html
--- buildroot.orig/package/webif/files/www/errors/err500.html	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/webif/files/www/errors/err500.html	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,44 @@
+<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
+<head>
+<title>PacketProtector Administrative Console</title>
+	<link rel="stylesheet" type="text/css" href="/themes/active/waitbox.css" media="screen" />
+	<link rel="stylesheet" type="text/css" href="/themes/active/webif.css" />
+	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
+	<meta http-equiv="expires" content="-1" />
+</head>
+<body >
+
+
+<div id="container">
+	<div id="header">
+
+		<h1>X-Wrt Administration Console</h1>
+		<div id="short-status">
+		<h3>Status:</h3>
+		<ul>
+			<li><strong>*</strong></li>
+			<li><strong>*</strong></li>
+
+			<li><strong>*</strong></li>
+			<li><strong>*</strong></li>
+		</ul>
+		</div>
+	</div>
+
+	<div id="mainmenu"><h3>500</h3></div>
+	<div id="submenu"><ul><li><b>Internal Server Error</b></li></ul></div>
+	
+        <div id="content">
+
+<h2>500 Internal Server Error</h2>
+
+        </div>
+	<div id="footer">
+	<h3>PacketProtector</h3>
+	<em>with X-Wrt Extensions</em>
+
+	</div>
+</div>
+</body>
+
+</html>
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/errors/err501.html buildroot/package/webif/files/www/errors/err501.html
--- buildroot.orig/package/webif/files/www/errors/err501.html	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/webif/files/www/errors/err501.html	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,44 @@
+<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
+<head>
+<title>PacketProtector Administrative Console</title>
+	<link rel="stylesheet" type="text/css" href="/themes/active/waitbox.css" media="screen" />
+	<link rel="stylesheet" type="text/css" href="/themes/active/webif.css" />
+	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
+	<meta http-equiv="expires" content="-1" />
+</head>
+<body >
+
+
+<div id="container">
+	<div id="header">
+
+		<h1>X-Wrt Administration Console</h1>
+		<div id="short-status">
+		<h3>Status:</h3>
+		<ul>
+			<li><strong>*</strong></li>
+			<li><strong>*</strong></li>
+
+			<li><strong>*</strong></li>
+			<li><strong>*</strong></li>
+		</ul>
+		</div>
+	</div>
+
+	<div id="mainmenu"><h3>501</h3></div>
+	<div id="submenu"><ul><li><b>Not Implemented</b></li></ul></div>
+	
+        <div id="content">
+
+<h2>501 Not Implemented</h2>
+
+        </div>
+	<div id="footer">
+	<h3>PacketProtector</h3>
+	<em>with X-Wrt Extensions</em>
+
+	</div>
+</div>
+</body>
+
+</html>
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/files/www/errors/err503.html buildroot/package/webif/files/www/errors/err503.html
--- buildroot.orig/package/webif/files/www/errors/err503.html	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/package/webif/files/www/errors/err503.html	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,44 @@
+<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
+<head>
+<title>PacketProtector Administrative Console</title>
+	<link rel="stylesheet" type="text/css" href="/themes/active/waitbox.css" media="screen" />
+	<link rel="stylesheet" type="text/css" href="/themes/active/webif.css" />
+	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
+	<meta http-equiv="expires" content="-1" />
+</head>
+<body >
+
+
+<div id="container">
+	<div id="header">
+
+		<h1>X-Wrt Administration Console</h1>
+		<div id="short-status">
+		<h3>Status:</h3>
+		<ul>
+			<li><strong>*</strong></li>
+			<li><strong>*</strong></li>
+
+			<li><strong>*</strong></li>
+			<li><strong>*</strong></li>
+		</ul>
+		</div>
+	</div>
+
+	<div id="mainmenu"><h3>503</h3></div>
+	<div id="submenu"><ul><li><b>Service Unavailable</b></li></ul></div>
+	
+        <div id="content">
+
+<h2>503 Service Unavailable</h2>
+
+        </div>
+	<div id="footer">
+	<h3>PacketProtector</h3>
+	<em>with X-Wrt Extensions</em>
+
+	</div>
+</div>
+</body>
+
+</html>
Binary files buildroot.orig/package/webif/files/www/favicon.ico and buildroot/package/webif/files/www/favicon.ico differ
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/package/webif/Makefile buildroot/package/webif/Makefile
--- buildroot.orig/package/webif/Makefile	2010-09-24 22:20:29.000000000 -0400
+++ buildroot/package/webif/Makefile	2010-09-24 22:27:13.000000000 -0400
@@ -29,7 +29,6 @@
 define Package/webif/conffiles
 /etc/config/webif
 /etc/config/cron
-/etc/httpd.conf
 /etc/init.d/custom-user-startup
 endef
 
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/scripts/config/lex.zconf.c buildroot/scripts/config/lex.zconf.c
--- buildroot.orig/scripts/config/lex.zconf.c	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/scripts/config/lex.zconf.c	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,2341 @@
+
+#line 3 "lex.zconf.c"
+
+#define  YY_INT_ALIGNED short int
+
+/* A lexical scanner generated by flex */
+
+#define FLEX_SCANNER
+#define YY_FLEX_MAJOR_VERSION 2
+#define YY_FLEX_MINOR_VERSION 5
+#define YY_FLEX_SUBMINOR_VERSION 31
+#if YY_FLEX_SUBMINOR_VERSION > 0
+#define FLEX_BETA
+#endif
+
+/* First, we deal with  platform-specific or compiler-specific issues. */
+
+/* begin standard C headers. */
+#include <stdio.h>
+#include <string.h>
+#include <errno.h>
+#include <stdlib.h>
+
+/* end standard C headers. */
+
+/* flex integer type definitions */
+
+#ifndef FLEXINT_H
+#define FLEXINT_H
+
+/* C99 systems have <inttypes.h>. Non-C99 systems may or may not. */
+
+#if defined __STDC_VERSION__ && __STDC_VERSION__ >= 199901L
+#include <inttypes.h>
+typedef int8_t flex_int8_t;
+typedef uint8_t flex_uint8_t;
+typedef int16_t flex_int16_t;
+typedef uint16_t flex_uint16_t;
+typedef int32_t flex_int32_t;
+typedef uint32_t flex_uint32_t;
+#else
+typedef signed char flex_int8_t;
+typedef short int flex_int16_t;
+typedef int flex_int32_t;
+typedef unsigned char flex_uint8_t; 
+typedef unsigned short int flex_uint16_t;
+typedef unsigned int flex_uint32_t;
+#endif /* ! C99 */
+
+/* Limits of integral types. */
+#ifndef INT8_MIN
+#define INT8_MIN               (-128)
+#endif
+#ifndef INT16_MIN
+#define INT16_MIN              (-32767-1)
+#endif
+#ifndef INT32_MIN
+#define INT32_MIN              (-2147483647-1)
+#endif
+#ifndef INT8_MAX
+#define INT8_MAX               (127)
+#endif
+#ifndef INT16_MAX
+#define INT16_MAX              (32767)
+#endif
+#ifndef INT32_MAX
+#define INT32_MAX              (2147483647)
+#endif
+#ifndef UINT8_MAX
+#define UINT8_MAX              (255U)
+#endif
+#ifndef UINT16_MAX
+#define UINT16_MAX             (65535U)
+#endif
+#ifndef UINT32_MAX
+#define UINT32_MAX             (4294967295U)
+#endif
+
+#endif /* ! FLEXINT_H */
+
+#ifdef __cplusplus
+
+/* The "const" storage-class-modifier is valid. */
+#define YY_USE_CONST
+
+#else	/* ! __cplusplus */
+
+#if __STDC__
+
+#define YY_USE_CONST
+
+#endif	/* __STDC__ */
+#endif	/* ! __cplusplus */
+
+#ifdef YY_USE_CONST
+#define yyconst const
+#else
+#define yyconst
+#endif
+
+/* Returned upon end-of-file. */
+#define YY_NULL 0
+
+/* Promotes a possibly negative, possibly signed char to an unsigned
+ * integer for use as an array index.  If the signed char is negative,
+ * we want to instead treat it as an 8-bit unsigned char, hence the
+ * double cast.
+ */
+#define YY_SC_TO_UI(c) ((unsigned int) (unsigned char) c)
+
+/* Enter a start condition.  This macro really ought to take a parameter,
+ * but we do it the disgusting crufty way forced on us by the ()-less
+ * definition of BEGIN.
+ */
+#define BEGIN (yy_start) = 1 + 2 *
+
+/* Translate the current start state into a value that can be later handed
+ * to BEGIN to return to the state.  The YYSTATE alias is for lex
+ * compatibility.
+ */
+#define YY_START (((yy_start) - 1) / 2)
+#define YYSTATE YY_START
+
+/* Action number for EOF rule of a given start state. */
+#define YY_STATE_EOF(state) (YY_END_OF_BUFFER + state + 1)
+
+/* Special action meaning "start processing a new file". */
+#define YY_NEW_FILE zconfrestart(zconfin  )
+
+#define YY_END_OF_BUFFER_CHAR 0
+
+/* Size of default input buffer. */
+#ifndef YY_BUF_SIZE
+#define YY_BUF_SIZE 16384
+#endif
+
+#ifndef YY_TYPEDEF_YY_BUFFER_STATE
+#define YY_TYPEDEF_YY_BUFFER_STATE
+typedef struct yy_buffer_state *YY_BUFFER_STATE;
+#endif
+
+extern int zconfleng;
+
+extern FILE *zconfin, *zconfout;
+
+#define EOB_ACT_CONTINUE_SCAN 0
+#define EOB_ACT_END_OF_FILE 1
+#define EOB_ACT_LAST_MATCH 2
+
+    #define YY_LESS_LINENO(n)
+    
+/* Return all but the first "n" matched characters back to the input stream. */
+#define yyless(n) \
+	do \
+		{ \
+		/* Undo effects of setting up zconftext. */ \
+        int yyless_macro_arg = (n); \
+        YY_LESS_LINENO(yyless_macro_arg);\
+		*yy_cp = (yy_hold_char); \
+		YY_RESTORE_YY_MORE_OFFSET \
+		(yy_c_buf_p) = yy_cp = yy_bp + yyless_macro_arg - YY_MORE_ADJ; \
+		YY_DO_BEFORE_ACTION; /* set up zconftext again */ \
+		} \
+	while ( 0 )
+
+#define unput(c) yyunput( c, (yytext_ptr)  )
+
+/* The following is because we cannot portably get our hands on size_t
+ * (without autoconf's help, which isn't available because we want
+ * flex-generated scanners to compile on their own).
+ */
+
+#ifndef YY_TYPEDEF_YY_SIZE_T
+#define YY_TYPEDEF_YY_SIZE_T
+typedef unsigned int yy_size_t;
+#endif
+
+#ifndef YY_STRUCT_YY_BUFFER_STATE
+#define YY_STRUCT_YY_BUFFER_STATE
+struct yy_buffer_state
+	{
+	FILE *yy_input_file;
+
+	char *yy_ch_buf;		/* input buffer */
+	char *yy_buf_pos;		/* current position in input buffer */
+
+	/* Size of input buffer in bytes, not including room for EOB
+	 * characters.
+	 */
+	yy_size_t yy_buf_size;
+
+	/* Number of characters read into yy_ch_buf, not including EOB
+	 * characters.
+	 */
+	int yy_n_chars;
+
+	/* Whether we "own" the buffer - i.e., we know we created it,
+	 * and can realloc() it to grow it, and should free() it to
+	 * delete it.
+	 */
+	int yy_is_our_buffer;
+
+	/* Whether this is an "interactive" input source; if so, and
+	 * if we're using stdio for input, then we want to use getc()
+	 * instead of fread(), to make sure we stop fetching input after
+	 * each newline.
+	 */
+	int yy_is_interactive;
+
+	/* Whether we're considered to be at the beginning of a line.
+	 * If so, '^' rules will be active on the next match, otherwise
+	 * not.
+	 */
+	int yy_at_bol;
+
+    int yy_bs_lineno; /**< The line count. */
+    int yy_bs_column; /**< The column count. */
+    
+	/* Whether to try to fill the input buffer when we reach the
+	 * end of it.
+	 */
+	int yy_fill_buffer;
+
+	int yy_buffer_status;
+
+#define YY_BUFFER_NEW 0
+#define YY_BUFFER_NORMAL 1
+	/* When an EOF's been seen but there's still some text to process
+	 * then we mark the buffer as YY_EOF_PENDING, to indicate that we
+	 * shouldn't try reading from the input source any more.  We might
+	 * still have a bunch of tokens to match, though, because of
+	 * possible backing-up.
+	 *
+	 * When we actually see the EOF, we change the status to "new"
+	 * (via zconfrestart()), so that the user can continue scanning by
+	 * just pointing zconfin at a new input file.
+	 */
+#define YY_BUFFER_EOF_PENDING 2
+
+	};
+#endif /* !YY_STRUCT_YY_BUFFER_STATE */
+
+/* Stack of input buffers. */
+static size_t yy_buffer_stack_top = 0; /**< index of top of stack. */
+static size_t yy_buffer_stack_max = 0; /**< capacity of stack. */
+static YY_BUFFER_STATE * yy_buffer_stack = 0; /**< Stack as an array. */
+
+/* We provide macros for accessing buffer states in case in the
+ * future we want to put the buffer states in a more general
+ * "scanner state".
+ *
+ * Returns the top of the stack, or NULL.
+ */
+#define YY_CURRENT_BUFFER ( (yy_buffer_stack) \
+                          ? (yy_buffer_stack)[(yy_buffer_stack_top)] \
+                          : NULL)
+
+/* Same as previous macro, but useful when we know that the buffer stack is not
+ * NULL or when we need an lvalue. For internal use only.
+ */
+#define YY_CURRENT_BUFFER_LVALUE (yy_buffer_stack)[(yy_buffer_stack_top)]
+
+/* yy_hold_char holds the character lost when zconftext is formed. */
+static char yy_hold_char;
+static int yy_n_chars;		/* number of characters read into yy_ch_buf */
+int zconfleng;
+
+/* Points to current character in buffer. */
+static char *yy_c_buf_p = (char *) 0;
+static int yy_init = 1;		/* whether we need to initialize */
+static int yy_start = 0;	/* start state number */
+
+/* Flag which is used to allow zconfwrap()'s to do buffer switches
+ * instead of setting up a fresh zconfin.  A bit of a hack ...
+ */
+static int yy_did_buffer_switch_on_eof;
+
+void zconfrestart (FILE *input_file  );
+void zconf_switch_to_buffer (YY_BUFFER_STATE new_buffer  );
+YY_BUFFER_STATE zconf_create_buffer (FILE *file,int size  );
+void zconf_delete_buffer (YY_BUFFER_STATE b  );
+void zconf_flush_buffer (YY_BUFFER_STATE b  );
+void zconfpush_buffer_state (YY_BUFFER_STATE new_buffer  );
+void zconfpop_buffer_state (void );
+
+static void zconfensure_buffer_stack (void );
+static void zconf_load_buffer_state (void );
+static void zconf_init_buffer (YY_BUFFER_STATE b,FILE *file  );
+
+#define YY_FLUSH_BUFFER zconf_flush_buffer(YY_CURRENT_BUFFER )
+
+YY_BUFFER_STATE zconf_scan_buffer (char *base,yy_size_t size  );
+YY_BUFFER_STATE zconf_scan_string (yyconst char *yy_str  );
+YY_BUFFER_STATE zconf_scan_bytes (yyconst char *bytes,int len  );
+
+void *zconfalloc (yy_size_t  );
+void *zconfrealloc (void *,yy_size_t  );
+void zconffree (void *  );
+
+#define yy_new_buffer zconf_create_buffer
+
+#define yy_set_interactive(is_interactive) \
+	{ \
+	if ( ! YY_CURRENT_BUFFER ){ \
+        zconfensure_buffer_stack (); \
+		YY_CURRENT_BUFFER_LVALUE =    \
+            zconf_create_buffer(zconfin,YY_BUF_SIZE ); \
+	} \
+	YY_CURRENT_BUFFER_LVALUE->yy_is_interactive = is_interactive; \
+	}
+
+#define yy_set_bol(at_bol) \
+	{ \
+	if ( ! YY_CURRENT_BUFFER ){\
+        zconfensure_buffer_stack (); \
+		YY_CURRENT_BUFFER_LVALUE =    \
+            zconf_create_buffer(zconfin,YY_BUF_SIZE ); \
+	} \
+	YY_CURRENT_BUFFER_LVALUE->yy_at_bol = at_bol; \
+	}
+
+#define YY_AT_BOL() (YY_CURRENT_BUFFER_LVALUE->yy_at_bol)
+
+/* Begin user sect3 */
+
+#define zconfwrap(n) 1
+#define YY_SKIP_YYWRAP
+
+typedef unsigned char YY_CHAR;
+
+FILE *zconfin = (FILE *) 0, *zconfout = (FILE *) 0;
+
+typedef int yy_state_type;
+
+extern int zconflineno;
+
+int zconflineno = 1;
+
+extern char *zconftext;
+#define yytext_ptr zconftext
+static yyconst flex_int16_t yy_nxt[][17] =
+    {
+    {
+        0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
+        0,    0,    0,    0,    0,    0,    0
+    },
+
+    {
+       11,   12,   13,   14,   12,   12,   15,   12,   12,   12,
+       12,   12,   12,   12,   12,   12,   12
+    },
+
+    {
+       11,   12,   13,   14,   12,   12,   15,   12,   12,   12,
+       12,   12,   12,   12,   12,   12,   12
+    },
+
+    {
+       11,   16,   16,   17,   16,   16,   16,   16,   16,   16,
+       16,   16,   16,   18,   16,   16,   16
+    },
+
+    {
+       11,   16,   16,   17,   16,   16,   16,   16,   16,   16,
+       16,   16,   16,   18,   16,   16,   16
+
+    },
+
+    {
+       11,   19,   20,   21,   19,   19,   19,   19,   19,   19,
+       19,   19,   19,   19,   19,   19,   19
+    },
+
+    {
+       11,   19,   20,   21,   19,   19,   19,   19,   19,   19,
+       19,   19,   19,   19,   19,   19,   19
+    },
+
+    {
+       11,   22,   22,   23,   22,   24,   22,   22,   24,   22,
+       22,   22,   22,   22,   22,   25,   22
+    },
+
+    {
+       11,   22,   22,   23,   22,   24,   22,   22,   24,   22,
+       22,   22,   22,   22,   22,   25,   22
+    },
+
+    {
+       11,   26,   26,   27,   28,   29,   30,   31,   29,   32,
+       33,   34,   35,   35,   36,   37,   38
+
+    },
+
+    {
+       11,   26,   26,   27,   28,   29,   30,   31,   29,   32,
+       33,   34,   35,   35,   36,   37,   38
+    },
+
+    {
+      -11,  -11,  -11,  -11,  -11,  -11,  -11,  -11,  -11,  -11,
+      -11,  -11,  -11,  -11,  -11,  -11,  -11
+    },
+
+    {
+       11,  -12,  -12,  -12,  -12,  -12,  -12,  -12,  -12,  -12,
+      -12,  -12,  -12,  -12,  -12,  -12,  -12
+    },
+
+    {
+       11,  -13,   39,   40,  -13,  -13,   41,  -13,  -13,  -13,
+      -13,  -13,  -13,  -13,  -13,  -13,  -13
+    },
+
+    {
+       11,  -14,  -14,  -14,  -14,  -14,  -14,  -14,  -14,  -14,
+      -14,  -14,  -14,  -14,  -14,  -14,  -14
+
+    },
+
+    {
+       11,   42,   42,   43,   42,   42,   42,   42,   42,   42,
+       42,   42,   42,   42,   42,   42,   42
+    },
+
+    {
+       11,  -16,  -16,  -16,  -16,  -16,  -16,  -16,  -16,  -16,
+      -16,  -16,  -16,  -16,  -16,  -16,  -16
+    },
+
+    {
+       11,  -17,  -17,  -17,  -17,  -17,  -17,  -17,  -17,  -17,
+      -17,  -17,  -17,  -17,  -17,  -17,  -17
+    },
+
+    {
+       11,  -18,  -18,  -18,  -18,  -18,  -18,  -18,  -18,  -18,
+      -18,  -18,  -18,   44,  -18,  -18,  -18
+    },
+
+    {
+       11,   45,   45,  -19,   45,   45,   45,   45,   45,   45,
+       45,   45,   45,   45,   45,   45,   45
+
+    },
+
+    {
+       11,  -20,   46,   47,  -20,  -20,  -20,  -20,  -20,  -20,
+      -20,  -20,  -20,  -20,  -20,  -20,  -20
+    },
+
+    {
+       11,   48,  -21,  -21,   48,   48,   48,   48,   48,   48,
+       48,   48,   48,   48,   48,   48,   48
+    },
+
+    {
+       11,   49,   49,   50,   49,  -22,   49,   49,  -22,   49,
+       49,   49,   49,   49,   49,  -22,   49
+    },
+
+    {
+       11,  -23,  -23,  -23,  -23,  -23,  -23,  -23,  -23,  -23,
+      -23,  -23,  -23,  -23,  -23,  -23,  -23
+    },
+
+    {
+       11,  -24,  -24,  -24,  -24,  -24,  -24,  -24,  -24,  -24,
+      -24,  -24,  -24,  -24,  -24,  -24,  -24
+
+    },
+
+    {
+       11,   51,   51,   52,   51,   51,   51,   51,   51,   51,
+       51,   51,   51,   51,   51,   51,   51
+    },
+
+    {
+       11,  -26,  -26,  -26,  -26,  -26,  -26,  -26,  -26,  -26,
+      -26,  -26,  -26,  -26,  -26,  -26,  -26
+    },
+
+    {
+       11,  -27,  -27,  -27,  -27,  -27,  -27,  -27,  -27,  -27,
+      -27,  -27,  -27,  -27,  -27,  -27,  -27
+    },
+
+    {
+       11,  -28,  -28,  -28,  -28,  -28,  -28,  -28,  -28,  -28,
+      -28,  -28,  -28,  -28,   53,  -28,  -28
+    },
+
+    {
+       11,  -29,  -29,  -29,  -29,  -29,  -29,  -29,  -29,  -29,
+      -29,  -29,  -29,  -29,  -29,  -29,  -29
+
+    },
+
+    {
+       11,   54,   54,  -30,   54,   54,   54,   54,   54,   54,
+       54,   54,   54,   54,   54,   54,   54
+    },
+
+    {
+       11,  -31,  -31,  -31,  -31,  -31,  -31,   55,  -31,  -31,
+      -31,  -31,  -31,  -31,  -31,  -31,  -31
+    },
+
+    {
+       11,  -32,  -32,  -32,  -32,  -32,  -32,  -32,  -32,  -32,
+      -32,  -32,  -32,  -32,  -32,  -32,  -32
+    },
+
+    {
+       11,  -33,  -33,  -33,  -33,  -33,  -33,  -33,  -33,  -33,
+      -33,  -33,  -33,  -33,  -33,  -33,  -33
+    },
+
+    {
+       11,  -34,  -34,  -34,  -34,  -34,  -34,  -34,  -34,  -34,
+      -34,   56,   57,   57,  -34,  -34,  -34
+
+    },
+
+    {
+       11,  -35,  -35,  -35,  -35,  -35,  -35,  -35,  -35,  -35,
+      -35,   57,   57,   57,  -35,  -35,  -35
+    },
+
+    {
+       11,  -36,  -36,  -36,  -36,  -36,  -36,  -36,  -36,  -36,
+      -36,  -36,  -36,  -36,  -36,  -36,  -36
+    },
+
+    {
+       11,  -37,  -37,   58,  -37,  -37,  -37,  -37,  -37,  -37,
+      -37,  -37,  -37,  -37,  -37,  -37,  -37
+    },
+
+    {
+       11,  -38,  -38,  -38,  -38,  -38,  -38,  -38,  -38,  -38,
+      -38,  -38,  -38,  -38,  -38,  -38,   59
+    },
+
+    {
+       11,  -39,   39,   40,  -39,  -39,   41,  -39,  -39,  -39,
+      -39,  -39,  -39,  -39,  -39,  -39,  -39
+
+    },
+
+    {
+       11,  -40,  -40,  -40,  -40,  -40,  -40,  -40,  -40,  -40,
+      -40,  -40,  -40,  -40,  -40,  -40,  -40
+    },
+
+    {
+       11,   42,   42,   43,   42,   42,   42,   42,   42,   42,
+       42,   42,   42,   42,   42,   42,   42
+    },
+
+    {
+       11,   42,   42,   43,   42,   42,   42,   42,   42,   42,
+       42,   42,   42,   42,   42,   42,   42
+    },
+
+    {
+       11,  -43,  -43,  -43,  -43,  -43,  -43,  -43,  -43,  -43,
+      -43,  -43,  -43,  -43,  -43,  -43,  -43
+    },
+
+    {
+       11,  -44,  -44,  -44,  -44,  -44,  -44,  -44,  -44,  -44,
+      -44,  -44,  -44,   44,  -44,  -44,  -44
+
+    },
+
+    {
+       11,   45,   45,  -45,   45,   45,   45,   45,   45,   45,
+       45,   45,   45,   45,   45,   45,   45
+    },
+
+    {
+       11,  -46,   46,   47,  -46,  -46,  -46,  -46,  -46,  -46,
+      -46,  -46,  -46,  -46,  -46,  -46,  -46
+    },
+
+    {
+       11,   48,  -47,  -47,   48,   48,   48,   48,   48,   48,
+       48,   48,   48,   48,   48,   48,   48
+    },
+
+    {
+       11,  -48,  -48,  -48,  -48,  -48,  -48,  -48,  -48,  -48,
+      -48,  -48,  -48,  -48,  -48,  -48,  -48
+    },
+
+    {
+       11,   49,   49,   50,   49,  -49,   49,   49,  -49,   49,
+       49,   49,   49,   49,   49,  -49,   49
+
+    },
+
+    {
+       11,  -50,  -50,  -50,  -50,  -50,  -50,  -50,  -50,  -50,
+      -50,  -50,  -50,  -50,  -50,  -50,  -50
+    },
+
+    {
+       11,  -51,  -51,   52,  -51,  -51,  -51,  -51,  -51,  -51,
+      -51,  -51,  -51,  -51,  -51,  -51,  -51
+    },
+
+    {
+       11,  -52,  -52,  -52,  -52,  -52,  -52,  -52,  -52,  -52,
+      -52,  -52,  -52,  -52,  -52,  -52,  -52
+    },
+
+    {
+       11,  -53,  -53,  -53,  -53,  -53,  -53,  -53,  -53,  -53,
+      -53,  -53,  -53,  -53,  -53,  -53,  -53
+    },
+
+    {
+       11,   54,   54,  -54,   54,   54,   54,   54,   54,   54,
+       54,   54,   54,   54,   54,   54,   54
+
+    },
+
+    {
+       11,  -55,  -55,  -55,  -55,  -55,  -55,  -55,  -55,  -55,
+      -55,  -55,  -55,  -55,  -55,  -55,  -55
+    },
+
+    {
+       11,  -56,  -56,  -56,  -56,  -56,  -56,  -56,  -56,  -56,
+      -56,   60,   57,   57,  -56,  -56,  -56
+    },
+
+    {
+       11,  -57,  -57,  -57,  -57,  -57,  -57,  -57,  -57,  -57,
+      -57,   57,   57,   57,  -57,  -57,  -57
+    },
+
+    {
+       11,  -58,  -58,  -58,  -58,  -58,  -58,  -58,  -58,  -58,
+      -58,  -58,  -58,  -58,  -58,  -58,  -58
+    },
+
+    {
+       11,  -59,  -59,  -59,  -59,  -59,  -59,  -59,  -59,  -59,
+      -59,  -59,  -59,  -59,  -59,  -59,  -59
+
+    },
+
+    {
+       11,  -60,  -60,  -60,  -60,  -60,  -60,  -60,  -60,  -60,
+      -60,   57,   57,   57,  -60,  -60,  -60
+    },
+
+    } ;
+
+static yy_state_type yy_get_previous_state (void );
+static yy_state_type yy_try_NUL_trans (yy_state_type current_state  );
+static int yy_get_next_buffer (void );
+static void yy_fatal_error (yyconst char msg[]  );
+
+/* Done after the current pattern has been matched and before the
+ * corresponding action - sets up zconftext.
+ */
+#define YY_DO_BEFORE_ACTION \
+	(yytext_ptr) = yy_bp; \
+	zconfleng = (size_t) (yy_cp - yy_bp); \
+	(yy_hold_char) = *yy_cp; \
+	*yy_cp = '\0'; \
+	(yy_c_buf_p) = yy_cp;
+
+#define YY_NUM_RULES 33
+#define YY_END_OF_BUFFER 34
+/* This struct is not used in this scanner,
+   but its presence is necessary. */
+struct yy_trans_info
+	{
+	flex_int32_t yy_verify;
+	flex_int32_t yy_nxt;
+	};
+static yyconst flex_int16_t yy_accept[61] =
+    {   0,
+        0,    0,    0,    0,    0,    0,    0,    0,    0,    0,
+       34,    5,    4,    2,    3,    7,    8,    6,   32,   29,
+       31,   24,   28,   27,   26,   22,   17,   13,   16,   20,
+       22,   11,   12,   19,   19,   14,   22,   22,    4,    2,
+        3,    3,    1,    6,   32,   29,   31,   30,   24,   23,
+       26,   25,   15,   20,    9,   19,   19,   21,   10,   18
+    } ;
+
+static yyconst flex_int32_t yy_ec[256] =
+    {   0,
+        1,    1,    1,    1,    1,    1,    1,    1,    2,    3,
+        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
+        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
+        1,    2,    4,    5,    6,    1,    1,    7,    8,    9,
+       10,    1,    1,    1,   11,   12,   12,   13,   13,   13,
+       13,   13,   13,   13,   13,   13,   13,    1,    1,    1,
+       14,    1,    1,    1,   13,   13,   13,   13,   13,   13,
+       13,   13,   13,   13,   13,   13,   13,   13,   13,   13,
+       13,   13,   13,   13,   13,   13,   13,   13,   13,   13,
+        1,   15,    1,    1,   13,    1,   13,   13,   13,   13,
+
+       13,   13,   13,   13,   13,   13,   13,   13,   13,   13,
+       13,   13,   13,   13,   13,   13,   13,   13,   13,   13,
+       13,   13,    1,   16,    1,    1,    1,    1,    1,    1,
+        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
+        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
+        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
+        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
+        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
+        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
+        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
+
+        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
+        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
+        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
+        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
+        1,    1,    1,    1,    1,    1,    1,    1,    1,    1,
+        1,    1,    1,    1,    1
+    } ;
+
+extern int zconf_flex_debug;
+int zconf_flex_debug = 0;
+
+/* The intent behind this definition is that it'll catch
+ * any uses of REJECT which flex missed.
+ */
+#define REJECT reject_used_but_not_detected
+#define yymore() yymore_used_but_not_detected
+#define YY_MORE_ADJ 0
+#define YY_RESTORE_YY_MORE_OFFSET
+char *zconftext;
+
+/*
+ * Copyright (C) 2002 Roman Zippel <zippel@linux-m68k.org>
+ * Released under the terms of the GNU GPL v2.0.
+ */
+
+#include <limits.h>
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+#include <unistd.h>
+#include <glob.h>
+
+#define LKC_DIRECT_LINK
+#include "lkc.h"
+
+#define START_STRSIZE	16
+
+static struct {
+	struct file *file;
+	int lineno;
+} current_pos;
+
+static char *text;
+static int text_size, text_asize;
+
+struct buffer {
+        struct buffer *parent;
+        YY_BUFFER_STATE state;
+};
+
+struct buffer *current_buf;
+
+static int last_ts, first_ts;
+
+static void zconf_endhelp(void);
+static void zconf_endfile(void);
+
+void new_string(void)
+{
+	text = malloc(START_STRSIZE);
+	text_asize = START_STRSIZE;
+	text_size = 0;
+	*text = 0;
+}
+
+void append_string(const char *str, int size)
+{
+	int new_size = text_size + size + 1;
+	if (new_size > text_asize) {
+		new_size += START_STRSIZE - 1;
+		new_size &= -START_STRSIZE;
+		text = realloc(text, new_size);
+		text_asize = new_size;
+	}
+	memcpy(text + text_size, str, size);
+	text_size += size;
+	text[text_size] = 0;
+}
+
+void alloc_string(const char *str, int size)
+{
+	text = malloc(size + 1);
+	memcpy(text, str, size);
+	text[size] = 0;
+}
+
+#define INITIAL 0
+#define COMMAND 1
+#define HELP 2
+#define STRING 3
+#define PARAM 4
+
+#ifndef YY_NO_UNISTD_H
+/* Special case for "unistd.h", since it is non-ANSI. We include it way
+ * down here because we want the user's section 1 to have been scanned first.
+ * The user has a chance to override it with an option.
+ */
+#include <unistd.h>
+#endif
+
+#ifndef YY_EXTRA_TYPE
+#define YY_EXTRA_TYPE void *
+#endif
+
+/* Macros after this point can all be overridden by user definitions in
+ * section 1.
+ */
+
+#ifndef YY_SKIP_YYWRAP
+#ifdef __cplusplus
+extern "C" int zconfwrap (void );
+#else
+extern int zconfwrap (void );
+#endif
+#endif
+
+    static void yyunput (int c,char *buf_ptr  );
+    
+#ifndef yytext_ptr
+static void yy_flex_strncpy (char *,yyconst char *,int );
+#endif
+
+#ifdef YY_NEED_STRLEN
+static int yy_flex_strlen (yyconst char * );
+#endif
+
+#ifndef YY_NO_INPUT
+
+#ifdef __cplusplus
+static int yyinput (void );
+#else
+static int input (void );
+#endif
+
+#endif
+
+/* Amount of stuff to slurp up with each read. */
+#ifndef YY_READ_BUF_SIZE
+#define YY_READ_BUF_SIZE 8192
+#endif
+
+/* Copy whatever the last rule matched to the standard output. */
+#ifndef ECHO
+/* This used to be an fputs(), but since the string might contain NUL's,
+ * we now use fwrite().
+ */
+#define ECHO (void) fwrite( zconftext, zconfleng, 1, zconfout )
+#endif
+
+/* Gets input and stuffs it into "buf".  number of characters read, or YY_NULL,
+ * is returned in "result".
+ */
+#ifndef YY_INPUT
+#define YY_INPUT(buf,result,max_size) \
+	errno=0; \
+	while ( (result = read( fileno(zconfin), (char *) buf, max_size )) < 0 ) \
+	{ \
+		if( errno != EINTR) \
+		{ \
+			YY_FATAL_ERROR( "input in flex scanner failed" ); \
+			break; \
+		} \
+		errno=0; \
+		clearerr(zconfin); \
+	}\
+\
+
+#endif
+
+/* No semi-colon after return; correct usage is to write "yyterminate();" -
+ * we don't want an extra ';' after the "return" because that will cause
+ * some compilers to complain about unreachable statements.
+ */
+#ifndef yyterminate
+#define yyterminate() return YY_NULL
+#endif
+
+/* Number of entries by which start-condition stack grows. */
+#ifndef YY_START_STACK_INCR
+#define YY_START_STACK_INCR 25
+#endif
+
+/* Report a fatal error. */
+#ifndef YY_FATAL_ERROR
+#define YY_FATAL_ERROR(msg) yy_fatal_error( msg )
+#endif
+
+/* end tables serialization structures and prototypes */
+
+/* Default declaration of generated scanner - a define so the user can
+ * easily add parameters.
+ */
+#ifndef YY_DECL
+#define YY_DECL_IS_OURS 1
+
+extern int zconflex (void);
+
+#define YY_DECL int zconflex (void)
+#endif /* !YY_DECL */
+
+/* Code executed at the beginning of each rule, after zconftext and zconfleng
+ * have been set up.
+ */
+#ifndef YY_USER_ACTION
+#define YY_USER_ACTION
+#endif
+
+/* Code executed at the end of each rule. */
+#ifndef YY_BREAK
+#define YY_BREAK break;
+#endif
+
+#define YY_RULE_SETUP \
+	YY_USER_ACTION
+
+/** The main scanner function which does all the work.
+ */
+YY_DECL
+{
+	register yy_state_type yy_current_state;
+	register char *yy_cp, *yy_bp;
+	register int yy_act;
+    
+	int str = 0;
+	int ts, i;
+
+	if ( (yy_init) )
+		{
+		(yy_init) = 0;
+
+#ifdef YY_USER_INIT
+		YY_USER_INIT;
+#endif
+
+		if ( ! (yy_start) )
+			(yy_start) = 1;	/* first start state */
+
+		if ( ! zconfin )
+			zconfin = stdin;
+
+		if ( ! zconfout )
+			zconfout = stdout;
+
+		if ( ! YY_CURRENT_BUFFER ) {
+			zconfensure_buffer_stack ();
+			YY_CURRENT_BUFFER_LVALUE =
+				zconf_create_buffer(zconfin,YY_BUF_SIZE );
+		}
+
+		zconf_load_buffer_state( );
+		}
+
+	while ( 1 )		/* loops until end-of-file is reached */
+		{
+		yy_cp = (yy_c_buf_p);
+
+		/* Support of zconftext. */
+		*yy_cp = (yy_hold_char);
+
+		/* yy_bp points to the position in yy_ch_buf of the start of
+		 * the current run.
+		 */
+		yy_bp = yy_cp;
+
+		yy_current_state = (yy_start);
+yy_match:
+		while ( (yy_current_state = yy_nxt[yy_current_state][ yy_ec[YY_SC_TO_UI(*yy_cp)]  ]) > 0 )
+			++yy_cp;
+
+		yy_current_state = -yy_current_state;
+
+yy_find_action:
+		yy_act = yy_accept[yy_current_state];
+
+		YY_DO_BEFORE_ACTION;
+
+do_action:	/* This label is used only to access EOF actions. */
+
+		switch ( yy_act )
+	{ /* beginning of action switch */
+case 1:
+/* rule 1 can match eol */
+case 2:
+/* rule 2 can match eol */
+YY_RULE_SETUP
+{
+	current_file->lineno++;
+	return T_EOL;
+}
+	YY_BREAK
+case 3:
+YY_RULE_SETUP
+
+	YY_BREAK
+case 4:
+YY_RULE_SETUP
+{
+	BEGIN(COMMAND);
+}
+	YY_BREAK
+case 5:
+YY_RULE_SETUP
+{
+	unput(zconftext[0]);
+	BEGIN(COMMAND);
+}
+	YY_BREAK
+
+case 6:
+YY_RULE_SETUP
+{
+		struct kconf_id *id = kconf_id_lookup(zconftext, zconfleng);
+		BEGIN(PARAM);
+		current_pos.file = current_file;
+		current_pos.lineno = current_file->lineno;
+		if (id && id->flags & TF_COMMAND) {
+			zconflval.id = id;
+			return id->token;
+		}
+		alloc_string(zconftext, zconfleng);
+		zconflval.string = text;
+		return T_WORD;
+	}
+	YY_BREAK
+case 7:
+YY_RULE_SETUP
+
+	YY_BREAK
+case 8:
+/* rule 8 can match eol */
+YY_RULE_SETUP
+{
+		BEGIN(INITIAL);
+		current_file->lineno++;
+		return T_EOL;
+	}
+	YY_BREAK
+
+case 9:
+YY_RULE_SETUP
+return T_AND;
+	YY_BREAK
+case 10:
+YY_RULE_SETUP
+return T_OR;
+	YY_BREAK
+case 11:
+YY_RULE_SETUP
+return T_OPEN_PAREN;
+	YY_BREAK
+case 12:
+YY_RULE_SETUP
+return T_CLOSE_PAREN;
+	YY_BREAK
+case 13:
+YY_RULE_SETUP
+return T_NOT;
+	YY_BREAK
+case 14:
+YY_RULE_SETUP
+return T_EQUAL;
+	YY_BREAK
+case 15:
+YY_RULE_SETUP
+return T_UNEQUAL;
+	YY_BREAK
+case 16:
+YY_RULE_SETUP
+{
+		str = zconftext[0];
+		new_string();
+		BEGIN(STRING);
+	}
+	YY_BREAK
+case 17:
+/* rule 17 can match eol */
+YY_RULE_SETUP
+BEGIN(INITIAL); current_file->lineno++; return T_EOL;
+	YY_BREAK
+case 18:
+YY_RULE_SETUP
+/* ignore */
+	YY_BREAK
+case 19:
+YY_RULE_SETUP
+{
+		struct kconf_id *id = kconf_id_lookup(zconftext, zconfleng);
+		if (id && id->flags & TF_PARAM) {
+			zconflval.id = id;
+			return id->token;
+		}
+		alloc_string(zconftext, zconfleng);
+		zconflval.string = text;
+		return T_WORD;
+	}
+	YY_BREAK
+case 20:
+YY_RULE_SETUP
+/* comment */
+	YY_BREAK
+case 21:
+/* rule 21 can match eol */
+YY_RULE_SETUP
+current_file->lineno++;
+	YY_BREAK
+case 22:
+YY_RULE_SETUP
+
+	YY_BREAK
+case YY_STATE_EOF(PARAM):
+{
+		BEGIN(INITIAL);
+	}
+	YY_BREAK
+
+case 23:
+/* rule 23 can match eol */
+*yy_cp = (yy_hold_char); /* undo effects of setting up zconftext */
+(yy_c_buf_p) = yy_cp -= 1;
+YY_DO_BEFORE_ACTION; /* set up zconftext again */
+YY_RULE_SETUP
+{
+		append_string(zconftext, zconfleng);
+		zconflval.string = text;
+		return T_WORD_QUOTE;
+	}
+	YY_BREAK
+case 24:
+YY_RULE_SETUP
+{
+		append_string(zconftext, zconfleng);
+	}
+	YY_BREAK
+case 25:
+/* rule 25 can match eol */
+*yy_cp = (yy_hold_char); /* undo effects of setting up zconftext */
+(yy_c_buf_p) = yy_cp -= 1;
+YY_DO_BEFORE_ACTION; /* set up zconftext again */
+YY_RULE_SETUP
+{
+		append_string(zconftext + 1, zconfleng - 1);
+		zconflval.string = text;
+		return T_WORD_QUOTE;
+	}
+	YY_BREAK
+case 26:
+YY_RULE_SETUP
+{
+		append_string(zconftext + 1, zconfleng - 1);
+	}
+	YY_BREAK
+case 27:
+YY_RULE_SETUP
+{
+		if (str == zconftext[0]) {
+			BEGIN(PARAM);
+			zconflval.string = text;
+			return T_WORD_QUOTE;
+		} else
+			append_string(zconftext, 1);
+	}
+	YY_BREAK
+case 28:
+/* rule 28 can match eol */
+YY_RULE_SETUP
+{
+		printf("%s:%d:warning: multi-line strings not supported\n", zconf_curname(), zconf_lineno());
+		current_file->lineno++;
+		BEGIN(INITIAL);
+		return T_EOL;
+	}
+	YY_BREAK
+case YY_STATE_EOF(STRING):
+{
+		BEGIN(INITIAL);
+	}
+	YY_BREAK
+
+case 29:
+YY_RULE_SETUP
+{
+		ts = 0;
+		for (i = 0; i < zconfleng; i++) {
+			if (zconftext[i] == '\t')
+				ts = (ts & ~7) + 8;
+			else
+				ts++;
+		}
+		last_ts = ts;
+		if (first_ts) {
+			if (ts < first_ts) {
+				zconf_endhelp();
+				return T_HELPTEXT;
+			}
+			ts -= first_ts;
+			while (ts > 8) {
+				append_string("        ", 8);
+				ts -= 8;
+			}
+			append_string("        ", ts);
+		}
+	}
+	YY_BREAK
+case 30:
+/* rule 30 can match eol */
+*yy_cp = (yy_hold_char); /* undo effects of setting up zconftext */
+(yy_c_buf_p) = yy_cp -= 1;
+YY_DO_BEFORE_ACTION; /* set up zconftext again */
+YY_RULE_SETUP
+{
+		current_file->lineno++;
+		zconf_endhelp();
+		return T_HELPTEXT;
+	}
+	YY_BREAK
+case 31:
+/* rule 31 can match eol */
+YY_RULE_SETUP
+{
+		current_file->lineno++;
+		append_string("\n", 1);
+	}
+	YY_BREAK
+case 32:
+YY_RULE_SETUP
+{
+		append_string(zconftext, zconfleng);
+		if (!first_ts)
+			first_ts = last_ts;
+	}
+	YY_BREAK
+case YY_STATE_EOF(HELP):
+{
+		zconf_endhelp();
+		return T_HELPTEXT;
+	}
+	YY_BREAK
+
+case YY_STATE_EOF(INITIAL):
+case YY_STATE_EOF(COMMAND):
+{
+	if (current_file) {
+		zconf_endfile();
+		return T_EOL;
+	}
+	fclose(zconfin);
+	yyterminate();
+}
+	YY_BREAK
+case 33:
+YY_RULE_SETUP
+YY_FATAL_ERROR( "flex scanner jammed" );
+	YY_BREAK
+
+	case YY_END_OF_BUFFER:
+		{
+		/* Amount of text matched not including the EOB char. */
+		int yy_amount_of_matched_text = (int) (yy_cp - (yytext_ptr)) - 1;
+
+		/* Undo the effects of YY_DO_BEFORE_ACTION. */
+		*yy_cp = (yy_hold_char);
+		YY_RESTORE_YY_MORE_OFFSET
+
+		if ( YY_CURRENT_BUFFER_LVALUE->yy_buffer_status == YY_BUFFER_NEW )
+			{
+			/* We're scanning a new file or input source.  It's
+			 * possible that this happened because the user
+			 * just pointed zconfin at a new source and called
+			 * zconflex().  If so, then we have to assure
+			 * consistency between YY_CURRENT_BUFFER and our
+			 * globals.  Here is the right place to do so, because
+			 * this is the first action (other than possibly a
+			 * back-up) that will match for the new input source.
+			 */
+			(yy_n_chars) = YY_CURRENT_BUFFER_LVALUE->yy_n_chars;
+			YY_CURRENT_BUFFER_LVALUE->yy_input_file = zconfin;
+			YY_CURRENT_BUFFER_LVALUE->yy_buffer_status = YY_BUFFER_NORMAL;
+			}
+
+		/* Note that here we test for yy_c_buf_p "<=" to the position
+		 * of the first EOB in the buffer, since yy_c_buf_p will
+		 * already have been incremented past the NUL character
+		 * (since all states make transitions on EOB to the
+		 * end-of-buffer state).  Contrast this with the test
+		 * in input().
+		 */
+		if ( (yy_c_buf_p) <= &YY_CURRENT_BUFFER_LVALUE->yy_ch_buf[(yy_n_chars)] )
+			{ /* This was really a NUL. */
+			yy_state_type yy_next_state;
+
+			(yy_c_buf_p) = (yytext_ptr) + yy_amount_of_matched_text;
+
+			yy_current_state = yy_get_previous_state(  );
+
+			/* Okay, we're now positioned to make the NUL
+			 * transition.  We couldn't have
+			 * yy_get_previous_state() go ahead and do it
+			 * for us because it doesn't know how to deal
+			 * with the possibility of jamming (and we don't
+			 * want to build jamming into it because then it
+			 * will run more slowly).
+			 */
+
+			yy_next_state = yy_try_NUL_trans( yy_current_state );
+
+			yy_bp = (yytext_ptr) + YY_MORE_ADJ;
+
+			if ( yy_next_state )
+				{
+				/* Consume the NUL. */
+				yy_cp = ++(yy_c_buf_p);
+				yy_current_state = yy_next_state;
+				goto yy_match;
+				}
+
+			else
+				{
+				yy_cp = (yy_c_buf_p);
+				goto yy_find_action;
+				}
+			}
+
+		else switch ( yy_get_next_buffer(  ) )
+			{
+			case EOB_ACT_END_OF_FILE:
+				{
+				(yy_did_buffer_switch_on_eof) = 0;
+
+				if ( zconfwrap( ) )
+					{
+					/* Note: because we've taken care in
+					 * yy_get_next_buffer() to have set up
+					 * zconftext, we can now set up
+					 * yy_c_buf_p so that if some total
+					 * hoser (like flex itself) wants to
+					 * call the scanner after we return the
+					 * YY_NULL, it'll still work - another
+					 * YY_NULL will get returned.
+					 */
+					(yy_c_buf_p) = (yytext_ptr) + YY_MORE_ADJ;
+
+					yy_act = YY_STATE_EOF(YY_START);
+					goto do_action;
+					}
+
+				else
+					{
+					if ( ! (yy_did_buffer_switch_on_eof) )
+						YY_NEW_FILE;
+					}
+				break;
+				}
+
+			case EOB_ACT_CONTINUE_SCAN:
+				(yy_c_buf_p) =
+					(yytext_ptr) + yy_amount_of_matched_text;
+
+				yy_current_state = yy_get_previous_state(  );
+
+				yy_cp = (yy_c_buf_p);
+				yy_bp = (yytext_ptr) + YY_MORE_ADJ;
+				goto yy_match;
+
+			case EOB_ACT_LAST_MATCH:
+				(yy_c_buf_p) =
+				&YY_CURRENT_BUFFER_LVALUE->yy_ch_buf[(yy_n_chars)];
+
+				yy_current_state = yy_get_previous_state(  );
+
+				yy_cp = (yy_c_buf_p);
+				yy_bp = (yytext_ptr) + YY_MORE_ADJ;
+				goto yy_find_action;
+			}
+		break;
+		}
+
+	default:
+		YY_FATAL_ERROR(
+			"fatal flex scanner internal error--no action found" );
+	} /* end of action switch */
+		} /* end of scanning one token */
+} /* end of zconflex */
+
+/* yy_get_next_buffer - try to read in a new buffer
+ *
+ * Returns a code representing an action:
+ *	EOB_ACT_LAST_MATCH -
+ *	EOB_ACT_CONTINUE_SCAN - continue scanning from current position
+ *	EOB_ACT_END_OF_FILE - end of file
+ */
+static int yy_get_next_buffer (void)
+{
+    	register char *dest = YY_CURRENT_BUFFER_LVALUE->yy_ch_buf;
+	register char *source = (yytext_ptr);
+	register int number_to_move, i;
+	int ret_val;
+
+	if ( (yy_c_buf_p) > &YY_CURRENT_BUFFER_LVALUE->yy_ch_buf[(yy_n_chars) + 1] )
+		YY_FATAL_ERROR(
+		"fatal flex scanner internal error--end of buffer missed" );
+
+	if ( YY_CURRENT_BUFFER_LVALUE->yy_fill_buffer == 0 )
+		{ /* Don't try to fill the buffer, so this is an EOF. */
+		if ( (yy_c_buf_p) - (yytext_ptr) - YY_MORE_ADJ == 1 )
+			{
+			/* We matched a single character, the EOB, so
+			 * treat this as a final EOF.
+			 */
+			return EOB_ACT_END_OF_FILE;
+			}
+
+		else
+			{
+			/* We matched some text prior to the EOB, first
+			 * process it.
+			 */
+			return EOB_ACT_LAST_MATCH;
+			}
+		}
+
+	/* Try to read more data. */
+
+	/* First move last chars to start of buffer. */
+	number_to_move = (int) ((yy_c_buf_p) - (yytext_ptr)) - 1;
+
+	for ( i = 0; i < number_to_move; ++i )
+		*(dest++) = *(source++);
+
+	if ( YY_CURRENT_BUFFER_LVALUE->yy_buffer_status == YY_BUFFER_EOF_PENDING )
+		/* don't do the read, it's not guaranteed to return an EOF,
+		 * just force an EOF
+		 */
+		YY_CURRENT_BUFFER_LVALUE->yy_n_chars = (yy_n_chars) = 0;
+
+	else
+		{
+			size_t num_to_read =
+			YY_CURRENT_BUFFER_LVALUE->yy_buf_size - number_to_move - 1;
+
+		while ( num_to_read <= 0 )
+			{ /* Not enough room in the buffer - grow it. */
+
+			/* just a shorter name for the current buffer */
+			YY_BUFFER_STATE b = YY_CURRENT_BUFFER;
+
+			int yy_c_buf_p_offset =
+				(int) ((yy_c_buf_p) - b->yy_ch_buf);
+
+			if ( b->yy_is_our_buffer )
+				{
+				int new_size = b->yy_buf_size * 2;
+
+				if ( new_size <= 0 )
+					b->yy_buf_size += b->yy_buf_size / 8;
+				else
+					b->yy_buf_size *= 2;
+
+				b->yy_ch_buf = (char *)
+					/* Include room in for 2 EOB chars. */
+					zconfrealloc((void *) b->yy_ch_buf,b->yy_buf_size + 2  );
+				}
+			else
+				/* Can't grow it, we don't own it. */
+				b->yy_ch_buf = 0;
+
+			if ( ! b->yy_ch_buf )
+				YY_FATAL_ERROR(
+				"fatal error - scanner input buffer overflow" );
+
+			(yy_c_buf_p) = &b->yy_ch_buf[yy_c_buf_p_offset];
+
+			num_to_read = YY_CURRENT_BUFFER_LVALUE->yy_buf_size -
+						number_to_move - 1;
+
+			}
+
+		if ( num_to_read > YY_READ_BUF_SIZE )
+			num_to_read = YY_READ_BUF_SIZE;
+
+		/* Read in more data. */
+		YY_INPUT( (&YY_CURRENT_BUFFER_LVALUE->yy_ch_buf[number_to_move]),
+			(yy_n_chars), num_to_read );
+
+		YY_CURRENT_BUFFER_LVALUE->yy_n_chars = (yy_n_chars);
+		}
+
+	if ( (yy_n_chars) == 0 )
+		{
+		if ( number_to_move == YY_MORE_ADJ )
+			{
+			ret_val = EOB_ACT_END_OF_FILE;
+			zconfrestart(zconfin  );
+			}
+
+		else
+			{
+			ret_val = EOB_ACT_LAST_MATCH;
+			YY_CURRENT_BUFFER_LVALUE->yy_buffer_status =
+				YY_BUFFER_EOF_PENDING;
+			}
+		}
+
+	else
+		ret_val = EOB_ACT_CONTINUE_SCAN;
+
+	(yy_n_chars) += number_to_move;
+	YY_CURRENT_BUFFER_LVALUE->yy_ch_buf[(yy_n_chars)] = YY_END_OF_BUFFER_CHAR;
+	YY_CURRENT_BUFFER_LVALUE->yy_ch_buf[(yy_n_chars) + 1] = YY_END_OF_BUFFER_CHAR;
+
+	(yytext_ptr) = &YY_CURRENT_BUFFER_LVALUE->yy_ch_buf[0];
+
+	return ret_val;
+}
+
+/* yy_get_previous_state - get the state just before the EOB char was reached */
+
+    static yy_state_type yy_get_previous_state (void)
+{
+	register yy_state_type yy_current_state;
+	register char *yy_cp;
+    
+	yy_current_state = (yy_start);
+
+	for ( yy_cp = (yytext_ptr) + YY_MORE_ADJ; yy_cp < (yy_c_buf_p); ++yy_cp )
+		{
+		yy_current_state = yy_nxt[yy_current_state][(*yy_cp ? yy_ec[YY_SC_TO_UI(*yy_cp)] : 1)];
+		}
+
+	return yy_current_state;
+}
+
+/* yy_try_NUL_trans - try to make a transition on the NUL character
+ *
+ * synopsis
+ *	next_state = yy_try_NUL_trans( current_state );
+ */
+    static yy_state_type yy_try_NUL_trans  (yy_state_type yy_current_state )
+{
+	register int yy_is_jam;
+    
+	yy_current_state = yy_nxt[yy_current_state][1];
+	yy_is_jam = (yy_current_state <= 0);
+
+	return yy_is_jam ? 0 : yy_current_state;
+}
+
+    static void yyunput (int c, register char * yy_bp )
+{
+	register char *yy_cp;
+    
+    yy_cp = (yy_c_buf_p);
+
+	/* undo effects of setting up zconftext */
+	*yy_cp = (yy_hold_char);
+
+	if ( yy_cp < YY_CURRENT_BUFFER_LVALUE->yy_ch_buf + 2 )
+		{ /* need to shift things up to make room */
+		/* +2 for EOB chars. */
+		register int number_to_move = (yy_n_chars) + 2;
+		register char *dest = &YY_CURRENT_BUFFER_LVALUE->yy_ch_buf[
+					YY_CURRENT_BUFFER_LVALUE->yy_buf_size + 2];
+		register char *source =
+				&YY_CURRENT_BUFFER_LVALUE->yy_ch_buf[number_to_move];
+
+		while ( source > YY_CURRENT_BUFFER_LVALUE->yy_ch_buf )
+			*--dest = *--source;
+
+		yy_cp += (int) (dest - source);
+		yy_bp += (int) (dest - source);
+		YY_CURRENT_BUFFER_LVALUE->yy_n_chars =
+			(yy_n_chars) = YY_CURRENT_BUFFER_LVALUE->yy_buf_size;
+
+		if ( yy_cp < YY_CURRENT_BUFFER_LVALUE->yy_ch_buf + 2 )
+			YY_FATAL_ERROR( "flex scanner push-back overflow" );
+		}
+
+	*--yy_cp = (char) c;
+
+	(yytext_ptr) = yy_bp;
+	(yy_hold_char) = *yy_cp;
+	(yy_c_buf_p) = yy_cp;
+}
+
+#ifndef YY_NO_INPUT
+#ifdef __cplusplus
+    static int yyinput (void)
+#else
+    static int input  (void)
+#endif
+
+{
+	int c;
+    
+	*(yy_c_buf_p) = (yy_hold_char);
+
+	if ( *(yy_c_buf_p) == YY_END_OF_BUFFER_CHAR )
+		{
+		/* yy_c_buf_p now points to the character we want to return.
+		 * If this occurs *before* the EOB characters, then it's a
+		 * valid NUL; if not, then we've hit the end of the buffer.
+		 */
+		if ( (yy_c_buf_p) < &YY_CURRENT_BUFFER_LVALUE->yy_ch_buf[(yy_n_chars)] )
+			/* This was really a NUL. */
+			*(yy_c_buf_p) = '\0';
+
+		else
+			{ /* need more input */
+			int offset = (yy_c_buf_p) - (yytext_ptr);
+			++(yy_c_buf_p);
+
+			switch ( yy_get_next_buffer(  ) )
+				{
+				case EOB_ACT_LAST_MATCH:
+					/* This happens because yy_g_n_b()
+					 * sees that we've accumulated a
+					 * token and flags that we need to
+					 * try matching the token before
+					 * proceeding.  But for input(),
+					 * there's no matching to consider.
+					 * So convert the EOB_ACT_LAST_MATCH
+					 * to EOB_ACT_END_OF_FILE.
+					 */
+
+					/* Reset buffer status. */
+					zconfrestart(zconfin );
+
+					/*FALLTHROUGH*/
+
+				case EOB_ACT_END_OF_FILE:
+					{
+					if ( zconfwrap( ) )
+						return EOF;
+
+					if ( ! (yy_did_buffer_switch_on_eof) )
+						YY_NEW_FILE;
+#ifdef __cplusplus
+					return yyinput();
+#else
+					return input();
+#endif
+					}
+
+				case EOB_ACT_CONTINUE_SCAN:
+					(yy_c_buf_p) = (yytext_ptr) + offset;
+					break;
+				}
+			}
+		}
+
+	c = *(unsigned char *) (yy_c_buf_p);	/* cast for 8-bit char's */
+	*(yy_c_buf_p) = '\0';	/* preserve zconftext */
+	(yy_hold_char) = *++(yy_c_buf_p);
+
+	return c;
+}
+#endif	/* ifndef YY_NO_INPUT */
+
+/** Immediately switch to a different input stream.
+ * @param input_file A readable stream.
+ * 
+ * @note This function does not reset the start condition to @c INITIAL .
+ */
+    void zconfrestart  (FILE * input_file )
+{
+    
+	if ( ! YY_CURRENT_BUFFER ){
+        zconfensure_buffer_stack ();
+		YY_CURRENT_BUFFER_LVALUE =
+            zconf_create_buffer(zconfin,YY_BUF_SIZE );
+	}
+
+	zconf_init_buffer(YY_CURRENT_BUFFER,input_file );
+	zconf_load_buffer_state( );
+}
+
+/** Switch to a different input buffer.
+ * @param new_buffer The new input buffer.
+ * 
+ */
+    void zconf_switch_to_buffer  (YY_BUFFER_STATE  new_buffer )
+{
+    
+	/* TODO. We should be able to replace this entire function body
+	 * with
+	 *		zconfpop_buffer_state();
+	 *		zconfpush_buffer_state(new_buffer);
+     */
+	zconfensure_buffer_stack ();
+	if ( YY_CURRENT_BUFFER == new_buffer )
+		return;
+
+	if ( YY_CURRENT_BUFFER )
+		{
+		/* Flush out information for old buffer. */
+		*(yy_c_buf_p) = (yy_hold_char);
+		YY_CURRENT_BUFFER_LVALUE->yy_buf_pos = (yy_c_buf_p);
+		YY_CURRENT_BUFFER_LVALUE->yy_n_chars = (yy_n_chars);
+		}
+
+	YY_CURRENT_BUFFER_LVALUE = new_buffer;
+	zconf_load_buffer_state( );
+
+	/* We don't actually know whether we did this switch during
+	 * EOF (zconfwrap()) processing, but the only time this flag
+	 * is looked at is after zconfwrap() is called, so it's safe
+	 * to go ahead and always set it.
+	 */
+	(yy_did_buffer_switch_on_eof) = 1;
+}
+
+static void zconf_load_buffer_state  (void)
+{
+    	(yy_n_chars) = YY_CURRENT_BUFFER_LVALUE->yy_n_chars;
+	(yytext_ptr) = (yy_c_buf_p) = YY_CURRENT_BUFFER_LVALUE->yy_buf_pos;
+	zconfin = YY_CURRENT_BUFFER_LVALUE->yy_input_file;
+	(yy_hold_char) = *(yy_c_buf_p);
+}
+
+/** Allocate and initialize an input buffer state.
+ * @param file A readable stream.
+ * @param size The character buffer size in bytes. When in doubt, use @c YY_BUF_SIZE.
+ * 
+ * @return the allocated buffer state.
+ */
+    YY_BUFFER_STATE zconf_create_buffer  (FILE * file, int  size )
+{
+	YY_BUFFER_STATE b;
+    
+	b = (YY_BUFFER_STATE) zconfalloc(sizeof( struct yy_buffer_state )  );
+	if ( ! b )
+		YY_FATAL_ERROR( "out of dynamic memory in zconf_create_buffer()" );
+
+	b->yy_buf_size = size;
+
+	/* yy_ch_buf has to be 2 characters longer than the size given because
+	 * we need to put in 2 end-of-buffer characters.
+	 */
+	b->yy_ch_buf = (char *) zconfalloc(b->yy_buf_size + 2  );
+	if ( ! b->yy_ch_buf )
+		YY_FATAL_ERROR( "out of dynamic memory in zconf_create_buffer()" );
+
+	b->yy_is_our_buffer = 1;
+
+	zconf_init_buffer(b,file );
+
+	return b;
+}
+
+/** Destroy the buffer.
+ * @param b a buffer created with zconf_create_buffer()
+ * 
+ */
+    void zconf_delete_buffer (YY_BUFFER_STATE  b )
+{
+    
+	if ( ! b )
+		return;
+
+	if ( b == YY_CURRENT_BUFFER ) /* Not sure if we should pop here. */
+		YY_CURRENT_BUFFER_LVALUE = (YY_BUFFER_STATE) 0;
+
+	if ( b->yy_is_our_buffer )
+		zconffree((void *) b->yy_ch_buf  );
+
+	zconffree((void *) b  );
+}
+
+/* Initializes or reinitializes a buffer.
+ * This function is sometimes called more than once on the same buffer,
+ * such as during a zconfrestart() or at EOF.
+ */
+    static void zconf_init_buffer  (YY_BUFFER_STATE  b, FILE * file )
+
+{
+	int oerrno = errno;
+    
+	zconf_flush_buffer(b );
+
+	b->yy_input_file = file;
+	b->yy_fill_buffer = 1;
+
+    /* If b is the current buffer, then zconf_init_buffer was _probably_
+     * called from zconfrestart() or through yy_get_next_buffer.
+     * In that case, we don't want to reset the lineno or column.
+     */
+    if (b != YY_CURRENT_BUFFER){
+        b->yy_bs_lineno = 1;
+        b->yy_bs_column = 0;
+    }
+
+        b->yy_is_interactive = 0;
+    
+	errno = oerrno;
+}
+
+/** Discard all buffered characters. On the next scan, YY_INPUT will be called.
+ * @param b the buffer state to be flushed, usually @c YY_CURRENT_BUFFER.
+ * 
+ */
+    void zconf_flush_buffer (YY_BUFFER_STATE  b )
+{
+    	if ( ! b )
+		return;
+
+	b->yy_n_chars = 0;
+
+	/* We always need two end-of-buffer characters.  The first causes
+	 * a transition to the end-of-buffer state.  The second causes
+	 * a jam in that state.
+	 */
+	b->yy_ch_buf[0] = YY_END_OF_BUFFER_CHAR;
+	b->yy_ch_buf[1] = YY_END_OF_BUFFER_CHAR;
+
+	b->yy_buf_pos = &b->yy_ch_buf[0];
+
+	b->yy_at_bol = 1;
+	b->yy_buffer_status = YY_BUFFER_NEW;
+
+	if ( b == YY_CURRENT_BUFFER )
+		zconf_load_buffer_state( );
+}
+
+/** Pushes the new state onto the stack. The new state becomes
+ *  the current state. This function will allocate the stack
+ *  if necessary.
+ *  @param new_buffer The new state.
+ *  
+ */
+void zconfpush_buffer_state (YY_BUFFER_STATE new_buffer )
+{
+    	if (new_buffer == NULL)
+		return;
+
+	zconfensure_buffer_stack();
+
+	/* This block is copied from zconf_switch_to_buffer. */
+	if ( YY_CURRENT_BUFFER )
+		{
+		/* Flush out information for old buffer. */
+		*(yy_c_buf_p) = (yy_hold_char);
+		YY_CURRENT_BUFFER_LVALUE->yy_buf_pos = (yy_c_buf_p);
+		YY_CURRENT_BUFFER_LVALUE->yy_n_chars = (yy_n_chars);
+		}
+
+	/* Only push if top exists. Otherwise, replace top. */
+	if (YY_CURRENT_BUFFER)
+		(yy_buffer_stack_top)++;
+	YY_CURRENT_BUFFER_LVALUE = new_buffer;
+
+	/* copied from zconf_switch_to_buffer. */
+	zconf_load_buffer_state( );
+	(yy_did_buffer_switch_on_eof) = 1;
+}
+
+/** Removes and deletes the top of the stack, if present.
+ *  The next element becomes the new top.
+ *  
+ */
+void zconfpop_buffer_state (void)
+{
+    	if (!YY_CURRENT_BUFFER)
+		return;
+
+	zconf_delete_buffer(YY_CURRENT_BUFFER );
+	YY_CURRENT_BUFFER_LVALUE = NULL;
+	if ((yy_buffer_stack_top) > 0)
+		--(yy_buffer_stack_top);
+
+	if (YY_CURRENT_BUFFER) {
+		zconf_load_buffer_state( );
+		(yy_did_buffer_switch_on_eof) = 1;
+	}
+}
+
+/* Allocates the stack if it does not exist.
+ *  Guarantees space for at least one push.
+ */
+static void zconfensure_buffer_stack (void)
+{
+	int num_to_alloc;
+    
+	if (!(yy_buffer_stack)) {
+
+		/* First allocation is just for 2 elements, since we don't know if this
+		 * scanner will even need a stack. We use 2 instead of 1 to avoid an
+		 * immediate realloc on the next call.
+         */
+		num_to_alloc = 1;
+		(yy_buffer_stack) = (struct yy_buffer_state**)zconfalloc
+								(num_to_alloc * sizeof(struct yy_buffer_state*)
+								);
+		
+		memset((yy_buffer_stack), 0, num_to_alloc * sizeof(struct yy_buffer_state*));
+				
+		(yy_buffer_stack_max) = num_to_alloc;
+		(yy_buffer_stack_top) = 0;
+		return;
+	}
+
+	if ((yy_buffer_stack_top) >= ((yy_buffer_stack_max)) - 1){
+
+		/* Increase the buffer to prepare for a possible push. */
+		int grow_size = 8 /* arbitrary grow size */;
+
+		num_to_alloc = (yy_buffer_stack_max) + grow_size;
+		(yy_buffer_stack) = (struct yy_buffer_state**)zconfrealloc
+								((yy_buffer_stack),
+								num_to_alloc * sizeof(struct yy_buffer_state*)
+								);
+
+		/* zero only the new slots.*/
+		memset((yy_buffer_stack) + (yy_buffer_stack_max), 0, grow_size * sizeof(struct yy_buffer_state*));
+		(yy_buffer_stack_max) = num_to_alloc;
+	}
+}
+
+/** Setup the input buffer state to scan directly from a user-specified character buffer.
+ * @param base the character buffer
+ * @param size the size in bytes of the character buffer
+ * 
+ * @return the newly allocated buffer state object. 
+ */
+YY_BUFFER_STATE zconf_scan_buffer  (char * base, yy_size_t  size )
+{
+	YY_BUFFER_STATE b;
+    
+	if ( size < 2 ||
+	     base[size-2] != YY_END_OF_BUFFER_CHAR ||
+	     base[size-1] != YY_END_OF_BUFFER_CHAR )
+		/* They forgot to leave room for the EOB's. */
+		return 0;
+
+	b = (YY_BUFFER_STATE) zconfalloc(sizeof( struct yy_buffer_state )  );
+	if ( ! b )
+		YY_FATAL_ERROR( "out of dynamic memory in zconf_scan_buffer()" );
+
+	b->yy_buf_size = size - 2;	/* "- 2" to take care of EOB's */
+	b->yy_buf_pos = b->yy_ch_buf = base;
+	b->yy_is_our_buffer = 0;
+	b->yy_input_file = 0;
+	b->yy_n_chars = b->yy_buf_size;
+	b->yy_is_interactive = 0;
+	b->yy_at_bol = 1;
+	b->yy_fill_buffer = 0;
+	b->yy_buffer_status = YY_BUFFER_NEW;
+
+	zconf_switch_to_buffer(b  );
+
+	return b;
+}
+
+/** Setup the input buffer state to scan a string. The next call to zconflex() will
+ * scan from a @e copy of @a str.
+ * @param str a NUL-terminated string to scan
+ * 
+ * @return the newly allocated buffer state object.
+ * @note If you want to scan bytes that may contain NUL values, then use
+ *       zconf_scan_bytes() instead.
+ */
+YY_BUFFER_STATE zconf_scan_string (yyconst char * yy_str )
+{
+    
+	return zconf_scan_bytes(yy_str,strlen(yy_str) );
+}
+
+/** Setup the input buffer state to scan the given bytes. The next call to zconflex() will
+ * scan from a @e copy of @a bytes.
+ * @param bytes the byte buffer to scan
+ * @param len the number of bytes in the buffer pointed to by @a bytes.
+ * 
+ * @return the newly allocated buffer state object.
+ */
+YY_BUFFER_STATE zconf_scan_bytes  (yyconst char * bytes, int  len )
+{
+	YY_BUFFER_STATE b;
+	char *buf;
+	yy_size_t n;
+	int i;
+    
+	/* Get memory for full buffer, including space for trailing EOB's. */
+	n = len + 2;
+	buf = (char *) zconfalloc(n  );
+	if ( ! buf )
+		YY_FATAL_ERROR( "out of dynamic memory in zconf_scan_bytes()" );
+
+	for ( i = 0; i < len; ++i )
+		buf[i] = bytes[i];
+
+	buf[len] = buf[len+1] = YY_END_OF_BUFFER_CHAR;
+
+	b = zconf_scan_buffer(buf,n );
+	if ( ! b )
+		YY_FATAL_ERROR( "bad buffer in zconf_scan_bytes()" );
+
+	/* It's okay to grow etc. this buffer, and we should throw it
+	 * away when we're done.
+	 */
+	b->yy_is_our_buffer = 1;
+
+	return b;
+}
+
+#ifndef YY_EXIT_FAILURE
+#define YY_EXIT_FAILURE 2
+#endif
+
+static void yy_fatal_error (yyconst char* msg )
+{
+    	(void) fprintf( stderr, "%s\n", msg );
+	exit( YY_EXIT_FAILURE );
+}
+
+/* Redefine yyless() so it works in section 3 code. */
+
+#undef yyless
+#define yyless(n) \
+	do \
+		{ \
+		/* Undo effects of setting up zconftext. */ \
+        int yyless_macro_arg = (n); \
+        YY_LESS_LINENO(yyless_macro_arg);\
+		zconftext[zconfleng] = (yy_hold_char); \
+		(yy_c_buf_p) = zconftext + yyless_macro_arg; \
+		(yy_hold_char) = *(yy_c_buf_p); \
+		*(yy_c_buf_p) = '\0'; \
+		zconfleng = yyless_macro_arg; \
+		} \
+	while ( 0 )
+
+/* Accessor  methods (get/set functions) to struct members. */
+
+/** Get the current line number.
+ * 
+ */
+int zconfget_lineno  (void)
+{
+        
+    return zconflineno;
+}
+
+/** Get the input stream.
+ * 
+ */
+FILE *zconfget_in  (void)
+{
+        return zconfin;
+}
+
+/** Get the output stream.
+ * 
+ */
+FILE *zconfget_out  (void)
+{
+        return zconfout;
+}
+
+/** Get the length of the current token.
+ * 
+ */
+int zconfget_leng  (void)
+{
+        return zconfleng;
+}
+
+/** Get the current token.
+ * 
+ */
+
+char *zconfget_text  (void)
+{
+        return zconftext;
+}
+
+/** Set the current line number.
+ * @param line_number
+ * 
+ */
+void zconfset_lineno (int  line_number )
+{
+    
+    zconflineno = line_number;
+}
+
+/** Set the input stream. This does not discard the current
+ * input buffer.
+ * @param in_str A readable stream.
+ * 
+ * @see zconf_switch_to_buffer
+ */
+void zconfset_in (FILE *  in_str )
+{
+        zconfin = in_str ;
+}
+
+void zconfset_out (FILE *  out_str )
+{
+        zconfout = out_str ;
+}
+
+int zconfget_debug  (void)
+{
+        return zconf_flex_debug;
+}
+
+void zconfset_debug (int  bdebug )
+{
+        zconf_flex_debug = bdebug ;
+}
+
+/* zconflex_destroy is for both reentrant and non-reentrant scanners. */
+int zconflex_destroy  (void)
+{
+    
+    /* Pop the buffer stack, destroying each element. */
+	while(YY_CURRENT_BUFFER){
+		zconf_delete_buffer(YY_CURRENT_BUFFER  );
+		YY_CURRENT_BUFFER_LVALUE = NULL;
+		zconfpop_buffer_state();
+	}
+
+	/* Destroy the stack itself. */
+	zconffree((yy_buffer_stack) );
+	(yy_buffer_stack) = NULL;
+
+    return 0;
+}
+
+/*
+ * Internal utility routines.
+ */
+
+#ifndef yytext_ptr
+static void yy_flex_strncpy (char* s1, yyconst char * s2, int n )
+{
+	register int i;
+    	for ( i = 0; i < n; ++i )
+		s1[i] = s2[i];
+}
+#endif
+
+#ifdef YY_NEED_STRLEN
+static int yy_flex_strlen (yyconst char * s )
+{
+	register int n;
+    	for ( n = 0; s[n]; ++n )
+		;
+
+	return n;
+}
+#endif
+
+void *zconfalloc (yy_size_t  size )
+{
+	return (void *) malloc( size );
+}
+
+void *zconfrealloc  (void * ptr, yy_size_t  size )
+{
+	/* The cast to (char *) in the following accommodates both
+	 * implementations that use char* generic pointers, and those
+	 * that use void* generic pointers.  It works with the latter
+	 * because both ANSI C and C++ allow castless assignment from
+	 * any pointer type to void*, and deal with argument conversions
+	 * as though doing an assignment.
+	 */
+	return (void *) realloc( (char *) ptr, size );
+}
+
+void zconffree (void * ptr )
+{
+	free( (char *) ptr );	/* see zconfrealloc() for (char *) cast */
+}
+
+#define YYTABLES_NAME "yytables"
+
+#undef YY_NEW_FILE
+#undef YY_FLUSH_BUFFER
+#undef yy_set_bol
+#undef yy_new_buffer
+#undef yy_set_interactive
+#undef yytext_ptr
+#undef YY_DO_BEFORE_ACTION
+
+#ifdef YY_DECL_IS_OURS
+#undef YY_DECL_IS_OURS
+#undef YY_DECL
+#endif
+
+void zconf_starthelp(void)
+{
+	new_string();
+	last_ts = first_ts = 0;
+	BEGIN(HELP);
+}
+
+static void zconf_endhelp(void)
+{
+	zconflval.string = text;
+	BEGIN(INITIAL);
+}
+
+/*
+ * Try to open specified file with following names:
+ * ./name
+ * $(srctree)/name
+ * The latter is used when srctree is separate from objtree
+ * when compiling the kernel.
+ * Return NULL if file is not found.
+ */
+FILE *zconf_fopen(const char *name)
+{
+	char *env, fullname[PATH_MAX+1];
+	FILE *f;
+
+	f = fopen(name, "r");
+	if (!f && name[0] != '/') {
+		env = getenv(SRCTREE);
+		if (env) {
+			sprintf(fullname, "%s/%s", env, name);
+			f = fopen(fullname, "r");
+		}
+	}
+	return f;
+}
+
+void zconf_initscan(const char *name)
+{
+	zconfin = zconf_fopen(name);
+	if (!zconfin) {
+		printf("can't find file %s\n", name);
+		exit(1);
+	}
+
+	current_buf = malloc(sizeof(*current_buf));
+	memset(current_buf, 0, sizeof(*current_buf));
+
+	current_file = file_lookup(name);
+	current_file->lineno = 1;
+	current_file->flags = FILE_BUSY;
+}
+
+void zconf_nextfile(const char *name)
+{
+	size_t i;
+	int retval;
+	glob_t files;
+	char *filename;
+	struct file *file;
+	struct buffer *buf;
+
+	retval = glob(name, GLOB_ERR | GLOB_MARK, NULL, &files);
+	if (retval == GLOB_NOMATCH)
+		return;
+
+	if (retval == GLOB_NOSPACE || retval == GLOB_ABORTED) {
+		printf("%s:%d: glob failed: %s \"%s\"\n", zconf_curname(), zconf_lineno(),
+			retval == GLOB_NOSPACE ? "failed to allocate memory" :
+				retval == GLOB_ABORTED ? "read error" : "no match",
+			name);
+		exit(1);
+	}
+
+	for (i = files.gl_pathc-1; i != (size_t)-1; --i) {
+		filename = files.gl_pathv[i];
+
+		file = file_lookup(filename);
+		buf = malloc(sizeof(*buf));
+		memset(buf, 0, sizeof(*buf));
+		current_buf->state = YY_CURRENT_BUFFER;
+		zconfin = zconf_fopen(filename);
+		if (!zconfin) {
+			printf("%s:%d: can't open file \"%s\"\n",
+				zconf_curname(), zconf_lineno(), filename);
+			exit(1);
+		}
+		zconf_switch_to_buffer(zconf_create_buffer(zconfin,YY_BUF_SIZE));
+		buf->parent = current_buf;
+		current_buf = buf;
+
+		if (file->flags & FILE_BUSY) {
+			printf("recursive scan (%s)?\n", filename);
+			exit(1);
+		}
+		if (file->flags & FILE_SCANNED) {
+			printf("file %s already scanned?\n", filename);
+			exit(1);
+		}
+		file->flags |= FILE_BUSY;
+		file->lineno = 1;
+		file->parent = current_file;
+		current_file = file;
+	}
+}
+
+static void zconf_endfile(void)
+{
+	struct buffer *parent;
+
+	current_file->flags |= FILE_SCANNED;
+	current_file->flags &= ~FILE_BUSY;
+	current_file = current_file->parent;
+
+	parent = current_buf->parent;
+	if (parent) {
+		fclose(zconfin);
+		zconf_delete_buffer(YY_CURRENT_BUFFER);
+		zconf_switch_to_buffer(parent->state);
+	}
+	free(current_buf);
+	current_buf = parent;
+}
+
+int zconf_lineno(void)
+{
+	return current_pos.lineno;
+}
+
+char *zconf_curname(void)
+{
+	return current_pos.file ? current_pos.file->name : "<none>";
+}
+
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/scripts/config/zconf.hash.c buildroot/scripts/config/zconf.hash.c
--- buildroot.orig/scripts/config/zconf.hash.c	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/scripts/config/zconf.hash.c	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,235 @@
+/* ANSI-C code produced by gperf version 3.0.1 */
+/* Command-line: gperf  */
+/* Computed positions: -k'1,3' */
+
+#if !((' ' == 32) && ('!' == 33) && ('"' == 34) && ('#' == 35) \
+      && ('%' == 37) && ('&' == 38) && ('\'' == 39) && ('(' == 40) \
+      && (')' == 41) && ('*' == 42) && ('+' == 43) && (',' == 44) \
+      && ('-' == 45) && ('.' == 46) && ('/' == 47) && ('0' == 48) \
+      && ('1' == 49) && ('2' == 50) && ('3' == 51) && ('4' == 52) \
+      && ('5' == 53) && ('6' == 54) && ('7' == 55) && ('8' == 56) \
+      && ('9' == 57) && (':' == 58) && (';' == 59) && ('<' == 60) \
+      && ('=' == 61) && ('>' == 62) && ('?' == 63) && ('A' == 65) \
+      && ('B' == 66) && ('C' == 67) && ('D' == 68) && ('E' == 69) \
+      && ('F' == 70) && ('G' == 71) && ('H' == 72) && ('I' == 73) \
+      && ('J' == 74) && ('K' == 75) && ('L' == 76) && ('M' == 77) \
+      && ('N' == 78) && ('O' == 79) && ('P' == 80) && ('Q' == 81) \
+      && ('R' == 82) && ('S' == 83) && ('T' == 84) && ('U' == 85) \
+      && ('V' == 86) && ('W' == 87) && ('X' == 88) && ('Y' == 89) \
+      && ('Z' == 90) && ('[' == 91) && ('\\' == 92) && (']' == 93) \
+      && ('^' == 94) && ('_' == 95) && ('a' == 97) && ('b' == 98) \
+      && ('c' == 99) && ('d' == 100) && ('e' == 101) && ('f' == 102) \
+      && ('g' == 103) && ('h' == 104) && ('i' == 105) && ('j' == 106) \
+      && ('k' == 107) && ('l' == 108) && ('m' == 109) && ('n' == 110) \
+      && ('o' == 111) && ('p' == 112) && ('q' == 113) && ('r' == 114) \
+      && ('s' == 115) && ('t' == 116) && ('u' == 117) && ('v' == 118) \
+      && ('w' == 119) && ('x' == 120) && ('y' == 121) && ('z' == 122) \
+      && ('{' == 123) && ('|' == 124) && ('}' == 125) && ('~' == 126))
+/* The character set is not based on ISO-646.  */
+#error "gperf generated tables don't work with this execution character set. Please report a bug to <bug-gnu-gperf@gnu.org>."
+#endif
+
+struct kconf_id;
+/* maximum key range = 40, duplicates = 0 */
+
+#ifdef __GNUC__
+__inline
+#else
+#ifdef __cplusplus
+inline
+#endif
+#endif
+static unsigned int
+kconf_id_hash (register const char *str, register unsigned int len)
+{
+  static unsigned char asso_values[] =
+    {
+      42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42, 42, 35,  0, 20,
+       5,  0,  5, 42,  0, 25, 42, 42,  5,  5,
+      10,  0, 25, 15,  0,  0,  0, 10, 42, 42,
+       0, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42, 42, 42, 42, 42,
+      42, 42, 42, 42, 42, 42
+    };
+  register int hval = len;
+
+  switch (hval)
+    {
+      default:
+        hval += asso_values[(unsigned char)str[2]];
+      /*FALLTHROUGH*/
+      case 2:
+      case 1:
+        hval += asso_values[(unsigned char)str[0]];
+        break;
+    }
+  return hval;
+}
+
+struct kconf_id_strings_t
+  {
+    char kconf_id_strings_str2[sizeof("on")];
+    char kconf_id_strings_str3[sizeof("hex")];
+    char kconf_id_strings_str4[sizeof("bool")];
+    char kconf_id_strings_str5[sizeof("reset")];
+    char kconf_id_strings_str6[sizeof("string")];
+    char kconf_id_strings_str7[sizeof("boolean")];
+    char kconf_id_strings_str8[sizeof("optional")];
+    char kconf_id_strings_str9[sizeof("help")];
+    char kconf_id_strings_str10[sizeof("endif")];
+    char kconf_id_strings_str11[sizeof("select")];
+    char kconf_id_strings_str12[sizeof("endmenu")];
+    char kconf_id_strings_str13[sizeof("deselect")];
+    char kconf_id_strings_str14[sizeof("endchoice")];
+    char kconf_id_strings_str15[sizeof("range")];
+    char kconf_id_strings_str16[sizeof("source")];
+    char kconf_id_strings_str17[sizeof("default")];
+    char kconf_id_strings_str18[sizeof("def_bool")];
+    char kconf_id_strings_str19[sizeof("menu")];
+    char kconf_id_strings_str21[sizeof("def_boolean")];
+    char kconf_id_strings_str22[sizeof("def_tristate")];
+    char kconf_id_strings_str23[sizeof("requires")];
+    char kconf_id_strings_str25[sizeof("menuconfig")];
+    char kconf_id_strings_str26[sizeof("choice")];
+    char kconf_id_strings_str27[sizeof("if")];
+    char kconf_id_strings_str28[sizeof("int")];
+    char kconf_id_strings_str31[sizeof("prompt")];
+    char kconf_id_strings_str32[sizeof("comment")];
+    char kconf_id_strings_str33[sizeof("tristate")];
+    char kconf_id_strings_str36[sizeof("config")];
+    char kconf_id_strings_str37[sizeof("depends")];
+    char kconf_id_strings_str38[sizeof("mainmenu")];
+    char kconf_id_strings_str41[sizeof("enable")];
+  };
+static struct kconf_id_strings_t kconf_id_strings_contents =
+  {
+    "on",
+    "hex",
+    "bool",
+    "reset",
+    "string",
+    "boolean",
+    "optional",
+    "help",
+    "endif",
+    "select",
+    "endmenu",
+    "deselect",
+    "endchoice",
+    "range",
+    "source",
+    "default",
+    "def_bool",
+    "menu",
+    "def_boolean",
+    "def_tristate",
+    "requires",
+    "menuconfig",
+    "choice",
+    "if",
+    "int",
+    "prompt",
+    "comment",
+    "tristate",
+    "config",
+    "depends",
+    "mainmenu",
+    "enable"
+  };
+#define kconf_id_strings ((const char *) &kconf_id_strings_contents)
+#ifdef __GNUC__
+__inline
+#endif
+struct kconf_id *
+kconf_id_lookup (register const char *str, register unsigned int len)
+{
+  enum
+    {
+      TOTAL_KEYWORDS = 32,
+      MIN_WORD_LENGTH = 2,
+      MAX_WORD_LENGTH = 12,
+      MIN_HASH_VALUE = 2,
+      MAX_HASH_VALUE = 41
+    };
+
+  static struct kconf_id wordlist[] =
+    {
+      {-1}, {-1},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str2,		T_ON,		TF_PARAM},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str3,		T_TYPE,		TF_COMMAND, S_HEX},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str4,		T_TYPE,		TF_COMMAND, S_BOOLEAN},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str5,		T_RESET,	TF_COMMAND},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str6,		T_TYPE,		TF_COMMAND, S_STRING},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str7,	T_TYPE,		TF_COMMAND, S_BOOLEAN},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str8,	T_OPTIONAL,	TF_COMMAND},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str9,		T_HELP,		TF_COMMAND},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str10,		T_ENDIF,	TF_COMMAND},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str11,		T_SELECT,	TF_COMMAND},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str12,	T_ENDMENU,	TF_COMMAND},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str13,	T_DESELECT,	TF_COMMAND},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str14,	T_ENDCHOICE,	TF_COMMAND},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str15,		T_RANGE,	TF_COMMAND},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str16,		T_SOURCE,	TF_COMMAND},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str17,	T_DEFAULT,	TF_COMMAND, S_UNKNOWN},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str18,	T_DEFAULT,	TF_COMMAND, S_BOOLEAN},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str19,		T_MENU,		TF_COMMAND},
+      {-1},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str21,	T_DEFAULT,	TF_COMMAND, S_BOOLEAN},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str22,	T_DEFAULT,	TF_COMMAND, S_TRISTATE},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str23,	T_REQUIRES,	TF_COMMAND},
+      {-1},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str25,	T_MENUCONFIG,	TF_COMMAND},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str26,		T_CHOICE,	TF_COMMAND},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str27,		T_IF,		TF_COMMAND|TF_PARAM},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str28,		T_TYPE,		TF_COMMAND, S_INT},
+      {-1}, {-1},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str31,		T_PROMPT,	TF_COMMAND},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str32,	T_COMMENT,	TF_COMMAND},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str33,	T_TYPE,		TF_COMMAND, S_TRISTATE},
+      {-1}, {-1},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str36,		T_CONFIG,	TF_COMMAND},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str37,	T_DEPENDS,	TF_COMMAND},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str38,	T_MAINMENU,	TF_COMMAND},
+      {-1}, {-1},
+      {(int)(long)&((struct kconf_id_strings_t *)0)->kconf_id_strings_str41,		T_SELECT,	TF_COMMAND}
+    };
+
+  if (len <= MAX_WORD_LENGTH && len >= MIN_WORD_LENGTH)
+    {
+      register int key = kconf_id_hash (str, len);
+
+      if (key <= MAX_HASH_VALUE && key >= 0)
+        {
+          register int o = wordlist[key].name;
+          if (o >= 0)
+            {
+              register const char *s = o + kconf_id_strings;
+
+              if (*str == *s && !strncmp (str + 1, s + 1, len - 1) && s[len] == '\0')
+                return &wordlist[key];
+            }
+        }
+    }
+  return 0;
+}
+
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/scripts/config/zconf.tab.c buildroot/scripts/config/zconf.tab.c
--- buildroot.orig/scripts/config/zconf.tab.c	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/scripts/config/zconf.tab.c	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,2175 @@
+/* A Bison parser, made by GNU Bison 1.875d.  */
+
+/* Skeleton parser for Yacc-like parsing with Bison,
+   Copyright (C) 1984, 1989, 1990, 2000, 2001, 2002, 2003, 2004 Free Software Foundation, Inc.
+
+   This program is free software; you can redistribute it and/or modify
+   it under the terms of the GNU General Public License as published by
+   the Free Software Foundation; either version 2, or (at your option)
+   any later version.
+
+   This program is distributed in the hope that it will be useful,
+   but WITHOUT ANY WARRANTY; without even the implied warranty of
+   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+   GNU General Public License for more details.
+
+   You should have received a copy of the GNU General Public License
+   along with this program; if not, write to the Free Software
+   Foundation, Inc., 59 Temple Place - Suite 330,
+   Boston, MA 02111-1307, USA.  */
+
+/* As a special exception, when this file is copied by Bison into a
+   Bison output file, you may use that output file without restriction.
+   This special exception was added by the Free Software Foundation
+   in version 1.24 of Bison.  */
+
+/* Written by Richard Stallman by simplifying the original so called
+   ``semantic'' parser.  */
+
+/* All symbols defined below should begin with yy or YY, to avoid
+   infringing on user name space.  This should be done even for local
+   variables, as they might otherwise be expanded by user macros.
+   There are some unavoidable exceptions within include files to
+   define necessary library symbols; they are noted "INFRINGES ON
+   USER NAME SPACE" below.  */
+
+/* Identify Bison output.  */
+#define YYBISON 1
+
+/* Skeleton name.  */
+#define YYSKELETON_NAME "yacc.c"
+
+/* Pure parsers.  */
+#define YYPURE 0
+
+/* Using locations.  */
+#define YYLSP_NEEDED 0
+
+/* If NAME_PREFIX is specified substitute the variables and functions
+   names.  */
+#define yyparse zconfparse
+#define yylex   zconflex
+#define yyerror zconferror
+#define yylval  zconflval
+#define yychar  zconfchar
+#define yydebug zconfdebug
+#define yynerrs zconfnerrs
+
+
+/* Tokens.  */
+#ifndef YYTOKENTYPE
+# define YYTOKENTYPE
+   /* Put the tokens into the symbol table, so that GDB and other debuggers
+      know about them.  */
+   enum yytokentype {
+     T_MAINMENU = 258,
+     T_MENU = 259,
+     T_ENDMENU = 260,
+     T_SOURCE = 261,
+     T_CHOICE = 262,
+     T_ENDCHOICE = 263,
+     T_COMMENT = 264,
+     T_CONFIG = 265,
+     T_MENUCONFIG = 266,
+     T_HELP = 267,
+     T_HELPTEXT = 268,
+     T_IF = 269,
+     T_ENDIF = 270,
+     T_DEPENDS = 271,
+     T_REQUIRES = 272,
+     T_OPTIONAL = 273,
+     T_PROMPT = 274,
+     T_TYPE = 275,
+     T_DEFAULT = 276,
+     T_DESELECT = 277,
+     T_SELECT = 278,
+     T_RANGE = 279,
+     T_ON = 280,
+     T_RESET = 281,
+     T_WORD = 282,
+     T_WORD_QUOTE = 283,
+     T_UNEQUAL = 284,
+     T_CLOSE_PAREN = 285,
+     T_OPEN_PAREN = 286,
+     T_EOL = 287,
+     T_OR = 288,
+     T_AND = 289,
+     T_EQUAL = 290,
+     T_NOT = 291
+   };
+#endif
+#define T_MAINMENU 258
+#define T_MENU 259
+#define T_ENDMENU 260
+#define T_SOURCE 261
+#define T_CHOICE 262
+#define T_ENDCHOICE 263
+#define T_COMMENT 264
+#define T_CONFIG 265
+#define T_MENUCONFIG 266
+#define T_HELP 267
+#define T_HELPTEXT 268
+#define T_IF 269
+#define T_ENDIF 270
+#define T_DEPENDS 271
+#define T_REQUIRES 272
+#define T_OPTIONAL 273
+#define T_PROMPT 274
+#define T_TYPE 275
+#define T_DEFAULT 276
+#define T_DESELECT 277
+#define T_SELECT 278
+#define T_RANGE 279
+#define T_ON 280
+#define T_RESET 281
+#define T_WORD 282
+#define T_WORD_QUOTE 283
+#define T_UNEQUAL 284
+#define T_CLOSE_PAREN 285
+#define T_OPEN_PAREN 286
+#define T_EOL 287
+#define T_OR 288
+#define T_AND 289
+#define T_EQUAL 290
+#define T_NOT 291
+
+
+
+
+/* Copy the first part of user declarations.  */
+
+
+/*
+ * Copyright (C) 2002 Roman Zippel <zippel@linux-m68k.org>
+ * Released under the terms of the GNU GPL v2.0.
+ */
+
+#include <ctype.h>
+#include <stdarg.h>
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+#include <stdbool.h>
+
+#define LKC_DIRECT_LINK
+#include "lkc.h"
+
+#include "zconf.hash.c"
+
+#define printd(mask, fmt...) if (cdebug & (mask)) printf(fmt)
+
+#define PRINTD		0x0001
+#define DEBUG_PARSE	0x0002
+
+int cdebug = PRINTD;
+
+extern int zconflex(void);
+static void zconfprint(const char *err, ...);
+static void zconf_error(const char *err, ...);
+static void zconferror(const char *err);
+static bool zconf_endtoken(struct kconf_id *id, int starttoken, int endtoken);
+
+struct symbol *symbol_hash[257];
+
+static struct menu *current_menu, *current_entry;
+
+#define YYDEBUG 0
+#if YYDEBUG
+#define YYERROR_VERBOSE
+#endif
+
+
+/* Enabling traces.  */
+#ifndef YYDEBUG
+# define YYDEBUG 0
+#endif
+
+/* Enabling verbose error messages.  */
+#ifdef YYERROR_VERBOSE
+# undef YYERROR_VERBOSE
+# define YYERROR_VERBOSE 1
+#else
+# define YYERROR_VERBOSE 0
+#endif
+
+#if ! defined (YYSTYPE) && ! defined (YYSTYPE_IS_DECLARED)
+
+typedef union YYSTYPE {
+	char *string;
+	struct file *file;
+	struct symbol *symbol;
+	struct expr *expr;
+	struct menu *menu;
+	struct kconf_id *id;
+} YYSTYPE;
+/* Line 191 of yacc.c.  */
+
+# define yystype YYSTYPE /* obsolescent; will be withdrawn */
+# define YYSTYPE_IS_DECLARED 1
+# define YYSTYPE_IS_TRIVIAL 1
+#endif
+
+
+
+/* Copy the second part of user declarations.  */
+
+
+/* Line 214 of yacc.c.  */
+
+
+#if ! defined (yyoverflow) || YYERROR_VERBOSE
+
+# ifndef YYFREE
+#  define YYFREE free
+# endif
+# ifndef YYMALLOC
+#  define YYMALLOC malloc
+# endif
+
+/* The parser invokes alloca or malloc; define the necessary symbols.  */
+
+# ifdef YYSTACK_USE_ALLOCA
+#  if YYSTACK_USE_ALLOCA
+#   define YYSTACK_ALLOC alloca
+#  endif
+# else
+#  if defined (alloca) || defined (_ALLOCA_H)
+#   define YYSTACK_ALLOC alloca
+#  else
+#   ifdef __GNUC__
+#    define YYSTACK_ALLOC __builtin_alloca
+#   endif
+#  endif
+# endif
+
+# ifdef YYSTACK_ALLOC
+   /* Pacify GCC's `empty if-body' warning. */
+#  define YYSTACK_FREE(Ptr) do { /* empty */; } while (0)
+# else
+#  if defined (__STDC__) || defined (__cplusplus)
+#   include <stdlib.h> /* INFRINGES ON USER NAME SPACE */
+#   define YYSIZE_T size_t
+#  endif
+#  define YYSTACK_ALLOC YYMALLOC
+#  define YYSTACK_FREE YYFREE
+# endif
+#endif /* ! defined (yyoverflow) || YYERROR_VERBOSE */
+
+
+#if (! defined (yyoverflow) \
+     && (! defined (__cplusplus) \
+	 || (defined (YYSTYPE_IS_TRIVIAL) && YYSTYPE_IS_TRIVIAL)))
+
+/* A type that is properly aligned for any stack member.  */
+union yyalloc
+{
+  short int yyss;
+  YYSTYPE yyvs;
+  };
+
+/* The size of the maximum gap between one aligned stack and the next.  */
+# define YYSTACK_GAP_MAXIMUM (sizeof (union yyalloc) - 1)
+
+/* The size of an array large to enough to hold all stacks, each with
+   N elements.  */
+# define YYSTACK_BYTES(N) \
+     ((N) * (sizeof (short int) + sizeof (YYSTYPE))			\
+      + YYSTACK_GAP_MAXIMUM)
+
+/* Copy COUNT objects from FROM to TO.  The source and destination do
+   not overlap.  */
+# ifndef YYCOPY
+#  if defined (__GNUC__) && 1 < __GNUC__
+#   define YYCOPY(To, From, Count) \
+      __builtin_memcpy (To, From, (Count) * sizeof (*(From)))
+#  else
+#   define YYCOPY(To, From, Count)		\
+      do					\
+	{					\
+	  register YYSIZE_T yyi;		\
+	  for (yyi = 0; yyi < (Count); yyi++)	\
+	    (To)[yyi] = (From)[yyi];		\
+	}					\
+      while (0)
+#  endif
+# endif
+
+/* Relocate STACK from its old location to the new one.  The
+   local variables YYSIZE and YYSTACKSIZE give the old and new number of
+   elements in the stack, and YYPTR gives the new location of the
+   stack.  Advance YYPTR to a properly aligned location for the next
+   stack.  */
+# define YYSTACK_RELOCATE(Stack)					\
+    do									\
+      {									\
+	YYSIZE_T yynewbytes;						\
+	YYCOPY (&yyptr->Stack, Stack, yysize);				\
+	Stack = &yyptr->Stack;						\
+	yynewbytes = yystacksize * sizeof (*Stack) + YYSTACK_GAP_MAXIMUM; \
+	yyptr += yynewbytes / sizeof (*yyptr);				\
+      }									\
+    while (0)
+
+#endif
+
+#if defined (__STDC__) || defined (__cplusplus)
+   typedef signed char yysigned_char;
+#else
+   typedef short int yysigned_char;
+#endif
+
+/* YYFINAL -- State number of the termination state. */
+#define YYFINAL  3
+/* YYLAST -- Last index in YYTABLE.  */
+#define YYLAST   285
+
+/* YYNTOKENS -- Number of terminals. */
+#define YYNTOKENS  37
+/* YYNNTS -- Number of nonterminals. */
+#define YYNNTS  42
+/* YYNRULES -- Number of rules. */
+#define YYNRULES  108
+/* YYNRULES -- Number of states. */
+#define YYNSTATES  184
+
+/* YYTRANSLATE(YYLEX) -- Bison symbol number corresponding to YYLEX.  */
+#define YYUNDEFTOK  2
+#define YYMAXUTOK   291
+
+#define YYTRANSLATE(YYX) 						\
+  ((unsigned int) (YYX) <= YYMAXUTOK ? yytranslate[YYX] : YYUNDEFTOK)
+
+/* YYTRANSLATE[YYLEX] -- Bison symbol number corresponding to YYLEX.  */
+static const unsigned char yytranslate[] =
+{
+       0,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     2,     2,     2,     2,
+       2,     2,     2,     2,     2,     2,     1,     2,     3,     4,
+       5,     6,     7,     8,     9,    10,    11,    12,    13,    14,
+      15,    16,    17,    18,    19,    20,    21,    22,    23,    24,
+      25,    26,    27,    28,    29,    30,    31,    32,    33,    34,
+      35,    36
+};
+
+#if YYDEBUG
+/* YYPRHS[YYN] -- Index of the first RHS symbol of rule number YYN in
+   YYRHS.  */
+static const unsigned short int yyprhs[] =
+{
+       0,     0,     3,     5,     6,     9,    12,    15,    20,    23,
+      28,    33,    37,    39,    41,    43,    45,    47,    49,    51,
+      53,    55,    57,    59,    61,    63,    65,    67,    71,    74,
+      78,    81,    85,    88,    89,    92,    95,    98,   101,   104,
+     108,   113,   118,   123,   128,   134,   137,   140,   142,   146,
+     147,   150,   153,   156,   159,   162,   167,   171,   174,   178,
+     183,   184,   187,   191,   193,   197,   198,   201,   204,   207,
+     211,   214,   216,   220,   221,   224,   227,   230,   234,   238,
+     241,   244,   247,   248,   251,   254,   257,   262,   266,   270,
+     271,   274,   276,   278,   281,   284,   287,   289,   292,   293,
+     296,   298,   302,   306,   310,   313,   317,   321,   323
+};
+
+/* YYRHS -- A `-1'-separated list of the rules' RHS. */
+static const yysigned_char yyrhs[] =
+{
+      38,     0,    -1,    39,    -1,    -1,    39,    41,    -1,    39,
+      52,    -1,    39,    63,    -1,    39,     3,    73,    75,    -1,
+      39,    74,    -1,    39,    27,     1,    32,    -1,    39,    40,
+       1,    32,    -1,    39,     1,    32,    -1,    16,    -1,    19,
+      -1,    20,    -1,    22,    -1,    23,    -1,    18,    -1,    24,
+      -1,    21,    -1,    26,    -1,    32,    -1,    58,    -1,    67,
+      -1,    44,    -1,    46,    -1,    65,    -1,    27,     1,    32,
+      -1,     1,    32,    -1,    10,    27,    32,    -1,    43,    47,
+      -1,    11,    27,    32,    -1,    45,    47,    -1,    -1,    47,
+      48,    -1,    47,    71,    -1,    47,    69,    -1,    47,    42,
+      -1,    47,    32,    -1,    20,    72,    32,    -1,    19,    73,
+      76,    32,    -1,    21,    77,    76,    32,    -1,    22,    27,
+      76,    32,    -1,    23,    27,    76,    32,    -1,    24,    78,
+      78,    76,    32,    -1,     7,    32,    -1,    49,    53,    -1,
+      74,    -1,    50,    55,    51,    -1,    -1,    53,    54,    -1,
+      53,    71,    -1,    53,    69,    -1,    53,    32,    -1,    53,
+      42,    -1,    19,    73,    76,    32,    -1,    20,    72,    32,
+      -1,    18,    32,    -1,    26,    76,    32,    -1,    21,    27,
+      76,    32,    -1,    -1,    55,    41,    -1,    14,    77,    75,
+      -1,    74,    -1,    56,    59,    57,    -1,    -1,    59,    41,
+      -1,    59,    63,    -1,    59,    52,    -1,     4,    73,    32,
+      -1,    60,    70,    -1,    74,    -1,    61,    64,    62,    -1,
+      -1,    64,    41,    -1,    64,    63,    -1,    64,    52,    -1,
+       6,    73,    32,    -1,     9,    73,    32,    -1,    66,    70,
+      -1,    12,    32,    -1,    68,    13,    -1,    -1,    70,    71,
+      -1,    70,    32,    -1,    70,    42,    -1,    16,    25,    77,
+      32,    -1,    16,    77,    32,    -1,    17,    77,    32,    -1,
+      -1,    73,    76,    -1,    27,    -1,    28,    -1,     5,    32,
+      -1,     8,    32,    -1,    15,    32,    -1,    32,    -1,    75,
+      32,    -1,    -1,    14,    77,    -1,    78,    -1,    78,    35,
+      78,    -1,    78,    29,    78,    -1,    31,    77,    30,    -1,
+      36,    77,    -1,    77,    33,    77,    -1,    77,    34,    77,
+      -1,    27,    -1,    28,    -1
+};
+
+/* YYRLINE[YYN] -- source line where rule number YYN was defined.  */
+static const unsigned short int yyrline[] =
+{
+       0,   105,   105,   107,   109,   110,   111,   112,   113,   114,
+     115,   119,   123,   123,   123,   123,   123,   123,   123,   123,
+     123,   127,   128,   129,   130,   131,   132,   136,   137,   143,
+     151,   157,   165,   175,   177,   178,   179,   180,   181,   184,
+     192,   198,   208,   214,   220,   228,   237,   242,   250,   253,
+     255,   256,   257,   258,   259,   262,   268,   279,   285,   290,
+     300,   302,   307,   315,   323,   326,   328,   329,   330,   335,
+     342,   347,   355,   358,   360,   361,   362,   365,   373,   380,
+     387,   393,   400,   402,   403,   404,   407,   412,   417,   425,
+     427,   432,   433,   436,   437,   438,   442,   443,   446,   447,
+     450,   451,   452,   453,   454,   455,   456,   459,   460
+};
+#endif
+
+#if YYDEBUG || YYERROR_VERBOSE
+/* YYTNME[SYMBOL-NUM] -- String name of the symbol SYMBOL-NUM.
+   First, the terminals, then, starting at YYNTOKENS, nonterminals. */
+static const char *const yytname[] =
+{
+  "$end", "error", "$undefined", "T_MAINMENU", "T_MENU", "T_ENDMENU",
+  "T_SOURCE", "T_CHOICE", "T_ENDCHOICE", "T_COMMENT", "T_CONFIG",
+  "T_MENUCONFIG", "T_HELP", "T_HELPTEXT", "T_IF", "T_ENDIF", "T_DEPENDS",
+  "T_REQUIRES", "T_OPTIONAL", "T_PROMPT", "T_TYPE", "T_DEFAULT",
+  "T_DESELECT", "T_SELECT", "T_RANGE", "T_ON", "T_RESET", "T_WORD",
+  "T_WORD_QUOTE", "T_UNEQUAL", "T_CLOSE_PAREN", "T_OPEN_PAREN", "T_EOL",
+  "T_OR", "T_AND", "T_EQUAL", "T_NOT", "$accept", "input", "stmt_list",
+  "option_name", "common_stmt", "option_error", "config_entry_start",
+  "config_stmt", "menuconfig_entry_start", "menuconfig_stmt",
+  "config_option_list", "config_option", "choice", "choice_entry",
+  "choice_end", "choice_stmt", "choice_option_list", "choice_option",
+  "choice_block", "if_entry", "if_end", "if_stmt", "if_block", "menu",
+  "menu_entry", "menu_end", "menu_stmt", "menu_block", "source_stmt",
+  "comment", "comment_stmt", "help_start", "help", "depends_list",
+  "depends", "prompt_stmt_opt", "prompt", "end", "nl", "if_expr", "expr",
+  "symbol", 0
+};
+#endif
+
+# ifdef YYPRINT
+/* YYTOKNUM[YYLEX-NUM] -- Internal token number corresponding to
+   token YYLEX-NUM.  */
+static const unsigned short int yytoknum[] =
+{
+       0,   256,   257,   258,   259,   260,   261,   262,   263,   264,
+     265,   266,   267,   268,   269,   270,   271,   272,   273,   274,
+     275,   276,   277,   278,   279,   280,   281,   282,   283,   284,
+     285,   286,   287,   288,   289,   290,   291
+};
+# endif
+
+/* YYR1[YYN] -- Symbol number of symbol that rule YYN derives.  */
+static const unsigned char yyr1[] =
+{
+       0,    37,    38,    39,    39,    39,    39,    39,    39,    39,
+      39,    39,    40,    40,    40,    40,    40,    40,    40,    40,
+      40,    41,    41,    41,    41,    41,    41,    42,    42,    43,
+      44,    45,    46,    47,    47,    47,    47,    47,    47,    48,
+      48,    48,    48,    48,    48,    49,    50,    51,    52,    53,
+      53,    53,    53,    53,    53,    54,    54,    54,    54,    54,
+      55,    55,    56,    57,    58,    59,    59,    59,    59,    60,
+      61,    62,    63,    64,    64,    64,    64,    65,    66,    67,
+      68,    69,    70,    70,    70,    70,    71,    71,    71,    72,
+      72,    73,    73,    74,    74,    74,    75,    75,    76,    76,
+      77,    77,    77,    77,    77,    77,    77,    78,    78
+};
+
+/* YYR2[YYN] -- Number of symbols composing right hand side of rule YYN.  */
+static const unsigned char yyr2[] =
+{
+       0,     2,     1,     0,     2,     2,     2,     4,     2,     4,
+       4,     3,     1,     1,     1,     1,     1,     1,     1,     1,
+       1,     1,     1,     1,     1,     1,     1,     3,     2,     3,
+       2,     3,     2,     0,     2,     2,     2,     2,     2,     3,
+       4,     4,     4,     4,     5,     2,     2,     1,     3,     0,
+       2,     2,     2,     2,     2,     4,     3,     2,     3,     4,
+       0,     2,     3,     1,     3,     0,     2,     2,     2,     3,
+       2,     1,     3,     0,     2,     2,     2,     3,     3,     2,
+       2,     2,     0,     2,     2,     2,     4,     3,     3,     0,
+       2,     1,     1,     2,     2,     2,     1,     2,     0,     2,
+       1,     3,     3,     3,     2,     3,     3,     1,     1
+};
+
+/* YYDEFACT[STATE-NAME] -- Default rule to reduce with in state
+   STATE-NUM when YYTABLE doesn't specify something else to do.  Zero
+   means the default is an error.  */
+static const unsigned char yydefact[] =
+{
+       3,     0,     0,     1,     0,     0,     0,     0,     0,     0,
+       0,     0,     0,     0,     0,     0,    12,    17,    13,    14,
+      19,    15,    16,    18,    20,     0,    21,     0,     4,    33,
+      24,    33,    25,    49,    60,     5,    65,    22,    82,    73,
+       6,    26,    82,    23,     8,    11,    91,    92,     0,     0,
+      93,     0,    45,    94,     0,     0,     0,   107,   108,     0,
+       0,     0,   100,    95,     0,     0,     0,     0,     0,     0,
+       0,     0,     0,     0,    96,     7,    69,    77,    78,    29,
+      31,     0,   104,     0,     0,    62,     0,     0,     9,    10,
+       0,     0,     0,     0,     0,    89,     0,     0,     0,     0,
+       0,    38,    37,    34,     0,    36,    35,     0,     0,    89,
+       0,    98,    53,    54,    50,    52,    51,    61,    48,    47,
+      66,    68,    64,    67,    63,    84,    85,    83,    74,    76,
+      72,    75,    71,    97,   103,   105,   106,   102,   101,    28,
+      80,     0,     0,     0,    98,     0,    98,    98,    98,    98,
+       0,     0,    81,    57,    98,     0,    98,     0,     0,     0,
+      87,    88,     0,    39,    90,     0,     0,     0,    98,    27,
+       0,    56,     0,    99,    58,    86,    40,    41,    42,    43,
+       0,    55,    59,    44
+};
+
+/* YYDEFGOTO[NTERM-NUM]. */
+static const short int yydefgoto[] =
+{
+      -1,     1,     2,    27,    28,   102,    29,    30,    31,    32,
+      66,   103,    33,    34,   118,    35,    68,   114,    69,    36,
+     122,    37,    70,    38,    39,   130,    40,    72,    41,    42,
+      43,   104,   105,    71,   106,   145,   146,    44,    75,   158,
+      61,    62
+};
+
+/* YYPACT[STATE-NUM] -- Index in YYTABLE of the portion describing
+   STATE-NUM.  */
+#define YYPACT_NINF -80
+static const short int yypact[] =
+{
+     -80,     2,   164,   -80,   -22,   105,   105,    -6,   105,     0,
+       7,   105,    17,    28,    70,    35,   -80,   -80,   -80,   -80,
+     -80,   -80,   -80,   -80,   -80,    69,   -80,    78,   -80,   -80,
+     -80,   -80,   -80,   -80,   -80,   -80,   -80,   -80,   -80,   -80,
+     -80,   -80,   -80,   -80,   -80,   -80,   -80,   -80,    62,    68,
+     -80,    85,   -80,   -80,    97,   127,   144,   -80,   -80,    70,
+      70,   188,    -8,   -80,   149,   163,    42,   104,   192,    67,
+     221,     8,   221,   134,   -80,   167,   -80,   -80,   -80,   -80,
+     -80,    50,   -80,    70,    70,   167,   119,   119,   -80,   -80,
+     173,   184,    60,    70,   105,   105,    70,    65,   150,   119,
+     232,   -80,   -80,   -80,   210,   -80,   -80,   202,   105,   105,
+     231,   224,   -80,   -80,   -80,   -80,   -80,   -80,   -80,   -80,
+     -80,   -80,   -80,   -80,   -80,   -80,   -80,   -80,   -80,   -80,
+     -80,   -80,   -80,   -80,   -80,   226,   -80,   -80,   -80,   -80,
+     -80,    70,   211,   218,   224,   230,   224,    -3,   224,   224,
+     119,   233,   -80,   -80,   224,   234,   224,    70,   235,   222,
+     -80,   -80,   236,   -80,   -80,   237,   238,   239,   224,   -80,
+     240,   -80,   241,   129,   -80,   -80,   -80,   -80,   -80,   -80,
+     242,   -80,   -80,   -80
+};
+
+/* YYPGOTO[NTERM-NUM].  */
+static const short int yypgoto[] =
+{
+     -80,   -80,   -80,   -80,   -36,    22,   -80,   -80,   -80,   -80,
+     244,   -80,   -80,   -80,   -80,   176,   -80,   -80,   -80,   -80,
+     -80,   -80,   -80,   -80,   -80,   -80,   187,   -80,   -80,   -80,
+     -80,   -80,   195,   243,   121,   155,    -5,   145,   215,    93,
+     -55,   -79
+};
+
+/* YYTABLE[YYPACT[STATE-NUM]].  What to do in state STATE-NUM.  If
+   positive, shift that token.  If negative, reduce the rule which
+   number is the opposite.  If zero, do what YYDEFACT says.
+   If YYTABLE_NINF, syntax error.  */
+#define YYTABLE_NINF -80
+static const short int yytable[] =
+{
+      48,    49,     3,    51,    81,    82,    54,   137,   138,    90,
+      45,   157,   -70,   -70,   -70,   -70,   -70,   -70,   -70,   -70,
+     150,    86,   -70,   -70,    92,    93,    50,    87,   135,   136,
+      83,    84,    52,   117,   120,   100,   128,   142,   143,    53,
+     125,   147,   -30,    90,    55,   -30,   -30,   -30,   -30,   -30,
+     -30,   -30,   -30,   -30,    91,    56,   -30,   -30,    92,    93,
+     -30,    94,    95,    96,    97,    98,    99,    63,   -30,   100,
+      64,   168,     7,     8,   101,    10,    11,    12,    13,    65,
+     134,    14,    15,    83,    84,   141,   159,    57,    58,   144,
+     113,    59,   148,   126,    74,   126,    60,    57,    58,    26,
+      76,    59,   173,   154,   -32,    90,    60,   -32,   -32,   -32,
+     -32,   -32,   -32,   -32,   -32,   -32,    91,    77,   -32,   -32,
+      92,    93,   -32,    94,    95,    96,    97,    98,    99,    78,
+     -32,   100,    46,    47,   -79,    90,   101,   -79,   -79,   -79,
+     -79,   -79,   -79,   -79,   -79,   -79,    57,    58,   -79,   -79,
+      92,    93,   -79,   -79,   -79,   -79,   -79,   -79,   -79,    79,
+     -79,   100,    83,    84,    -2,     4,   125,     5,     6,     7,
+       8,     9,    10,    11,    12,    13,    80,   149,    14,    15,
+      16,    88,    17,    18,    19,    20,    21,    22,    23,   116,
+      24,    25,   127,    90,   127,    89,    26,   -46,   -46,   133,
+     -46,   -46,   -46,   -46,    91,   139,   -46,   -46,    92,    93,
+     107,   108,   109,   110,   119,   124,   140,   132,   111,   100,
+      74,    83,    84,   152,   112,     6,     7,     8,     9,    10,
+      11,    12,    13,   151,   153,    14,    15,   162,   157,   164,
+     165,   166,   167,   160,    83,    84,   121,   170,   129,   172,
+     161,    83,    84,    26,   175,    83,    84,   123,   156,   131,
+      84,   180,   163,   115,   155,   169,   171,   174,   176,   177,
+     178,   179,   181,   182,   183,    67,    85,     0,     0,     0,
+       0,     0,     0,     0,     0,    73
+};
+
+static const short int yycheck[] =
+{
+       5,     6,     0,     8,    59,    60,    11,    86,    87,     1,
+      32,    14,     4,     5,     6,     7,     8,     9,    10,    11,
+      99,    29,    14,    15,    16,    17,    32,    35,    83,    84,
+      33,    34,    32,    69,    70,    27,    72,    92,    93,    32,
+      32,    96,     0,     1,    27,     3,     4,     5,     6,     7,
+       8,     9,    10,    11,    12,    27,    14,    15,    16,    17,
+      18,    19,    20,    21,    22,    23,    24,    32,    26,    27,
+       1,   150,     5,     6,    32,     8,     9,    10,    11,     1,
+      30,    14,    15,    33,    34,    25,   141,    27,    28,    94,
+      68,    31,    27,    71,    32,    73,    36,    27,    28,    32,
+      32,    31,   157,   108,     0,     1,    36,     3,     4,     5,
+       6,     7,     8,     9,    10,    11,    12,    32,    14,    15,
+      16,    17,    18,    19,    20,    21,    22,    23,    24,    32,
+      26,    27,    27,    28,     0,     1,    32,     3,     4,     5,
+       6,     7,     8,     9,    10,    11,    27,    28,    14,    15,
+      16,    17,    18,    19,    20,    21,    22,    23,    24,    32,
+      26,    27,    33,    34,     0,     1,    32,     3,     4,     5,
+       6,     7,     8,     9,    10,    11,    32,    27,    14,    15,
+      16,    32,    18,    19,    20,    21,    22,    23,    24,    68,
+      26,    27,    71,     1,    73,    32,    32,     5,     6,    32,
+       8,     9,    10,    11,    12,    32,    14,    15,    16,    17,
+      18,    19,    20,    21,    69,    70,    32,    72,    26,    27,
+      32,    33,    34,    13,    32,     4,     5,     6,     7,     8,
+       9,    10,    11,     1,    32,    14,    15,   144,    14,   146,
+     147,   148,   149,    32,    33,    34,    70,   154,    72,   156,
+      32,    33,    34,    32,    32,    33,    34,    70,    27,    72,
+      34,   168,    32,    68,   109,    32,    32,    32,    32,    32,
+      32,    32,    32,    32,    32,    31,    61,    -1,    -1,    -1,
+      -1,    -1,    -1,    -1,    -1,    42
+};
+
+/* YYSTOS[STATE-NUM] -- The (internal number of the) accessing
+   symbol of state STATE-NUM.  */
+static const unsigned char yystos[] =
+{
+       0,    38,    39,     0,     1,     3,     4,     5,     6,     7,
+       8,     9,    10,    11,    14,    15,    16,    18,    19,    20,
+      21,    22,    23,    24,    26,    27,    32,    40,    41,    43,
+      44,    45,    46,    49,    50,    52,    56,    58,    60,    61,
+      63,    65,    66,    67,    74,    32,    27,    28,    73,    73,
+      32,    73,    32,    32,    73,    27,    27,    27,    28,    31,
+      36,    77,    78,    32,     1,     1,    47,    47,    53,    55,
+      59,    70,    64,    70,    32,    75,    32,    32,    32,    32,
+      32,    77,    77,    33,    34,    75,    29,    35,    32,    32,
+       1,    12,    16,    17,    19,    20,    21,    22,    23,    24,
+      27,    32,    42,    48,    68,    69,    71,    18,    19,    20,
+      21,    26,    32,    42,    54,    69,    71,    41,    51,    74,
+      41,    52,    57,    63,    74,    32,    42,    71,    41,    52,
+      62,    63,    74,    32,    30,    77,    77,    78,    78,    32,
+      32,    25,    77,    77,    73,    72,    73,    77,    27,    27,
+      78,     1,    13,    32,    73,    72,    27,    14,    76,    77,
+      32,    32,    76,    32,    76,    76,    76,    76,    78,    32,
+      76,    32,    76,    77,    32,    32,    32,    32,    32,    32,
+      76,    32,    32,    32
+};
+
+#if ! defined (YYSIZE_T) && defined (__SIZE_TYPE__)
+# define YYSIZE_T __SIZE_TYPE__
+#endif
+#if ! defined (YYSIZE_T) && defined (size_t)
+# define YYSIZE_T size_t
+#endif
+#if ! defined (YYSIZE_T)
+# if defined (__STDC__) || defined (__cplusplus)
+#  include <stddef.h> /* INFRINGES ON USER NAME SPACE */
+#  define YYSIZE_T size_t
+# endif
+#endif
+#if ! defined (YYSIZE_T)
+# define YYSIZE_T unsigned int
+#endif
+
+#define yyerrok		(yyerrstatus = 0)
+#define yyclearin	(yychar = YYEMPTY)
+#define YYEMPTY		(-2)
+#define YYEOF		0
+
+#define YYACCEPT	goto yyacceptlab
+#define YYABORT		goto yyabortlab
+#define YYERROR		goto yyerrorlab
+
+
+/* Like YYERROR except do call yyerror.  This remains here temporarily
+   to ease the transition to the new meaning of YYERROR, for GCC.
+   Once GCC version 2 has supplanted version 1, this can go.  */
+
+#define YYFAIL		goto yyerrlab
+
+#define YYRECOVERING()  (!!yyerrstatus)
+
+#define YYBACKUP(Token, Value)					\
+do								\
+  if (yychar == YYEMPTY && yylen == 1)				\
+    {								\
+      yychar = (Token);						\
+      yylval = (Value);						\
+      yytoken = YYTRANSLATE (yychar);				\
+      YYPOPSTACK;						\
+      goto yybackup;						\
+    }								\
+  else								\
+    { 								\
+      yyerror ("syntax error: cannot back up");\
+      YYERROR;							\
+    }								\
+while (0)
+
+#define YYTERROR	1
+#define YYERRCODE	256
+
+/* YYLLOC_DEFAULT -- Compute the default location (before the actions
+   are run).  */
+
+#ifndef YYLLOC_DEFAULT
+# define YYLLOC_DEFAULT(Current, Rhs, N)		\
+   ((Current).first_line   = (Rhs)[1].first_line,	\
+    (Current).first_column = (Rhs)[1].first_column,	\
+    (Current).last_line    = (Rhs)[N].last_line,	\
+    (Current).last_column  = (Rhs)[N].last_column)
+#endif
+
+/* YYLEX -- calling `yylex' with the right arguments.  */
+
+#ifdef YYLEX_PARAM
+# define YYLEX yylex (YYLEX_PARAM)
+#else
+# define YYLEX yylex ()
+#endif
+
+/* Enable debugging if requested.  */
+#if YYDEBUG
+
+# ifndef YYFPRINTF
+#  include <stdio.h> /* INFRINGES ON USER NAME SPACE */
+#  define YYFPRINTF fprintf
+# endif
+
+# define YYDPRINTF(Args)			\
+do {						\
+  if (yydebug)					\
+    YYFPRINTF Args;				\
+} while (0)
+
+# define YYDSYMPRINT(Args)			\
+do {						\
+  if (yydebug)					\
+    yysymprint Args;				\
+} while (0)
+
+# define YYDSYMPRINTF(Title, Token, Value, Location)		\
+do {								\
+  if (yydebug)							\
+    {								\
+      YYFPRINTF (stderr, "%s ", Title);				\
+      yysymprint (stderr, 					\
+                  Token, Value);	\
+      YYFPRINTF (stderr, "\n");					\
+    }								\
+} while (0)
+
+/*------------------------------------------------------------------.
+| yy_stack_print -- Print the state stack from its BOTTOM up to its |
+| TOP (included).                                                   |
+`------------------------------------------------------------------*/
+
+#if defined (__STDC__) || defined (__cplusplus)
+static void
+yy_stack_print (short int *bottom, short int *top)
+#else
+static void
+yy_stack_print (bottom, top)
+    short int *bottom;
+    short int *top;
+#endif
+{
+  YYFPRINTF (stderr, "Stack now");
+  for (/* Nothing. */; bottom <= top; ++bottom)
+    YYFPRINTF (stderr, " %d", *bottom);
+  YYFPRINTF (stderr, "\n");
+}
+
+# define YY_STACK_PRINT(Bottom, Top)				\
+do {								\
+  if (yydebug)							\
+    yy_stack_print ((Bottom), (Top));				\
+} while (0)
+
+
+/*------------------------------------------------.
+| Report that the YYRULE is going to be reduced.  |
+`------------------------------------------------*/
+
+#if defined (__STDC__) || defined (__cplusplus)
+static void
+yy_reduce_print (int yyrule)
+#else
+static void
+yy_reduce_print (yyrule)
+    int yyrule;
+#endif
+{
+  int yyi;
+  unsigned int yylno = yyrline[yyrule];
+  YYFPRINTF (stderr, "Reducing stack by rule %d (line %u), ",
+             yyrule - 1, yylno);
+  /* Print the symbols being reduced, and their result.  */
+  for (yyi = yyprhs[yyrule]; 0 <= yyrhs[yyi]; yyi++)
+    YYFPRINTF (stderr, "%s ", yytname [yyrhs[yyi]]);
+  YYFPRINTF (stderr, "-> %s\n", yytname [yyr1[yyrule]]);
+}
+
+# define YY_REDUCE_PRINT(Rule)		\
+do {					\
+  if (yydebug)				\
+    yy_reduce_print (Rule);		\
+} while (0)
+
+/* Nonzero means print parse trace.  It is left uninitialized so that
+   multiple parsers can coexist.  */
+int yydebug;
+#else /* !YYDEBUG */
+# define YYDPRINTF(Args)
+# define YYDSYMPRINT(Args)
+# define YYDSYMPRINTF(Title, Token, Value, Location)
+# define YY_STACK_PRINT(Bottom, Top)
+# define YY_REDUCE_PRINT(Rule)
+#endif /* !YYDEBUG */
+
+
+/* YYINITDEPTH -- initial size of the parser's stacks.  */
+#ifndef	YYINITDEPTH
+# define YYINITDEPTH 200
+#endif
+
+/* YYMAXDEPTH -- maximum size the stacks can grow to (effective only
+   if the built-in stack extension method is used).
+
+   Do not make this value too large; the results are undefined if
+   SIZE_MAX < YYSTACK_BYTES (YYMAXDEPTH)
+   evaluated with infinite-precision integer arithmetic.  */
+
+#if defined (YYMAXDEPTH) && YYMAXDEPTH == 0
+# undef YYMAXDEPTH
+#endif
+
+#ifndef YYMAXDEPTH
+# define YYMAXDEPTH 10000
+#endif
+
+
+
+#if YYERROR_VERBOSE
+
+# ifndef yystrlen
+#  if defined (__GLIBC__) && defined (_STRING_H)
+#   define yystrlen strlen
+#  else
+/* Return the length of YYSTR.  */
+static YYSIZE_T
+#   if defined (__STDC__) || defined (__cplusplus)
+yystrlen (const char *yystr)
+#   else
+yystrlen (yystr)
+     const char *yystr;
+#   endif
+{
+  register const char *yys = yystr;
+
+  while (*yys++ != '\0')
+    continue;
+
+  return yys - yystr - 1;
+}
+#  endif
+# endif
+
+# ifndef yystpcpy
+#  if defined (__GLIBC__) && defined (_STRING_H) && defined (_GNU_SOURCE)
+#   define yystpcpy stpcpy
+#  else
+/* Copy YYSRC to YYDEST, returning the address of the terminating '\0' in
+   YYDEST.  */
+static char *
+#   if defined (__STDC__) || defined (__cplusplus)
+yystpcpy (char *yydest, const char *yysrc)
+#   else
+yystpcpy (yydest, yysrc)
+     char *yydest;
+     const char *yysrc;
+#   endif
+{
+  register char *yyd = yydest;
+  register const char *yys = yysrc;
+
+  while ((*yyd++ = *yys++) != '\0')
+    continue;
+
+  return yyd - 1;
+}
+#  endif
+# endif
+
+#endif /* !YYERROR_VERBOSE */
+
+
+
+#if YYDEBUG
+/*--------------------------------.
+| Print this symbol on YYOUTPUT.  |
+`--------------------------------*/
+
+#if defined (__STDC__) || defined (__cplusplus)
+static void
+yysymprint (FILE *yyoutput, int yytype, YYSTYPE *yyvaluep)
+#else
+static void
+yysymprint (yyoutput, yytype, yyvaluep)
+    FILE *yyoutput;
+    int yytype;
+    YYSTYPE *yyvaluep;
+#endif
+{
+  /* Pacify ``unused variable'' warnings.  */
+  (void) yyvaluep;
+
+  if (yytype < YYNTOKENS)
+    {
+      YYFPRINTF (yyoutput, "token %s (", yytname[yytype]);
+# ifdef YYPRINT
+      YYPRINT (yyoutput, yytoknum[yytype], *yyvaluep);
+# endif
+    }
+  else
+    YYFPRINTF (yyoutput, "nterm %s (", yytname[yytype]);
+
+  switch (yytype)
+    {
+      default:
+        break;
+    }
+  YYFPRINTF (yyoutput, ")");
+}
+
+#endif /* ! YYDEBUG */
+/*-----------------------------------------------.
+| Release the memory associated to this symbol.  |
+`-----------------------------------------------*/
+
+#if defined (__STDC__) || defined (__cplusplus)
+static void
+yydestruct (int yytype, YYSTYPE *yyvaluep)
+#else
+static void
+yydestruct (yytype, yyvaluep)
+    int yytype;
+    YYSTYPE *yyvaluep;
+#endif
+{
+  /* Pacify ``unused variable'' warnings.  */
+  (void) yyvaluep;
+
+  switch (yytype)
+    {
+      case 50: /* choice_entry */
+
+        {
+	fprintf(stderr, "%s:%d: missing end statement for this entry\n",
+		yyvaluep->menu->file->name, yyvaluep->menu->lineno);
+	if (current_menu == yyvaluep->menu)
+		menu_end_menu();
+};
+
+        break;
+      case 56: /* if_entry */
+
+        {
+	fprintf(stderr, "%s:%d: missing end statement for this entry\n",
+		yyvaluep->menu->file->name, yyvaluep->menu->lineno);
+	if (current_menu == yyvaluep->menu)
+		menu_end_menu();
+};
+
+        break;
+      case 61: /* menu_entry */
+
+        {
+	fprintf(stderr, "%s:%d: missing end statement for this entry\n",
+		yyvaluep->menu->file->name, yyvaluep->menu->lineno);
+	if (current_menu == yyvaluep->menu)
+		menu_end_menu();
+};
+
+        break;
+
+      default:
+        break;
+    }
+}
+
+
+/* Prevent warnings from -Wmissing-prototypes.  */
+
+#ifdef YYPARSE_PARAM
+# if defined (__STDC__) || defined (__cplusplus)
+int yyparse (void *YYPARSE_PARAM);
+# else
+int yyparse ();
+# endif
+#else /* ! YYPARSE_PARAM */
+#if defined (__STDC__) || defined (__cplusplus)
+int yyparse (void);
+#else
+int yyparse ();
+#endif
+#endif /* ! YYPARSE_PARAM */
+
+
+
+/* The lookahead symbol.  */
+int yychar;
+
+/* The semantic value of the lookahead symbol.  */
+YYSTYPE yylval;
+
+/* Number of syntax errors so far.  */
+int yynerrs;
+
+
+
+/*----------.
+| yyparse.  |
+`----------*/
+
+#ifdef YYPARSE_PARAM
+# if defined (__STDC__) || defined (__cplusplus)
+int yyparse (void *YYPARSE_PARAM)
+# else
+int yyparse (YYPARSE_PARAM)
+  void *YYPARSE_PARAM;
+# endif
+#else /* ! YYPARSE_PARAM */
+#if defined (__STDC__) || defined (__cplusplus)
+int
+yyparse (void)
+#else
+int
+yyparse ()
+
+#endif
+#endif
+{
+  
+  register int yystate;
+  register int yyn;
+  int yyresult;
+  /* Number of tokens to shift before error messages enabled.  */
+  int yyerrstatus;
+  /* Lookahead token as an internal (translated) token number.  */
+  int yytoken = 0;
+
+  /* Three stacks and their tools:
+     `yyss': related to states,
+     `yyvs': related to semantic values,
+     `yyls': related to locations.
+
+     Refer to the stacks thru separate pointers, to allow yyoverflow
+     to reallocate them elsewhere.  */
+
+  /* The state stack.  */
+  short int yyssa[YYINITDEPTH];
+  short int *yyss = yyssa;
+  register short int *yyssp;
+
+  /* The semantic value stack.  */
+  YYSTYPE yyvsa[YYINITDEPTH];
+  YYSTYPE *yyvs = yyvsa;
+  register YYSTYPE *yyvsp;
+
+
+
+#define YYPOPSTACK   (yyvsp--, yyssp--)
+
+  YYSIZE_T yystacksize = YYINITDEPTH;
+
+  /* The variables used to return semantic value and location from the
+     action routines.  */
+  YYSTYPE yyval;
+
+
+  /* When reducing, the number of symbols on the RHS of the reduced
+     rule.  */
+  int yylen;
+
+  YYDPRINTF ((stderr, "Starting parse\n"));
+
+  yystate = 0;
+  yyerrstatus = 0;
+  yynerrs = 0;
+  yychar = YYEMPTY;		/* Cause a token to be read.  */
+
+  /* Initialize stack pointers.
+     Waste one element of value and location stack
+     so that they stay on the same level as the state stack.
+     The wasted elements are never initialized.  */
+
+  yyssp = yyss;
+  yyvsp = yyvs;
+
+
+  goto yysetstate;
+
+/*------------------------------------------------------------.
+| yynewstate -- Push a new state, which is found in yystate.  |
+`------------------------------------------------------------*/
+ yynewstate:
+  /* In all cases, when you get here, the value and location stacks
+     have just been pushed. so pushing a state here evens the stacks.
+     */
+  yyssp++;
+
+ yysetstate:
+  *yyssp = yystate;
+
+  if (yyss + yystacksize - 1 <= yyssp)
+    {
+      /* Get the current used size of the three stacks, in elements.  */
+      YYSIZE_T yysize = yyssp - yyss + 1;
+
+#ifdef yyoverflow
+      {
+	/* Give user a chance to reallocate the stack. Use copies of
+	   these so that the &'s don't force the real ones into
+	   memory.  */
+	YYSTYPE *yyvs1 = yyvs;
+	short int *yyss1 = yyss;
+
+
+	/* Each stack pointer address is followed by the size of the
+	   data in use in that stack, in bytes.  This used to be a
+	   conditional around just the two extra args, but that might
+	   be undefined if yyoverflow is a macro.  */
+	yyoverflow ("parser stack overflow",
+		    &yyss1, yysize * sizeof (*yyssp),
+		    &yyvs1, yysize * sizeof (*yyvsp),
+
+		    &yystacksize);
+
+	yyss = yyss1;
+	yyvs = yyvs1;
+      }
+#else /* no yyoverflow */
+# ifndef YYSTACK_RELOCATE
+      goto yyoverflowlab;
+# else
+      /* Extend the stack our own way.  */
+      if (YYMAXDEPTH <= yystacksize)
+	goto yyoverflowlab;
+      yystacksize *= 2;
+      if (YYMAXDEPTH < yystacksize)
+	yystacksize = YYMAXDEPTH;
+
+      {
+	short int *yyss1 = yyss;
+	union yyalloc *yyptr =
+	  (union yyalloc *) YYSTACK_ALLOC (YYSTACK_BYTES (yystacksize));
+	if (! yyptr)
+	  goto yyoverflowlab;
+	YYSTACK_RELOCATE (yyss);
+	YYSTACK_RELOCATE (yyvs);
+
+#  undef YYSTACK_RELOCATE
+	if (yyss1 != yyssa)
+	  YYSTACK_FREE (yyss1);
+      }
+# endif
+#endif /* no yyoverflow */
+
+      yyssp = yyss + yysize - 1;
+      yyvsp = yyvs + yysize - 1;
+
+
+      YYDPRINTF ((stderr, "Stack size increased to %lu\n",
+		  (unsigned long int) yystacksize));
+
+      if (yyss + yystacksize - 1 <= yyssp)
+	YYABORT;
+    }
+
+  YYDPRINTF ((stderr, "Entering state %d\n", yystate));
+
+  goto yybackup;
+
+/*-----------.
+| yybackup.  |
+`-----------*/
+yybackup:
+
+/* Do appropriate processing given the current state.  */
+/* Read a lookahead token if we need one and don't already have one.  */
+/* yyresume: */
+
+  /* First try to decide what to do without reference to lookahead token.  */
+
+  yyn = yypact[yystate];
+  if (yyn == YYPACT_NINF)
+    goto yydefault;
+
+  /* Not known => get a lookahead token if don't already have one.  */
+
+  /* YYCHAR is either YYEMPTY or YYEOF or a valid lookahead symbol.  */
+  if (yychar == YYEMPTY)
+    {
+      YYDPRINTF ((stderr, "Reading a token: "));
+      yychar = YYLEX;
+    }
+
+  if (yychar <= YYEOF)
+    {
+      yychar = yytoken = YYEOF;
+      YYDPRINTF ((stderr, "Now at end of input.\n"));
+    }
+  else
+    {
+      yytoken = YYTRANSLATE (yychar);
+      YYDSYMPRINTF ("Next token is", yytoken, &yylval, &yylloc);
+    }
+
+  /* If the proper action on seeing token YYTOKEN is to reduce or to
+     detect an error, take that action.  */
+  yyn += yytoken;
+  if (yyn < 0 || YYLAST < yyn || yycheck[yyn] != yytoken)
+    goto yydefault;
+  yyn = yytable[yyn];
+  if (yyn <= 0)
+    {
+      if (yyn == 0 || yyn == YYTABLE_NINF)
+	goto yyerrlab;
+      yyn = -yyn;
+      goto yyreduce;
+    }
+
+  if (yyn == YYFINAL)
+    YYACCEPT;
+
+  /* Shift the lookahead token.  */
+  YYDPRINTF ((stderr, "Shifting token %s, ", yytname[yytoken]));
+
+  /* Discard the token being shifted unless it is eof.  */
+  if (yychar != YYEOF)
+    yychar = YYEMPTY;
+
+  *++yyvsp = yylval;
+
+
+  /* Count tokens shifted since error; after three, turn off error
+     status.  */
+  if (yyerrstatus)
+    yyerrstatus--;
+
+  yystate = yyn;
+  goto yynewstate;
+
+
+/*-----------------------------------------------------------.
+| yydefault -- do the default action for the current state.  |
+`-----------------------------------------------------------*/
+yydefault:
+  yyn = yydefact[yystate];
+  if (yyn == 0)
+    goto yyerrlab;
+  goto yyreduce;
+
+
+/*-----------------------------.
+| yyreduce -- Do a reduction.  |
+`-----------------------------*/
+yyreduce:
+  /* yyn is the number of a rule to reduce with.  */
+  yylen = yyr2[yyn];
+
+  /* If YYLEN is nonzero, implement the default value of the action:
+     `$$ = $1'.
+
+     Otherwise, the following line sets YYVAL to garbage.
+     This behavior is undocumented and Bison
+     users should not rely upon it.  Assigning to YYVAL
+     unconditionally makes the parser a bit smaller, and it avoids a
+     GCC warning that YYVAL may be used uninitialized.  */
+  yyval = yyvsp[1-yylen];
+
+
+  YY_REDUCE_PRINT (yyn);
+  switch (yyn)
+    {
+        case 8:
+
+    { zconf_error("unexpected end statement"); ;}
+    break;
+
+  case 9:
+
+    { zconf_error("unknown statement \"%s\"", yyvsp[-2].string); ;}
+    break;
+
+  case 10:
+
+    {
+	zconf_error("unexpected option \"%s\"", kconf_id_strings + yyvsp[-2].id->name);
+;}
+    break;
+
+  case 11:
+
+    { zconf_error("invalid statement"); ;}
+    break;
+
+  case 27:
+
+    { zconf_error("unknown option \"%s\"", yyvsp[-2].string); ;}
+    break;
+
+  case 28:
+
+    { zconf_error("invalid option"); ;}
+    break;
+
+  case 29:
+
+    {
+	struct symbol *sym = sym_lookup(yyvsp[-1].string, 0);
+	sym->flags |= SYMBOL_OPTIONAL;
+	menu_add_entry(sym);
+	printd(DEBUG_PARSE, "%s:%d:config %s\n", zconf_curname(), zconf_lineno(), yyvsp[-1].string);
+;}
+    break;
+
+  case 30:
+
+    {
+	menu_end_entry();
+	printd(DEBUG_PARSE, "%s:%d:endconfig\n", zconf_curname(), zconf_lineno());
+;}
+    break;
+
+  case 31:
+
+    {
+	struct symbol *sym = sym_lookup(yyvsp[-1].string, 0);
+	sym->flags |= SYMBOL_OPTIONAL;
+	menu_add_entry(sym);
+	printd(DEBUG_PARSE, "%s:%d:menuconfig %s\n", zconf_curname(), zconf_lineno(), yyvsp[-1].string);
+;}
+    break;
+
+  case 32:
+
+    {
+	if (current_entry->prompt)
+		current_entry->prompt->type = P_MENU;
+	else
+		zconfprint("warning: menuconfig statement without prompt");
+	menu_end_entry();
+	printd(DEBUG_PARSE, "%s:%d:endconfig\n", zconf_curname(), zconf_lineno());
+;}
+    break;
+
+  case 39:
+
+    {
+	menu_set_type(yyvsp[-2].id->stype);
+	printd(DEBUG_PARSE, "%s:%d:type(%u)\n",
+		zconf_curname(), zconf_lineno(),
+		yyvsp[-2].id->stype);
+;}
+    break;
+
+  case 40:
+
+    {
+	menu_add_prompt(P_PROMPT, yyvsp[-2].string, yyvsp[-1].expr);
+	printd(DEBUG_PARSE, "%s:%d:prompt\n", zconf_curname(), zconf_lineno());
+;}
+    break;
+
+  case 41:
+
+    {
+	menu_add_expr(P_DEFAULT, yyvsp[-2].expr, yyvsp[-1].expr);
+	if (yyvsp[-3].id->stype != S_UNKNOWN)
+		menu_set_type(yyvsp[-3].id->stype);
+	printd(DEBUG_PARSE, "%s:%d:default(%u)\n",
+		zconf_curname(), zconf_lineno(),
+		yyvsp[-3].id->stype);
+;}
+    break;
+
+  case 42:
+
+    {
+	menu_add_symbol(P_DESELECT, sym_lookup(yyvsp[-2].string, 0), yyvsp[-1].expr);
+	printd(DEBUG_PARSE, "%s:%d:deselect\n", zconf_curname(), zconf_lineno());
+;}
+    break;
+
+  case 43:
+
+    {
+	menu_add_symbol(P_SELECT, sym_lookup(yyvsp[-2].string, 0), yyvsp[-1].expr);
+	printd(DEBUG_PARSE, "%s:%d:select\n", zconf_curname(), zconf_lineno());
+;}
+    break;
+
+  case 44:
+
+    {
+	menu_add_expr(P_RANGE, expr_alloc_comp(E_RANGE,yyvsp[-3].symbol, yyvsp[-2].symbol), yyvsp[-1].expr);
+	printd(DEBUG_PARSE, "%s:%d:range\n", zconf_curname(), zconf_lineno());
+;}
+    break;
+
+  case 45:
+
+    {
+	struct symbol *sym = sym_lookup(NULL, 0);
+	sym->flags |= SYMBOL_CHOICE;
+	menu_add_entry(sym);
+	menu_add_expr(P_CHOICE, NULL, NULL);
+	printd(DEBUG_PARSE, "%s:%d:choice\n", zconf_curname(), zconf_lineno());
+;}
+    break;
+
+  case 46:
+
+    {
+	yyval.menu = menu_add_menu();
+;}
+    break;
+
+  case 47:
+
+    {
+	if (zconf_endtoken(yyvsp[0].id, T_CHOICE, T_ENDCHOICE)) {
+		menu_end_menu();
+		printd(DEBUG_PARSE, "%s:%d:endchoice\n", zconf_curname(), zconf_lineno());
+	}
+;}
+    break;
+
+  case 55:
+
+    {
+	menu_add_prompt(P_PROMPT, yyvsp[-2].string, yyvsp[-1].expr);
+	printd(DEBUG_PARSE, "%s:%d:prompt\n", zconf_curname(), zconf_lineno());
+;}
+    break;
+
+  case 56:
+
+    {
+	if (yyvsp[-2].id->stype == S_BOOLEAN || yyvsp[-2].id->stype == S_TRISTATE) {
+		menu_set_type(yyvsp[-2].id->stype);
+		printd(DEBUG_PARSE, "%s:%d:type(%u)\n",
+			zconf_curname(), zconf_lineno(),
+			yyvsp[-2].id->stype);
+	} else
+		YYERROR;
+;}
+    break;
+
+  case 57:
+
+    {
+	current_entry->sym->flags |= SYMBOL_OPTIONAL;
+	printd(DEBUG_PARSE, "%s:%d:optional\n", zconf_curname(), zconf_lineno());
+;}
+    break;
+
+  case 58:
+
+    {
+	menu_add_prop(P_RESET, NULL, NULL, yyvsp[-1].expr);
+;}
+    break;
+
+  case 59:
+
+    {
+	if (yyvsp[-3].id->stype == S_UNKNOWN) {
+		menu_add_symbol(P_DEFAULT, sym_lookup(yyvsp[-2].string, 0), yyvsp[-1].expr);
+		printd(DEBUG_PARSE, "%s:%d:default\n",
+			zconf_curname(), zconf_lineno());
+	} else
+		YYERROR;
+;}
+    break;
+
+  case 62:
+
+    {
+	printd(DEBUG_PARSE, "%s:%d:if\n", zconf_curname(), zconf_lineno());
+	menu_add_entry(NULL);
+	menu_add_dep(yyvsp[-1].expr);
+	yyval.menu = menu_add_menu();
+;}
+    break;
+
+  case 63:
+
+    {
+	if (zconf_endtoken(yyvsp[0].id, T_IF, T_ENDIF)) {
+		menu_end_menu();
+		printd(DEBUG_PARSE, "%s:%d:endif\n", zconf_curname(), zconf_lineno());
+	}
+;}
+    break;
+
+  case 69:
+
+    {
+	menu_add_entry(NULL);
+	menu_add_prompt(P_MENU, yyvsp[-1].string, NULL);
+	printd(DEBUG_PARSE, "%s:%d:menu\n", zconf_curname(), zconf_lineno());
+;}
+    break;
+
+  case 70:
+
+    {
+	yyval.menu = menu_add_menu();
+;}
+    break;
+
+  case 71:
+
+    {
+	if (zconf_endtoken(yyvsp[0].id, T_MENU, T_ENDMENU)) {
+		menu_end_menu();
+		printd(DEBUG_PARSE, "%s:%d:endmenu\n", zconf_curname(), zconf_lineno());
+	}
+;}
+    break;
+
+  case 77:
+
+    {
+	printd(DEBUG_PARSE, "%s:%d:source %s\n", zconf_curname(), zconf_lineno(), yyvsp[-1].string);
+	zconf_nextfile(yyvsp[-1].string);
+;}
+    break;
+
+  case 78:
+
+    {
+	menu_add_entry(NULL);
+	menu_add_prompt(P_COMMENT, yyvsp[-1].string, NULL);
+	printd(DEBUG_PARSE, "%s:%d:comment\n", zconf_curname(), zconf_lineno());
+;}
+    break;
+
+  case 79:
+
+    {
+	menu_end_entry();
+;}
+    break;
+
+  case 80:
+
+    {
+	printd(DEBUG_PARSE, "%s:%d:help\n", zconf_curname(), zconf_lineno());
+	zconf_starthelp();
+;}
+    break;
+
+  case 81:
+
+    {
+	current_entry->sym->help = yyvsp[0].string;
+;}
+    break;
+
+  case 86:
+
+    {
+	menu_add_dep(yyvsp[-1].expr);
+	printd(DEBUG_PARSE, "%s:%d:depends on\n", zconf_curname(), zconf_lineno());
+;}
+    break;
+
+  case 87:
+
+    {
+	menu_add_dep(yyvsp[-1].expr);
+	printd(DEBUG_PARSE, "%s:%d:depends\n", zconf_curname(), zconf_lineno());
+;}
+    break;
+
+  case 88:
+
+    {
+	menu_add_dep(yyvsp[-1].expr);
+	printd(DEBUG_PARSE, "%s:%d:requires\n", zconf_curname(), zconf_lineno());
+;}
+    break;
+
+  case 90:
+
+    {
+	menu_add_prompt(P_PROMPT, yyvsp[-1].string, yyvsp[0].expr);
+;}
+    break;
+
+  case 93:
+
+    { yyval.id = yyvsp[-1].id; ;}
+    break;
+
+  case 94:
+
+    { yyval.id = yyvsp[-1].id; ;}
+    break;
+
+  case 95:
+
+    { yyval.id = yyvsp[-1].id; ;}
+    break;
+
+  case 98:
+
+    { yyval.expr = NULL; ;}
+    break;
+
+  case 99:
+
+    { yyval.expr = yyvsp[0].expr; ;}
+    break;
+
+  case 100:
+
+    { yyval.expr = expr_alloc_symbol(yyvsp[0].symbol); ;}
+    break;
+
+  case 101:
+
+    { yyval.expr = expr_alloc_comp(E_EQUAL, yyvsp[-2].symbol, yyvsp[0].symbol); ;}
+    break;
+
+  case 102:
+
+    { yyval.expr = expr_alloc_comp(E_UNEQUAL, yyvsp[-2].symbol, yyvsp[0].symbol); ;}
+    break;
+
+  case 103:
+
+    { yyval.expr = yyvsp[-1].expr; ;}
+    break;
+
+  case 104:
+
+    { yyval.expr = expr_alloc_one(E_NOT, yyvsp[0].expr); ;}
+    break;
+
+  case 105:
+
+    { yyval.expr = expr_alloc_two(E_OR, yyvsp[-2].expr, yyvsp[0].expr); ;}
+    break;
+
+  case 106:
+
+    { yyval.expr = expr_alloc_two(E_AND, yyvsp[-2].expr, yyvsp[0].expr); ;}
+    break;
+
+  case 107:
+
+    { yyval.symbol = sym_lookup(yyvsp[0].string, 0); free(yyvsp[0].string); ;}
+    break;
+
+  case 108:
+
+    { yyval.symbol = sym_lookup(yyvsp[0].string, 1); free(yyvsp[0].string); ;}
+    break;
+
+
+    }
+
+/* Line 1010 of yacc.c.  */
+
+
+  yyvsp -= yylen;
+  yyssp -= yylen;
+
+
+  YY_STACK_PRINT (yyss, yyssp);
+
+  *++yyvsp = yyval;
+
+
+  /* Now `shift' the result of the reduction.  Determine what state
+     that goes to, based on the state we popped back to and the rule
+     number reduced by.  */
+
+  yyn = yyr1[yyn];
+
+  yystate = yypgoto[yyn - YYNTOKENS] + *yyssp;
+  if (0 <= yystate && yystate <= YYLAST && yycheck[yystate] == *yyssp)
+    yystate = yytable[yystate];
+  else
+    yystate = yydefgoto[yyn - YYNTOKENS];
+
+  goto yynewstate;
+
+
+/*------------------------------------.
+| yyerrlab -- here on detecting error |
+`------------------------------------*/
+yyerrlab:
+  /* If not already recovering from an error, report this error.  */
+  if (!yyerrstatus)
+    {
+      ++yynerrs;
+#if YYERROR_VERBOSE
+      yyn = yypact[yystate];
+
+      if (YYPACT_NINF < yyn && yyn < YYLAST)
+	{
+	  YYSIZE_T yysize = 0;
+	  int yytype = YYTRANSLATE (yychar);
+	  const char* yyprefix;
+	  char *yymsg;
+	  int yyx;
+
+	  /* Start YYX at -YYN if negative to avoid negative indexes in
+	     YYCHECK.  */
+	  int yyxbegin = yyn < 0 ? -yyn : 0;
+
+	  /* Stay within bounds of both yycheck and yytname.  */
+	  int yychecklim = YYLAST - yyn;
+	  int yyxend = yychecklim < YYNTOKENS ? yychecklim : YYNTOKENS;
+	  int yycount = 0;
+
+	  yyprefix = ", expecting ";
+	  for (yyx = yyxbegin; yyx < yyxend; ++yyx)
+	    if (yycheck[yyx + yyn] == yyx && yyx != YYTERROR)
+	      {
+		yysize += yystrlen (yyprefix) + yystrlen (yytname [yyx]);
+		yycount += 1;
+		if (yycount == 5)
+		  {
+		    yysize = 0;
+		    break;
+		  }
+	      }
+	  yysize += (sizeof ("syntax error, unexpected ")
+		     + yystrlen (yytname[yytype]));
+	  yymsg = (char *) YYSTACK_ALLOC (yysize);
+	  if (yymsg != 0)
+	    {
+	      char *yyp = yystpcpy (yymsg, "syntax error, unexpected ");
+	      yyp = yystpcpy (yyp, yytname[yytype]);
+
+	      if (yycount < 5)
+		{
+		  yyprefix = ", expecting ";
+		  for (yyx = yyxbegin; yyx < yyxend; ++yyx)
+		    if (yycheck[yyx + yyn] == yyx && yyx != YYTERROR)
+		      {
+			yyp = yystpcpy (yyp, yyprefix);
+			yyp = yystpcpy (yyp, yytname[yyx]);
+			yyprefix = " or ";
+		      }
+		}
+	      yyerror (yymsg);
+	      YYSTACK_FREE (yymsg);
+	    }
+	  else
+	    yyerror ("syntax error; also virtual memory exhausted");
+	}
+      else
+#endif /* YYERROR_VERBOSE */
+	yyerror ("syntax error");
+    }
+
+
+
+  if (yyerrstatus == 3)
+    {
+      /* If just tried and failed to reuse lookahead token after an
+	 error, discard it.  */
+
+      if (yychar <= YYEOF)
+        {
+          /* If at end of input, pop the error token,
+	     then the rest of the stack, then return failure.  */
+	  if (yychar == YYEOF)
+	     for (;;)
+	       {
+		 YYPOPSTACK;
+		 if (yyssp == yyss)
+		   YYABORT;
+		 YYDSYMPRINTF ("Error: popping", yystos[*yyssp], yyvsp, yylsp);
+		 yydestruct (yystos[*yyssp], yyvsp);
+	       }
+        }
+      else
+	{
+	  YYDSYMPRINTF ("Error: discarding", yytoken, &yylval, &yylloc);
+	  yydestruct (yytoken, &yylval);
+	  yychar = YYEMPTY;
+
+	}
+    }
+
+  /* Else will try to reuse lookahead token after shifting the error
+     token.  */
+  goto yyerrlab1;
+
+
+/*---------------------------------------------------.
+| yyerrorlab -- error raised explicitly by YYERROR.  |
+`---------------------------------------------------*/
+yyerrorlab:
+
+#ifdef __GNUC__
+  /* Pacify GCC when the user code never invokes YYERROR and the label
+     yyerrorlab therefore never appears in user code.  */
+  if (0)
+     goto yyerrorlab;
+#endif
+
+  yyvsp -= yylen;
+  yyssp -= yylen;
+  yystate = *yyssp;
+  goto yyerrlab1;
+
+
+/*-------------------------------------------------------------.
+| yyerrlab1 -- common code for both syntax error and YYERROR.  |
+`-------------------------------------------------------------*/
+yyerrlab1:
+  yyerrstatus = 3;	/* Each real token shifted decrements this.  */
+
+  for (;;)
+    {
+      yyn = yypact[yystate];
+      if (yyn != YYPACT_NINF)
+	{
+	  yyn += YYTERROR;
+	  if (0 <= yyn && yyn <= YYLAST && yycheck[yyn] == YYTERROR)
+	    {
+	      yyn = yytable[yyn];
+	      if (0 < yyn)
+		break;
+	    }
+	}
+
+      /* Pop the current state because it cannot handle the error token.  */
+      if (yyssp == yyss)
+	YYABORT;
+
+      YYDSYMPRINTF ("Error: popping", yystos[*yyssp], yyvsp, yylsp);
+      yydestruct (yystos[yystate], yyvsp);
+      YYPOPSTACK;
+      yystate = *yyssp;
+      YY_STACK_PRINT (yyss, yyssp);
+    }
+
+  if (yyn == YYFINAL)
+    YYACCEPT;
+
+  YYDPRINTF ((stderr, "Shifting error token, "));
+
+  *++yyvsp = yylval;
+
+
+  yystate = yyn;
+  goto yynewstate;
+
+
+/*-------------------------------------.
+| yyacceptlab -- YYACCEPT comes here.  |
+`-------------------------------------*/
+yyacceptlab:
+  yyresult = 0;
+  goto yyreturn;
+
+/*-----------------------------------.
+| yyabortlab -- YYABORT comes here.  |
+`-----------------------------------*/
+yyabortlab:
+  yyresult = 1;
+  goto yyreturn;
+
+#ifndef yyoverflow
+/*----------------------------------------------.
+| yyoverflowlab -- parser overflow comes here.  |
+`----------------------------------------------*/
+yyoverflowlab:
+  yyerror ("parser stack overflow");
+  yyresult = 2;
+  /* Fall through.  */
+#endif
+
+yyreturn:
+#ifndef yyoverflow
+  if (yyss != yyssa)
+    YYSTACK_FREE (yyss);
+#endif
+  return yyresult;
+}
+
+
+
+
+
+void conf_parse(const char *name)
+{
+	struct symbol *sym;
+	int i;
+
+	zconf_initscan(name);
+
+	sym_init();
+	menu_init();
+	modules_sym = sym_lookup("MODULES", 0);
+	rootmenu.prompt = menu_add_prompt(P_MENU, "OpenWrt Configuration", NULL);
+
+#if YYDEBUG
+	if (getenv("ZCONF_DEBUG"))
+		zconfdebug = 1;
+#endif
+	zconfparse();
+	if (zconfnerrs)
+		exit(1);
+	menu_finalize(&rootmenu);
+	for_all_symbols(i, sym) {
+		sym_check_deps(sym);
+        }
+
+	sym_change_count = 1;
+}
+
+const char *zconf_tokenname(int token)
+{
+	switch (token) {
+	case T_MENU:		return "menu";
+	case T_ENDMENU:		return "endmenu";
+	case T_CHOICE:		return "choice";
+	case T_ENDCHOICE:	return "endchoice";
+	case T_IF:		return "if";
+	case T_ENDIF:		return "endif";
+	case T_DEPENDS:		return "depends";
+	}
+	return "<token>";
+}
+
+static bool zconf_endtoken(struct kconf_id *id, int starttoken, int endtoken)
+{
+	if (id->token != endtoken) {
+		zconf_error("unexpected '%s' within %s block",
+			kconf_id_strings + id->name, zconf_tokenname(starttoken));
+		zconfnerrs++;
+		return false;
+	}
+	if (current_menu->file != current_file) {
+		zconf_error("'%s' in different file than '%s'",
+			kconf_id_strings + id->name, zconf_tokenname(starttoken));
+		fprintf(stderr, "%s:%d: location of the '%s'\n",
+			current_menu->file->name, current_menu->lineno,
+			zconf_tokenname(starttoken));
+		zconfnerrs++;
+		return false;
+	}
+	return true;
+}
+
+static void zconfprint(const char *err, ...)
+{
+	va_list ap;
+
+	fprintf(stderr, "%s:%d: ", zconf_curname(), zconf_lineno());
+	va_start(ap, err);
+	vfprintf(stderr, err, ap);
+	va_end(ap);
+	fprintf(stderr, "\n");
+}
+
+static void zconf_error(const char *err, ...)
+{
+	va_list ap;
+
+	zconfnerrs++;
+	fprintf(stderr, "%s:%d: ", zconf_curname(), zconf_lineno());
+	va_start(ap, err);
+	vfprintf(stderr, err, ap);
+	va_end(ap);
+	fprintf(stderr, "\n");
+}
+
+static void zconferror(const char *err)
+{
+#if YYDEBUG
+	fprintf(stderr, "%s:%d: %s\n", zconf_curname(), zconf_lineno() + 1, err);
+#endif
+}
+
+void print_quoted_string(FILE *out, const char *str)
+{
+	const char *p;
+	int len;
+
+	putc('"', out);
+	while ((p = strchr(str, '"'))) {
+		len = p - str;
+		if (len)
+			fprintf(out, "%.*s", len, str);
+		fputs("\\\"", out);
+		str = p + 1;
+	}
+	fputs(str, out);
+	putc('"', out);
+}
+
+void print_symbol(FILE *out, struct menu *menu)
+{
+	struct symbol *sym = menu->sym;
+	struct property *prop;
+
+	if (sym_is_choice(sym))
+		fprintf(out, "choice\n");
+	else
+		fprintf(out, "config %s\n", sym->name);
+	switch (sym->type) {
+	case S_BOOLEAN:
+		fputs("  boolean\n", out);
+		break;
+	case S_TRISTATE:
+		fputs("  tristate\n", out);
+		break;
+	case S_STRING:
+		fputs("  string\n", out);
+		break;
+	case S_INT:
+		fputs("  integer\n", out);
+		break;
+	case S_HEX:
+		fputs("  hex\n", out);
+		break;
+	default:
+		fputs("  ???\n", out);
+		break;
+	}
+	for (prop = sym->prop; prop; prop = prop->next) {
+		if (prop->menu != menu)
+			continue;
+		switch (prop->type) {
+		case P_PROMPT:
+			fputs("  prompt ", out);
+			print_quoted_string(out, prop->text);
+			if (!expr_is_yes(prop->visible.expr)) {
+				fputs(" if ", out);
+				expr_fprint(prop->visible.expr, out);
+			}
+			fputc('\n', out);
+			break;
+		case P_DEFAULT:
+			fputs( "  default ", out);
+			expr_fprint(prop->expr, out);
+			if (!expr_is_yes(prop->visible.expr)) {
+				fputs(" if ", out);
+				expr_fprint(prop->visible.expr, out);
+			}
+			fputc('\n', out);
+			break;
+		case P_CHOICE:
+			fputs("  #choice value\n", out);
+			break;
+		default:
+			fprintf(out, "  unknown prop %d!\n", prop->type);
+			break;
+		}
+	}
+	if (sym->help) {
+		int len = strlen(sym->help);
+		while (sym->help[--len] == '\n')
+			sym->help[len] = 0;
+		fprintf(out, "  help\n%s\n", sym->help);
+	}
+	fputc('\n', out);
+}
+
+void zconfdump(FILE *out)
+{
+	struct property *prop;
+	struct symbol *sym;
+	struct menu *menu;
+
+	menu = rootmenu.list;
+	while (menu) {
+		if ((sym = menu->sym))
+			print_symbol(out, menu);
+		else if ((prop = menu->prompt)) {
+			switch (prop->type) {
+			case P_COMMENT:
+				fputs("\ncomment ", out);
+				print_quoted_string(out, prop->text);
+				fputs("\n", out);
+				break;
+			case P_MENU:
+				fputs("\nmenu ", out);
+				print_quoted_string(out, prop->text);
+				fputs("\n", out);
+				break;
+			default:
+				;
+			}
+			if (!expr_is_yes(prop->visible.expr)) {
+				fputs("  depends ", out);
+				expr_fprint(prop->visible.expr, out);
+				fputc('\n', out);
+			}
+			fputs("\n", out);
+		}
+
+		if (menu->list)
+			menu = menu->list;
+		else if (menu->next)
+			menu = menu->next;
+		else while ((menu = menu->parent)) {
+			if (menu->prompt && menu->prompt->type == P_MENU)
+				fputs("\nendmenu\n", out);
+			if (menu->next) {
+				menu = menu->next;
+				break;
+			}
+		}
+	}
+}
+
+#include "lex.zconf.c"
+#include "util.c"
+#include "confdata.c"
+#include "expr.c"
+#include "symbol.c"
+#include "menu.c"
+
+
diff --exclude=.svn --exclude=.config.old --exclude=brcm47xx --exclude=tmp -ruN buildroot.orig/staging_dir/toolchain-mipsel_gcc-3.4.6_uClibc-0.9.30.1/info.mk buildroot/staging_dir/toolchain-mipsel_gcc-3.4.6_uClibc-0.9.30.1/info.mk
--- buildroot.orig/staging_dir/toolchain-mipsel_gcc-3.4.6_uClibc-0.9.30.1/info.mk	1969-12-31 19:00:00.000000000 -0500
+++ buildroot/staging_dir/toolchain-mipsel_gcc-3.4.6_uClibc-0.9.30.1/info.mk	2010-09-24 22:27:13.000000000 -0400
@@ -0,0 +1,6 @@
+TARGET_CROSS=
+GCC_VERSION=unknown
+LIBC_TYPE=unknown
+LIBC_URL=unknown
+LIBC_VERSION=unknown
+LIBC_SO_VERSION=unknown
